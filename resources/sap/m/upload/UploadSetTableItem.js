/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/ColumnListItem","sap/ui/core/IconPool","sap/m/upload/UploadSetTableItemRenderer","sap/base/Log","sap/m/upload/FilePreviewDialog"],function(e,t,i,n,s){"use strict";var a=e.extend("sap.m.upload.UploadSetTableItem",{metadata:{properties:{fileName:{type:"string",defaultValue:null},mediaType:{type:"string",defaultValue:null},url:{type:"string",defaultValue:null},uploadUrl:{type:"string",defaultValue:null},uploadState:{type:"sap.m.UploadState",defaultValue:null}},aggregations:{headerFields:{type:"sap.ui.core.Item",multiple:true,singularName:"headerField"}}},render:i});a.prototype.init=function(){e.prototype.init.apply(this,arguments);this._oFileObject=null;this._fFileSize=null;this._bFileTypeRestricted=false;this._bNameLengthRestricted=false;this._bSizeRestricted=false;this._bMediaTypeRestricted=false};a.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments)};a.prototype.onAfterRendering=function(){e.prototype.onAfterRendering.call(this)};a.prototype.exit=function(){e.prototype.exit.call(this)};a.prototype.setFileName=function(e){if(this.getFileName()!==e){this.setProperty("fileName",e,true);if(this.getParent()){this._checkNameLengthRestriction(this.getParent().getMaxFileNameLength());this._checkTypeRestriction(this.getParent().getFileTypes())}}return this};a.prototype.getFileObject=function(){return this._oFileObject};a.openPreview=function(e){e._previewCarousel()};a.prototype.download=function(e){var t=this.getParent();if(!t){n.warning("Download cannot proceed without a parent association.");return false}return t._getActiveUploader?t._getActiveUploader().download(this,[],e):false};a.prototype.isRestricted=function(){return this._isRestricted()};a.prototype._previewCarousel=function(){var e=new s(this);e.open()};a._getIconByMimeType=function(e,i){var n=["image/png","image/tiff","image/bmp","image/jpeg","image/gif"];if(e){if(n.indexOf(e)===-1){return t.getIconForMimeType(e)}return a._getIconByFileType(i)}else{return a._getIconByFileType(i)}};a._getIconByFileType=function(e){var t=a._splitFileName(e).extension;if(!t){return"sap-icon://document"}switch(t.toLowerCase()){case"bmp":case"jpg":case"jpeg":case"png":return a.IMAGE_FILE_ICON;case"csv":case"xls":case"xlsx":return"sap-icon://excel-attachment";case"doc":case"docx":case"odt":return"sap-icon://doc-attachment";case"pdf":return"sap-icon://pdf-attachment";case"ppt":case"pptx":return"sap-icon://ppt-attachment";case"txt":return"sap-icon://document-text";default:return"sap-icon://document"}};a._splitFileName=function(e,t){var i={};var n=/(?:\.([^.]+))?$/;var s=n.exec(e);if(!s[0]){s[0]="";i.name=e}else{i.name=e?e.slice(0,e.indexOf(s[0])):""}if(t){i.extension=s[0]}else{i.extension=s[1]}return i};a.prototype._setFileObject=function(e){this._oFileObject=e;if(e){this._fFileSize=e.size/a.MEGABYTE;this.setMediaType(e.type)}else{this._fFileSize=null;this.setMediaType(null)}if(this.getParent()){this._checkSizeRestriction(this.getParent().getMaxFileSize());this._checkMediaTypeRestriction(this.getParent().getMediaTypes())}};a.prototype._checkNameLengthRestriction=function(e){var t=e&&!!this.getFileName()&&this.getFileName().length>e;if(t!==this._bNameLengthRestricted){this._bNameLengthRestricted=t;this.invalidate();if(t&&this.getParent()){this.getParent().fireFileNameLengthExceeded({item:this})}}};a.prototype._checkSizeRestriction=function(e){var t=e&&this._fFileSize>e;if(t!==this._bSizeRestricted){this._bSizeRestricted=t;this.invalidate();if(t&&this.getParent()){this.getParent().fireFileSizeExceeded({item:this})}}};a.prototype._checkMediaTypeRestriction=function(e){var t=!!e&&e.length>0&&!!this.getMediaType()&&e.indexOf(this.getMediaType())===-1;if(t!==this._bMediaTypeRestricted){this._bMediaTypeRestricted=t;this.invalidate();if(t&&this.getParent()){this.getParent().fireMediaTypeMismatch({item:this})}}};a.prototype._checkTypeRestriction=function(e){var t=a._splitFileName(this.getFileName()),i=!!this.getFileName()&&!!e&&e.length>0&&t.extension&&e.indexOf(t.extension.toLowerCase())===-1;if(i!==this._bFileTypeRestricted){this._bFileTypeRestricted=i;this.invalidate();if(i&&this.getParent()){this.getParent().fireFileTypeMismatch({item:this})}}};a.prototype._isRestricted=function(){return this._bFileTypeRestricted||this._bNameLengthRestricted||this._bSizeRestricted||this._bMediaTypeRestricted};a.IMAGE_FILE_ICON="sap-icon://card";a.MEGABYTE=1048576;return a});
//# sourceMappingURL=UploadSetTableItem.js.map