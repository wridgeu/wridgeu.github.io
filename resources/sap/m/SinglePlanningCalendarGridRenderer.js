/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/unified/calendar/CalendarDate","sap/ui/unified/calendar/CalendarUtils","sap/ui/core/date/UniversalDate","sap/ui/core/IconPool","sap/ui/core/InvisibleText","./PlanningCalendarLegend","sap/ui/unified/library","sap/ui/core/Configuration","sap/ui/core/date/UI5Date"],function(e,a,t,l,n,r,s,i,o){"use strict";var p=.125;var d=.125;var c=.0625;var g=s.CalendarDayType;var u={apiVersion:2};u.render=function(e,a){e.openStart("div",a);e.class("sapMSinglePCGrid");e.openEnd();e.renderControl(a.getAggregation("_columnHeaders"));this.renderBlockersContainer(e,a);e.openStart("div");e.attr("role","grid");e.class("sapMSinglePCGridContent");e.openEnd();this.renderRowHeaders(e,a);this.renderNowMarker(e,a);this.renderColumns(e,a);e.close("div");e.close("div")};u.renderBlockersContainer=function(t,l){var s=l._getColumns(),i=l._getBlockersToRender().iMaxlevel,o=l.getStartDate(),p=(i+1)*l._getBlockerRowHeight()+.1875,d=l._getDateFormatter(),c=l._getSpecialDates(),g=e.fromLocalJSDate(o),u=l._getColumnHeaders()._getDateTypes(g),f,S;t.openStart("div");t.attr("role","grid");t.class("sapMSinglePCBlockersRow");t.openEnd();t.openStart("div");t.attr("role","row");t.class("sapMSinglePCBlockersColumns");if(c&&l._getColumns()===1){if(u&&u[0]){f=u[0];t.class("sapUiCalItem"+f.type);S=r.findLegendItemForItem(sap.ui.getCore().byId(l._sLegendId),f)}t.class("sapMSpecialDaysInDayView")}t.style("height",p+"rem");t.openEnd();this.renderDndPlaceholders(t,l,l.getAggregation("_blockersPlaceholders"));for(var C=0;C<s;C++){var v=new e(o.getFullYear(),o.getMonth(),o.getDate()+C);t.openStart("div");t.attr("role","gridcell");t.attr("data-sap-start-date",d.format(v.toLocalJSDate()));t.attr("data-sap-end-date",d.format(v.toLocalJSDate()));t.attr("aria-labelledby",n.getStaticId("sap.m","SPC_BLOCKERS")+" "+"fullDay-"+d.format(v.toLocalJSDate())+"-Descr");t.class("sapMSinglePCBlockersColumn");t.attr("tabindex",-1);if(v.isSame(new e)){t.class("sapMSinglePCBlockersColumnToday")}if(a._isWeekend(v,l._getCoreLocaleData())){t.class("sapMSinglePCBlockersColumnWeekend")}t.openEnd();t.openStart("span","fullDay-"+d.format(v.toLocalJSDate())+"-Descr");t.class("sapUiInvisibleText");t.openEnd();t.text(l._getCellStartEndInfo(v.toLocalJSDate()));if(l._sLegendId&&S){t.text(S)}t.close("span");t.close("div")}this.renderBlockers(t,l);t.close("div");t.close("div")};u.renderBlockers=function(e,a){var t=this,l=a._getBlockersToRender().oBlockersList;e.openStart("div");e.attr("role","list");e.attr("aria-labelledby",n.getStaticId("sap.m","SPC_BLOCKERS"));e.class("sapMSinglePCBlockers");e.class("sapUiCalendarRowVisFilled");e.openEnd();l.getIterator().forEach(function(l){t.renderBlockerAppointment(e,a,l)});e.close("div")};u.renderBlockerAppointment=function(t,l,r){var s=e.fromLocalJSDate(l.getStartDate()),o=r.getData(),p=e.fromLocalJSDate(o.getStartDate()),d=e.fromLocalJSDate(o.getEndDate()),c=a._daysBetween(p,s),u=a._daysBetween(d,s),f=l._getColumns(),S=l._getBlockerRowHeight(),C=r.level,v=r.width,m=o.getTooltip_AsString(),b=o.getType(),A=o.getColor(),T=o.getTitle(),y=o.getText(),M=o.getIcon(),_=o.getId(),P={role:"listitem",labelledby:{value:n.getStaticId("sap.ui.unified","APPOINTMENT"),append:true},selected:null},E=l.getAriaLabelledBy(),I=c*(100/f),w=(f-u-1)*(100/f),D=i.getRTL(),h;if(E.length>0){P["labelledby"].value=P["labelledby"].value+" "+E.join(" ")}if(T){P["labelledby"].value=P["labelledby"].value+" "+_+"-Title"}P["labelledby"].value=P["labelledby"].value+" "+_+"-Descr";if(y){P["labelledby"].value=P["labelledby"].value+" "+_+"-Text"}if(o.getTentative()){P["labelledby"].value=P["labelledby"].value+" "+n.getStaticId("sap.ui.unified","APPOINTMENT_TENTATIVE")}if(o.getSelected()){P["labelledby"].value=P["labelledby"].value+" "+n.getStaticId("sap.ui.unified","APPOINTMENT_SELECTED")}t.openStart("div",o);t.attr("data-sap-level",C);t.attr("data-sap-width",v);t.attr("tabindex",0);if(m){t.attr("title",m)}t.accessibilityState(o,P);t.class("sapMSinglePCAppointmentWrap");t.class("sapUiCalendarRowApps");if(!A&&b!==g.None){t.class("sapUiCalendarApp"+b)}if(A){if(i.getRTL()){t.style("border-right-color",A)}else{t.style("border-left-color",A)}}t.style("top",S*C+.0625+"rem");t.style(D?"right":"left",Math.max(I,0)+"%");t.style(D?"left":"right",Math.max(w,0)+"%");t.openEnd();t.openStart("div");t.class("sapUiCalendarApp");if(o.getSelected()){t.class("sapUiCalendarAppSel")}if(o.getTentative()){t.class("sapUiCalendarAppTent")}if(M){t.class("sapUiCalendarAppWithIcon")}t.openEnd();t.openStart("div");t.class("sapUiCalendarAppCont");if(A){t.style("background-color",o._getCSSColorForBackground(A))}t.openEnd();if(I<0){h=["sapUiCalendarAppArrowIconLeft","sapUiCalendarAppArrowIcon"];t.icon("sap-icon://arrow-left",h,{title:null,role:"img"})}if(M){h=["sapUiCalendarAppIcon"];var U={};U["id"]=_+"-Icon";U["title"]=null;U["role"]="img";t.icon(M,h,U)}if(T){t.openStart("span",_+"-Title");t.class("sapUiCalendarAppTitle");t.openEnd();t.text(T,true);t.close("span")}if(w<0){h=["sapUiCalendarAppArrowIconRight","sapUiCalendarAppArrowIcon"];t.icon("sap-icon://arrow-right",h,{title:null,role:"img"})}t.openStart("span",_+"-Descr");t.class("sapUiInvisibleText");t.openEnd();t.text(l._getAppointmentAnnouncementInfo(o));t.close("span");t.close("div");t.close("div");t.close("div")};u.renderRowHeaders=function(e,a){var t=a._getVisibleStartHour(),l=a._getVisibleEndHour(),n=o.getInstance(),r=a._getHoursFormat(),s=a._getAMPMFormat();e.openStart("div");e.class("sapMSinglePCRowHeaders");e.openEnd();for(var i=t;i<=l;i++){n.setHours(i);e.openStart("span");e.class("sapMSinglePCRowHeader");e.class("sapMSinglePCRowHeader"+i);if(a._shouldHideRowHeader(i)){e.class("sapMSinglePCRowHeaderHidden")}e.openEnd();e.text(r.format(n));if(a._hasAMPM()){e.openStart("span");e.class("sapMSinglePCRowHeaderAMPM");e.openEnd();e.text(" "+s.format(n));e.close("span")}e.close("span")}e.close("div")};u.renderColumns=function(t,l){var r=l._getColumns(),s=l.getStartDate(),i=l._getAppointmentsToRender();t.openStart("div");t.attr("role","grid");t.attr("aria-labelledby",n.getStaticId("sap.m","SPC_APPOINTMENTS"));t.class("sapMSinglePCColumns");t.openEnd();for(var o=0;o<r;o++){var p=new e(s.getFullYear(),s.getMonth(),s.getDate()+o),d=l._getDateFormatter(),c=d.format(p.toLocalJSDate());t.openStart("div");t.attr("role","row");t.attr("data-sap-day",c);t.class("sapMSinglePCColumn");if(p.isSame(new e)){t.class("sapMSinglePCColumnToday")}if(a._isWeekend(p,l._getCoreLocaleData())){t.class("sapMSinglePCColumnWeekend")}t.openEnd();this.renderDndPlaceholders(t,l,l._dndPlaceholdersMap[p]);this.renderRows(t,l,c);this.renderAppointments(t,l,i[c],p,o);t.close("div")}t.close("div")};u.renderDndPlaceholders=function(e,a,t){e.openStart("div");e.class("sapMSinglePCOverlay");e.openEnd();t.forEach(e.renderControl,e);e.close("div")};u.renderRows=function(e,a,t){var l=a._getVisibleStartHour(),n=a._getVisibleEndHour(),r=a._getDateFormatter(),s,i;for(var p=l;p<=n;p++){s=a._parseDateStringAndHours(t,p);i=o.getInstance(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours()+1);e.openStart("div");e.attr("role","gridcell");e.class("sapMSinglePCRow");if(!a._isVisibleHour(p)){e.class("sapMSinglePCNonWorkingRow")}e.attr("data-sap-hour",p);e.attr("data-sap-start-date",r.format(s));e.attr("data-sap-end-date",r.format(i));e.attr("aria-labelledby",r.format(s)+"-Descr");e.attr("tabindex",-1);e.openEnd();e.openStart("span",r.format(s)+"-Descr");e.class("sapUiInvisibleText");e.openEnd();e.text(a._getCellStartEndInfo(s,i));e.close("span");e.close("div")}};u.renderAppointments=function(e,a,t,l,n){var r=this,s=0;if(t){e.openStart("div");e.attr("role","list");e.class("sapMSinglePCAppointments");e.class("sapUiCalendarRowVisFilled");e.openEnd();t.oAppointmentsList.getIterator().forEach(function(i){var o=t.iMaxLevel,p=i.level,d=i.width,c=i.getData();r.renderAppointment(e,a,o,p,d,c,l,n,s);s++});e.close("div")}};u.renderAppointment=function(l,r,s,o,u,f,S,C,v){var m=e.fromLocalJSDate(r.getStartDate()),b=new e(m),A=r._getRowHeight(),T=new t(S.getYear(),S.getMonth(),S.getDate(),r._getVisibleStartHour()),y=new t(S.getYear(),S.getMonth(),S.getDate(),r._getVisibleEndHour(),59,59),M=f.getStartDate(),_=f.getEndDate(),P=e.fromLocalJSDate(M),E=e.fromLocalJSDate(_),I=f.getTooltip_AsString(),w=f.getType(),D=f.getColor(),h=f.getTitle(),U=f.getText(),L=f.getIcon(),k=f.getId(),R=this._getLineClamp(M,_),x={role:"listitem",labelledby:{value:n.getStaticId("sap.ui.unified","APPOINTMENT"),append:true},selected:null},H=r.getAriaLabelledBy(),B=T.getTime()>M.getTime(),N=y.getTime()<_.getTime(),F=B?0:r._calculateTopPosition(M),V=N?0:r._calculateBottomPosition(_),J=100/(s+1),O=f.getParent().getEnableAppointmentsDragAndDrop(),W=r.getProperty("scaleFactor"),z=2*W,Y,j,G,K,q;b.setDate(b.getDate()+r._getColumns()-1);Y=a._daysBetween(P,m);j=a._daysBetween(b,E);G=S.isSame(m);K=S.isSame(b);if(H.length>0){x["labelledby"].value=x["labelledby"].value+" "+H.join(" ")}if(h){x["labelledby"].value=x["labelledby"].value+" "+k+"-Title"}x["labelledby"].value=x["labelledby"].value+" "+k+"-Descr";if(U){x["labelledby"].value=x["labelledby"].value+" "+k+"-Text"}if(f.getTentative()){x["labelledby"].value=x["labelledby"].value+" "+n.getStaticId("sap.ui.unified","APPOINTMENT_TENTATIVE")}if(f.getSelected()){x["labelledby"].value=x["labelledby"].value+" "+n.getStaticId("sap.ui.unified","APPOINTMENT_SELECTED")}l.openStart("div",f.getId()+"-"+C+"_"+v);l.attr("draggable",O);l.attr("data-sap-ui-draggable",O);l.attr("data-sap-ui-related",f.getId());l.attr("data-sap-level",o);l.attr("data-sap-width",u);l.attr("tabindex",0);if(I){l.attr("title",I)}l.accessibilityState(f,x);l.class("sapMSinglePCAppointmentWrap");l.class("sapUiCalendarRowApps");if(!D&&w!==g.None){l.class("sapUiCalendarApp"+w)}if(D){if(i.getRTL()){l.style("border-right-color",D)}else{l.style("border-left-color",D)}}l.style("top",F+"rem");l.style("bottom",V+"rem");l.style(i.getRTL()?"right":"left",J*o+"%");l.style("width",J*u+"%");l.openEnd();l.openStart("div");l.class("sapUiCalendarApp");l.style("min-height",(A-(p+d+c)*W)/z+"rem");if(f.getSelected()){l.class("sapUiCalendarAppSel")}if(f.getTentative()){l.class("sapUiCalendarAppTent")}if(L){l.class("sapUiCalendarAppWithIcon")}l.openEnd();l.openStart("div");l.class("sapUiCalendarAppCont");if(D){l.style("background-color",f._getCSSColorForBackground(D))}l.openEnd();if(G&&Y<0){q=["sapUiCalendarAppArrowIconLeft","sapUiCalendarAppArrowIcon"];l.icon("sap-icon://arrow-left",q,{title:null,role:"img"})}if(L){q=["sapUiCalendarAppIcon"];var Q={};Q["id"]=k+"-Icon";Q["title"]=null;Q["role"]="img";l.icon(L,q,Q)}l.openStart("div");l.class("sapUiCalendarAppTitleWrapper");l.class("sapUiSPCAppLineClamp"+R);l.openEnd();if(h){l.openStart("span",k+"-Title");l.class("sapUiCalendarAppTitle");l.openEnd();l.text(h,true);l.close("span")}if(U){l.openStart("span",k+"-Text");l.class("sapUiCalendarAppText");l.openEnd();l.text(U,true);l.close("span")}l.close("div");if(K&&j<0){q=["sapUiCalendarAppArrowIconRight","sapUiCalendarAppArrowIcon"];l.icon("sap-icon://arrow-right",q,{title:null,role:"img"})}l.openStart("span",k+"-Descr");l.class("sapUiInvisibleText");l.openEnd();l.text(r._getAppointmentAnnouncementInfo(f));l.close("span");l.close("div");if(r.getEnableAppointmentsResize()){this.renderResizeHandles(l,!B,!N)}l.close("div");l.close("div")};u.renderNowMarker=function(e,a){var t=o.getInstance();e.openStart("div",a.getId()+"-nowMarker");e.style("top",a._calculateTopPosition(t)+"rem");e.class("sapMSinglePCNowMarker");if(!a._isVisibleHour(t.getHours())){e.class("sapMSinglePCNowMarkerHidden")}e.openEnd();e.openStart("span",a.getId()+"-nowMarkerText");e.class("sapMSinglePCNowMarkerText");e.openEnd();e.text(a._formatTimeAsString(t));if(a._hasAMPM()){e.openStart("span",a.getId()+"-nowMarkerAMPM");e.class("sapMSinglePCNowMarkerAMPM");e.openEnd();e.text(a._addAMPM(t));e.close("span")}e.close("span");e.close("div")};u.renderResizeHandles=function(e,a,t){if(t){e.openStart("span");e.class("sapMSinglePCAppResizeHandleBottom");e.openEnd();e.close("span")}if(a){e.openStart("span");e.class("sapMSinglePCAppResizeHandleTop");e.openEnd();e.close("span")}};u._getLineClamp=function(e,t){var l=a._minutesBetween(e,t);if(l>=51&&l<69){return"2"}else if(l>=69&&l<90){return"3"}else if(l>=90&&l<110){return"4"}else if(l>=110&&l<130){return"5"}else if(l>=130&&l<150){return"6"}else if(l>=150&&l<170){return"7"}else if(l>=170&&l<190){return"8"}else if(l>=190){return"9"}else{return"1"}};return u},true);
//# sourceMappingURL=SinglePlanningCalendarGridRenderer.js.map