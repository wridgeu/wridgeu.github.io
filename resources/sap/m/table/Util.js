/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/ui/core/Core","sap/ui/core/theming/Parameters","sap/m/IllustratedMessage"],function(t,a,e,r){"use strict";var n={};var i="";var u=parseFloat(t.BaseFontSize);n.measureText=function(){var t=.05;var r=document.createElement("canvas").getContext("2d");var n=function(){i=[parseFloat(e.get({name:"sapMFontMediumSize"})||"0.875rem")*u+"px",e.get({name:"sapUiFontFamily"})||"Arial"].join(" ");return i};a.attachThemeChanged(n);return function(a,e){r.font=e||i||n();return r.measureText(a||"").width/u+t}}();n.calcTypeWidth=function(){var t=0;var e=[2023,9,26,22,47,58,999];var r=new Date(Date.UTC.apply(0,e));var i=new(Function.prototype.bind.apply(Date,[null].concat(e)));var u={Byte:3,SByte:3,Int16:5,Int32:9,Int64:12,Single:6,Float:12,Double:13,Decimal:15,Integer:9};a.attachThemeChanged(function(){t=0});return function(e,o){var m=e.getMetadata().getName().split(".").pop();var s=o&&o.maxWidth||19;var l=o&&o.gap||0;var c=function(t){return Math.min(t+l,s)};if(m=="Boolean"){if(!t){var h=a.getLibraryResourceBundle("sap.ui.core");var d=n.measureText(h.getText("YES"));var g=n.measureText(h.getText("NO"));t=Math.max(d,g)}return c(t)}if(m=="String"||e.isA("sap.ui.model.odata.type.String")){var p=parseInt(e.getConstraints().maxLength)||0;if(!p||p*.25>s){return s}var f=n.measureText("A".repeat(p));if(p<s||s<10){return Math.min(f,s)}var v=Math.log(f-s*.16)/Math.log(s/3)*(s/2)*Math.pow(s/19,1/f);return c(Math.min(v,f))}if(m.startsWith("Date")||m.startsWith("Time")){var T=e.getFormatOptions();var M=T.UTC?r:i;var x=M.toLocaleDateString();if(m=="TimeOfDay"){x=new Intl.DateTimeFormat("de",{hour:"numeric",minute:"numeric",second:"numeric"}).format(M);x=e.formatValue(x,"string")}else if(e.isA("sap.ui.model.odata.type.Time")){x=e.formatValue({__edmType:"Edm.Time",ms:r.valueOf()},"string")}else{x=e.formatValue(T.interval?[M,new Date(M*1.009)]:M,"string");(e.oFormat&&e.oFormat.oFormatOptions&&e.oFormat.oFormatOptions.pattern||"").replace(/[MELVec]{3,4}/,function(t){x+=t.length==4?"---":"-"})}return c(n.measureText(x))}if(u[m]){var y=parseInt(e.getConstraints().scale)||0;var W=parseInt(e.getConstraints().precision)||20;W=Math.min(W,u[m]);var C=2*Math.pow(10,W-y-1);C=e.formatValue(C,"string");return c(n.measureText(C))}return o&&o.defaultWidth||8}}();n.calcHeaderWidth=function(){var t="";var r=function(){if(!t){t=[e.get({name:"sapUiColumnHeaderFontWeight"})||"normal",i].join(" ")}return t};a.attachThemeChanged(function(){t=""});return function(t,a,e,i){var u=t.length;e=e||19;i=i||2;if(a>e){return e}if(i>u){return i}if(!a){return n.measureText(t,r())}a=Math.max(a,i);if(a>u){return a}var o=n.measureText(t,r());o=Math.min(o,e*.7);var m=Math.max(1,1-Math.log(Math.max(a-1.7,.2))/Math.log(e*.5)+1);var s=m*a;var l=Math.max(0,o-s);var c=l<.15?o:s+l*(1-1/a)/Math.E;return c}}();n.calcColumnWidth=function(t,a,e){if(!Array.isArray(t)){t=[t]}e=Object.assign({minWidth:2,maxWidth:19,defaultWidth:8,truncateLabel:true,padding:1,gap:0,verticalArrangement:false},e);var r=0;var i=Math.max(1,e.minWidth);var u=Math.max(i,e.maxWidth);var o=e.gap+t.reduce(function(t,a){var r=a,i={defaultWidth:e.defaultWidth,maxWidth:e.maxWidth};if(Array.isArray(a)){r=a[0];i=a[1]||i}var u=n.calcTypeWidth(r,i);return e.verticalArrangement?Math.max(t,u):t+u+(t&&.5)},0);if(a){r=n.calcHeaderWidth(a,e.truncateLabel?o:0,u,i)}o=Math.max(i,o,r);o=Math.min(o,u);o=Math.round(o*100)/100;return o+e.padding+"rem"};n.getNoColumnsIllustratedMessage=function(){var e=a.getLibraryResourceBundle("sap.m");return new r({illustrationType:t.IllustratedMessageType.AddColumn,title:e.getText("TABLE_NO_COLUMNS_TITLE"),description:e.getText("TABLE_NO_COLUMNS_DESCRIPTION")})};return n});