/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/ui/core/Core","sap/ui/core/theming/Parameters","sap/m/IllustratedMessage","sap/m/Button","sap/ui/core/InvisibleMessage"],function(e,t,a,r,n,i){"use strict";var o={};var u="";var s=parseFloat(e.BaseFontSize);var l=null;var c=null;o.measureText=function(){var e=.05;var r=document.createElement("canvas").getContext("2d");var n=function(){u=[parseFloat(a.get({name:"sapMFontMediumSize"})||"0.875rem")*s+"px",a.get({name:"sapUiFontFamily"})||"Arial"].join(" ");return u};t.attachThemeChanged(n);return function(t,a){r.font=a||u||n();return r.measureText(t||"").width/s+e}}();o.calcTypeWidth=function(){var e=0;var a=[2023,9,26,22,47,58,999];var r=new Date(Date.UTC.apply(0,a));var n=new(Function.prototype.bind.apply(Date,[null].concat(a)));var i={Byte:3,SByte:3,Int16:5,Int32:9,Int64:12,Single:6,Float:12,Double:13,Decimal:15,Integer:9};t.attachThemeChanged(function(){e=0});return function(a,u){var s=a.getMetadata().getName().split(".").pop();var l=u&&u.maxWidth||19;var c=u&&u.gap||0;var m=function(e){return Math.min(e+c,l)};if(s=="Boolean"){if(!e){var d=t.getLibraryResourceBundle("sap.ui.core");var p=o.measureText(d.getText("YES"));var v=o.measureText(d.getText("NO"));e=Math.max(p,v)}return m(e)}if(s=="String"||a.isA("sap.ui.model.odata.type.String")){var T=parseInt(a.getConstraints().maxLength)||0;if(!T||T*.25>l){return l}var f=o.measureText("A".repeat(T));if(T<l||l<10){return m(f)}var g=Math.log(f-l*.16)/Math.log(l/3)*(l/2)*Math.pow(l/19,1/f);return m(Math.min(g,f))}if(s.startsWith("Date")||s.startsWith("Time")){var h=a.getFormatOptions();var x=h.UTC?r:n;var M=x.toLocaleDateString();if(s=="TimeOfDay"){M=new Intl.DateTimeFormat("de",{hour:"numeric",minute:"numeric",second:"numeric"}).format(x);M=a.formatValue(M,"string")}else if(a.isA("sap.ui.model.odata.type.Time")){M=a.formatValue({__edmType:"Edm.Time",ms:r.valueOf()},"string")}else{M=a.formatValue(h.interval?[x,new Date(x*1.009)]:x,"string");(a.oFormat&&a.oFormat.oFormatOptions&&a.oFormat.oFormatOptions.pattern||"").replace(/[MELVec]{3,4}/,function(e){M+=e.length==4?"---":"-"})}return m(o.measureText(M))}if(i[s]){var E=parseInt(a.getConstraints().scale)||0;var L=parseInt(a.getConstraints().precision)||20;L=Math.min(L,i[s]);var C=2*Math.pow(10,L-E-1);C=a.formatValue(C,"string");return m(o.measureText(C))}return u&&u.defaultWidth||8}}();o.calcHeaderWidth=function(){var e="";var r="";var n=function(){if(!e){e=[a.get({name:"sapUiColumnHeaderFontWeight"})||"normal",u].join(" ")}return e};var i=function(){if(!r){r=[a.get({name:"sapMFontLargeSize"})||"normal",u].join(" ")}return r};t.attachThemeChanged(function(){e="";r=""});return function(e,t,a,r,u){var s=e.length;var l=0;a=a||19;r=r||2;if(t>a){return a}if(r>s){return r}if(u){l=.125+o.measureText("*",i())}if(!t){var c=o.measureText(e,n());return c+l}t=Math.max(t,r);if(t>s){return t}var m=o.measureText(e,n());m=Math.min(m,a*.7);var d=Math.max(1,1-Math.log(Math.max(t-1.7,.2))/Math.log(a*.5)+1);var p=d*t;var v=Math.max(0,m-p);var c=v<.15?m:p+v*(1-1/t)/Math.E;return c+l}}();o.calcColumnWidth=function(e,t,a){if(!Array.isArray(e)){e=[e]}a=Object.assign({minWidth:2,maxWidth:19,defaultWidth:8,truncateLabel:true,padding:1.0625,gap:0},a);var r=0;var n=Math.max(1,a.minWidth);var i=Math.max(n,a.maxWidth);var u=a.treeColumn?3:0;var l=a.gap+u+e.reduce(function(e,t){var r=t,n={defaultWidth:a.defaultWidth,maxWidth:a.maxWidth};if(Array.isArray(t)){r=t[0];n=t[1]||n}var i=o.calcTypeWidth(r,n);return a.verticalArrangement?Math.max(e,i):e+i+(e&&.5)},0);if(t){r=o.calcHeaderWidth(t,a.truncateLabel?l:0,i,n,a.required);r+=a.headerGap?(8+14)/s:0}l=Math.max(n,l,r);l=Math.min(l,i);l=Math.ceil(l*100)/100;return l+a.padding+"rem"};o.getNoColumnsIllustratedMessage=function(a){var i=t.getLibraryResourceBundle("sap.m");var o=new r({illustrationType:e.IllustratedMessageType.AddColumn,title:i.getText("TABLE_NO_COLUMNS_TITLE"),description:i.getText("TABLE_NO_COLUMNS_DESCRIPTION")});if(a){var u=new n({icon:"sap-icon://action-settings",press:a});o.addAdditionalContent(u)}return o};o.getSelectAllPopover=function(){if(c){return c}c=Promise.all([new Promise(function(e){sap.ui.require(["sap/m/Popover","sap/m/Bar","sap/m/HBox","sap/m/Title","sap/ui/core/library","sap/m/Text"],function(t,a,r,n,i,o){e({Popover:t,Bar:a,HBox:r,Title:n,coreLib:i,Text:o})})}),t.getLibraryResourceBundle("sap.m",true)]).then(function(e){var t=e[0];var a=e[1];var r=t.coreLib.IconColor.Critical,n=t.coreLib.TitleLevel.H2;l=new t.Popover({customHeader:new t.Bar({contentMiddle:[new t.HBox({items:[new t.coreLib.Icon({src:"sap-icon://message-warning",color:r}).addStyleClass("sapUiTinyMarginEnd"),new t.Title({text:a.getText("TABLE_SELECT_LIMIT_TITLE"),level:n})],renderType:"Bare",justifyContent:"Center",alignItems:"Center"})]}),content:[new t.Text]}).addStyleClass("sapUiContentPadding");return{oSelectAllNotificationPopover:l,oResourceBundle:a}});return c};o.showSelectionLimitPopover=function(e,t){o.getSelectAllPopover().then(function(a){var r=a.oSelectAllNotificationPopover;var n=a.oResourceBundle;var i=n.getText("TABLE_SELECT_LIMIT",[e]);r.getContent()[0].setText(i);if(t){r.openBy(t)}})};o.hideSelectionLimitPopover=function(){if(l&&l.isOpen()){l.close()}};o.announceTableUpdate=function(e,a){var r=i.getInstance();if(r){var n=t.getLibraryResourceBundle("sap.m");if(a==undefined){r.announce(n.getText("table.ANNOUNCEMENT_TABLE_UPDATED",[e]))}else if(a>1){r.announce(n.getText("table.ANNOUNCEMENT_TABLE_UPDATED_MULT",[e,a]))}else if(a===1){r.announce(n.getText("table.ANNOUNCEMENT_TABLE_UPDATED_SING",[e,a]))}else{r.announce(n.getText("table.ANNOUNCEMENT_TABLE_UPDATED_NOITEMS",[e]))}}};o.isEmpty=function(e){if(!e){return true}var t=e.getLength();if(t===1&&e.isA("sap.ui.model.analytics.AnalyticalBinding")){var a=e?e.providesGrandTotal()&&e.hasTotaledMeasures():false;if(a){t=0}}return t<=0};return o});
//# sourceMappingURL=Util.js.map