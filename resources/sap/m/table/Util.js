/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/ui/core/Core","sap/ui/core/theming/Parameters","sap/m/IllustratedMessage"],function(t,a,e,r){"use strict";var n={};var i="";var o=parseFloat(t.BaseFontSize);n.measureText=function(){var t=.05;var r=document.createElement("canvas").getContext("2d");var n=function(){i=[parseFloat(e.get({name:"sapMFontMediumSize"})||"0.875rem")*o+"px",e.get({name:"sapUiFontFamily"})||"Arial"].join(" ");return i};a.attachThemeChanged(n);return function(a,e){r.font=e||i||n();return r.measureText(a||"").width/o+t}}();n.calcTypeWidth=function(){var t=0;var e=[2023,9,26,22,47,58,999];var r=new Date(Date.UTC.apply(0,e));var i=new(Function.prototype.bind.apply(Date,[null].concat(e)));var o={Byte:3,SByte:3,Int16:5,Int32:9,Int64:12,Single:6,Float:12,Double:13,Decimal:15,Integer:9};a.attachThemeChanged(function(){t=0});return function(e,u){var m=e.getMetadata().getName().split(".").pop();if(m=="Boolean"){if(!t){var s=a.getLibraryResourceBundle("sap.ui.core");var l=n.measureText(s.getText("YES"));var c=n.measureText(s.getText("NO"));t=Math.max(l,c)}return t}if(m=="String"||e.isA("sap.ui.model.odata.type.String")){var h=u&&u.maxWidth||19;var d=parseInt(e.getConstraints().maxLength)||0;if(!d){return Math.max(Math.min(10,h),h*.75)}if(d*.25>h){return h}var g=n.measureText("A".repeat(d));if(d<h||h<10){return Math.min(g,h)}var p=Math.log(g-h*.16)/Math.log(h/3)*(h/2)*Math.pow(h/19,1/g);return Math.min(p,g,h)}if(m.startsWith("Date")||m.startsWith("Time")){var v=e.getFormatOptions();var f=v.UTC?r:i;var M=f.toLocaleDateString();if(m=="TimeOfDay"){M=new Intl.DateTimeFormat("de",{hour:"numeric",minute:"numeric",second:"numeric"}).format(f);M=e.formatValue(M,"string")}else if(e.isA("sap.ui.model.odata.type.Time")){M=e.formatValue({__edmType:"Edm.Time",ms:r.valueOf()},"string")}else{M=e.formatValue(v.interval?[f,new Date(f*1.009)]:f,"string");(e.oFormat&&e.oFormat.oFormatOptions&&e.oFormat.oFormatOptions.pattern||"").replace(/[MELVec]{3,4}/,function(t){M+=t.length==4?"---":"-"})}return n.measureText(M)}if(o[m]){var T=parseInt(e.getConstraints().scale)||0;var x=parseInt(e.getConstraints().precision)||20;x=Math.min(x,o[m]);var y=2*Math.pow(10,x-T-1);y=e.formatValue(y,"string");return n.measureText(y)}return u&&u.defaultWidth||8}}();n.calcHeaderWidth=function(){var t="";var r=function(){if(!t){t=[e.get({name:"sapUiColumnHeaderFontWeight"})||"normal",i].join(" ")}return t};a.attachThemeChanged(function(){t=""});return function(t,a,e,i){var o=t.length;e=e||19;i=i||2;if(a>e){return e}if(i>o){return i}a=Math.max(a,i);if(a>o){return a}var u=n.measureText(t,r());u=Math.min(u,e*.7);var m=Math.max(1,1-Math.log(Math.max(a-1.7,.2))/Math.log(e*.5)+1);var s=m*a;var l=Math.max(0,u-s);var c=l<.15?u:s+l*(1-1/a)/Math.E;return c}}();n.calcColumnWidth=function(t,a,e){if(!Array.isArray(t)){t=[t]}e=Object.assign({minWidth:2,maxWidth:19,defaultWidth:8,padding:1,gap:0,verticalArrangement:false},e);var r=0;var i=Math.max(1,e.minWidth);var o=Math.max(i,e.maxWidth);var u=e.gap+t.reduce(function(t,a){var r=a,i=e;if(Array.isArray(a)){r=a[0];i=a[1]||e}var o=n.calcTypeWidth(r,i);return e.verticalArrangement?Math.max(t,o):t+o+(t&&.5)},0);if(a){r=n.calcHeaderWidth(a,u,o,i)}u=Math.max(i,u,r);u=Math.min(u,o);u=Math.round(u*100)/100;return u+e.padding+"rem"};n.getNoColumnsIllustratedMessage=function(){var e=a.getLibraryResourceBundle("sap.m");return new r({illustrationType:t.IllustratedMessageType.AddColumn,title:e.getText("TABLE_NO_COLUMNS_TITLE"),description:e.getText("TABLE_NO_COLUMNS_DESCRIPTION")})};return n});