/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/fl/variants/VariantManagement","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/m/p13n/enum/PersistenceMode","sap/ui/layout/VerticalLayout","sap/ui/core/UIArea","sap/ui/core/Core"],function(e,t,i,o,r,n,s){"use strict";var a=e.extend("sap.m.p13n.PersistenceProvider",{metadata:{library:"sap.m",designtime:"sap/m/designtime/PersistenceProvider.designtime",properties:{mode:{type:"sap.m.p13n.enum.PersistenceMode",group:"Data",defaultValue:o.Auto}},associations:{for:{type:"sap.ui.core.Control",multiple:true}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("div",t);e.openEnd();e.close("div")}}});a.prototype.init=function(){e.prototype.init.apply(this,arguments);this.attachModelContextChange(this._setModel,this);this._oModelPromise=new Promise(function(e,t){this._fnResolveModel=e}.bind(this))};a.prototype._setModel=function(){var e=this.getModel(i.getVariantModelName());if(e){this.reinitialize();this._fnResolveModel(e)}};a.prototype.applySettings=function(){e.prototype.applySettings.apply(this,arguments);this._bmodeLocked=true;if(this.getMode()===o.Transient){var a=new t(this.getId()+"--vm",{for:this.getAssociation("for")});this._oModelPromise.then(function(e){a.setModel(e,i.getVariantModelName())});this._oWrapper=new r(this.getId()+"--accWrapper",{visible:true,content:[a]});this._oWrapper.onAfterRendering=function(){r.prototype.onAfterRendering.apply(this,arguments);this.getDomRef().setAttribute("aria-hidden",true)};var p=s.getStaticAreaRef();var d=n.registry.get(p.id);d.addContent(this._oWrapper,true);s.createRenderManager().render(this._oWrapper,p)}return this};a.prototype.addFor=function(e){this.addAssociation("for",e);var t=s.byId(this.getId()+"--vm");if(this.getMode()===o.Transient&&t){t.addFor(e)}return this};a.prototype.removeFor=function(e){this.removeAssociation("for",e);var t=s.byId(this.getId()+"--vm");if(this.getMode()===o.Transient&&t){t.removeFor(e)}return this};a.prototype.setMode=function(e){if(this._bmodeLocked&&e!==this.getMode()){throw new Error("mode is a final property.")}this.setProperty("mode",e);return this};a.prototype.reinitialize=function(){var e=s.byId(this.getId()+"--vm");if(this.getMode()===o.Transient&&e){var t=this.getModel(i.getVariantModelName());e.setModel(t,i.getVariantModelName());e.reinitialize()}};a.prototype.exit=function(){if(this._oWrapper){var t=s.getStaticAreaRef();var i=n.registry.get(t.id);i.removeContent(this._oWrapper);this._oWrapper.destroy();this._oWrapper=null}this._oModelPromise=null;this._fnResolveModel=null;this._bmodeLocked=null;e.prototype.exit.apply(this,arguments)};return a});
//# sourceMappingURL=PersistenceProvider.js.map