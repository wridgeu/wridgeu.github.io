/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./TableHelper.support","sap/ui/support/library","sap/ui/Device"],function(e,t,i){"use strict";var a=t.Categories;var n=t.Severity;function o(t,i,a,o){var s=false;t.each(function(){if(jQuery(this).closest(i).length){s=true}});if(s&&a){e.reportIssue(o,a,n.High)}return s}var s=e.normalizeRule({id:"ContentDensity",minversion:"1.38",categories:[a.Usage],title:"Content Density Usage",description:"Checks whether the content densities 'Cozy', 'Compact' and 'Condensed' are used correctly.",resolution:"Ensure that either only the 'Cozy' or 'Compact' content density is used, or the 'Condensed' and 'Compact' content densities"+" are used in combination.",resolutionurls:[e.createDocuRef("Documentation: Content Densities","#docs/guide/e54f729da8e3405fae5e4fe8ae7784c1.html")],check:function(t,i,a){var s=jQuery("html");var r=s.find(".sapUiSizeCozy");var c=s.find(".sapUiSizeCompact");var u=s.find(".sapUiSizeCondensed");o(c,".sapUiSizeCozy","'Compact' content density is used within 'Cozy' area.",t);o(r,".sapUiSizeCompact","'Cozy' content density is used within 'Compact' area.",t);o(u,".sapUiSizeCozy","'Condensed' content density is used within 'Cozy' area.",t);o(r,".sapUiSizeCondensed","'Cozy' content density is used within 'Condensed' area.",t);if(u.length>0){var d=o(u,".sapUiSizeCompact",t);if(!d){e.reportIssue(t,"'Condensed' content density must be used in combination with 'Compact'.",n.High)}}if(sap.ui.getCore().getLoadedLibraries()["sap.m"]&&r.length===0&&c.length===0&&u.length===0){e.reportIssue(t,"If the sap.ui.table and the sap.m libraries are used together, a content density must be specified.",n.High)}}});var r=e.normalizeRule({id:"RowHeights",minversion:"1.38",categories:[a.Usage],title:"Row heights",description:"Checks whether the currently rendered rows have the expected height.",resolution:"Check whether content densities are correctly used, and only the supported controls are used as column templates, with their"+' wrapping property set to "false"',resolutionurls:[e.createDocuRef("Documentation: Content Densities","#/topic/e54f729da8e3405fae5e4fe8ae7784c1"),e.createDocuRef("Documentation: Supported controls","#/topic/148892ff9aea4a18b912829791e38f3e"),e.createDocuRef("API Reference: sap.ui.table.Column#getTemplate","#/api/sap.ui.table.Column/methods/getTemplate"),e.createFioriGuidelineResolutionEntry()],check:function(t,a,o){var s=e.find(o,true,"sap.ui.table.Table");var r=i.browser.chrome&&window.devicePixelRatio!=1;for(var c=0;c<s.length;c++){var u=s[c].getRows();var d=s[c]._getBaseRowHeight();var l=false;for(var h=0;h<u.length;h++){var p=u[h].getDomRef();var f=u[h].getDomRef("fixed");if(p){var g=p.getBoundingClientRect().height;var m=f?f.getBoundingClientRect().height:null;var C=g;if(r){var v=Math.abs(d-g);var w=Math.abs(m-g);if(v>1){l=true}else if(m!=null&&w>1){l=true;C=m}}else if(g!==d){l=true}else if(m!=null&&m!==d){l=true;C=m}if(l){e.reportIssue(t,"The row height was expected to be "+d+"px, but was "+C+"px instead."+" This causes issues with vertical scrolling.",n.High,u[h].getId());break}}}}}});var c=e.normalizeRule({id:"DynamicPageConfiguration",minversion:"1.38",categories:[a.Usage],title:"Table environment validation - 'sap.f.DynamicPage'",description:"Verifies that the DynamicPage is configured correctly from the table's perspective.",resolution:"If a table with visibleRowCountMode=Auto is placed inside a sap.f.DynamicPage, the fitContent property of the DynamicPage"+" should be set to true, otherwise false.",resolutionurls:[e.createDocuRef("API Reference: sap.f.DynamicPage#getFitContent","#/api/sap.f.DynamicPage/methods/getFitContent")],check:function(t,i,a){var o=e.find(a,true,"sap.ui.table.Table");function s(e,t){if(e){if(e.isA("sap.f.DynamicPage")){t(e)}s(e.getParent(),t)}}function r(i,a){if(i._getRowMode().isA("sap.ui.table.rowmodes.AutoRowMode")&&!a.getFitContent()){e.reportIssue(t,'A table with an auto row mode is placed inside a sap.f.DynamicPage with fitContent="false"',n.High,i.getId())}else if((i._getRowMode().isA("sap.ui.table.rowmodes.FixedRowMode")||i._getRowMode().isA("sap.ui.table.rowmodes.InteractiveRowMode"))&&a.getFitContent()){e.reportIssue(t,'A table with a fixed or interactive row mode is placed inside a sap.f.DynamicPage with fitContent="true"',n.Low,i.getId())}}for(var c=0;c<o.length;c++){s(o[c],r.bind(null,o[c]))}}});return[s,r,c]},true);