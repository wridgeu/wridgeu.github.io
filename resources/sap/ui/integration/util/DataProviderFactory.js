/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/Object","sap/ui/integration/util/ServiceDataProvider","sap/ui/integration/util/RequestDataProvider","sap/ui/integration/util/CacheAndRequestDataProvider","sap/ui/integration/util/DataProvider","sap/ui/integration/util/ExtensionDataProvider","sap/ui/integration/util/JSONBindingHelper","sap/ui/integration/util/BindingHelper","sap/ui/integration/util/CsrfTokenHandler"],function(e,t,i,s,n,o,r,a,d){"use strict";var l=e.extend("sap.ui.integration.util.DataProviderFactory",{constructor:function(t){e.call(this);t=t||{};this._oDestinations=t.destinations;this._oExtension=t.extension;this._oCsrfTokenHandler=t.csrfTokenHandler;this._oCard=t.card;this._oEditor=t.editor;this._oHost=t.host;if(t.csrfTokensConfig){this._oCsrfTokenHandler=new d({host:t.host,configuration:t.csrfTokensConfig})}this._aDataProviders=[];this._aFiltersProviders=[]}});l.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);if(this._aDataProviders){this._aDataProviders.forEach(function(e){if(!e.bIsDestroyed){e.destroy()}});this._aDataProviders=null;this._aFiltersProviders=null}if(this._oCsrfTokenHandler){this._oCsrfTokenHandler.destroy();this._oCsrfTokenHandler=null}this._oCard=null;this._oExtension=null;this._bIsDestroyed=true};l.prototype.isDestroyed=function(){return this._bIsDestroyed};l.prototype.create=function(e,d,l){var u=this._oCard,f=this._oEditor,h=this._oHost||u&&u.getHostInstance()||f&&f.getHostInstance(),c=h&&h.bUseExperimentalCaching,p,_;if(!e){return null}if(u){p={baseRuntimeUrl:u.getRuntimeUrl("/"),settingsJson:r.createJsonWithBindingInfos(e,u.getBindingNamespaces())}}else if(f){p={baseRuntimeUrl:f.getRuntimeUrl("/"),settingsJson:r.createJsonWithBindingInfos(e,f.getBindingNamespaces())}}else{p={settingsJson:r.createJsonWithBindingInfos(e,{})}}if(e.request&&c){_=new s(p);_.setHost(h)}else if(e.request){_=new i(p);if(h){_.setHost(h)}}else if(e.service){_=new t(p)}else if(e.json){_=new n(p)}else if(e.extension){_=new o(p,this._oExtension)}else{return null}if(u){_.setCard(u);a.propagateModels(u,_)}else if(f){a.propagateModels(f,_)}_.bindObject("/");_.setDestinations(this._oDestinations);if(this._oCsrfTokenHandler){_.setCsrfTokenHandler(this._oCsrfTokenHandler);this._oCsrfTokenHandler.setDataProviderFactory(this)}if(_.isA("sap.ui.integration.util.IServiceDataProvider")){_.createServiceInstances(d)}this._aDataProviders.push(_);if(l){this._aFiltersProviders.push(_)}else{_.setDependencies(this._aFiltersProviders)}return _};l.prototype.remove=function(e){var t=this._aDataProviders.indexOf(e);if(t>-1){this._aDataProviders.splice(t,1)}if(e&&!e.bDestroyed&&e._bIsDestroyed){e.destroy()}};l.prototype.setHost=function(e){this._oHost=e;if(this._oCsrfTokenHandler){this._oCsrfTokenHandler.setHost(e)}};return l});