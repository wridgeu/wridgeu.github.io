/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","sap/m/Popover","sap/ui/model/json/JSONModel","sap/m/Button","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/VBox","sap/m/HBox","sap/m/Select","sap/ui/core/ListItem","sap/m/Label","sap/m/Text","sap/m/Title","sap/m/CheckBox","sap/m/Menu","sap/m/MenuItem","sap/m/Input","sap/ui/integration/util/ParameterMap","sap/base/util/merge","sap/ui/core/Core","sap/m/Table","sap/m/Column","sap/m/ColumnListItem","sap/m/ScrollContainer","sap/base/util/ObjectPath","sap/ui/integration/util/BindingHelper","sap/ui/integration/editor/fields/ObjectListField","sap/ui/layout/form/SimpleForm","sap/ui/integration/util/Utils","sap/base/util/deepClone","sap/base/util/deepEqual"],function(e,t,a,n,s,i,l,r,o,d,u,p,_,g,c,m,f,v,y,b,S,h,w,T,I,x,P,E,V,D,M,C,O){"use strict";var A=e.extend("sap.ui.integration.editor.Settings",{metadata:{library:"sap.ui.integration"},renderer:null});var R=h.getLibraryResourceBundle("sap.ui.integration"),N,L,j=null,B,U,F,$,K,k,H,G,W,z,Y,Z,q,X=450,J=360;A.prototype.setConfiguration=function(e){this._originalConfig=e;e=S({},e);var t=new a(e);this.setModel(t,"currentSettings");this.bindElement({path:"currentSettings>/"})};A.prototype.open=function(e,t,a,n,s,i,l){var r=this.getModel("currentSettings").getData(),o=s.getParameterId();if(r.values&&r.values.item){this.prepareFieldsInKey(r)}j=this;q=Q(r,s);this.addDependent(q);this.oHost=n;this.fnApply=i;this.fnCancel=l;this._oOpener=s;L=true;e.addDependent(this);if(!r.allowDynamicValues&&r.values&&r.values.item){h.byId(o+"_settings_popover_scroll_container").setHeight("155px")}this.getModel("currentSettings").checkUpdate(true,true);ve(R.getText("EDITOR_SELECT_FROM_LIST"),[]);if(t){var d=a.getDomRef().offsetHeight;d=d>X?X:d;q.setContentHeight(d-50+"px");var u;var p="Right";var _=a.getDomRef().getBoundingClientRect();var g=e.getDomRef().getBoundingClientRect();var c=g.x+g.width/2-_.x;var m=_.width;if(2*c>m){p="Left";u=c-g.width*1.5}else{u=m-c-g.width}u=u>J?J:u;q.setContentWidth(u+"px");q.setPlacement(p);K.setValue(e._label);q.openBy(e)}else{q.open()}N=this.getModel("currentSettings");if(N.getProperty("/type")==="destination"){ie(o)}else if(N.getProperty("/_hasDynamicValue")){le(o)}else if(N.getProperty("/_hasSettings")){se(o)}else if(N.getProperty("/allowDynamicValues")){le(o)}else if(N.getProperty("/allowSettings")){se(o)}};A.prototype._applyCurrentSettings=function(){this.fnApply(N.getData())};A.prototype._cancelCurrentSettings=function(){this.fnCancel(this._originalConfig)};A.prototype.destroy=function(){this.removeDependent(q);return e.prototype.destroy.apply(this,arguments)};function Q(e,a){var s=a.getParameterId(),i=ae(e,s),o=ne(e,s,a),d=ue(s),u=pe(s),p=_e(e,a),_=ge(e,a),g=new t({id:s+"_settings_popover",showArrow:true,contentWidth:"400px",showHeader:false,horizontalScrolling:false,verticalScrolling:false,modal:false,footer:new l({content:[o,new r,new n(s+"_settings_popover_ok_btn",{text:R.getText("EDITOR_MORE_OK"),type:"Emphasized",press:function(){if(e.type==="destination"){if(a._oNewParameter){var t=Object.assign({},a._oNewParameter);var n=C(Object.assign([],a._oValue.value));n=n.sort(function(e,t){if(!e._dt||!e._dt._position||!t._dt||!t._dt._position){return 0}return e._dt._position-t._dt._position});n.forEach(function(e){delete e._dt});t.configuration.values.data.json={values:n};re("pageAdminNewDestinationParameter",t)}}else{if(e.values&&e.values.item){var i=h.byId(s+"_settings_popover_pav_table"),l=i.getSelectedContexts(),r=[];if(N.getProperty("/selectedValues")==="Partion"){for(var o=0;o<l.length;o++){var d=j.getKeyFromItem(l[o].getObject());r.push(d)}re("pageAdminValues",r)}else{re("pageAdminValues",[])}}}j._applyCurrentSettings();L=false;g.close()}}),new n(s+"_settings_popover_cancel_btn",{text:R.getText("EDITOR_MORE_CANCEL"),press:function(){g.close()}})]}),afterClose:function(){if(L){j._cancelCurrentSettings()}L=true;g.destroy()},afterOpen:function(){window.requestAnimationFrame(function(){g.getDomRef()&&(g.getDomRef().style.opacity="1")});if(e.values&&e.values.item){var t=h.byId(s+"_settings_popover_pav_table"),a=N.getProperty("/_next/pageAdminValues");if(a!==undefined&&a.length>0){t.removeSelections();N.setProperty("/selectedValues","None");var n=N.getProperty("/_next/pageAdminValues"),i=t.getItems();for(var l=0;l<n.length;l++){for(var r=0;r<i.length;r++){var o=j.getKeyFromItem(i[r].getBindingContext().getObject());if(n[l]===o){t.setSelectedItem(i[r])}}}N.setProperty("/selectedValues","Partion")}else{t.selectAll();N.setProperty("/selectedValues","All")}}}});g.setCustomHeader(i);g.addContent(d);g.addContent(u);g.addContent(p);g.addContent(_);g.addStyleClass("sapUiIntegrationFieldSettings");return g}function ee(e){z=new i({text:R.getText("EDITOR_MORE_SETTINGS"),tooltip:R.getText("EDITOR_MORE_SETTINGS"),key:"settings",icon:"sap-icon://action-settings",width:"50%",press:function(t){se(e)}}).addStyleClass("setbtn");return z}function te(e){z=ee(e);Y=new s(e+"_settings_popover_segmented_btn",{width:"100%",visible:"{= ${currentSettings>allowDynamicValues} && ${currentSettings>allowSettings}}",items:[new i({text:R.getText("EDITOR_MORE_DYNAMICVALUES"),tooltip:R.getText("EDITOR_MORE_DYNAMICVALUES"),key:"dynamic",icon:"{= ${currentSettings>_hasDynamicValue} ? 'sap-icon://display-more' : 'sap-icon://enter-more'}",width:"50%",press:function(t){le(e)}}).addStyleClass("dynbtn sel"),z]});return Y}function ae(e,t){Y=te(t);var a=new g(t+"_settings_popover_dynamicvalue_txt",{text:R.getText("EDITOR_MORE_DYNAMICVALUES"),tooltip:R.getText("EDITOR_MORE_DYNAMICVALUES"),visible:e.type!=="destination"&&e.allowDynamicValues&&!e.allowSettings}).addStyleClass("sapUiTinyMagin");var n=new g(t+"_settings_popover_settings_txt",{text:R.getText("EDITOR_MORE_SETTINGS"),visible:e.type!=="destination"&&!e.allowDynamicValues&&e.allowSettings}).addStyleClass("sapUiTinyMagin");var s=new g(t+"_settings_popover_transform_txt",{text:R.getText("EDITOR_MORE_TRANSFORM"),visible:e.type==="destination"}).addStyleClass("sapUiTinyMagin");var i=new l({content:[Y,a,n,s]}).addStyleClass("headertitle");return i}function ne(e,t,a){Z=new n(t+"_settings_popover_reset_btn",{type:"Transparent",text:R.getText("EDITOR_MORE_RESET"),enabled:"{= ${currentSettings>_next/visible} === (typeof(${currentSettings>visibleToUser}) === 'undefined' ? false : !${currentSettings>visibleToUser}) || ${currentSettings>_next/editable} === (typeof(${currentSettings>editableToUser}) === 'undefined' ? false : !${currentSettings>editableToUser}) || ${currentSettings>_next/allowDynamicValues} === (typeof(${currentSettings>allowDynamicValues}) === 'undefined' ? false : !${currentSettings>allowDynamicValues}) || ${currentSettings>_beforeValue} !== ${currentSettings>value} || ${currentSettings>type} === 'destination'}",tooltip:R.getText("EDITOR_MORE_SETTINGS_P_ADMIN_RESET"),press:function(){if(e.type==="destination"){re("pageAdminNewDestinationParameter",undefined);a._oValue=undefined;a._oNewParameter=undefined}else{var n=typeof N.getProperty("/visibleToUser")==="undefined"?true:N.getProperty("/visibleToUser");var s=typeof N.getProperty("/editableToUser")==="undefined"?true:N.getProperty("/editableToUser");var i=typeof N.getProperty("/allowDynamicValues")==="undefined"?true:N.getProperty("/allowDynamicValues");re("visible",n);re("editable",s);re("allowDynamicValues",i);if(N.getProperty("/translatable")){if(N.getProperty("/_translatedDefaultValue")&&N.getProperty("/_translatedDefaultValue")!==""){N.setProperty("/value",N.getProperty("/_translatedDefaultValue"))}else if(N.getProperty("/_translatedDefaultPlaceholder")&&N.getProperty("/_translatedDefaultPlaceholder")!==""){N.setProperty("/value",N.getProperty("/_translatedDefaultPlaceholder"))}N.setProperty("/_changed",false)}else{N.setProperty("/value",N.getProperty("/_beforeValue"));if(e.type.indexOf("object")>-1){a.setValue(N.getProperty("/_beforeValue"));a.resetControl()}}if(e.values&&e.values.item){var l=h.byId(t+"_settings_popover_pav_table"),r=N.getProperty("/_next/pageAdminValues"),o=l.getItems();if(r!==undefined&&r.length>0&&r.length<o.length){l.removeSelections();for(var d=0;d<r.length;d++){for(var u=0;u<o.length;u++){var p=j.getKeyFromItem(o[u].getBindingContext().getObject());if(r[d]===p){l.setSelectedItem(o[u])}}}N.setProperty("/selectedValues","Partion")}else{l.selectAll();N.setProperty("/selectedValues","All")}}}var _=h.byId(t+"_settings_popover");_.getFooter().getContent()[2].firePress()}}).addStyleClass("resetbutton");return Z}function se(e){U.setVisible(true);B.setVisible(false);F.setVisible(false);h.byId(e+"_settings_popover_segmented_btn").setSelectedKey("settings");var t=h.byId(e+"_settings_popover_currentvalue");t.setVisible(false)}function ie(e){F.setVisible(true);U.setVisible(false);B.setVisible(false);var t=h.byId(e+"_settings_popover_currentvalue");t.setVisible(false)}function le(e){U.setVisible(false);F.setVisible(false);B.setVisible(true);h.byId(e+"_settings_popover_segmented_btn").setSelectedKey("dynamic");var t=j.getModel("contextflat"),a=t._getValueObject(N.getProperty("/value"));if(a&&a.object.label){K.setValue(a.object.label);ve(a.object.description,a.object.tags);if(a.path==="empty"){K.setValue(a.object.label)}be(a)}var n=h.byId(e+"_settings_popover_currentvalue");n.setVisible(true)}function re(e,t){if(!N.getProperty("/_next")){N.setProperty("/_next",{})}N.setProperty("/_next/"+e,t)}function oe(e,t){var a=[];for(var n in e){if(e[n]&&e[n].label){var s=new v({text:e[n].label});s.__data=e[n];e[n].pathvalue=(t+"/"+n).substring(1);a.push(s);var i=oe(e[n],t+"/"+n);for(var l=0;l<i.length;l++){s.addItem(i[l])}}}return a}var de=[{formatMethod:"format.DateTime",sourceTypes:["datetime","date"],label:"Relative date/datetime text of the value",description:"Should be applied to dynamic values of type date or datetime or string values that represent a datetime in the format 'yyyy-MM-ddZhh:mm:ss'",example:"4 weeks ago",syntax:"handlebars",binding:"{= format.dateTime('__|VALUE|__',{relative:true})}"},{formatMethod:"format.DateTime",sourceTypes:["datetime","date"],label:"Short date/datetime text of the value",description:"Should be applied to dynamic values of type date, date-time or text values that represent a datetime in the format 'yyyy-MM-ddZhh:mm:ss.sss'",example:"9/18/20, 2:09 PM",binding:"{= format.dateTime('__|VALUE|__',{style:'short'})}"},{formatMethod:"format.DateTime",sourceTypes:["datetime","date"],label:"Medium date/datetime text of the value",description:"Should be applied to dynamic values of type date, date-time or text values that represent a datetime in the format 'yyyy-MM-ddThh:mm:ss.sssZ'",example:"Sep 18, 2020, 2:09:04 PM",binding:"{= format.dateTime('__|VALUE|__',{style:'medium'})}"},{formatMethod:"format.DateTime",sourceTypes:["datetime","date"],label:"Long date, date-time text of the value",description:"Should be applied to dynamic values of type date or date-time or string values that represent a datetime in the format 'yyyy-MM-ddThh:mm:ss.sssZ'",example:"Sep 18, 2020, 2:09:04 PM",binding:"{= format.dateTime('__|VALUE|__',{style:'long'})}"}];function ue(e){B=new o({visible:true});B.addStyleClass("sapUiSmallMargin");K=new y(e+"_settings_popover_dynamicvalue_input",{width:"100%",showValueHelp:true,valueHelpOnly:true,valueHelpRequest:function(){if(k){k.destroy()}k=new f({});H=oe(B.getModel("context").getData(),"");for(var e=0;e<H.length;e++){k.addItem(H[e])}k.attachItemSelected(function(e){var t=e.getParameter("item").__data;ve(t.description||"",t.tags||[]);K.setValue(t.placeholder||t.label);var a=j.getModel("contextflat");be(a._getPathObject(t.pathvalue))});K.addDependent(k);k.addStyleClass("sapUiIntegrationFieldSettingsMenu");k.openBy(K,false,null,null,"1 0")}});K.addStyleClass("selectvariable");var t=new _(e+"_settings_popover_dynamicvalue_label",{text:"Select a dynamic value"});K.addAriaLabelledBy(t);var a=new o({items:[t,K]});B.addItem(a);$=new g(e+"_settings_popover_dynamicvalue_desc_txt",{text:"",maxLines:6,renderWhitespace:true});a=new o({width:"100%",items:[$]});$.addStyleClass("description");B.addItem(a);if(de.length===-1){G=new u(e+"_settings_popover_dynamicvalue_format_select",{width:"100%",enabled:true,change:function(){W.setText(G.getSelectedItem()._data.description)}});a=new o({visible:false,items:[new _({text:"Customize the value..."}),G]});B.addItem(a);W=new g(e+"_settings_popover_dynamicvalue_format_label",{text:"",maxLines:4,renderWhitespace:true});W.addStyleClass("description");a=new o({width:"100%",items:[W]});B.addItem(a);B.getItems()[2].getItems()[0].addStyleClass("sapUiTinyMarginTop")}B.getItems()[0].getItems()[0].addStyleClass("sapUiTinyMarginTop");return B}function pe(e){var t=new g(e+"_settings_popover_actualvalue_label",{text:R.getText("EDITOR_ACTUAL_VALUE")});var a=new y(e+"_settings_popover_actualvalue_input",{value:{path:"currentSettings>_currentContextValue"},editable:false});a.addAriaLabelledBy(t);var n=new o(e+"_settings_popover_currentvalue",{width:"100%",items:[t,a]});n.addStyleClass("currentval");return n}function _e(e,t){var s=t.getParameterId();U=new o({visible:false});if(e.type==="destination"){return U}var i=(new o).addStyleClass("commonSettings");U.addItem(i);i.addItem(new c({text:R.getText("EDITOR_MORE_SETTINGS_P_ADMIN"),wrapping:true}).addStyleClass("stitle"));var l=new _(s+"_settings_popover_adminvisible_label",{text:R.getText("EDITOR_MORE_SETTINGS_P_ADMIN_VISIBLE"),wrapping:true});var r=new m(s+"_settings_popover_adminvisible_checkbox",{selected:"{= ${currentSettings>_next/visible} !== false}",select:function(e){re("visible",e.getParameter("selected"))}});r.addAriaLabelledBy(l);i.addItem(new d({alignItems:"Start",justifyContent:"SpaceBetween",items:[l,r]}).addStyleClass("cbrow"));var u=new _(s+"_settings_popover_admineditable_label",{text:R.getText("EDITOR_MORE_SETTINGS_P_ADMIN_EDIT"),wrapping:true});var p=new m(s+"_settings_popover_admineditable_checkbox",{selected:"{= ${currentSettings>_next/editable} !== false}",enabled:"{= ${currentSettings>_next/visible} !== false}",select:function(e){re("editable",e.getParameter("selected"))}});p.addAriaLabelledBy(u);i.addItem(new d({alignItems:"Start",justifyContent:"SpaceBetween",items:[u,p]}).addStyleClass("cbrow"));var f=new _(s+"_settings_popover_allowdynamicvalues_label",{text:R.getText("EDITOR_MORE_SETTINGS_P_ADMIN_DYN"),wrapping:true});var v=new m(s+"_settings_popover_allowdynamicvalues_checkbox",{selected:"{= ${currentSettings>_next/allowDynamicValues} !== false}",enabled:"{= ${currentSettings>_next/visible} !== false && ${currentSettings>_next/editable} !== false}",select:function(e){re("allowDynamicValues",e.getParameter("selected"))}});v.addAriaLabelledBy(f);i.addItem(new d({alignItems:"Start",justifyContent:"SpaceBetween",visible:"{= ${currentSettings>allowDynamicValues}!== false}",items:[f,v]}).addStyleClass("cbrow"));if(e.values&&e.values.item){var y;if(e.values.data){var b=e.values.data.path,S;if(b&&b!=="/"){if(b.startsWith("/")){b=b.substring(1)}if(b.endsWith("/")){b=b.substring(0,b.length-1)}S=b.split("/");y=P.get(["_values",S],e)}else{y=P.get(["_values"],e)}}else if(t.getParent().getParent().getAggregation("_extension")){var h=e.values.path;if(h.length>1){h=h.substring(1)}y=P.get([h],t.getModel().getData())}i.addItem(new d({alignItems:"Start",justifyContent:"SpaceBetween",visible:"{= ${currentSettings>_next/visible} !== false && ${currentSettings>_next/editable} !== false}",items:[new _(s+"_settings_popover_allowselectedvalues_label",{text:R.getText("EDITOR_MORE_SETTINGS_P_ADMIN_VALUES_LIST"),tooltip:R.getText("EDITOR_MORE_SETTINGS_P_ADMIN_VALUES_LIST_TOOLTIPS"),wrapping:false}),new n(s+"_settings_popover_allowselectedvalues_all_btn",{type:"Transparent",enabled:y!==undefined,icon:{path:"currentSettings>selectedValues",formatter:function(e){if(e==="All"){return"sap-icon://multiselect-all"}else if(e==="Partion"){return"sap-icon://multi-select"}else if(e==="None"){return"sap-icon://multiselect-none"}}},tooltip:{path:"currentSettings>selectedValues",formatter:function(e){if(e==="All"){return R.getText("EDITOR_MORE_SETTINGS_P_ADMIN_DESELECT_ALL")}else{return R.getText("EDITOR_MORE_SETTINGS_P_ADMIN_SELECT_ALL")}}},press:function(){ce(s)}})]}).addStyleClass("cbrow"));var V=new w({id:s+"_settings_popover_pav_table",mode:"MultiSelect",select:function(e){me(e,s)},columns:[new T]}).addStyleClass("tableHdr");var D=e.values.item.text,M=new a(y);V.setModel(M);var C=(new I).addStyleClass("pavlistItem");if(y){for(var O=0;O<y.length;O++){C.addCell(new d({items:[new g({text:E.createBindingInfos(D)}).addStyleClass("pavTblCellText")]})).addStyleClass("pavlistItem")}}V.bindItems("/",C);var A=new x({id:s+"_settings_popover_scroll_container",height:"125px",vertical:true,horizontal:false,visible:"{= ${currentSettings>_next/visible} !== false && ${currentSettings>_next/editable} !== false}",content:[V]}).addStyleClass("SettingsPAVTable");U.addItem(A)}return U}function ge(e,t){F=new o({visible:false});if(e.type!=="destination"){return F}var n=new _({text:R.getText("EDITOR_MORE_TRANSFORM_P_ADMIN_LABEL"),wrapping:true});var s=new y({id:t.getAssociation("_editor")+"_"+t.getParameterKey()+".toParameter_label",value:"{/configuration/label}"});s.addAriaLabelledBy(n);var i=new _({text:R.getText("EDITOR_MORE_TRANSFORM_P_ADMIN_MAPPINGS"),wrapping:true});var l=1,r=C(t.getModel("destinations").getData()._values),d=e._next?e._next.pageAdminNewDestinationParameter:undefined;if(!t._oValue){var u=d?d.configuration.values.data.json.values:[];if(Array.isArray(u)&&u.length>0){u.forEach(function(e){e.label=e.label||e.name;e._dt={_uuid:M.generateUuidV4(),_position:l};l++})}else{var p=t.getAggregation("_field").getSelectedItem();var g=p?p.getBindingContext("destinations").getPath():undefined;if(g){var c=C(p.getModel("destinations").getProperty(g));c.label=c.label||c.name;c._dt={_uuid:M.generateUuidV4(),_position:l};u=[c]}}t._oValue={value:u}}else{t._oValue.value.forEach(function(e){e._dt=e._dt||{};var t=C(e);delete t._dt;if(typeof t==="object"&&!O(t,{})){e.label=t.label||t.name}})}var m=new a(t._oValue);t._oDestinationValueObjectConfig={label:"Destination Mappings",type:"object[]",values:{data:{path:"/value"},allowAdd:true},showSelectionColumn:false,properties:{label:{label:"Label",column:{width:"50%"},cell:{text:"{label}",editable:true}},name:{label:"Name",column:{width:"50%"},cell:{type:"string",values:{data:{json:r,path:"/"},item:{text:"{settings>name}",key:"{settings>name}"},sorter:"name"},change:function(e){var t=e.getSource();var a=t.getBindingContext().getObject();if(a&&!a.label&&a.name){a.label=a.name}}}}},value:t._oValue.value};var f=new V(t.getAssociation("_editor")+"_"+t.getParameterKey()+".toParameter_field",{configuration:t._oDestinationValueObjectConfig,allowPopover:false,parameterKey:t.getParameterKey()+".toParameter",objectBindings:{currentSettings:{path:"currentSettings>/"}}});f.setAssociation("_editor",t.getAssociation("_editor"));f.setModel(m);f.setModel(new a(t._oDestinationValueObjectConfig),"currentSettings");var v=new D({layout:"ResponsiveGridLayout",labelSpanXL:4,labelSpanL:4,labelSpanM:4,labelSpanS:12,emptySpanXL:1,emptySpanL:1,emptySpanM:1,emptySpanS:0,columnsXL:1,columnsL:1,columnsM:1,content:[n,s,i,f]});if(!t._oNewParameter){t._oNewParameter={parameter:t.getParameterKey()+".toParameter",configuration:{label:e.label,manifestpath:e.manifestpath,type:"string",visible:true,editable:true,values:{data:{path:"/values"},item:{text:"{label}",key:"{name}"}},parameterFromDestination:true}};if(d){delete d.configuration.values.data.json;t._oNewParameter=Object.assign(t._oNewParameter,d)}}var b=new a(t._oNewParameter);v.setModel(b);F.addItem(v);return F}function ce(e){var t=h.byId(e+"_settings_popover_pav_table"),a=h.byId(e+"_settings_popover_reset_btn"),n=N.getProperty("/selectedValues");if(n==="All"){t.removeSelections();N.setProperty("/selectedValues","None")}else{t.selectAll();N.setProperty("/selectedValues","All")}if(!a.getEnabled()){a.setEnabled(true)}}function me(e,t){var a=e.getSource(),n=a.getSelectedItems(),s=a.getItems(),i=h.byId(t+"_settings_popover_reset_btn");if(n.length===s.length){N.setProperty("/selectedValues","All")}else if(n.length<s.length&&n.length>0){N.setProperty("/selectedValues","Partion")}else{N.setProperty("/selectedValues","None")}if(!i.getEnabled()){i.setEnabled(true)}}function fe(e,t){e=e||[];G.removeAllItems();var a=[];G.addItem(new p({text:"No customizing needed",key:""}));for(var n=0;n<de.length;n++){var s=de[n],i=new p({text:s.label,key:"key"+n});i._data=s;if(s.sourceTypes.indexOf(t)>-1||e.indexOf(s.formatMethod)>-1){G.addItem(i)}else{a.push(i)}}for(var n=0;n<a.length;n++){G.addItem(a[n])}}function ve(e,t){t=t||[];if(t.indexOf("technical")>-1){e=e+"\n"+R.getText("EDITOR_MORE_DYNAMICVALUES_TECHHINT")}$.setText(e)}function ye(e){if(de.length===-1){if(!e){G.removeAllItems();G.addItem(new p({text:"No customizing available for this value"}));W.setText("");G.setEnabled(false)}else{fe(e.customize,e.type);G.setEnabled(true)}}}function be(e){if(e){N.setProperty("/_hasDynamicValue",true);var t=e.value;N.setProperty("/value",t);N.setProperty("/_contextpath",e.path);if(e.object&&e.object.value&&e.object.value.indexOf("{{")===0){N.setProperty("/_currentContextValue",b.processPredefinedParameter(e.object.value));ye(e.object)}else{if(e.path==="empty"){N.setProperty("/value","");N.setProperty("/_currentContextValue","");N.setProperty("/_hasDynamicValue",false);ye()}else{ye(e.object);if(e.object&&e.object.hasOwnProperty("value")){N.setProperty("/_currentContextValue",e.object.value)}else{j.oHost.getContextValue(e.path+"/value").then(function(t){if(t===null){N.setProperty("/_currentContextValue","(not available)")}else{N.setProperty("/_currentContextValue",t)}e.object&&(e.object.value=t)})}}}}}A._private=function(){return{oPopover:q,oSegmentedButton:Y,oSettingsButton:z,oDynamicPanel:B,oSettingsPanel:U,oTransformPanel:F,oCurrentModel:N,updateCurrentValue:be,oCurrentInstance:j,oDynamicValueField:K,oResetToDefaultButton:Z,getMenuItems:function(){return H},getMenu:function(){return k}}};A.prototype.prepareFieldsInKey=function(e){this._sKeySeparator=e.values.keySeparator;if(!this._sKeySeparator){this._sKeySeparator="#"}var t=e.values.item.key;this._aFields=t.split(this._sKeySeparator);for(var a in this._aFields){if(this._aFields[a].startsWith("{")){this._aFields[a]=this._aFields[a].substring(1)}if(this._aFields[a].endsWith("}")){this._aFields[a]=this._aFields[a].substring(0,this._aFields[a].length-1)}}};A.prototype.getKeyFromItem=function(e){var t="";this._aFields.forEach(function(a){t+=e[a].toString()+this._sKeySeparator}.bind(this));if(t.endsWith(this._sKeySeparator)){t=t.substring(0,t.length-this._sKeySeparator.length)}return t};return A});
//# sourceMappingURL=Settings.js.map