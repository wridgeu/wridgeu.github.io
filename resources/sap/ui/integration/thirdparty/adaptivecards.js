/**
 * MIT License
 *
 * Copyright (c) 2017 Microsoft
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
(function e(t,i){if(typeof exports==="object"&&typeof module==="object")module.exports=i();else if(typeof sap.ui.define==="function")sap.ui.define([],i);else if(typeof exports==="object")exports["AdaptiveCards"]=i();else t["AdaptiveCards"]=i()})(window,function(){return function(e){var t={};function i(n){if(t[n]){return t[n].exports}var r=t[n]={i:n,l:false,exports:{}};e[n].call(r.exports,r,r.exports,i);r.l=true;return r.exports}i.m=e;i.c=t;i.d=function(e,t,n){if(!i.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:n})}};i.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};i.t=function(e,t){if(t&1)e=i(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var n=Object.create(null);i.r(n);Object.defineProperty(n,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n};i.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};i.d(t,"a",t);return t};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="";return i(i.s="./src/adaptivecards.ts")}({"./src/activity-request.ts":function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return e(t,i)};return function(t,i){e(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:true});t.LoginRequestResponse=t.ErrorResponse=t.SuccessResponse=t.ActivityResponse=t.ActivityRequestError=t.ActivityRequestTrigger=void 0;var r;(function(e){e["Automatic"]="automatic";e["Manual"]="manual"})(r=t.ActivityRequestTrigger||(t.ActivityRequestTrigger={}));var o=function(){function e(e,t){this.code=e;this.message=t}return e}();t.ActivityRequestError=o;var a=function(){function e(e){this.request=e}return e}();t.ActivityResponse=a;var s=function(e){n(t,e);function t(t,i){var n=e.call(this,t)||this;n.request=t;n.rawContent=i;return n}return t}(a);t.SuccessResponse=s;var l=function(e){n(t,e);function t(t,i){var n=e.call(this,t)||this;n.request=t;n.error=i;return n}return t}(a);t.ErrorResponse=l;var u=function(e){n(t,e);function t(t,i){var n=e.call(this,t)||this;n.request=t;n._auth=i;for(var r=0,o=n._auth.buttons;r<o.length;r++){var a=o[r];if(a.type==="signin"&&a.value!==undefined){try{new URL(a.value);n.signinButton=a;break}catch(e){}}}return n}Object.defineProperty(t.prototype,"tokenExchangeResource",{get:function(){return this._auth.tokenExchangeResource},enumerable:false,configurable:true});return t}(a);t.LoginRequestResponse=u},"./src/adaptive-applet.ts":function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n["throw"](e))}catch(e){o(e)}}function l(e){e.done?i(e.value):r(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())})};var r=this&&this.__generator||function(e,t){var i={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,r,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return l([e,t])}}function l(a){if(n)throw new TypeError("Generator is already executing.");while(i)try{if(n=1,r&&(o=a[0]&2?r["return"]:a[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;if(r=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:i.label++;return{value:a[1],done:false};case 5:i.label++;r=a[1];a=[0];continue;case 7:a=i.ops.pop();i.trys.pop();continue;default:if(!(o=i.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){i=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(a[0]===6&&i.label<o[1]){i.label=o[1];o=a;break}if(o&&i.label<o[2]){i.label=o[2];i.ops.push(a);break}if(o[2])i.ops.pop();i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e];r=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};Object.defineProperty(t,"__esModule",{value:true});t.AdaptiveApplet=void 0;var o=i("./src/enums.ts");var a=i("./src/utils.ts");var s=i("./src/shared.ts");var l=i("./src/activity-request.ts");var u=i("./src/strings.ts");var p=i("./src/card-elements.ts");var c=i("./src/serialization.ts");function d(e,t){var i=[];for(var n=2;n<arguments.length;n++){i[n-2]=arguments[n]}if(s.GlobalSettings.applets.logEnabled){if(s.GlobalSettings.applets.onLogEvent){s.GlobalSettings.applets.onLogEvent(e,t,i)}else{switch(e){case o.LogLevel.Warning:console.warn(t,i);break;case o.LogLevel.Error:console.error(t,i);break;default:console.log(t,i);break}}}}var f=function(){function e(e,t,i){this.action=e;this.trigger=t;this.consecutiveRefreshes=i;this.attemptNumber=0}e.prototype.retryAsync=function(){return n(this,void 0,void 0,function(){return r(this,function(e){if(this.onSend){this.onSend(this)}return[2]})})};return e}();var h=function(){function e(){this._allowAutomaticCardUpdate=false;this.renderedElement=document.createElement("div");this.renderedElement.className="aaf-cardHost";this.renderedElement.style.position="relative";this.renderedElement.style.display="flex";this.renderedElement.style.flexDirection="column";this._cardHostElement=document.createElement("div");this._refreshButtonHostElement=document.createElement("div");this._refreshButtonHostElement.className="aaf-refreshButtonHost";this._refreshButtonHostElement.style.display="none";this.renderedElement.appendChild(this._cardHostElement);this.renderedElement.appendChild(this._refreshButtonHostElement)}e.prototype.displayCard=function(e){if(e.renderedElement){a.clearElementChildren(this._cardHostElement);this._refreshButtonHostElement.style.display="none";this._cardHostElement.appendChild(e.renderedElement)}else{throw new Error("displayCard: undefined card.")}};e.prototype.showManualRefreshButton=function(e){var t=this;var i=this.onShowManualRefreshButton?this.onShowManualRefreshButton(this):true;if(i){this._refreshButtonHostElement.style.display="none";var n=undefined;if(this.onRenderManualRefreshButton){n=this.onRenderManualRefreshButton(this)}else{var r=u.Strings.runtime.refreshThisCard();if(s.GlobalSettings.applets.refresh.mode===o.RefreshMode.Automatic){var d=u.Strings.runtime.automaticRefreshPaused();if(d[d.length-1]!==" "){d+=" "}r=u.Strings.runtime.clckToRestartAutomaticRefresh()}var f={type:"AdaptiveCard",version:"1.2",body:[{type:"RichTextBlock",horizontalAlignment:"right",inlines:[{type:"TextRun",text:r,selectAction:{type:"Action.Submit",id:"refreshCard"}}]}]};var h=new p.AdaptiveCard;h.parse(f,new p.SerializationContext(c.Versions.v1_2));h.onExecuteAction=function(i){if(i.id==="refreshCard"){a.clearElementChildren(t._refreshButtonHostElement);t.internalExecuteAction(e,l.ActivityRequestTrigger.Automatic,0)}};n=h.render()}if(n){a.clearElementChildren(this._refreshButtonHostElement);this._refreshButtonHostElement.appendChild(n);this._refreshButtonHostElement.style.removeProperty("display")}}};e.prototype.createActivityRequest=function(e,t,i){var n=this;if(this.card){var r=new f(e,t,i);r.onSend=function(e){e.attemptNumber++;n.internalSendActivityRequestAsync(r)};var o=this.onPrepareActivityRequest?!this.onPrepareActivityRequest(this,r,e):false;return o?undefined:r}else{throw new Error("createActivityRequest: no card has been set.")}};e.prototype.createMagicCodeInputCard=function(t){var i={type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",color:"attention",text:t===1?undefined:"That didn't work... let's try again.",wrap:true,horizontalAlignment:"center"},{type:"TextBlock",text:'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"',wrap:true,horizontalAlignment:"center"},{type:"Input.Text",id:"magicCode",placeholder:"Enter magic code"},{type:"ActionSet",horizontalAlignment:"center",actions:[{type:"Action.Submit",id:e.submitMagicCodeActionId,title:"Submit"},{type:"Action.Submit",id:e.cancelMagicCodeAuthActionId,title:"Cancel"}]}]};var n=new p.AdaptiveCard;n.parse(i);return n};e.prototype.cancelAutomaticRefresh=function(){if(this._allowAutomaticCardUpdate){d(o.LogLevel.Warning,"Automatic card refresh has been cancelled as a result of the user interacting with the card.")}this._allowAutomaticCardUpdate=false};e.prototype.createSerializationContext=function(){return this.onCreateSerializationContext?this.onCreateSerializationContext(this):new p.SerializationContext};e.prototype.internalSetCard=function(e,t){var i=this;if(typeof e==="object"&&e["type"]==="AdaptiveCard"){this._cardPayload=e}if(this._cardPayload){try{var n=new p.AdaptiveCard;if(this.hostConfig){n.hostConfig=this.hostConfig}var r=this.createSerializationContext();n.parse(this._cardPayload,r);var a=this.onCardChanging?this.onCardChanging(this,this._cardPayload):true;if(a){this._card=n;if(this._card.authentication&&this._card.authentication.tokenExchangeResource&&this.onPrefetchSSOToken){this.onPrefetchSSOToken(this,this._card.authentication.tokenExchangeResource)}this._card.onExecuteAction=function(e){i.cancelAutomaticRefresh();i.internalExecuteAction(e,l.ActivityRequestTrigger.Manual,0)};this._card.onInputValueChanged=function(e){i.cancelAutomaticRefresh()};this._card.render();if(this._card.renderedElement){this.displayCard(this._card);if(this.onCardChanged){this.onCardChanged(this)}if(this._card.refresh){if(s.GlobalSettings.applets.refresh.mode===o.RefreshMode.Automatic&&t<s.GlobalSettings.applets.refresh.maximumConsecutiveAutomaticRefreshes){if(s.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes<=0){d(o.LogLevel.Info,"Triggering automatic card refresh number "+(t+1));this.internalExecuteAction(this._card.refresh.action,l.ActivityRequestTrigger.Automatic,t+1)}else{d(o.LogLevel.Info,"Scheduling automatic card refresh number "+(t+1)+" in "+s.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes+"ms");var u=this._card.refresh.action;this._allowAutomaticCardUpdate=true;window.setTimeout(function(){if(i._allowAutomaticCardUpdate){i.internalExecuteAction(u,l.ActivityRequestTrigger.Automatic,t+1)}},s.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes)}}else if(s.GlobalSettings.applets.refresh.mode!==o.RefreshMode.Disabled){if(t>0){d(o.LogLevel.Warning,"Stopping automatic refreshes after "+t+" consecutive refreshes.")}else{d(o.LogLevel.Warning,"The card has a refresh section, but automatic refreshes are disabled.")}if(s.GlobalSettings.applets.refresh.allowManualRefreshesAfterAutomaticRefreshes||s.GlobalSettings.applets.refresh.mode===o.RefreshMode.Manual){d(o.LogLevel.Info,"Showing manual refresh button.");this.showManualRefreshButton(this._card.refresh.action)}}}}}}catch(e){d(o.LogLevel.Error,"setCard: "+e)}}};e.prototype.internalExecuteAction=function(e,t,i){if(e instanceof p.ExecuteAction){if(this.channelAdapter){var n=this.createActivityRequest(e,t,i);if(n){n.retryAsync()}}else{throw new Error("internalExecuteAction: No channel adapter set.")}}if(this.onAction){this.onAction(this,e)}};e.prototype.createProgressOverlay=function(e){if(!this._progressOverlay){if(this.onCreateProgressOverlay){this._progressOverlay=this.onCreateProgressOverlay(this,e)}else{this._progressOverlay=document.createElement("div");this._progressOverlay.className="aaf-progress-overlay";var t=document.createElement("div");t.className="aaf-spinner";t.style.width="28px";t.style.height="28px";this._progressOverlay.appendChild(t)}}return this._progressOverlay};e.prototype.removeProgressOverlay=function(e){if(this.onRemoveProgressOverlay){this.onRemoveProgressOverlay(this,e)}if(this._progressOverlay!==undefined){this.renderedElement.removeChild(this._progressOverlay);this._progressOverlay=undefined}};e.prototype.activityRequestSucceeded=function(e,t){if(this.onActivityRequestSucceeded){this.onActivityRequestSucceeded(this,e,t)}};e.prototype.activityRequestFailed=function(e){return this.onActivityRequestFailed?this.onActivityRequestFailed(this,e):s.GlobalSettings.applets.defaultTimeBetweenRetryAttempts};e.prototype.showAuthCodeInputDialog=function(t){var i=this;var n=this.onShowAuthCodeInputDialog?this.onShowAuthCodeInputDialog(this,t):true;if(n){var r=this.createMagicCodeInputCard(t.attemptNumber);r.render();r.onExecuteAction=function(n){if(i.card&&n instanceof p.SubmitAction){switch(n.id){case e.submitMagicCodeActionId:var r=undefined;if(n.data&&typeof n.data["magicCode"]==="string"){r=n.data["magicCode"]}if(r){i.displayCard(i.card);t.authCode=r;t.retryAsync()}else{alert("Please enter the magic code you received.")}break;case e.cancelMagicCodeAuthActionId:d(o.LogLevel.Warning,"Authentication cancelled by user.");i.displayCard(i.card);break;default:d(o.LogLevel.Error,"Unespected action taken from magic code input card (id = "+n.id+")");alert(u.Strings.magicCodeInputCard.somethingWentWrong());break}}};this.displayCard(r)}};e.prototype.internalSendActivityRequestAsync=function(e){return n(this,void 0,void 0,function(){var t,i,n,a,p;return r(this,function(c){switch(c.label){case 0:if(!this.channelAdapter){throw new Error("internalSendActivityRequestAsync: channelAdapter is not set.")}t=this.createProgressOverlay(e);if(t!==undefined){this.renderedElement.appendChild(t)}i=false;n=function(){var t,n,p,c,f,h,y;return r(this,function(r){switch(r.label){case 0:t=undefined;if(e.attemptNumber===1){d(o.LogLevel.Info,"Sending activity request to channel (attempt "+e.attemptNumber+")")}else{d(o.LogLevel.Info,"Re-sending activity request to channel (attempt "+e.attemptNumber+")")}r.label=1;case 1:r.trys.push([1,3,,4]);return[4,a.channelAdapter.sendRequestAsync(e)];case 2:t=r.sent();return[3,4];case 3:n=r.sent();d(o.LogLevel.Error,"Activity request failed: "+n);a.removeProgressOverlay(e);i=true;return[3,4];case 4:if(!t)return[3,10];if(!(t instanceof l.SuccessResponse))return[3,5];a.removeProgressOverlay(e);if(t.rawContent===undefined){throw new Error("internalSendActivityRequestAsync: Action.Execute result is undefined")}p=t.rawContent;try{p=JSON.parse(t.rawContent)}catch(e){}if(typeof p==="string"){d(o.LogLevel.Info,"The activity request returned a string after "+e.attemptNumber+" attempt(s).");a.activityRequestSucceeded(t,p)}else if(typeof p==="object"&&p["type"]==="AdaptiveCard"){d(o.LogLevel.Info,"The activity request returned an Adaptive Card after "+e.attemptNumber+" attempt(s).");a.internalSetCard(p,e.consecutiveRefreshes);a.activityRequestSucceeded(t,a.card)}else{throw new Error("internalSendActivityRequestAsync: Action.Execute result is of unsupported type ("+typeof t.rawContent+")")}i=true;return[3,10];case 5:if(!(t instanceof l.ErrorResponse))return[3,9];c=a.activityRequestFailed(t);if(!(c>=0&&e.attemptNumber<s.GlobalSettings.applets.maximumRetryAttempts))return[3,7];d(o.LogLevel.Warning,"Activity request failed: "+t.error.message+". Retrying in "+c+"ms");e.attemptNumber++;return[4,new Promise(function(e,t){window.setTimeout(function(){e()},c)})];case 6:r.sent();return[3,8];case 7:d(o.LogLevel.Error,"Activity request failed: "+t.error.message+". Giving up after "+e.attemptNumber+" attempt(s)");a.removeProgressOverlay(e);i=true;r.label=8;case 8:return[3,10];case 9:if(t instanceof l.LoginRequestResponse){d(o.LogLevel.Info,"The activity request returned a LoginRequestResponse after "+e.attemptNumber+" attempt(s).");if(e.attemptNumber<=s.GlobalSettings.applets.maximumRetryAttempts){f=true;if(t.tokenExchangeResource&&a.onSSOTokenNeeded){f=!a.onSSOTokenNeeded(a,e,t.tokenExchangeResource)}if(f){a.removeProgressOverlay(e);if(t.signinButton===undefined){throw new Error("internalSendActivityRequestAsync: the login request doesn't contain a valid signin URL.")}d(o.LogLevel.Info,"Login required at "+t.signinButton.value);if(a.onShowSigninPrompt){a.onShowSigninPrompt(a,e,t.signinButton)}else{a.showAuthCodeInputDialog(e);h=window.screenX+(window.outerWidth-s.GlobalSettings.applets.authPromptWidth)/2;y=window.screenY+(window.outerHeight-s.GlobalSettings.applets.authPromptHeight)/2;window.open(t.signinButton.value,t.signinButton.title?t.signinButton.title:"Sign in","width="+s.GlobalSettings.applets.authPromptWidth+",height="+s.GlobalSettings.applets.authPromptHeight+",left="+h+",top="+y)}}}else{d(o.LogLevel.Error,"Authentication failed. Giving up after "+e.attemptNumber+" attempt(s)");alert(u.Strings.magicCodeInputCard.authenticationFailed())}return[2,"break"]}else{throw new Error("Unhandled response type: "+t.toString())}r.label=10;case 10:return[2]}})};a=this;c.label=1;case 1:if(!!i)return[3,3];return[5,n()];case 2:p=c.sent();if(p==="break")return[3,3];return[3,1];case 3:return[2]}})})};e.prototype.refreshCard=function(){if(this._card&&this._card.refresh){this.internalExecuteAction(this._card.refresh.action,l.ActivityRequestTrigger.Manual,0)}};e.prototype.setCard=function(e){this.internalSetCard(e,0)};Object.defineProperty(e.prototype,"card",{get:function(){return this._card},enumerable:false,configurable:true});e.submitMagicCodeActionId="submitMagicCode";e.cancelMagicCodeAuthActionId="cancelMagicCodeAuth";return e}();t.AdaptiveApplet=h},"./src/adaptivecards.ts":function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){if(n===undefined)n=i;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[i]}})}:function(e,t,i,n){if(n===undefined)n=i;e[n]=t[i]});var r=this&&this.__exportStar||function(e,t){for(var i in e)if(i!=="default"&&!t.hasOwnProperty(i))n(t,e,i)};Object.defineProperty(t,"__esModule",{value:true});
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
r(i("./src/serialization.ts"),t);r(i("./src/registry.ts"),t);r(i("./src/card-object.ts"),t);r(i("./src/card-elements.ts"),t);r(i("./src/enums.ts"),t);r(i("./src/host-config.ts"),t);r(i("./src/shared.ts"),t);r(i("./src/utils.ts"),t);r(i("./src/strings.ts"),t);r(i("./src/channel-adapter.ts"),t);r(i("./src/activity-request.ts"),t);r(i("./src/adaptive-applet.ts"),t)},"./src/card-elements.ts":function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return e(t,i)};return function(t,i){e(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var r=this&&this.__decorate||function(e,t,i,n){var r=arguments.length,o=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,i):n,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)if(a=e[s])o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o;return r>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(t,"__esModule",{value:true});t.SerializationContext=t.GlobalRegistry=t.AdaptiveCard=t.Authentication=t.TokenExchangeResource=t.AuthCardButton=t.RefreshDefinition=t.RefreshActionProperty=t.ContainerWithActions=t.ColumnSet=t.Column=t.Container=t.BackgroundImage=t.StylableCardElementContainer=t.ActionSet=t.ShowCardAction=t.HttpAction=t.HttpHeader=t.ToggleVisibilityAction=t.OpenUrlAction=t.ExecuteAction=t.SubmitAction=t.SubmitActionBase=t.Action=t.TimeInput=t.TimeProperty=t.DateInput=t.NumberInput=t.ChoiceSetInput=t.Choice=t.ToggleInput=t.TextInput=t.Input=t.Media=t.MediaSource=t.ImageSet=t.CardElementContainer=t.Image=t.FactSet=t.Fact=t.RichTextBlock=t.TextRun=t.TextBlock=t.BaseTextBlock=t.ActionProperty=t.CardElement=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var o=i("./src/enums.ts");var a=i("./src/shared.ts");var s=i("./src/utils.ts");var l=i("./src/host-config.ts");var u=i("./src/text-formatters.ts");var p=i("./src/card-object.ts");var c=i("./src/serialization.ts");var d=i("./src/registry.ts");var f=i("./src/strings.ts");var h=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._truncatedDueToOverflow=false;return t}Object.defineProperty(t.prototype,"lang",{get:function(){var e=this.getValue(t.langProperty);if(e){return e}else{if(this.parent){return this.parent.lang}else{return undefined}}},set:function(e){this.setValue(t.langProperty,e)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:function(e){if(a.GlobalSettings.useAdvancedCardBottomTruncation&&!e){this.undoOverflowTruncation()}if(this.isVisible!==e){this.setValue(t.isVisibleProperty,e);this.updateRenderedElementVisibility();if(this._renderedElement){ae(this)}}if(this._renderedElement){this._renderedElement.setAttribute("aria-expanded",e.toString())}},enumerable:false,configurable:true});t.prototype.internalRenderSeparator=function(){var e=s.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:undefined,lineColor:this.separator?this.hostConfig.separator.lineColor:undefined},this.separatorOrientation);if(a.GlobalSettings.alwaysBleedSeparators&&e&&this.separatorOrientation==o.Orientation.Horizontal){var t=this.getParentContainer();if(t&&t.getEffectivePadding()){var i=this.hostConfig.paddingDefinitionToSpacingDefinition(t.getEffectivePadding());e.style.marginLeft="-"+i.left+"px";e.style.marginRight="-"+i.right+"px"}}return e};t.prototype.updateRenderedElementVisibility=function(){var e=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";if(this._renderedElement){if(e){this._renderedElement.style.display=e}else{this._renderedElement.style.removeProperty("display")}}if(this._separatorElement){if(this.parent&&this.parent.isFirstElement(this)){this._separatorElement.style.display="none"}else{if(e){this._separatorElement.style.display=e}else{this._separatorElement.style.removeProperty("display")}}}};t.prototype.hideElementDueToOverflow=function(){if(this._renderedElement&&this.isVisible){this._renderedElement.style.visibility="hidden";this.isVisible=false;ae(this,false)}};t.prototype.showElementHiddenDueToOverflow=function(){if(this._renderedElement&&!this.isVisible){this._renderedElement.style.removeProperty("visibility");this.isVisible=true;ae(this,false)}};t.prototype.handleOverflow=function(e){if(this.isVisible||this.isHiddenDueToOverflow()){var t=this.truncateOverflow(e);this._truncatedDueToOverflow=t||this._truncatedDueToOverflow;if(!t){this.hideElementDueToOverflow()}else if(t&&!this.isVisible){this.showElementHiddenDueToOverflow()}}};t.prototype.resetOverflow=function(){var e=false;if(this._truncatedDueToOverflow){this.undoOverflowTruncation();this._truncatedDueToOverflow=false;e=true}if(this.isHiddenDueToOverflow()){this.showElementHiddenDueToOverflow()}return e};t.prototype.getDefaultSerializationContext=function(){return new ge};t.prototype.createPlaceholderElement=function(){var e=this.getEffectiveStyleDefinition();var t=s.stringToCssColor(e.foregroundColors.default.subtle);var i=document.createElement("div");i.style.border="1px dashed "+t;i.style.padding="4px";i.style.minHeight="32px";i.style.fontSize="10px";i.style.color=t;i.innerText="Empty "+this.getJsonTypeName();return i};t.prototype.adjustRenderedElementSize=function(e){if(this.height==="auto"){e.style.flex="0 0 auto"}else{e.style.flex="1 1 auto"}};t.prototype.isDisplayed=function(){return this._renderedElement!==undefined&&this.isVisible&&this._renderedElement.offsetHeight>0};t.prototype.overrideInternalRender=function(){return this.internalRender()};t.prototype.applyPadding=function(){if(this.separatorElement&&this.separatorOrientation===o.Orientation.Horizontal){if(a.GlobalSettings.alwaysBleedSeparators&&!this.isBleeding()){var e=new a.PaddingDefinition;this.getImmediateSurroundingPadding(e);var t=this.hostConfig.paddingDefinitionToSpacingDefinition(e);this.separatorElement.style.marginLeft="-"+t.left+"px";this.separatorElement.style.marginRight="-"+t.right+"px"}else{this.separatorElement.style.marginRight="0";this.separatorElement.style.marginLeft="0"}}};t.prototype.truncateOverflow=function(e){return false};t.prototype.undoOverflowTruncation=function(){};t.prototype.getDefaultPadding=function(){return new a.PaddingDefinition};t.prototype.getHasBackground=function(){return false};t.prototype.getPadding=function(){return this._padding};t.prototype.setPadding=function(e){this._padding=e};t.prototype.shouldSerialize=function(e){return e.elementRegistry.findByName(this.getJsonTypeName())!==undefined};Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"allowCustomPadding",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return o.Orientation.Horizontal},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return o.ContainerStyle.Default},enumerable:false,configurable:true});t.prototype.parse=function(t,i){e.prototype.parse.call(this,t,i?i:new ge)};t.prototype.asString=function(){return""};t.prototype.isBleeding=function(){return false};t.prototype.getEffectiveStyle=function(){if(this.parent){return this.parent.getEffectiveStyle()}return this.defaultStyle};t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())};t.prototype.getForbiddenActionTypes=function(){return[]};t.prototype.getImmediateSurroundingPadding=function(e,t,i,n,r){if(t===void 0){t=true}if(i===void 0){i=true}if(n===void 0){n=true}if(r===void 0){r=true}if(this.parent){var a=t&&this.parent.isTopElement(this);var s=i&&this.parent.isRightMostElement(this);var l=n&&this.parent.isBottomElement(this);var u=r&&this.parent.isLeftMostElement(this);var p=this.parent.getEffectivePadding();if(p){if(a&&p.top!=o.Spacing.None){e.top=p.top;a=false}if(s&&p.right!=o.Spacing.None){e.right=p.right;s=false}if(l&&p.bottom!=o.Spacing.None){e.bottom=p.bottom;l=false}if(u&&p.left!=o.Spacing.None){e.left=p.left;u=false}}if(a||s||l||u){this.parent.getImmediateSurroundingPadding(e,a,s,l,u)}}};t.prototype.getActionCount=function(){return 0};t.prototype.getActionAt=function(e){throw new Error(f.Strings.errors.indexOutOfRange(e))};t.prototype.remove=function(){if(this.parent&&this.parent instanceof A){return this.parent.removeItem(this)}return false};t.prototype.render=function(){this._renderedElement=this.overrideInternalRender();this._separatorElement=this.internalRenderSeparator();if(this._renderedElement){if(this.id){this._renderedElement.id=this.id}if(this.customCssSelector){this._renderedElement.classList.add(this.customCssSelector)}this._renderedElement.style.boxSizing="border-box";this._defaultRenderedElementDisplayMode=this._renderedElement.style.display?this._renderedElement.style.display:undefined;this.adjustRenderedElementSize(this._renderedElement);this.updateLayout(false)}else if(this.isDesignMode()){this._renderedElement=this.createPlaceholderElement()}return this._renderedElement};t.prototype.updateLayout=function(e){if(e===void 0){e=true}this.updateRenderedElementVisibility();this.applyPadding()};t.prototype.indexOf=function(e){return-1};t.prototype.isDesignMode=function(){var e=this.getRootElement();return e instanceof fe&&e.designMode};t.prototype.isFirstElement=function(e){return true};t.prototype.isLastElement=function(e){return true};t.prototype.isAtTheVeryLeft=function(){return this.parent?this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft():true};t.prototype.isAtTheVeryRight=function(){return this.parent?this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight():true};t.prototype.isAtTheVeryTop=function(){return this.parent?this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop():true};t.prototype.isAtTheVeryBottom=function(){return this.parent?this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom():true};t.prototype.isBleedingAtTop=function(){return false};t.prototype.isBleedingAtBottom=function(){return false};t.prototype.isLeftMostElement=function(e){return true};t.prototype.isRightMostElement=function(e){return true};t.prototype.isTopElement=function(e){return this.isFirstElement(e)};t.prototype.isBottomElement=function(e){return this.isLastElement(e)};t.prototype.isHiddenDueToOverflow=function(){return this._renderedElement!==undefined&&this._renderedElement.style.visibility=="hidden"};t.prototype.getRootElement=function(){return this.getRootObject()};t.prototype.getParentContainer=function(){var e=this.parent;while(e){if(e instanceof Z){return e}e=e.parent}return undefined};t.prototype.getAllInputs=function(e){if(e===void 0){e=true}return[]};t.prototype.getResourceInformation=function(){return[]};t.prototype.getElementById=function(e){return this.id===e?this:undefined};t.prototype.getActionById=function(e){return undefined};t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e&&this.allowCustomPadding?e:this.getDefaultPadding()};Object.defineProperty(t.prototype,"hostConfig",{get:function(){if(this._hostConfig){return this._hostConfig}else{if(this.parent){return this.parent.hostConfig}else{return l.defaultHostConfig}}},set:function(e){this._hostConfig=e},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"index",{get:function(){if(this.parent){return this.parent.indexOf(this)}else{return 0}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isInteractive",{get:function(){return false},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isStandalone",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isInline",{get:function(){return false},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){if(this.parent&&this.separatorElement){return!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode())}else{return false}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:false,configurable:true});t.langProperty=new c.StringProperty(c.Versions.v1_1,"lang",true,/^[a-z]{2,3}$/gi);t.isVisibleProperty=new c.BoolProperty(c.Versions.v1_2,"isVisible",true);t.separatorProperty=new c.BoolProperty(c.Versions.v1_0,"separator",false);t.heightProperty=new c.ValueSetProperty(c.Versions.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto");t.horizontalAlignmentProperty=new c.EnumProperty(c.Versions.v1_0,"horizontalAlignment",o.HorizontalAlignment,o.HorizontalAlignment.Left);t.spacingProperty=new c.EnumProperty(c.Versions.v1_0,"spacing",o.Spacing,o.Spacing.Default);r([c.property(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0);r([c.property(t.spacingProperty)],t.prototype,"spacing",void 0);r([c.property(t.separatorProperty)],t.prototype,"separator",void 0);r([c.property(t.heightProperty)],t.prototype,"height",void 0);r([c.property(t.langProperty)],t.prototype,"lang",null);r([c.property(t.isVisibleProperty)],t.prototype,"isVisible",null);return t}(p.CardObject);t.CardElement=h;var y=function(e){n(t,e);function t(t,i,n){if(n===void 0){n=[]}var r=e.call(this,t,i,undefined)||this;r.targetVersion=t;r.name=i;r.forbiddenActionTypes=n;return r}t.prototype.parse=function(e,t,i){var n=e;return i.parseAction(n,t[this.name],this.forbiddenActionTypes,n.isDesignMode())};t.prototype.toJSON=function(e,t,i,n){n.serializeValue(t,this.name,i?i.toJSON(n):undefined,undefined,true)};return t}(c.PropertyDefinition);t.ActionProperty=y;var g=function(e){n(t,e);function t(t){var i=e.call(this)||this;i.size=o.TextSize.Default;i.weight=o.TextWeight.Default;i.color=o.TextColor.Default;i.isSubtle=false;i.ariaHidden=false;if(t){i.text=t}return i}t.prototype.populateSchema=function(i){e.prototype.populateSchema.call(this,i);i.remove(t.selectActionProperty)};Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setText(e)},enumerable:false,configurable:true});t.prototype.getFontSize=function(e){switch(this.size){case o.TextSize.Small:return e.fontSizes.small;case o.TextSize.Medium:return e.fontSizes.medium;case o.TextSize.Large:return e.fontSizes.large;case o.TextSize.ExtraLarge:return e.fontSizes.extraLarge;default:return e.fontSizes.default}};t.prototype.getColorDefinition=function(e,t){switch(t){case o.TextColor.Accent:return e.accent;case o.TextColor.Dark:return e.dark;case o.TextColor.Light:return e.light;case o.TextColor.Good:return e.good;case o.TextColor.Warning:return e.warning;case o.TextColor.Attention:return e.attention;default:return e.default}};t.prototype.setText=function(e){this.setValue(t.textProperty,e)};t.prototype.init=function(e){this.size=e.size;this.weight=e.weight;this.color=e.color;this.isSubtle=e.isSubtle};t.prototype.asString=function(){return this.text};t.prototype.applyStylesTo=function(e){var t=this.hostConfig.getFontTypeDefinition(this.fontType);if(t.fontFamily){e.style.fontFamily=t.fontFamily}var i;switch(this.size){case o.TextSize.Small:i=t.fontSizes.small;break;case o.TextSize.Medium:i=t.fontSizes.medium;break;case o.TextSize.Large:i=t.fontSizes.large;break;case o.TextSize.ExtraLarge:i=t.fontSizes.extraLarge;break;default:i=t.fontSizes.default;break}e.style.fontSize=i+"px";var n=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);e.style.color=s.stringToCssColor(this.isSubtle?n.subtle:n.default);var r;switch(this.weight){case o.TextWeight.Lighter:r=t.fontWeights.lighter;break;case o.TextWeight.Bolder:r=t.fontWeights.bolder;break;default:r=t.fontWeights.default;break}e.style.fontWeight=r.toString();if(this.ariaHidden){e.setAttribute("aria-hidden","true")}};Object.defineProperty(t.prototype,"effectiveColor",{get:function(){return this.color?this.color:o.TextColor.Default},enumerable:false,configurable:true});t.textProperty=new c.StringProperty(c.Versions.v1_0,"text",true);t.sizeProperty=new c.EnumProperty(c.Versions.v1_0,"size",o.TextSize,o.TextSize.Default);t.weightProperty=new c.EnumProperty(c.Versions.v1_0,"weight",o.TextWeight,o.TextWeight.Default);t.colorProperty=new c.EnumProperty(c.Versions.v1_0,"color",o.TextColor,o.TextColor.Default);t.isSubtleProperty=new c.BoolProperty(c.Versions.v1_0,"isSubtle",false);t.fontTypeProperty=new c.EnumProperty(c.Versions.v1_2,"fontType",o.FontType);t.selectActionProperty=new y(c.Versions.v1_1,"selectAction",["Action.ShowCard"]);r([c.property(t.sizeProperty)],t.prototype,"size",void 0);r([c.property(t.weightProperty)],t.prototype,"weight",void 0);r([c.property(t.colorProperty)],t.prototype,"color",void 0);r([c.property(t.fontTypeProperty)],t.prototype,"fontType",void 0);r([c.property(t.isSubtleProperty)],t.prototype,"isSubtle",void 0);r([c.property(t.textProperty)],t.prototype,"text",null);r([c.property(t.selectActionProperty)],t.prototype,"selectAction",void 0);return t}(h);t.BaseTextBlock=g;var m=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.wrap=false;t._treatAsPlainText=true;t.useMarkdown=true;return t}t.prototype.restoreOriginalContent=function(){if(this.renderedElement!==undefined){if(this.maxLines&&this.maxLines>0){this.renderedElement.style.maxHeight=this._computedLineHeight*this.maxLines+"px"}this.renderedElement.innerHTML=this._originalInnerHtml}};t.prototype.truncateIfSupported=function(e){if(this.renderedElement!==undefined){var t=this.renderedElement.children;var i=!t.length;var n=i||t.length==1&&t[0].tagName.toLowerCase()=="p";if(n){var r=i?this.renderedElement:t[0];s.truncate(r,e,this._computedLineHeight);return true}}return false};t.prototype.setText=function(t){e.prototype.setText.call(this,t);this._processedText=undefined};t.prototype.internalRender=function(){var e=this;this._processedText=undefined;if(this.text){var t=this.preProcessPropertyValue(g.textProperty);var i=this.hostConfig;var n=void 0;if(this.forElementId){var r=document.createElement("label");r.htmlFor=this.forElementId;n=r}else{n=document.createElement("div")}n.classList.add(i.makeCssClassName("ac-textBlock"));n.style.overflow="hidden";this.applyStylesTo(n);if(this.selectAction){n.onclick=function(t){t.preventDefault();t.cancelBubble=true;if(e.selectAction){e.selectAction.execute()}};if(i.supportsInteractivity){n.tabIndex=0;n.setAttribute("role",this.selectAction.getAriaRole());if(this.selectAction.title){n.setAttribute("aria-label",this.selectAction.title);n.title=this.selectAction.title}n.classList.add(i.makeCssClassName("ac-selectable"))}}if(!this._processedText){this._treatAsPlainText=true;var o=u.formatText(this.lang,t);if(this.useMarkdown&&o){if(a.GlobalSettings.allowMarkForTextHighlighting){o=o.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/")}var l=fe.applyMarkdown(o);if(l.didProcess&&l.outputHtml){this._processedText=l.outputHtml;this._treatAsPlainText=false;if(a.GlobalSettings.allowMarkForTextHighlighting&&this._processedText){var p="";var c=this.getEffectiveStyleDefinition();if(c.highlightBackgroundColor){p+="background-color: "+c.highlightBackgroundColor+";"}if(c.highlightForegroundColor){p+="color: "+c.highlightForegroundColor+";"}if(p){p='style="'+p+'"'}this._processedText=this._processedText.replace(/===/g,"<mark "+p+">").replace(/\/==\//g,"</mark>")}}else{this._processedText=o;this._treatAsPlainText=true}}else{this._processedText=o;this._treatAsPlainText=true}}if(!this._processedText){this._processedText=""}if(this._treatAsPlainText){n.innerText=this._processedText}else{n.innerHTML=this._processedText}if(n.firstElementChild instanceof HTMLElement){var d=n.firstElementChild;d.style.marginTop="0px";d.style.width="100%";if(!this.wrap){d.style.overflow="hidden";d.style.textOverflow="ellipsis"}}if(n.lastElementChild instanceof HTMLElement){n.lastElementChild.style.marginBottom="0px"}var f=n.getElementsByTagName("a");for(var h=0;h<f.length;h++){var y=f[h];y.classList.add(i.makeCssClassName("ac-anchor"));y.target="_blank";y.onclick=function(t){if(ie(e,t.target,t)){t.preventDefault();t.cancelBubble=true}};y.oncontextmenu=function(t){if(ie(e,t.target,t)){t.preventDefault();t.cancelBubble=true;return false}return true}}if(this.wrap){n.style.wordWrap="break-word";if(this.maxLines&&this.maxLines>0){n.style.overflow="hidden";if(s.isInternetExplorer()||!a.GlobalSettings.useWebkitLineClamp){n.style.maxHeight=this._computedLineHeight*this.maxLines+"px"}else{n.style.removeProperty("line-height");n.style.display="-webkit-box";n.style.webkitBoxOrient="vertical";n.style.webkitLineClamp=this.maxLines.toString()}}}else{n.style.whiteSpace="nowrap";n.style.textOverflow="ellipsis"}if(a.GlobalSettings.useAdvancedTextBlockTruncation||a.GlobalSettings.useAdvancedCardBottomTruncation){this._originalInnerHtml=n.innerHTML}return n}else{return undefined}};t.prototype.truncateOverflow=function(e){if(e>=this._computedLineHeight){return this.truncateIfSupported(e)}return false};t.prototype.undoOverflowTruncation=function(){this.restoreOriginalContent();if(a.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines){var e=this._computedLineHeight*this.maxLines;this.truncateIfSupported(e)}};t.prototype.applyStylesTo=function(t){e.prototype.applyStylesTo.call(this,t);var i=this.getParentContainer();var n=i?i.isRtl():false;switch(this.horizontalAlignment){case o.HorizontalAlignment.Center:t.style.textAlign="center";break;case o.HorizontalAlignment.Right:t.style.textAlign=n?"left":"right";break;default:t.style.textAlign=n?"right":"left";break}var r=this.hostConfig.lineHeights;if(r){switch(this.size){case o.TextSize.Small:this._computedLineHeight=r.small;break;case o.TextSize.Medium:this._computedLineHeight=r.medium;break;case o.TextSize.Large:this._computedLineHeight=r.large;break;case o.TextSize.ExtraLarge:this._computedLineHeight=r.extraLarge;break;default:this._computedLineHeight=r.default;break}}else{this._computedLineHeight=this.getFontSize(this.hostConfig.getFontTypeDefinition(this.fontType))*1.33}t.style.lineHeight=this._computedLineHeight+"px"};t.prototype.getJsonTypeName=function(){return"TextBlock"};t.prototype.updateLayout=function(t){if(t===void 0){t=false}e.prototype.updateLayout.call(this,t);if(a.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines&&this.isDisplayed()){this.restoreOriginalContent();this.truncateIfSupported(this._computedLineHeight*this.maxLines)}};t.wrapProperty=new c.BoolProperty(c.Versions.v1_0,"wrap",false);t.maxLinesProperty=new c.NumProperty(c.Versions.v1_0,"maxLines");r([c.property(t.wrapProperty)],t.prototype,"wrap",void 0);r([c.property(t.maxLinesProperty)],t.prototype,"maxLines",void 0);return t}(g);t.TextBlock=m;var v=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.italic=false;t.strikethrough=false;t.highlight=false;t.underline=false;return t}t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t);t.add(g.selectActionProperty)};t.prototype.internalRender=function(){var e=this;if(this.text){var t=this.preProcessPropertyValue(g.textProperty);var i=this.hostConfig;var n=u.formatText(this.lang,t);if(!n){n=""}var r=document.createElement("span");r.classList.add(i.makeCssClassName("ac-textRun"));this.applyStylesTo(r);if(this.selectAction&&i.supportsInteractivity){var o=document.createElement("a");o.classList.add(i.makeCssClassName("ac-anchor"));var a=this.selectAction.getHref();o.href=a?a:"";o.target="_blank";o.onclick=function(t){t.preventDefault();t.cancelBubble=true;if(e.selectAction){e.selectAction.execute()}};if(this.selectAction.title){o.setAttribute("aria-label",this.selectAction.title);o.title=this.selectAction.title}o.innerText=n;r.appendChild(o)}else{r.innerText=n}return r}else{return undefined}};t.prototype.applyStylesTo=function(t){e.prototype.applyStylesTo.call(this,t);if(this.italic){t.style.fontStyle="italic"}if(this.strikethrough){t.style.textDecoration="line-through"}if(this.highlight){var i=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);t.style.backgroundColor=s.stringToCssColor(this.isSubtle?i.highlightColors.subtle:i.highlightColors.default)}if(this.underline){t.style.textDecoration="underline"}};t.prototype.getJsonTypeName=function(){return"TextRun"};Object.defineProperty(t.prototype,"isStandalone",{get:function(){return false},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isInline",{get:function(){return true},enumerable:false,configurable:true});t.italicProperty=new c.BoolProperty(c.Versions.v1_2,"italic",false);t.strikethroughProperty=new c.BoolProperty(c.Versions.v1_2,"strikethrough",false);t.highlightProperty=new c.BoolProperty(c.Versions.v1_2,"highlight",false);t.underlineProperty=new c.BoolProperty(c.Versions.v1_3,"underline",false);r([c.property(t.italicProperty)],t.prototype,"italic",void 0);r([c.property(t.strikethroughProperty)],t.prototype,"strikethrough",void 0);r([c.property(t.highlightProperty)],t.prototype,"highlight",void 0);r([c.property(t.underlineProperty)],t.prototype,"underline",void 0);return t}(g);t.TextRun=v;var b=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._inlines=[];return t}t.prototype.internalAddInline=function(e,t){if(t===void 0){t=false}if(!e.isInline){throw new Error(f.Strings.errors.elementCannotBeUsedAsInline())}var i=e.parent===undefined||t;if(!i&&e.parent!=this){throw new Error(f.Strings.errors.inlineAlreadyParented())}else{e.setParent(this);this._inlines.push(e)}};t.prototype.internalParse=function(t,i){e.prototype.internalParse.call(this,t,i);this._inlines=[];if(Array.isArray(t["inlines"])){for(var n=0,r=t["inlines"];n<r.length;n++){var o=r[n];var a=void 0;if(typeof o==="string"){var s=new v;s.text=o;a=s}else{a=i.parseElement(this,o,false)}if(a){this.internalAddInline(a,true)}}}};t.prototype.internalToJSON=function(t,i){e.prototype.internalToJSON.call(this,t,i);if(this._inlines.length>0){var n=[];for(var r=0,o=this._inlines;r<o.length;r++){var a=o[r];n.push(a.toJSON(i))}i.serializeValue(t,"inlines",n)}};t.prototype.internalRender=function(){if(this._inlines.length>0){var e=void 0;if(this.forElementId){var t=document.createElement("label");t.htmlFor=this.forElementId;e=t}else{e=document.createElement("div")}e.className=this.hostConfig.makeCssClassName("ac-richTextBlock");var i=this.getParentContainer();var n=i?i.isRtl():false;switch(this.horizontalAlignment){case o.HorizontalAlignment.Center:e.style.textAlign="center";break;case o.HorizontalAlignment.Right:e.style.textAlign=n?"left":"right";break;default:e.style.textAlign=n?"right":"left";break}var r=0;for(var a=0,s=this._inlines;a<s.length;a++){var l=s[a];var u=l.render();if(u){e.appendChild(u);r++}}if(r>0){return e}}return undefined};t.prototype.asString=function(){var e="";for(var t=0,i=this._inlines;t<i.length;t++){var n=i[t];e+=n.asString()}return e};t.prototype.getJsonTypeName=function(){return"RichTextBlock"};t.prototype.getInlineCount=function(){return this._inlines.length};t.prototype.getInlineAt=function(e){if(e>=0&&e<this._inlines.length){return this._inlines[e]}else{throw new Error(f.Strings.errors.indexOutOfRange(e))}};t.prototype.addInline=function(e){if(typeof e==="string"){this.internalAddInline(new v(e))}else{this.internalAddInline(e)}};t.prototype.removeInline=function(e){var t=this._inlines.indexOf(e);if(t>=0){this._inlines[t].setParent(undefined);this._inlines.splice(t,1);return true}return false};return t}(h);t.RichTextBlock=b;var C=function(e){n(t,e);function t(t,i){var n=e.call(this)||this;n.name=t;n.value=i;return n}t.prototype.getSchemaKey=function(){return"Fact"};t.titleProperty=new c.StringProperty(c.Versions.v1_0,"title");t.valueProperty=new c.StringProperty(c.Versions.v1_0,"value");r([c.property(t.titleProperty)],t.prototype,"name",void 0);r([c.property(t.valueProperty)],t.prototype,"value",void 0);return t}(c.SerializableObject);t.Fact=C;var S=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return false},enumerable:false,configurable:true});t.prototype.internalRender=function(){var e=undefined;var t=this.hostConfig;if(this.facts.length>0){e=document.createElement("table");e.style.borderWidth="0px";e.style.borderSpacing="0px";e.style.borderStyle="none";e.style.borderCollapse="collapse";e.style.display="block";e.style.overflow="hidden";e.classList.add(t.makeCssClassName("ac-factset"));e.setAttribute("role","presentation");for(var i=0;i<this.facts.length;i++){var n=document.createElement("tr");if(i>0){n.style.marginTop=t.factSet.spacing+"px"}var r=document.createElement("td");r.style.padding="0";r.classList.add(t.makeCssClassName("ac-fact-title"));if(t.factSet.title.maxWidth){r.style.maxWidth=t.factSet.title.maxWidth+"px"}r.style.verticalAlign="top";var a=new m;a.setParent(this);a.text=!this.facts[i].name&&this.isDesignMode()?"Title":this.facts[i].name;a.size=t.factSet.title.size;a.color=t.factSet.title.color;a.isSubtle=t.factSet.title.isSubtle;a.weight=t.factSet.title.weight;a.wrap=t.factSet.title.wrap;a.spacing=o.Spacing.None;s.appendChild(r,a.render());s.appendChild(n,r);r=document.createElement("td");r.style.width="10px";s.appendChild(n,r);r=document.createElement("td");r.style.padding="0";r.style.verticalAlign="top";r.classList.add(t.makeCssClassName("ac-fact-value"));a=new m;a.setParent(this);a.text=this.facts[i].value;a.size=t.factSet.value.size;a.color=t.factSet.value.color;a.isSubtle=t.factSet.value.isSubtle;a.weight=t.factSet.value.weight;a.wrap=t.factSet.value.wrap;a.spacing=o.Spacing.None;s.appendChild(r,a.render());s.appendChild(n,r);s.appendChild(e,n)}}return e};t.prototype.getJsonTypeName=function(){return"FactSet"};t.factsProperty=new c.SerializableObjectCollectionProperty(c.Versions.v1_0,"facts",C);r([c.property(t.factsProperty)],t.prototype,"facts",void 0);return t}(h);t.FactSet=S;var P=function(e){n(t,e);function t(t,i,n,r){var o=e.call(this,t,i)||this;o.targetVersion=t;o.name=i;o.internalName=n;o.fallbackProperty=r;return o}t.prototype.getInternalName=function(){return this.internalName};t.prototype.parse=function(e,t,i){var n=undefined;var r=t[this.name];if(r===undefined){return this.defaultValue}var s=false;if(typeof r==="string"){try{var l=a.SizeAndUnit.parse(r,true);if(l.unit==o.SizeUnit.Pixel){n=l.physicalSize;s=true}}catch(e){}if(!s&&this.fallbackProperty){s=this.fallbackProperty.isValidValue(r,i)}}if(!s){i.logParseEvent(e,o.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidPropertyValue(r,this.name))}return n};t.prototype.toJSON=function(e,t,i,n){n.serializeValue(t,this.name,typeof i==="number"&&!isNaN(i)?i+"px":undefined)};return t}(c.PropertyDefinition);var _=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.size=o.Size.Auto;t.style=o.ImageStyle.Default;return t}t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t);t.remove(h.heightProperty)};t.prototype.applySize=function(e){if(this.pixelWidth||this.pixelHeight){if(this.pixelWidth){e.style.width=this.pixelWidth+"px"}if(this.pixelHeight){e.style.height=this.pixelHeight+"px"}}else{if(this.maxHeight){switch(this.size){case o.Size.Small:e.style.height=this.hostConfig.imageSizes.small+"px";break;case o.Size.Large:e.style.height=this.hostConfig.imageSizes.large+"px";break;default:e.style.height=this.hostConfig.imageSizes.medium+"px";break}e.style.maxHeight=this.maxHeight+"px"}else{switch(this.size){case o.Size.Stretch:e.style.width="100%";break;case o.Size.Auto:e.style.maxWidth="100%";break;case o.Size.Small:e.style.width=this.hostConfig.imageSizes.small+"px";break;case o.Size.Large:e.style.width=this.hostConfig.imageSizes.large+"px";break;case o.Size.Medium:e.style.width=this.hostConfig.imageSizes.medium+"px";break}e.style.maxHeight="100%"}}};Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return false},enumerable:false,configurable:true});t.prototype.internalRender=function(){var e=this;var i=undefined;if(this.url){i=document.createElement("div");i.style.display="flex";i.style.alignItems="flex-start";i.onkeypress=function(t){if(e.selectAction&&(t.keyCode==13||t.keyCode==32)){t.preventDefault();t.cancelBubble=true;e.selectAction.execute()}};i.onclick=function(t){if(e.selectAction){t.preventDefault();t.cancelBubble=true;e.selectAction.execute()}};switch(this.horizontalAlignment){case o.HorizontalAlignment.Center:i.style.justifyContent="center";break;case o.HorizontalAlignment.Right:i.style.justifyContent="flex-end";break;default:i.style.justifyContent="flex-start";break}var n=this.hostConfig;var r=document.createElement("img");r.onload=function(t){te(e)};r.onerror=function(t){if(e.renderedElement){var i=e.getRootElement();e.renderedElement.innerHTML="";if(i&&i.designMode){var n=document.createElement("div");n.style.display="flex";n.style.alignItems="center";n.style.justifyContent="center";n.style.backgroundColor="#EEEEEE";n.style.color="black";n.innerText=":-(";n.style.padding="10px";e.applySize(n);e.renderedElement.appendChild(n)}}te(e)};r.style.minWidth="0";r.classList.add(n.makeCssClassName("ac-image"));if(this.selectAction!==undefined&&n.supportsInteractivity){r.tabIndex=0;r.setAttribute("role",this.selectAction.getAriaRole());if(this.selectAction.title){r.setAttribute("aria-label",this.selectAction.title);r.title=this.selectAction.title}r.classList.add(n.makeCssClassName("ac-selectable"))}this.applySize(r);if(this.style===o.ImageStyle.Person){r.style.borderRadius="50%";r.style.backgroundPosition="50% 50%";r.style.backgroundRepeat="no-repeat"}r.style.backgroundColor=s.stringToCssColor(this.backgroundColor);r.src=this.preProcessPropertyValue(t.urlProperty);var a=this.preProcessPropertyValue(t.altTextProperty);if(a){r.alt=a}i.appendChild(r)}return i};t.prototype.getJsonTypeName=function(){return"Image"};t.prototype.getActionById=function(t){var i=e.prototype.getActionById.call(this,t);if(!i&&this.selectAction){i=this.selectAction.getActionById(t)}return i};t.prototype.getResourceInformation=function(){return this.url?[{url:this.url,mimeType:"image"}]:[]};t.urlProperty=new c.StringProperty(c.Versions.v1_0,"url");t.altTextProperty=new c.StringProperty(c.Versions.v1_0,"altText");t.backgroundColorProperty=new c.StringProperty(c.Versions.v1_1,"backgroundColor");t.styleProperty=new c.EnumProperty(c.Versions.v1_0,"style",o.ImageStyle,o.ImageStyle.Default);t.sizeProperty=new c.EnumProperty(c.Versions.v1_0,"size",o.Size,o.Size.Auto);t.pixelWidthProperty=new P(c.Versions.v1_1,"width","pixelWidth");t.pixelHeightProperty=new P(c.Versions.v1_1,"height","pixelHeight",h.heightProperty);t.selectActionProperty=new y(c.Versions.v1_1,"selectAction",["Action.ShowCard"]);r([c.property(t.urlProperty)],t.prototype,"url",void 0);r([c.property(t.altTextProperty)],t.prototype,"altText",void 0);r([c.property(t.backgroundColorProperty)],t.prototype,"backgroundColor",void 0);r([c.property(t.sizeProperty)],t.prototype,"size",void 0);r([c.property(t.styleProperty)],t.prototype,"style",void 0);r([c.property(t.pixelWidthProperty)],t.prototype,"pixelWidth",void 0);r([c.property(t.pixelHeightProperty)],t.prototype,"pixelHeight",void 0);r([c.property(t.selectActionProperty)],t.prototype,"selectAction",void 0);return t}(h);t.Image=_;var A=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.allowVerticalOverflow=false;return t}t.prototype.populateSchema=function(i){e.prototype.populateSchema.call(this,i);if(!this.isSelectable){i.remove(t.selectActionProperty)}};t.prototype.isElementAllowed=function(e){return this.hostConfig.supportsInteractivity||!e.isInteractive};t.prototype.applyPadding=function(){e.prototype.applyPadding.call(this);if(!this.renderedElement){return}var t=new a.SpacingDefinition;if(this.getEffectivePadding()){t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())}this.renderedElement.style.paddingTop=t.top+"px";this.renderedElement.style.paddingRight=t.right+"px";this.renderedElement.style.paddingBottom=t.bottom+"px";this.renderedElement.style.paddingLeft=t.left+"px";this.renderedElement.style.marginRight="0";this.renderedElement.style.marginLeft="0"};Object.defineProperty(t.prototype,"isSelectable",{get:function(){return false},enumerable:false,configurable:true});t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var i=0;i<this.getItemCount();i++){var n=this.getItemAt(i);if(!this.hostConfig.supportsInteractivity&&n.isInteractive){t.addFailure(this,o.ValidationEvent.InteractivityNotAllowed,f.Strings.errors.interactivityNotAllowed())}if(!this.isElementAllowed(n)){t.addFailure(this,o.ValidationEvent.InteractivityNotAllowed,f.Strings.errors.elementTypeNotAllowed(n.getJsonTypeName()))}n.internalValidateProperties(t)}if(this._selectAction){this._selectAction.internalValidateProperties(t)}};t.prototype.render=function(){var t=this;var i=e.prototype.render.call(this);if(i){var n=this.hostConfig;if(this.allowVerticalOverflow){i.style.overflowX="hidden";i.style.overflowY="auto"}if(i&&this.isSelectable&&this._selectAction&&n.supportsInteractivity){i.classList.add(n.makeCssClassName("ac-selectable"));i.tabIndex=0;i.setAttribute("role",this._selectAction.getAriaRole());if(this._selectAction.title){i.setAttribute("aria-label",this._selectAction.title);i.title=this._selectAction.title}i.onclick=function(e){if(t._selectAction!==undefined){e.preventDefault();e.cancelBubble=true;t._selectAction.execute()}};i.onkeypress=function(e){if(t._selectAction!==undefined&&(e.keyCode==13||e.keyCode==32)){e.preventDefault();e.cancelBubble=true;t._selectAction.execute()}}}}return i};t.prototype.updateLayout=function(t){if(t===void 0){t=true}e.prototype.updateLayout.call(this,t);if(t){for(var i=0;i<this.getItemCount();i++){this.getItemAt(i).updateLayout()}}};t.prototype.getAllInputs=function(e){if(e===void 0){e=true}var t=[];for(var i=0;i<this.getItemCount();i++){t=t.concat(this.getItemAt(i).getAllInputs(e))}return t};t.prototype.getResourceInformation=function(){var e=[];for(var t=0;t<this.getItemCount();t++){e=e.concat(this.getItemAt(t).getResourceInformation())}return e};t.prototype.getElementById=function(t){var i=e.prototype.getElementById.call(this,t);if(!i){for(var n=0;n<this.getItemCount();n++){i=this.getItemAt(n).getElementById(t);if(i){break}}}return i};t.prototype.findDOMNodeOwner=function(t){var i=undefined;for(var n=0;n<this.getItemCount();n++){i=this.getItemAt(n).findDOMNodeOwner(t);if(i){return i}}return e.prototype.findDOMNodeOwner.call(this,t)};t.selectActionProperty=new y(c.Versions.v1_1,"selectAction",["Action.ShowCard"]);r([c.property(t.selectActionProperty)],t.prototype,"_selectAction",void 0);return t}(h);t.CardElementContainer=A;var E=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._images=[];t.imageSize=o.ImageSize.Medium;return t}t.prototype.internalRender=function(){var e=undefined;if(this._images.length>0){e=document.createElement("div");e.style.display="flex";e.style.flexWrap="wrap";for(var t=0,i=this._images;t<i.length;t++){var n=i[t];switch(this.imageSize){case o.ImageSize.Small:n.size=o.Size.Small;break;case o.ImageSize.Large:n.size=o.Size.Large;break;default:n.size=o.Size.Medium;break}n.maxHeight=this.hostConfig.imageSet.maxImageHeight;var r=n.render();if(r){r.style.display="inline-flex";r.style.margin="0px";r.style.marginRight="10px";s.appendChild(e,r)}}}return e};t.prototype.getItemCount=function(){return this._images.length};t.prototype.getItemAt=function(e){return this._images[e]};t.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:undefined};t.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:undefined};t.prototype.removeItem=function(e){if(e instanceof _){var t=this._images.indexOf(e);if(t>=0){this._images.splice(t,1);e.setParent(undefined);this.updateLayout();return true}}return false};t.prototype.getJsonTypeName=function(){return"ImageSet"};t.prototype.addImage=function(e){if(!e.parent){this._images.push(e);e.setParent(this)}else{throw new Error("This image already belongs to another ImageSet")}};t.prototype.indexOf=function(e){return e instanceof _?this._images.indexOf(e):-1};t.imagesProperty=new c.SerializableObjectCollectionProperty(c.Versions.v1_0,"images",_,function(e,t){t.setParent(e)});t.imageSizeProperty=new c.EnumProperty(c.Versions.v1_0,"imageSize",o.ImageSize,o.ImageSize.Medium);r([c.property(t.imagesProperty)],t.prototype,"_images",void 0);r([c.property(t.imageSizeProperty)],t.prototype,"imageSize",void 0);return t}(A);t.ImageSet=E;var w=function(e){n(t,e);function t(t,i){var n=e.call(this)||this;n.url=t;n.mimeType=i;return n}t.prototype.getSchemaKey=function(){return"MediaSource"};t.prototype.isValid=function(){return this.mimeType&&this.url?true:false};t.prototype.render=function(){var e=undefined;if(this.isValid()){e=document.createElement("source");e.src=this.url;e.type=this.mimeType}return e};t.mimeTypeProperty=new c.StringProperty(c.Versions.v1_1,"mimeType");t.urlProperty=new c.StringProperty(c.Versions.v1_1,"url");r([c.property(t.mimeTypeProperty)],t.prototype,"mimeType",void 0);r([c.property(t.urlProperty)],t.prototype,"url",void 0);return t}(c.SerializableObject);t.MediaSource=w;var x=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.sources=[];return t}t.prototype.getPosterUrl=function(){return this.poster?this.poster:this.hostConfig.media.defaultPoster};t.prototype.processSources=function(){this._selectedSources=[];this._selectedMediaType=undefined;for(var e=0,i=this.sources;e<i.length;e++){var n=i[e];var r=n.mimeType?n.mimeType.split("/"):[];if(r.length==2){if(!this._selectedMediaType){var o=t.supportedMediaTypes.indexOf(r[0]);if(o>=0){this._selectedMediaType=t.supportedMediaTypes[o]}}if(r[0]==this._selectedMediaType){this._selectedSources.push(n)}}}};t.prototype.handlePlayButtonInvoke=function(e){if(this.hostConfig.media.allowInlinePlayback){e.preventDefault();e.cancelBubble=true;if(this.renderedElement){var i=this.renderMediaPlayer();this.renderedElement.innerHTML="";this.renderedElement.appendChild(i);i.play();i.focus()}}else{if(t.onPlay){e.preventDefault();e.cancelBubble=true;t.onPlay(this)}}};t.prototype.renderPoster=function(){var e=this;var t=12;var i=15;var n=document.createElement("div");n.className=this.hostConfig.makeCssClassName("ac-media-poster");n.setAttribute("role","contentinfo");n.setAttribute("aria-label",this.altText?this.altText:f.Strings.defaults.mediaPlayerAriaLabel());n.style.position="relative";n.style.display="flex";var r=this.getPosterUrl();if(r){var o=document.createElement("img");o.style.width="100%";o.style.height="100%";o.setAttribute("role","presentation");o.onerror=function(e){if(o.parentNode){o.parentNode.removeChild(o)}n.classList.add("empty");n.style.minHeight="150px"};o.src=r;n.appendChild(o)}else{n.classList.add("empty");n.style.minHeight="150px"}if(this.hostConfig.supportsInteractivity&&this._selectedSources.length>0){var a=document.createElement("div");a.tabIndex=0;a.setAttribute("role","button");a.setAttribute("aria-label",f.Strings.defaults.mediaPlayerPlayMedia());a.className=this.hostConfig.makeCssClassName("ac-media-playButton");a.style.display="flex";a.style.alignItems="center";a.style.justifyContent="center";a.onclick=function(t){e.handlePlayButtonInvoke(t)};a.onkeypress=function(t){if(t.keyCode==13||t.keyCode==32){e.handlePlayButtonInvoke(t)}};var s=document.createElement("div");s.className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow");s.style.width=t+"px";s.style.height=i+"px";s.style.borderTopWidth=i/2+"px";s.style.borderBottomWidth=i/2+"px";s.style.borderLeftWidth=t+"px";s.style.borderRightWidth="0";s.style.borderStyle="solid";s.style.borderTopColor="transparent";s.style.borderRightColor="transparent";s.style.borderBottomColor="transparent";s.style.transform="translate("+t/10+"px,0px)";a.appendChild(s);var l=document.createElement("div");l.style.position="absolute";l.style.left="0";l.style.top="0";l.style.width="100%";l.style.height="100%";l.style.display="flex";l.style.justifyContent="center";l.style.alignItems="center";l.appendChild(a);n.appendChild(l)}return n};t.prototype.renderMediaPlayer=function(){var e;if(this._selectedMediaType=="video"){var t=document.createElement("video");var i=this.getPosterUrl();if(i){t.poster=i}e=t}else{e=document.createElement("audio")}e.setAttribute("aria-label",this.altText?this.altText:f.Strings.defaults.mediaPlayerAriaLabel());e.setAttribute("webkit-playsinline","");e.setAttribute("playsinline","");e.autoplay=true;e.controls=true;if(s.isMobileOS()){e.muted=true}e.preload="none";e.style.width="100%";for(var n=0,r=this.sources;n<r.length;n++){var o=r[n];var a=o.render();s.appendChild(e,a)}return e};t.prototype.internalRender=function(){var e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-media");this.processSources();e.appendChild(this.renderPoster());return e};t.prototype.getJsonTypeName=function(){return"Media"};t.prototype.getResourceInformation=function(){var e=[];var t=this.getPosterUrl();if(t){e.push({url:t,mimeType:"image"})}for(var i=0,n=this.sources;i<n.length;i++){var r=n[i];if(r.isValid()){e.push({url:r.url,mimeType:r.mimeType})}}return e};Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:false,configurable:true});t.sourcesProperty=new c.SerializableObjectCollectionProperty(c.Versions.v1_1,"sources",w);t.posterProperty=new c.StringProperty(c.Versions.v1_1,"poster");t.altTextProperty=new c.StringProperty(c.Versions.v1_1,"altText");t.supportedMediaTypes=["audio","video"];r([c.property(t.sourcesProperty)],t.prototype,"sources",void 0);r([c.property(t.posterProperty)],t.prototype,"poster",void 0);r([c.property(t.altTextProperty)],t.prototype,"altText",void 0);return t}(h);t.Media=x;var I=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getAllLabelIds=function(){var e=[];if(this._renderedLabelElement){e.push(this._renderedLabelElement.id)}if(this._renderedErrorMessageElement){e.push(this._renderedErrorMessageElement.id)}return e};t.prototype.updateInputControlAriaLabelledBy=function(){if(this._renderedInputControlElement){var e=this.getAllLabelIds();if(this.labelledBy){e.push(this.labelledBy)}if(this._renderedLabelElement){e.push(this._renderedLabelElement.id)}if(this._renderedErrorMessageElement){e.push(this._renderedErrorMessageElement.id)}if(e.length>0){this._renderedInputControlElement.setAttribute("aria-labelledby",e.join(" "))}else{this._renderedInputControlElement.removeAttribute("aria-labelledby")}}};Object.defineProperty(t.prototype,"isNullable",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:false,configurable:true});t.prototype.overrideInternalRender=function(){var e=this.hostConfig;this._outerContainerElement=document.createElement("div");this._outerContainerElement.style.display="flex";this._outerContainerElement.style.flexDirection="column";var t=s.generateUniqueId();if(this.label){var i=new b;i.setParent(this);i.forElementId=t;var n=new v(this.label);i.addInline(n);if(this.isRequired){n.init(e.inputs.label.requiredInputs);var r=new v(e.inputs.label.requiredInputs.suffix);r.color=e.inputs.label.requiredInputs.suffixColor;r.ariaHidden=true;i.addInline(r)}else{n.init(e.inputs.label.optionalInputs)}this._renderedLabelElement=i.render();if(this._renderedLabelElement){this._renderedLabelElement.id=s.generateUniqueId();this._renderedLabelElement.style.marginBottom=e.getEffectiveSpacing(e.inputs.label.inputSpacing)+"px";this._outerContainerElement.appendChild(this._renderedLabelElement)}}this._inputControlContainerElement=document.createElement("div");this._inputControlContainerElement.className=e.makeCssClassName("ac-input-container");this._inputControlContainerElement.style.display="flex";if(this.height==="stretch"){this._inputControlContainerElement.style.alignItems="stretch";this._inputControlContainerElement.style.flex="1 1 auto"}this._renderedInputControlElement=this.internalRender();if(this._renderedInputControlElement){this._renderedInputControlElement.id=t;this._renderedInputControlElement.style.minWidth="0px";if(this.isNullable&&this.isRequired){this._renderedInputControlElement.setAttribute("aria-required","true");this._renderedInputControlElement.classList.add(e.makeCssClassName("ac-input-required"))}this._inputControlContainerElement.appendChild(this._renderedInputControlElement);this._outerContainerElement.appendChild(this._inputControlContainerElement);this.updateInputControlAriaLabelledBy();return this._outerContainerElement}return undefined};t.prototype.valueChanged=function(){if(this.isValid()){this.resetValidationFailureCue()}if(this.onValueChanged){this.onValueChanged(this)}oe(this)};t.prototype.resetValidationFailureCue=function(){if(this.renderedInputControlElement){this.renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed"));this.updateInputControlAriaLabelledBy();if(this._renderedErrorMessageElement){this._outerContainerElement.removeChild(this._renderedErrorMessageElement);this._renderedErrorMessageElement=undefined}}};t.prototype.showValidationErrorMessage=function(){if(this.renderedElement&&this.errorMessage&&a.GlobalSettings.displayInputValidationErrors){var e=new m;e.setParent(this);e.text=this.errorMessage;e.wrap=true;e.init(this.hostConfig.inputs.errorMessage);this._renderedErrorMessageElement=e.render();if(this._renderedErrorMessageElement){this._renderedErrorMessageElement.id=s.generateUniqueId();this._outerContainerElement.appendChild(this._renderedErrorMessageElement);this.updateInputControlAriaLabelledBy()}}};t.prototype.focus=function(){if(this._renderedInputControlElement){this._renderedInputControlElement.focus()}};t.prototype.isValid=function(){return true};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(!this.id){t.addFailure(this,o.ValidationEvent.PropertyCantBeNull,f.Strings.errors.inputsMustHaveUniqueId())}if(this.isRequired){if(!this.label){t.addFailure(this,o.ValidationEvent.RequiredInputsShouldHaveLabel,"Required inputs should have a label")}if(!this.errorMessage){t.addFailure(this,o.ValidationEvent.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message")}}};t.prototype.validateValue=function(){this.resetValidationFailureCue();var e=this.isRequired?this.isSet()&&this.isValid():this.isValid();if(!e&&this.renderedInputControlElement){this.renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed"));this.showValidationErrorMessage()}return e};t.prototype.getAllInputs=function(e){if(e===void 0){e=true}return[this]};Object.defineProperty(t.prototype,"isInteractive",{get:function(){return true},enumerable:false,configurable:true});t.labelProperty=new c.StringProperty(c.Versions.v1_3,"label",true);t.isRequiredProperty=new c.BoolProperty(c.Versions.v1_3,"isRequired",false);t.errorMessageProperty=new c.StringProperty(c.Versions.v1_3,"errorMessage",true);r([c.property(t.labelProperty)],t.prototype,"label",void 0);r([c.property(t.isRequiredProperty)],t.prototype,"isRequired",void 0);r([c.property(t.errorMessageProperty)],t.prototype,"errorMessage",void 0);return t}(h);t.Input=I;var T=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.isMultiline=false;t.style=o.InputTextStyle.Text;return t}t.prototype.setupInput=function(e){var t=this;e.style.flex="1 1 auto";e.tabIndex=0;if(this.placeholder){e.placeholder=this.placeholder;e.setAttribute("aria-label",this.placeholder)}if(this.defaultValue){e.value=this.defaultValue}if(this.maxLength&&this.maxLength>0){e.maxLength=this.maxLength}e.oninput=function(){t.valueChanged()};e.onkeypress=function(e){if(e.ctrlKey&&e.code==="Enter"&&t.inlineAction){t.inlineAction.execute()}}};t.prototype.internalRender=function(){var e;if(this.isMultiline){e=document.createElement("textarea");e.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline");if(this.height==="stretch"){e.style.height="initial"}}else{e=document.createElement("input");e.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput");e.type=o.InputTextStyle[this.style].toLowerCase()}this.setupInput(e);return e};t.prototype.overrideInternalRender=function(){var t=this;var i=e.prototype.overrideInternalRender.call(this);if(this.inlineAction){var n=document.createElement("button");n.className=this.hostConfig.makeCssClassName("ac-inlineActionButton");n.onclick=function(e){e.preventDefault();e.cancelBubble=true;if(t.inlineAction){t.inlineAction.execute()}};if(this.inlineAction.iconUrl){n.classList.add("iconOnly");var r=document.createElement("img");r.style.height="100%";r.setAttribute("role","presentation");r.style.display="none";r.onload=function(){r.style.removeProperty("display")};r.onerror=function(){n.removeChild(r);n.classList.remove("iconOnly");n.classList.add("textOnly");n.textContent=t.inlineAction&&t.inlineAction.title?t.inlineAction.title:f.Strings.defaults.inlineActionTitle()};r.src=this.inlineAction.iconUrl;n.appendChild(r);n.title=this.inlineAction.title?this.inlineAction.title:f.Strings.defaults.inlineActionTitle()}else{n.classList.add("textOnly");n.textContent=this.inlineAction.title?this.inlineAction.title:f.Strings.defaults.inlineActionTitle()}n.style.marginLeft="8px";this.inputControlContainerElement.appendChild(n)}return i};t.prototype.getJsonTypeName=function(){return"Input.Text"};t.prototype.getActionById=function(t){var i=e.prototype.getActionById.call(this,t);if(!i&&this.inlineAction){i=this.inlineAction.getActionById(t)}return i};t.prototype.isSet=function(){return this.value?true:false};t.prototype.isValid=function(){if(!this.value){return true}if(this.regex){return new RegExp(this.regex,"g").test(this.value)}return true};Object.defineProperty(t.prototype,"value",{get:function(){if(this.renderedInputControlElement){if(this.isMultiline){return this.renderedInputControlElement.value}else{return this.renderedInputControlElement.value}}else{return undefined}},enumerable:false,configurable:true});t.valueProperty=new c.StringProperty(c.Versions.v1_0,"value");t.maxLengthProperty=new c.NumProperty(c.Versions.v1_0,"maxLength");t.isMultilineProperty=new c.BoolProperty(c.Versions.v1_0,"isMultiline",false);t.placeholderProperty=new c.StringProperty(c.Versions.v1_0,"placeholder");t.styleProperty=new c.EnumProperty(c.Versions.v1_0,"style",o.InputTextStyle,o.InputTextStyle.Text);t.inlineActionProperty=new y(c.Versions.v1_0,"inlineAction",["Action.ShowCard"]);t.regexProperty=new c.StringProperty(c.Versions.v1_3,"regex",true);r([c.property(t.valueProperty)],t.prototype,"defaultValue",void 0);r([c.property(t.maxLengthProperty)],t.prototype,"maxLength",void 0);r([c.property(t.isMultilineProperty)],t.prototype,"isMultiline",void 0);r([c.property(t.placeholderProperty)],t.prototype,"placeholder",void 0);r([c.property(t.styleProperty)],t.prototype,"style",void 0);r([c.property(t.inlineActionProperty)],t.prototype,"inlineAction",void 0);r([c.property(t.regexProperty)],t.prototype,"regex",void 0);return t}(I);t.TextInput=T;var V=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.valueOn="true";t.valueOff="false";t.wrap=false;return t}t.prototype.updateInputControlAriaLabelledBy=function(){if(this._checkboxInputElement){var e=this.getAllLabelIds().join(" ");if(this._checkboxInputLabelElement&&this._checkboxInputLabelElement.id){e+=" "+this._checkboxInputLabelElement.id}if(e){this._checkboxInputElement.setAttribute("aria-labelledby",e)}else{this._checkboxInputElement.removeAttribute("aria-labelledby")}}};t.prototype.internalRender=function(){var e=this;var t=document.createElement("div");t.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput");t.style.width="100%";t.style.display="flex";t.style.alignItems="center";this._checkboxInputElement=document.createElement("input");this._checkboxInputElement.id=s.generateUniqueId();this._checkboxInputElement.type="checkbox";this._checkboxInputElement.style.display="inline-block";this._checkboxInputElement.style.verticalAlign="middle";this._checkboxInputElement.style.margin="0";this._checkboxInputElement.style.flex="0 0 auto";if(this.title){this._checkboxInputElement.setAttribute("aria-label",this.title)}if(this.isRequired){this._checkboxInputElement.setAttribute("aria-required","true")}this._checkboxInputElement.tabIndex=0;if(this.defaultValue==this.valueOn){this._checkboxInputElement.checked=true}this._checkboxInputElement.onchange=function(){e.valueChanged()};s.appendChild(t,this._checkboxInputElement);if(this.title||this.isDesignMode()){var i=new m;i.setParent(this);i.forElementId=this._checkboxInputElement.id;i.hostConfig=this.hostConfig;i.text=!this.title?this.getJsonTypeName():this.title;i.useMarkdown=a.GlobalSettings.useMarkdownInRadioButtonAndCheckbox;i.wrap=this.wrap;this._checkboxInputLabelElement=i.render();if(this._checkboxInputLabelElement){this._checkboxInputLabelElement.id=s.generateUniqueId();this._checkboxInputLabelElement.style.display="inline-block";this._checkboxInputLabelElement.style.flex="1 1 auto";this._checkboxInputLabelElement.style.marginLeft="6px";this._checkboxInputLabelElement.style.verticalAlign="middle";var n=document.createElement("div");n.style.width="6px";s.appendChild(t,n);s.appendChild(t,this._checkboxInputLabelElement)}}return t};Object.defineProperty(t.prototype,"isNullable",{get:function(){return false},enumerable:false,configurable:true});t.prototype.getJsonTypeName=function(){return"Input.Toggle"};t.prototype.focus=function(){if(this._checkboxInputElement){this._checkboxInputElement.focus()}};t.prototype.isSet=function(){if(this.isRequired){return this.value===this.valueOn}return this.value?true:false};Object.defineProperty(t.prototype,"value",{get:function(){if(this._checkboxInputElement){return this._checkboxInputElement.checked?this.valueOn:this.valueOff}else{return undefined}},enumerable:false,configurable:true});t.valueProperty=new c.StringProperty(c.Versions.v1_0,"value");t.titleProperty=new c.StringProperty(c.Versions.v1_0,"title");t.valueOnProperty=new c.StringProperty(c.Versions.v1_0,"valueOn",true,undefined,"true",function(e){return"true"});t.valueOffProperty=new c.StringProperty(c.Versions.v1_0,"valueOff",true,undefined,"false",function(e){return"false"});t.wrapProperty=new c.BoolProperty(c.Versions.v1_2,"wrap",false);r([c.property(t.valueProperty)],t.prototype,"defaultValue",void 0);r([c.property(t.titleProperty)],t.prototype,"title",void 0);r([c.property(t.valueOnProperty)],t.prototype,"valueOn",void 0);r([c.property(t.valueOffProperty)],t.prototype,"valueOff",void 0);r([c.property(t.wrapProperty)],t.prototype,"wrap",void 0);return t}(I);t.ToggleInput=V;var O=function(e){n(t,e);function t(t,i){var n=e.call(this)||this;n.title=t;n.value=i;return n}t.prototype.getSchemaKey=function(){return"Choice"};t.titleProperty=new c.StringProperty(c.Versions.v1_0,"title");t.valueProperty=new c.StringProperty(c.Versions.v1_0,"value");r([c.property(t.titleProperty)],t.prototype,"title",void 0);r([c.property(t.valueProperty)],t.prototype,"value",void 0);return t}(c.SerializableObject);t.Choice=O;var k=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.isMultiSelect=false;t.wrap=false;t.choices=[];return t}Object.defineProperty(t.prototype,"isCompact",{get:function(){return this.style!=="expanded"},set:function(e){this.style=e?undefined:"expanded"},enumerable:false,configurable:true});t.getUniqueCategoryName=function(){var e="__ac-category"+t.uniqueCategoryCounter;t.uniqueCategoryCounter++;return e};t.prototype.internalApplyAriaCurrent=function(){var e=this._selectElement.options;if(e){for(var t=0;t<e.length;t++){if(e[t].selected){e[t].setAttribute("aria-current","true")}else{e[t].removeAttribute("aria-current")}}}};t.prototype.renderCompoundInput=function(e,t,i){var n=this;var r=document.createElement("div");r.className=this.hostConfig.makeCssClassName("ac-input",e);r.style.width="100%";this._toggleInputs=[];this._labels=[];for(var o=0,l=this.choices;o<l.length;o++){var u=l[o];var p=document.createElement("input");p.id=s.generateUniqueId();p.type=t;p.style.margin="0";p.style.display="inline-block";p.style.verticalAlign="middle";p.style.flex="0 0 auto";p.name=this.id?this.id:this._uniqueCategoryName;if(this.isRequired){p.setAttribute("aria-required","true")}if(u.value){p.value=u.value}if(u.title){p.setAttribute("aria-label",u.title)}if(i&&u.value){if(i.indexOf(u.value)>=0){p.checked=true}}p.onchange=function(){n.valueChanged()};this._toggleInputs.push(p);var c=document.createElement("div");c.style.display="flex";c.style.alignItems="center";s.appendChild(c,p);var d=new m;d.setParent(this);d.forElementId=p.id;d.hostConfig=this.hostConfig;d.text=u.title?u.title:"Choice "+this._toggleInputs.length;d.useMarkdown=a.GlobalSettings.useMarkdownInRadioButtonAndCheckbox;d.wrap=this.wrap;var f=d.render();this._labels.push(f);if(f){f.id=s.generateUniqueId();f.style.display="inline-block";f.style.flex="1 1 auto";f.style.marginLeft="6px";f.style.verticalAlign="middle";var h=document.createElement("div");h.style.width="6px";s.appendChild(c,h);s.appendChild(c,f)}s.appendChild(r,c)}return r};t.prototype.updateInputControlAriaLabelledBy=function(){if((this.isMultiSelect||this.style==="expanded")&&this._toggleInputs&&this._labels){var t=this.getAllLabelIds();for(var i=0;i<this._toggleInputs.length;i++){var n=t.join(" ");var r=this._labels[i];if(r&&r.id){n+=" "+r.id}if(n){this._toggleInputs[i].setAttribute("aria-labelledby",n)}else{this._toggleInputs[i].removeAttribute("aria-labelledby")}}}else{e.prototype.updateInputControlAriaLabelledBy.call(this)}};t.prototype.internalRender=function(){var e=this;this._uniqueCategoryName=t.getUniqueCategoryName();if(this.isMultiSelect){return this.renderCompoundInput("ac-choiceSetInput-multiSelect","checkbox",this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):undefined)}else{if(this.style==="expanded"){return this.renderCompoundInput("ac-choiceSetInput-expanded","radio",this.defaultValue?[this.defaultValue]:undefined)}else{this._selectElement=document.createElement("select");this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact");this._selectElement.style.width="100%";var i=document.createElement("option");i.selected=true;i.disabled=true;i.hidden=true;i.value="";if(this.placeholder){i.text=this.placeholder}s.appendChild(this._selectElement,i);for(var n=0,r=this.choices;n<r.length;n++){var o=r[n];var a=document.createElement("option");a.value=o.value;a.text=o.title;a.setAttribute("aria-label",o.title);if(o.value==this.defaultValue){a.selected=true}s.appendChild(this._selectElement,a)}this._selectElement.onchange=function(){e.internalApplyAriaCurrent();e.valueChanged()};this.internalApplyAriaCurrent();return this._selectElement}}};t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"};t.prototype.focus=function(){if(this._toggleInputs&&(this.isMultiSelect||this.style==="expanded")){if(this._toggleInputs.length>0){this._toggleInputs[0].focus()}}else{e.prototype.focus.call(this)}};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(this.choices.length==0){t.addFailure(this,o.ValidationEvent.CollectionCantBeEmpty,f.Strings.errors.choiceSetMustHaveAtLeastOneChoice())}for(var i=0,n=this.choices;i<n.length;i++){var r=n[i];if(!r.title||!r.value){t.addFailure(this,o.ValidationEvent.PropertyCantBeNull,f.Strings.errors.choiceSetChoicesMustHaveTitleAndValue())}}};t.prototype.isSet=function(){return this.value?true:false};Object.defineProperty(t.prototype,"value",{get:function(){if(!this.isMultiSelect){if(this.isCompact){if(this._selectElement){return this._selectElement.selectedIndex>0?this._selectElement.value:undefined}return undefined}else{if(!this._toggleInputs||this._toggleInputs.length==0){return undefined}for(var e=0,t=this._toggleInputs;e<t.length;e++){var i=t[e];if(i.checked){return i.value}}return undefined}}else{if(!this._toggleInputs||this._toggleInputs.length==0){return undefined}var n="";for(var r=0,o=this._toggleInputs;r<o.length;r++){var i=o[r];if(i.checked){if(n!=""){n+=this.hostConfig.choiceSetInputValueSeparator}n+=i.value}}return n?n:undefined}},enumerable:false,configurable:true});t.valueProperty=new c.StringProperty(c.Versions.v1_0,"value");t.choicesProperty=new c.SerializableObjectCollectionProperty(c.Versions.v1_0,"choices",O);t.styleProperty=new c.ValueSetProperty(c.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"}],"compact");t.isMultiSelectProperty=new c.BoolProperty(c.Versions.v1_0,"isMultiSelect",false);t.placeholderProperty=new c.StringProperty(c.Versions.v1_0,"placeholder");t.wrapProperty=new c.BoolProperty(c.Versions.v1_2,"wrap",false);t.uniqueCategoryCounter=0;r([c.property(t.valueProperty)],t.prototype,"defaultValue",void 0);r([c.property(t.styleProperty)],t.prototype,"style",void 0);r([c.property(t.isMultiSelectProperty)],t.prototype,"isMultiSelect",void 0);r([c.property(t.placeholderProperty)],t.prototype,"placeholder",void 0);r([c.property(t.wrapProperty)],t.prototype,"wrap",void 0);r([c.property(t.choicesProperty)],t.prototype,"choices",void 0);return t}(I);t.ChoiceSetInput=k;var z=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.internalRender=function(){var e=this;this._numberInputElement=document.createElement("input");this._numberInputElement.setAttribute("type","number");if(this.min!==undefined){this._numberInputElement.setAttribute("min",this.min.toString())}if(this.max!==undefined){this._numberInputElement.setAttribute("max",this.max.toString())}this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput");this._numberInputElement.style.width="100%";this._numberInputElement.tabIndex=0;if(this.defaultValue!==undefined){this._numberInputElement.valueAsNumber=this.defaultValue}if(this.placeholder){this._numberInputElement.placeholder=this.placeholder;this._numberInputElement.setAttribute("aria-label",this.placeholder)}this._numberInputElement.oninput=function(){e.valueChanged()};return this._numberInputElement};t.prototype.getJsonTypeName=function(){return"Input.Number"};t.prototype.isSet=function(){return this.value!==undefined&&!isNaN(this.value)};t.prototype.isValid=function(){if(this.value===undefined){return!this.isRequired}var e=true;if(this.min!==undefined){e=e&&this.value>=this.min}if(this.max!==undefined){e=e&&this.value<=this.max}return e};Object.defineProperty(t.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:undefined},enumerable:false,configurable:true});t.valueProperty=new c.NumProperty(c.Versions.v1_0,"value");t.placeholderProperty=new c.StringProperty(c.Versions.v1_0,"placeholder");t.minProperty=new c.NumProperty(c.Versions.v1_0,"min");t.maxProperty=new c.NumProperty(c.Versions.v1_0,"max");r([c.property(t.valueProperty)],t.prototype,"defaultValue",void 0);r([c.property(t.minProperty)],t.prototype,"min",void 0);r([c.property(t.maxProperty)],t.prototype,"max",void 0);r([c.property(t.placeholderProperty)],t.prototype,"placeholder",void 0);return t}(I);t.NumberInput=z;var N=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.internalRender=function(){var e=this;this._dateInputElement=document.createElement("input");this._dateInputElement.setAttribute("type","date");if(this.min){this._dateInputElement.setAttribute("min",this.min)}if(this.max){this._dateInputElement.setAttribute("max",this.max)}if(this.placeholder){this._dateInputElement.placeholder=this.placeholder;this._dateInputElement.setAttribute("aria-label",this.placeholder)}this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput");this._dateInputElement.style.width="100%";this._dateInputElement.oninput=function(){e.valueChanged()};if(this.defaultValue){this._dateInputElement.value=this.defaultValue}return this._dateInputElement};t.prototype.getJsonTypeName=function(){return"Input.Date"};t.prototype.isSet=function(){return this.value?true:false};t.prototype.isValid=function(){if(!this.value){return!this.isRequired}var e=new Date(this.value);var t=true;if(this.min){var i=new Date(this.min);t=t&&e>=i}if(this.max){var n=new Date(this.max);t=t&&e<=n}return t};Object.defineProperty(t.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:undefined},enumerable:false,configurable:true});t.valueProperty=new c.StringProperty(c.Versions.v1_0,"value");t.placeholderProperty=new c.StringProperty(c.Versions.v1_0,"placeholder");t.minProperty=new c.StringProperty(c.Versions.v1_0,"min");t.maxProperty=new c.StringProperty(c.Versions.v1_0,"max");r([c.property(t.valueProperty)],t.prototype,"defaultValue",void 0);r([c.property(t.minProperty)],t.prototype,"min",void 0);r([c.property(t.maxProperty)],t.prototype,"max",void 0);r([c.property(t.placeholderProperty)],t.prototype,"placeholder",void 0);return t}(I);t.DateInput=N;var R=function(e){n(t,e);function t(t,i){var n=e.call(this,t,i,function(e,t,i,n){var r=i[t.name];if(typeof r==="string"&&r&&/^[0-9]{2}:[0-9]{2}$/.test(r)){return r}return undefined},function(e,t,i,n,r){r.serializeValue(i,t.name,n)})||this;n.targetVersion=t;n.name=i;return n}return t}(c.CustomProperty);t.TimeProperty=R;var L=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.convertTimeStringToDate=function(e){return new Date("1973-09-04T"+e+":00Z")};t.prototype.internalRender=function(){var e=this;this._timeInputElement=document.createElement("input");this._timeInputElement.setAttribute("type","time");this._timeInputElement.setAttribute("min",this.min);this._timeInputElement.setAttribute("max",this.max);this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput");this._timeInputElement.style.width="100%";this._timeInputElement.oninput=function(){e.valueChanged()};if(this.placeholder){this._timeInputElement.placeholder=this.placeholder;this._timeInputElement.setAttribute("aria-label",this.placeholder)}if(this.defaultValue){this._timeInputElement.value=this.defaultValue}return this._timeInputElement};t.prototype.getJsonTypeName=function(){return"Input.Time"};t.prototype.isSet=function(){return this.value?true:false};t.prototype.isValid=function(){if(!this.value){return!this.isRequired}var e=t.convertTimeStringToDate(this.value);var i=true;if(this.min){var n=t.convertTimeStringToDate(this.min);i=i&&e>=n}if(this.max){var r=t.convertTimeStringToDate(this.max);i=i&&e<=r}return i};Object.defineProperty(t.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:undefined},enumerable:false,configurable:true});t.valueProperty=new R(c.Versions.v1_0,"value");t.placeholderProperty=new c.StringProperty(c.Versions.v1_0,"placeholder");t.minProperty=new R(c.Versions.v1_0,"min");t.maxProperty=new R(c.Versions.v1_0,"max");r([c.property(t.valueProperty)],t.prototype,"defaultValue",void 0);r([c.property(t.minProperty)],t.prototype,"min",void 0);r([c.property(t.maxProperty)],t.prototype,"max",void 0);r([c.property(t.placeholderProperty)],t.prototype,"placeholder",void 0);return t}(I);t.TimeInput=L;var B=function(){function e(e,t){this._state=0;this.action=e;this._parentContainerStyle=t}e.prototype.updateCssStyle=function(){var e,t;if(this.action.parent&&this.action.renderedElement){var i=this.action.parent.hostConfig;this.action.renderedElement.className=i.makeCssClassName("ac-pushButton");if(this._parentContainerStyle){this.action.renderedElement.classList.add("style-"+this._parentContainerStyle)}this.action.updateActionButtonCssStyle(this.action.renderedElement,this._state);this.action.renderedElement.classList.remove(i.makeCssClassName("expanded"));this.action.renderedElement.classList.remove(i.makeCssClassName("subdued"));switch(this._state){case 1:this.action.renderedElement.classList.add(i.makeCssClassName("expanded"));break;case 2:this.action.renderedElement.classList.add(i.makeCssClassName("subdued"));break}if(this.action.style){if(this.action.style===o.ActionStyle.Positive){(e=this.action.renderedElement.classList).add.apply(e,i.makeCssClassNames("primary","style-positive"))}else{(t=this.action.renderedElement.classList).add.apply(t,i.makeCssClassNames("style-"+this.action.style.toLowerCase()))}}}};e.prototype.render=function(){var e=this;this.action.render();if(this.action.renderedElement){this.action.renderedElement.onclick=function(t){t.preventDefault();t.cancelBubble=true;e.click()};this.updateCssStyle()}};e.prototype.click=function(){if(this.onClick!==undefined){this.onClick(this)}};Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e;this.updateCssStyle()},enumerable:false,configurable:true});return e}();var D=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.style=o.ActionStyle.Default;return t}t.prototype.getDefaultSerializationContext=function(){return new ge};t.prototype.addCssClasses=function(e){};t.prototype.internalGetReferencedInputs=function(){return{}};t.prototype.internalPrepareForExecution=function(e){};t.prototype.internalValidateInputs=function(e){var t=[];if(e){for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];var o=e[r];if(!o.validateValue()){t.push(o)}}}return t};t.prototype.shouldSerialize=function(e){return e.actionRegistry.findByName(this.getJsonTypeName())!==undefined};t.prototype.raiseExecuteActionEvent=function(){if(this.onExecute){this.onExecute(this)}ne(this)};t.prototype.getHref=function(){return""};t.prototype.getAriaRole=function(){return"button"};t.prototype.updateActionButtonCssStyle=function(e,t){if(t===void 0){t=0}};t.prototype.parse=function(t,i){return e.prototype.parse.call(this,t,i?i:new ge)};t.prototype.render=function(e){if(e===void 0){e="ac-pushButton"}var t=this.hostConfig;var i=document.createElement("button");this.addCssClasses(i);if(this.accessibleTitle){i.setAttribute("aria-label",this.accessibleTitle)}else if(this.title){i.setAttribute("aria-label",this.title)}if(this.expanded!=undefined){i.setAttribute("aria-expanded",this.expanded.toString())}i.type="button";i.style.display="flex";i.style.alignItems="center";i.style.justifyContent="center";i.setAttribute("role",this.getAriaRole());var n=document.createElement("div");n.style.overflow="hidden";n.style.textOverflow="ellipsis";if(!(t.actions.iconPlacement==o.ActionIconPlacement.AboveTitle||t.actions.allowTitleToWrap)){n.style.whiteSpace="nowrap"}if(this.title){n.innerText=this.title}if(!this.iconUrl){i.classList.add("noIcon");i.appendChild(n)}else{var r=document.createElement("img");r.src=this.iconUrl;r.style.width=t.actions.iconSize+"px";r.style.height=t.actions.iconSize+"px";r.style.flex="0 0 auto";if(t.actions.iconPlacement==o.ActionIconPlacement.AboveTitle){i.classList.add("iconAbove");i.style.flexDirection="column";if(this.title){r.style.marginBottom="6px"}}else{i.classList.add("iconLeft");r.style.maxHeight="100%";if(this.title){r.style.marginRight="6px"}}i.appendChild(r);i.appendChild(n)}this._renderedElement=i};t.prototype.execute=function(){if(this._actionCollection){this._actionCollection.actionExecuted(this)}this.raiseExecuteActionEvent()};t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs();var t=this.internalValidateInputs(e);if(t.length>0){t[0].focus();return false}this.internalPrepareForExecution(e);return true};t.prototype.remove=function(){if(this._actionCollection){return this._actionCollection.removeAction(this)}return false};t.prototype.getAllInputs=function(e){if(e===void 0){e=true}return[]};t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]};t.prototype.getActionById=function(e){return this.id===e?this:undefined};t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()};t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())};Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style==o.ActionStyle.Positive},set:function(e){if(e){this.style=o.ActionStyle.Positive}else{if(this.style==o.ActionStyle.Positive){this.style=o.ActionStyle.Default}}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:l.defaultHostConfig},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:false,configurable:true});t.titleProperty=new c.StringProperty(c.Versions.v1_0,"title");t.iconUrlProperty=new c.StringProperty(c.Versions.v1_1,"iconUrl");t.styleProperty=new c.ValueSetProperty(c.Versions.v1_2,"style",[{value:o.ActionStyle.Default},{value:o.ActionStyle.Positive},{value:o.ActionStyle.Destructive}],o.ActionStyle.Default);r([c.property(t.titleProperty)],t.prototype,"title",void 0);r([c.property(t.iconUrlProperty)],t.prototype,"iconUrl",void 0);r([c.property(t.styleProperty)],t.prototype,"style",void 0);return t}(p.CardObject);t.Action=D;var M=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._isPrepared=false;return t}t.prototype.internalGetReferencedInputs=function(){var e={};if(this.associatedInputs!=="none"){var t=this.parent;var i=[];while(t){i=i.concat(t.getAllInputs(false));t=t.parent}for(var n=0,r=i;n<r.length;n++){var o=r[n];if(o.id){e[o.id]=o}}}return e};t.prototype.internalPrepareForExecution=function(e){if(this._originalData){this._processedData=JSON.parse(JSON.stringify(this._originalData))}else{this._processedData={}}if(this._processedData&&e){for(var t=0,i=Object.keys(e);t<i.length;t++){var n=i[t];var r=e[n];if(r.id&&r.isSet()){this._processedData[r.id]=typeof r.value==="string"?r.value:r.value.toString()}}}this._isPrepared=true};Object.defineProperty(t.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(e){this._originalData=e;this._isPrepared=false},enumerable:false,configurable:true});t.dataProperty=new c.PropertyDefinition(c.Versions.v1_0,"data");t.associatedInputsProperty=new c.CustomProperty(c.Versions.v1_3,"associatedInputs",function(e,t,i,n){var r=i[t.name];if(r!==undefined&&typeof r==="string"){return r.toLowerCase()==="none"?"none":"auto"}return undefined},function(e,t,i,n,r){r.serializeValue(i,t.name,n)});r([c.property(t.dataProperty)],t.prototype,"_originalData",void 0);r([c.property(t.associatedInputsProperty)],t.prototype,"associatedInputs",void 0);return t}(D);t.SubmitActionBase=M;var j=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.JsonTypeName="Action.Submit";return t}(M);t.SubmitAction=j;var F=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.JsonTypeName="Action.Execute";t.verbProperty=new c.StringProperty(c.Versions.v1_4,"verb");r([c.property(t.verbProperty)],t.prototype,"verb",void 0);return t}(M);t.ExecuteAction=F;var H=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.prototype.getAriaRole=function(){return"link"};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(!this.url){t.addFailure(this,o.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("url"))}};t.prototype.getHref=function(){return this.url};t.urlProperty=new c.StringProperty(c.Versions.v1_0,"url");t.JsonTypeName="Action.OpenUrl";r([c.property(t.urlProperty)],t.prototype,"url",void 0);return t}(D);t.OpenUrlAction=H;var W=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.targetElements={};return t}t.prototype.updateAriaControlsAttribute=function(){if(this.targetElements){var e=Object.keys(this.targetElements);if(this._renderedElement){if(e.length>0){this._renderedElement.setAttribute("aria-controls",e.join(" "))}else{this._renderedElement.removeAttribute("aria-controls")}}}};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(!this.targetElements){t.addFailure(this,o.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("targetElements"))}};t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.prototype.render=function(t){if(t===void 0){t="ac-pushButton"}e.prototype.render.call(this,t);this.updateAriaControlsAttribute()};t.prototype.execute=function(){if(this.parent){for(var e=0,t=Object.keys(this.targetElements);e<t.length;e++){var i=t[e];var n=this.parent.getRootElement().getElementById(i);if(n){if(typeof this.targetElements[i]==="boolean"){n.isVisible=this.targetElements[i]}else{n.isVisible=!n.isVisible}}}}};t.prototype.addTargetElement=function(e,t){if(t===void 0){t=undefined}this.targetElements[e]=t;this.updateAriaControlsAttribute()};t.prototype.removeTargetElement=function(e){delete this.targetElements[e];this.updateAriaControlsAttribute()};t.targetElementsProperty=new c.CustomProperty(c.Versions.v1_2,"targetElements",function(e,t,i,n){var r={};if(Array.isArray(i[t.name])){for(var o=0,a=i[t.name];o<a.length;o++){var l=a[o];if(typeof l==="string"){r[l]=undefined}else if(typeof l==="object"){var u=l["elementId"];if(typeof u==="string"){r[u]=s.parseBool(l["isVisible"])}}}}return r},function(e,t,i,n,r){var o=[];for(var a=0,s=Object.keys(n);a<s.length;a++){var l=s[a];if(typeof n[l]==="boolean"){o.push({elementId:l,isVisible:n[l]})}else{o.push(l)}}r.serializeArray(i,t.name,o)},{},function(e){return{}});t.JsonTypeName="Action.ToggleVisibility";r([c.property(t.targetElementsProperty)],t.prototype,"targetElements",void 0);return t}(D);t.ToggleVisibilityAction=W;var J=function(e){n(t,e);function t(t,i){var n=e.call(this,t,i,undefined,function(){return new a.StringWithSubstitutions})||this;n.targetVersion=t;n.name=i;return n}t.prototype.parse=function(e,t,i){var n=new a.StringWithSubstitutions;n.set(s.parseString(t[this.name]));return n};t.prototype.toJSON=function(e,t,i,n){n.serializeValue(t,this.name,i.getOriginal())};return t}(c.PropertyDefinition);var q=function(e){n(t,e);function t(t,i){if(t===void 0){t=""}if(i===void 0){i=""}var n=e.call(this)||this;n.name=t;n.value=i;return n}t.prototype.getSchemaKey=function(){return"HttpHeader"};t.prototype.getReferencedInputs=function(e,t){this._value.getReferencedInputs(e,t)};t.prototype.prepareForExecution=function(e){this._value.substituteInputValues(e,a.ContentTypes.applicationXWwwFormUrlencoded)};Object.defineProperty(t.prototype,"value",{get:function(){return this._value.get()},set:function(e){this._value.set(e)},enumerable:false,configurable:true});t.nameProperty=new c.StringProperty(c.Versions.v1_0,"name");t.valueProperty=new J(c.Versions.v1_0,"value");r([c.property(t.nameProperty)],t.prototype,"name",void 0);r([c.property(t.valueProperty)],t.prototype,"_value",void 0);return t}(c.SerializableObject);t.HttpHeader=q;var U=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._ignoreInputValidation=false;return t}t.prototype.internalGetReferencedInputs=function(){var e=this.parent?this.parent.getRootElement().getAllInputs():[];var t={};this._url.getReferencedInputs(e,t);for(var i=0,n=this.headers;i<n.length;i++){var r=n[i];r.getReferencedInputs(e,t)}this._body.getReferencedInputs(e,t);return t};t.prototype.internalPrepareForExecution=function(e){if(e){this._url.substituteInputValues(e,a.ContentTypes.applicationXWwwFormUrlencoded);var t=a.ContentTypes.applicationJson;for(var i=0,n=this.headers;i<n.length;i++){var r=n[i];r.prepareForExecution(e);if(r.name&&r.name.toLowerCase()=="content-type"){t=r.value}}this._body.substituteInputValues(e,t)}};t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(!this.url){t.addFailure(this,o.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("url"))}if(this.headers.length>0){for(var i=0,n=this.headers;i<n.length;i++){var r=n[i];if(!r.name){t.addFailure(this,o.ValidationEvent.PropertyCantBeNull,f.Strings.errors.actionHttpHeadersMustHaveNameAndValue())}}}};Object.defineProperty(t.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(e){this._ignoreInputValidation=e},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"url",{get:function(){return this._url.get()},set:function(e){this._url.set(e)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"body",{get:function(){return this._body.get()},set:function(e){this._body.set(e)},enumerable:false,configurable:true});t.urlProperty=new J(c.Versions.v1_0,"url");t.bodyProperty=new J(c.Versions.v1_0,"body");t.methodProperty=new c.StringProperty(c.Versions.v1_0,"method");t.headersProperty=new c.SerializableObjectCollectionProperty(c.Versions.v1_0,"headers",q);t.ignoreInputValidationProperty=new c.BoolProperty(c.Versions.v1_3,"ignoreInputValidation",false);t.JsonTypeName="Action.Http";r([c.property(t.urlProperty)],t.prototype,"_url",void 0);r([c.property(t.bodyProperty)],t.prototype,"_body",void 0);r([c.property(t.methodProperty)],t.prototype,"method",void 0);r([c.property(t.headersProperty)],t.prototype,"headers",void 0);r([c.property(t.ignoreInputValidationProperty)],t.prototype,"_ignoreInputValidation",void 0);return t}(D);t.HttpAction=U;var G=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.card=new he;return t}t.prototype.internalParse=function(t,i){e.prototype.internalParse.call(this,t,i);var n=t["card"];if(n){this.card.parse(n,i)}else{i.logParseEvent(this,o.ValidationEvent.PropertyCantBeNull,f.Strings.errors.showCardMustHaveCard())}};t.prototype.internalToJSON=function(t,i){e.prototype.internalToJSON.call(this,t,i);if(this.card){i.serializeValue(t,"card",this.card.toJSON(i))}};t.prototype.addCssClasses=function(t){e.prototype.addCssClasses.call(this,t);if(this.parent){t.classList.add(this.parent.hostConfig.makeCssClassName("expandable"))}};t.prototype.raiseExecuteActionEvent=function(){if(this.hostConfig.actions.showCard.actionMode===o.ShowCardActionMode.Popup){e.prototype.raiseExecuteActionEvent.call(this)}};t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);this.card.internalValidateProperties(t)};t.prototype.updateActionButtonCssStyle=function(t,i){if(i===void 0){i=0}e.prototype.updateActionButtonCssStyle.call(this,t);if(this.parent){t.classList.add(this.parent.hostConfig.makeCssClassName("expandable"));t.setAttribute("aria-expanded",(i===1).toString())}};t.prototype.setParent=function(t){e.prototype.setParent.call(this,t);this.card.setParent(t)};t.prototype.getAllInputs=function(e){if(e===void 0){e=true}return this.card.getAllInputs(e)};t.prototype.getResourceInformation=function(){return e.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation())};t.prototype.getActionById=function(t){var i=e.prototype.getActionById.call(this,t);if(!i){i=this.card.getActionById(t)}return i};t.JsonTypeName="Action.ShowCard";return t}(D);t.ShowCardAction=G;var K=function(){function e(e){this._renderedActionCount=0;this.items=[];this.buttons=[];this._owner=e}e.prototype.isActionAllowed=function(e){var t=this._owner.getForbiddenActionTypes();if(t){for(var i=0,n=t;i<n.length;i++){var r=n[i];if(e.constructor===r){return false}}}return true};e.prototype.refreshContainer=function(){this._actionCardContainer.innerHTML="";if(!this._actionCard){this._actionCardContainer.style.marginTop="0px";return}this._actionCardContainer.style.marginTop=this._renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var e=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(e);var t=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(e);if(this._actionCard){this._actionCard.style.paddingLeft=t.left+"px";this._actionCard.style.paddingRight=t.right+"px";this._actionCard.style.marginLeft="-"+t.left+"px";this._actionCard.style.marginRight="-"+t.right+"px";if(t.bottom!=0&&!this._owner.isDesignMode()){this._actionCard.style.paddingBottom=t.bottom+"px";this._actionCard.style.marginBottom="-"+t.bottom+"px"}s.appendChild(this._actionCardContainer,this._actionCard)}};e.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()};e.prototype.showActionCard=function(e,t,i){if(t===void 0){t=false}if(i===void 0){i=true}e.card.suppressStyle=t;var n=e.card.renderedElement&&!this._owner.isDesignMode()?e.card.renderedElement:e.card.render();this._actionCard=n;this._expandedAction=e;this.refreshContainer();if(i){this.layoutChanged();re(e,true)}};e.prototype.collapseExpandedAction=function(){for(var e=0,t=this.buttons;e<t.length;e++){var i=t[e];i.state=0}var n=this._expandedAction;this._expandedAction=undefined;this._actionCard=undefined;this.refreshContainer();if(n){this.layoutChanged();re(n,false)}};e.prototype.expandShowCardAction=function(e,t){for(var i=0,n=this.buttons;i<n.length;i++){var r=n[i];if(r.action!==e){r.state=2}else{r.state=1}}this.showActionCard(e,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),t)};e.prototype.getParentContainer=function(){if(this._owner instanceof Z){return this._owner}else{return this._owner.getParentContainer()}};e.prototype.findActionButton=function(e){for(var t=0,i=this.buttons;t<i.length;t++){var n=i[t];if(n.action==e){return n}}return undefined};e.prototype.actionExecuted=function(e){if(!(e instanceof G)){this.collapseExpandedAction()}else{if(e===this._expandedAction){this.collapseExpandedAction()}else{this.expandShowCardAction(e,true)}}};e.prototype.parse=function(e,t){this.clear();if(Array.isArray(e)){for(var i=0,n=e;i<n.length;i++){var r=n[i];var o=t.parseAction(this._owner,r,[],!this._owner.isDesignMode());if(o){this.addAction(o)}}}};e.prototype.toJSON=function(e,t,i){i.serializeArray(e,t,this.items)};e.prototype.getActionById=function(e){var t=undefined;for(var i=0,n=this.items;i<n.length;i++){var r=n[i];t=r.getActionById(e);if(t){break}}return t};e.prototype.validateProperties=function(e){if(this._owner.hostConfig.actions.maxActions&&this.items.length>this._owner.hostConfig.actions.maxActions){e.addFailure(this._owner,o.ValidationEvent.TooManyActions,f.Strings.errors.tooManyActions(this._owner.hostConfig.actions.maxActions))}if(this.items.length>0&&!this._owner.hostConfig.supportsInteractivity){e.addFailure(this._owner,o.ValidationEvent.InteractivityNotAllowed,f.Strings.errors.interactivityNotAllowed())}for(var t=0,i=this.items;t<i.length;t++){var n=i[t];if(!this.isActionAllowed(n)){e.addFailure(this._owner,o.ValidationEvent.ActionTypeNotAllowed,f.Strings.errors.actionTypeNotAllowed(n.getJsonTypeName()))}n.internalValidateProperties(e)}};e.prototype.render=function(e,t){var i=this._owner.hostConfig;if(!i.supportsInteractivity){return undefined}var n=document.createElement("div");var r=i.actions.maxActions?Math.min(i.actions.maxActions,this.items.length):this.items.length;this._actionCardContainer=document.createElement("div");this._renderedActionCount=0;if(i.actions.preExpandSingleShowCardAction&&r==1&&this.items[0]instanceof G&&this.isActionAllowed(this.items[0])){this.showActionCard(this.items[0],true);this._renderedActionCount=1}else{var a=document.createElement("div");a.className=i.makeCssClassName("ac-actionSet");a.style.display="flex";a.setAttribute("role","menubar");if(e==o.Orientation.Horizontal){a.style.flexDirection="row";if(this._owner.horizontalAlignment&&i.actions.actionAlignment!=o.ActionAlignment.Stretch){switch(this._owner.horizontalAlignment){case o.HorizontalAlignment.Center:a.style.justifyContent="center";break;case o.HorizontalAlignment.Right:a.style.justifyContent="flex-end";break;default:a.style.justifyContent="flex-start";break}}else{switch(i.actions.actionAlignment){case o.ActionAlignment.Center:a.style.justifyContent="center";break;case o.ActionAlignment.Right:a.style.justifyContent="flex-end";break;default:a.style.justifyContent="flex-start";break}}}else{a.style.flexDirection="column";if(this._owner.horizontalAlignment&&i.actions.actionAlignment!=o.ActionAlignment.Stretch){switch(this._owner.horizontalAlignment){case o.HorizontalAlignment.Center:a.style.alignItems="center";break;case o.HorizontalAlignment.Right:a.style.alignItems="flex-end";break;default:a.style.alignItems="flex-start";break}}else{switch(i.actions.actionAlignment){case o.ActionAlignment.Center:a.style.alignItems="center";break;case o.ActionAlignment.Right:a.style.alignItems="flex-end";break;case o.ActionAlignment.Stretch:a.style.alignItems="stretch";break;default:a.style.alignItems="flex-start";break}}}var l=this.getParentContainer();if(l){var u=l.getEffectiveStyle();var p=this.items.filter(this.isActionAllowed.bind(this));for(var c=0;c<p.length;c++){var d=this.findActionButton(p[c]);if(!d){d=new B(p[c],u);d.onClick=function(e){e.action.execute()};this.buttons.push(d)}d.render();if(d.action.renderedElement){if(p.length>1){d.action.renderedElement.setAttribute("aria-posinset",(c+1).toString());d.action.renderedElement.setAttribute("aria-setsize",p.length.toString());d.action.renderedElement.setAttribute("role","menuitem")}if(i.actions.actionsOrientation==o.Orientation.Horizontal&&i.actions.actionAlignment==o.ActionAlignment.Stretch){d.action.renderedElement.style.flex="0 1 100%"}else{d.action.renderedElement.style.flex="0 1 auto"}a.appendChild(d.action.renderedElement);this._renderedActionCount++;if(this._renderedActionCount>=i.actions.maxActions||c==this.items.length-1){break}else if(i.actions.buttonSpacing>0){var f=document.createElement("div");if(e===o.Orientation.Horizontal){f.style.flex="0 0 auto";f.style.width=i.actions.buttonSpacing+"px"}else{f.style.height=i.actions.buttonSpacing+"px"}s.appendChild(a,f)}}}}var h=document.createElement("div");h.style.overflow="hidden";h.appendChild(a);s.appendChild(n,h)}s.appendChild(n,this._actionCardContainer);for(var y=0,g=this.buttons;y<g.length;y++){var m=g[y];if(m.state==1){this.expandShowCardAction(m.action,false);break}}return this._renderedActionCount>0?n:undefined};e.prototype.addAction=function(e){if(!e){throw new Error("The action parameter cannot be null.")}if((!e.parent||e.parent===this._owner)&&this.items.indexOf(e)<0){this.items.push(e);if(!e.parent){e.setParent(this._owner)}e["_actionCollection"]=this}else{throw new Error(f.Strings.errors.actionAlreadyParented())}};e.prototype.removeAction=function(e){if(this.expandedAction&&this._expandedAction==e){this.collapseExpandedAction()}var t=this.items.indexOf(e);if(t>=0){this.items.splice(t,1);e.setParent(undefined);e["_actionCollection"]=undefined;for(var i=0;i<this.buttons.length;i++){if(this.buttons[i].action==e){this.buttons.splice(i,1);break}}return true}return false};e.prototype.clear=function(){this.items=[];this.buttons=[];this._expandedAction=undefined;this._renderedActionCount=0};e.prototype.getAllInputs=function(e){if(e===void 0){e=true}var t=[];if(e){for(var i=0,n=this.items;i<n.length;i++){var r=n[i];t=t.concat(r.getAllInputs())}}return t};e.prototype.getResourceInformation=function(){var e=[];for(var t=0,i=this.items;t<i.length;t++){var n=i[t];e=e.concat(n.getResourceInformation())}return e};Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._renderedActionCount},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:false,configurable:true});return e}();var X=function(e){n(t,e);function t(){var t=e.call(this)||this;t._actionCollection=new K(t);return t}t.prototype.internalParse=function(t,i){e.prototype.internalParse.call(this,t,i);this._actionCollection.parse(t["actions"],i)};t.prototype.internalToJSON=function(t,i){e.prototype.internalToJSON.call(this,t,i);this._actionCollection.toJSON(t,"actions",i)};t.prototype.internalRender=function(){return this._actionCollection.render(this.orientation!==undefined?this.orientation:this.hostConfig.actions.actionsOrientation,this.isDesignMode())};t.prototype.isBleedingAtBottom=function(){if(this._actionCollection.renderedActionCount==0){return e.prototype.isBleedingAtBottom.call(this)}else{if(this._actionCollection.items.length==1){return this._actionCollection.expandedAction!==undefined&&!this.hostConfig.actions.preExpandSingleShowCardAction}else{return this._actionCollection.expandedAction!==undefined}}};t.prototype.getJsonTypeName=function(){return"ActionSet"};t.prototype.getActionCount=function(){return this._actionCollection.items.length};t.prototype.getActionAt=function(t){if(t>=0&&t<this.getActionCount()){return this._actionCollection.items[t]}else{return e.prototype.getActionAt.call(this,t)}};t.prototype.getActionById=function(t){var i=this._actionCollection.getActionById(t);return i?i:e.prototype.getActionById.call(this,t)};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);this._actionCollection.validateProperties(t)};t.prototype.addAction=function(e){this._actionCollection.addAction(e)};t.prototype.getAllInputs=function(e){if(e===void 0){e=true}return e?this._actionCollection.getAllInputs():[]};t.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()};t.prototype.findDOMNodeOwner=function(t){var i=undefined;for(var n=0,r=this._actionCollection.items;n<r.length;n++){var o=r[n];i=o.findDOMNodeOwner(t);if(i){return i}}return e.prototype.findDOMNodeOwner.call(this,t)};Object.defineProperty(t.prototype,"isInteractive",{get:function(){return true},enumerable:false,configurable:true});t.orientationProperty=new c.EnumProperty(c.Versions.v1_1,"orientation",o.Orientation);r([c.property(t.orientationProperty)],t.prototype,"orientation",void 0);return t}(h);t.ActionSet=X;var Y=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._bleed=false;return t}Object.defineProperty(t.prototype,"style",{get:function(){if(this.allowCustomStyle){var e=this.getValue(t.styleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e)){return e}}return undefined},set:function(e){this.setValue(t.styleProperty,e)},enumerable:false,configurable:true});t.prototype.adjustRenderedElementSize=function(t){e.prototype.adjustRenderedElementSize.call(this,t);if(this.minPixelHeight){t.style.minHeight=this.minPixelHeight+"px"}};t.prototype.applyBackground=function(){if(this.renderedElement){var e=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(e.backgroundColor){var t=s.stringToCssColor(e.backgroundColor);this.renderedElement.style.backgroundColor=t;this.renderedElement.style.border="1px solid "+t}}};t.prototype.applyPadding=function(){e.prototype.applyPadding.call(this);if(!this.renderedElement){return}var t=new a.SpacingDefinition;if(this.getEffectivePadding()){t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())}this.renderedElement.style.paddingTop=t.top+"px";this.renderedElement.style.paddingRight=t.right+"px";this.renderedElement.style.paddingBottom=t.bottom+"px";this.renderedElement.style.paddingLeft=t.left+"px";if(this.isBleeding()){var i=new a.PaddingDefinition;this.getImmediateSurroundingPadding(i);var n=this.hostConfig.paddingDefinitionToSpacingDefinition(i);this.renderedElement.style.marginRight="-"+n.right+"px";this.renderedElement.style.marginLeft="-"+n.left+"px";if(!this.isDesignMode()){this.renderedElement.style.marginTop="-"+n.top+"px";this.renderedElement.style.marginBottom="-"+n.bottom+"px"}if(this.separatorElement&&this.separatorOrientation==o.Orientation.Horizontal){this.separatorElement.style.marginLeft="-"+n.left+"px";this.separatorElement.style.marginRight="-"+n.right+"px"}}else{this.renderedElement.style.marginRight="0";this.renderedElement.style.marginLeft="0";this.renderedElement.style.marginTop="0";this.renderedElement.style.marginBottom="0";if(this.separatorElement&&this.separatorOrientation===o.Orientation.Horizontal){this.separatorElement.style.marginRight="0";this.separatorElement.style.marginLeft="0"}}};t.prototype.getHasBackground=function(){var e=this.parent;while(e){var i=e instanceof Z?e.backgroundImage.isValid():false;if(e instanceof t){if(this.hasExplicitStyle&&(e.getEffectiveStyle()!=this.getEffectiveStyle()||i)){return true}}e=e.parent}return false};t.prototype.getDefaultPadding=function(){return this.getHasBackground()?new a.PaddingDefinition(o.Spacing.Padding,o.Spacing.Padding,o.Spacing.Padding,o.Spacing.Padding):e.prototype.getDefaultPadding.call(this)};t.prototype.getHasExpandedAction=function(){return false};t.prototype.getBleed=function(){return this._bleed};t.prototype.setBleed=function(e){this._bleed=e};Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return 0},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"hasExplicitStyle",{get:function(){return this.getValue(t.styleProperty)!==undefined},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return true},enumerable:false,configurable:true});t.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()};t.prototype.internalValidateProperties=function(i){e.prototype.internalValidateProperties.call(this,i);var n=this.getValue(t.styleProperty);if(n!==undefined){var r=this.hostConfig.containerStyles.getStyleByName(n);if(!r){i.addFailure(this,o.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidPropertyValue(n,"style"))}}};t.prototype.render=function(){var t=e.prototype.render.call(this);if(t&&this.getHasBackground()){this.applyBackground()}return t};t.prototype.getEffectiveStyle=function(){var t=this.style;return t?t:e.prototype.getEffectiveStyle.call(this)};t.styleProperty=new c.ValueSetProperty(c.Versions.v1_0,"style",[{value:o.ContainerStyle.Default},{value:o.ContainerStyle.Emphasis},{targetVersion:c.Versions.v1_2,value:o.ContainerStyle.Accent},{targetVersion:c.Versions.v1_2,value:o.ContainerStyle.Good},{targetVersion:c.Versions.v1_2,value:o.ContainerStyle.Attention},{targetVersion:c.Versions.v1_2,value:o.ContainerStyle.Warning}]);t.bleedProperty=new c.BoolProperty(c.Versions.v1_2,"bleed",false);t.minHeightProperty=new c.PixelSizeProperty(c.Versions.v1_2,"minHeight");r([c.property(t.styleProperty)],t.prototype,"style",null);r([c.property(t.bleedProperty)],t.prototype,"_bleed",void 0);r([c.property(t.minHeightProperty)],t.prototype,"minPixelHeight",void 0);return t}(A);t.StylableCardElementContainer=Y;var $=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getSchemaKey=function(){return"BackgroundImage"};t.prototype.internalParse=function(t,i){if(typeof t==="string"){this.resetDefaultValues();this.url=t}else{return e.prototype.internalParse.call(this,t,i)}};t.prototype.apply=function(e){if(this.url&&e.renderedElement){e.renderedElement.style.backgroundImage="url('"+e.preProcessPropertyValue(t.urlProperty,this.url)+"')";switch(this.fillMode){case o.FillMode.Repeat:e.renderedElement.style.backgroundRepeat="repeat";break;case o.FillMode.RepeatHorizontally:e.renderedElement.style.backgroundRepeat="repeat-x";break;case o.FillMode.RepeatVertically:e.renderedElement.style.backgroundRepeat="repeat-y";break;case o.FillMode.Cover:default:e.renderedElement.style.backgroundRepeat="no-repeat";e.renderedElement.style.backgroundSize="cover";break}switch(this.horizontalAlignment){case o.HorizontalAlignment.Center:e.renderedElement.style.backgroundPositionX="center";break;case o.HorizontalAlignment.Right:e.renderedElement.style.backgroundPositionX="right";break}switch(this.verticalAlignment){case o.VerticalAlignment.Center:e.renderedElement.style.backgroundPositionY="center";break;case o.VerticalAlignment.Bottom:e.renderedElement.style.backgroundPositionY="bottom";break}}};t.prototype.isValid=function(){return this.url?true:false};t.urlProperty=new c.StringProperty(c.Versions.v1_0,"url");t.fillModeProperty=new c.EnumProperty(c.Versions.v1_2,"fillMode",o.FillMode,o.FillMode.Cover);t.horizontalAlignmentProperty=new c.EnumProperty(c.Versions.v1_2,"horizontalAlignment",o.HorizontalAlignment,o.HorizontalAlignment.Left);t.verticalAlignmentProperty=new c.EnumProperty(c.Versions.v1_2,"verticalAlignment",o.VerticalAlignment,o.VerticalAlignment.Top);r([c.property(t.urlProperty)],t.prototype,"url",void 0);r([c.property(t.fillModeProperty)],t.prototype,"fillMode",void 0);r([c.property(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0);r([c.property(t.verticalAlignmentProperty)],t.prototype,"verticalAlignment",void 0);return t}(c.SerializableObject);t.BackgroundImage=$;var Z=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.verticalContentAlignment=o.VerticalAlignment.Top;t._items=[];t._renderedItems=[];return t}Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.getValue(t.backgroundImageProperty)},enumerable:false,configurable:true});t.prototype.insertItemAt=function(e,t,i){if(!e.parent||i){if(e.isStandalone){if(t<0||t>=this._items.length){this._items.push(e)}else{this._items.splice(t,0,e)}e.setParent(this)}else{throw new Error(f.Strings.errors.elementTypeNotStandalone(e.getJsonTypeName()))}}else{throw new Error(f.Strings.errors.elementAlreadyParented())}};t.prototype.supportsExcplitiHeight=function(){return true};t.prototype.getItemsCollectionPropertyName=function(){return"items"};t.prototype.applyBackground=function(){if(this.backgroundImage.isValid()&&this.renderedElement){this.backgroundImage.apply(this)}e.prototype.applyBackground.call(this)};t.prototype.internalRender=function(){this._renderedItems=[];var e=this.hostConfig;var t=document.createElement("div");if(this.rtl!==undefined&&this.rtl){t.dir="rtl"}t.classList.add(e.makeCssClassName("ac-container"));t.style.display="flex";t.style.flexDirection="column";if(a.GlobalSettings.useAdvancedCardBottomTruncation){t.style.minHeight="-webkit-min-content"}switch(this.verticalContentAlignment){case o.VerticalAlignment.Center:t.style.justifyContent="center";break;case o.VerticalAlignment.Bottom:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start";break}if(this._items.length>0){for(var i=0,n=this._items;i<n.length;i++){var r=n[i];var l=this.isElementAllowed(r)?r.render():undefined;if(l){if(this._renderedItems.length>0&&r.separatorElement){r.separatorElement.style.flex="0 0 auto";s.appendChild(t,r.separatorElement)}s.appendChild(t,l);this._renderedItems.push(r)}}}else{if(this.isDesignMode()){var u=this.createPlaceholderElement();u.style.width="100%";u.style.height="100%";t.appendChild(u)}}return t};t.prototype.truncateOverflow=function(e){if(this.renderedElement){var t=this.renderedElement.offsetTop+e+1;var i=function(e){var n=e.renderedElement;if(n){switch(s.getFitStatus(n,t)){case o.ContainerFitStatus.FullyInContainer:var r=e["resetOverflow"]();if(r){i(e)}break;case o.ContainerFitStatus.Overflowing:var a=t-n.offsetTop;e["handleOverflow"](a);break;case o.ContainerFitStatus.FullyOutOfContainer:e["handleOverflow"](0);break}}};for(var n=0,r=this._items;n<r.length;n++){var a=r[n];i(a)}return true}return false};t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._items;e<t.length;e++){var i=t[e];i["resetOverflow"]()}};t.prototype.getHasBackground=function(){return this.backgroundImage.isValid()||e.prototype.getHasBackground.call(this)};t.prototype.internalParse=function(t,i){e.prototype.internalParse.call(this,t,i);this.clear();this.setShouldFallback(false);var n=t[this.getItemsCollectionPropertyName()];if(Array.isArray(n)){for(var r=0,o=n;r<o.length;r++){var a=o[r];var s=i.parseElement(this,a,!this.isDesignMode());if(s){this.insertItemAt(s,-1,true)}}}};t.prototype.internalToJSON=function(t,i){e.prototype.internalToJSON.call(this,t,i);i.serializeArray(t,this.getItemsCollectionPropertyName(),this._items)};Object.defineProperty(t.prototype,"isSelectable",{get:function(){return true},enumerable:false,configurable:true});t.prototype.getItemCount=function(){return this._items.length};t.prototype.getItemAt=function(e){return this._items[e]};t.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0){for(var e=0,t=this._renderedItems;e<t.length;e++){var i=t[e];if(i.isVisible){return i}}}return undefined};t.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0){for(var e=this._renderedItems.length-1;e>=0;e--){if(this._renderedItems[e].isVisible){return this._renderedItems[e]}}}return undefined};t.prototype.getJsonTypeName=function(){return"Container"};t.prototype.isFirstElement=function(e){var t=this.isDesignMode();for(var i=0,n=this._items;i<n.length;i++){var r=n[i];if(r.isVisible||t){return r==e}}return false};t.prototype.isLastElement=function(e){var t=this.isDesignMode();for(var i=this._items.length-1;i>=0;i--){if(this._items[i].isVisible||t){return this._items[i]==e}}return false};t.prototype.isRtl=function(){if(this.rtl!==undefined){return this.rtl}else{var e=this.getParentContainer();return e?e.isRtl():false}};t.prototype.isBleedingAtTop=function(){var e=this.getFirstVisibleRenderedItem();return this.isBleeding()||(e?e.isBleedingAtTop():false)};t.prototype.isBleedingAtBottom=function(){var e=this.getLastVisibleRenderedItem();return this.isBleeding()||(e?e.isBleedingAtBottom()&&e.getEffectiveStyle()==this.getEffectiveStyle():false)};t.prototype.indexOf=function(e){return this._items.indexOf(e)};t.prototype.addItem=function(e){this.insertItemAt(e,-1,false)};t.prototype.insertItemBefore=function(e,t){this.insertItemAt(e,this._items.indexOf(t),false)};t.prototype.insertItemAfter=function(e,t){this.insertItemAt(e,this._items.indexOf(t)+1,false)};t.prototype.removeItem=function(e){var t=this._items.indexOf(e);if(t>=0){this._items.splice(t,1);e.setParent(undefined);this.updateLayout();return true}return false};t.prototype.clear=function(){this._items=[];this._renderedItems=[]};t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);if(this.backgroundImage.isValid()){t.push({url:this.backgroundImage.url,mimeType:"image"})}return t};t.prototype.getActionById=function(t){var i=e.prototype.getActionById.call(this,t);if(!i){if(this.selectAction){i=this.selectAction.getActionById(t)}if(!i){for(var n=0,r=this._items;n<r.length;n++){var o=r[n];i=o.getActionById(t);if(i){break}}}}return i};Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:false,configurable:true});t.backgroundImageProperty=new c.SerializableObjectProperty(c.Versions.v1_0,"backgroundImage",$);t.verticalContentAlignmentProperty=new c.EnumProperty(c.Versions.v1_1,"verticalContentAlignment",o.VerticalAlignment,o.VerticalAlignment.Top);t.rtlProperty=new c.BoolProperty(c.Versions.v1_0,"rtl");r([c.property(t.backgroundImageProperty)],t.prototype,"backgroundImage",null);r([c.property(t.verticalContentAlignmentProperty)],t.prototype,"verticalContentAlignment",void 0);r([c.property(t.rtlProperty)],t.prototype,"rtl",void 0);return t}(Y);t.Container=Z;var Q=function(e){n(t,e);function t(t){if(t===void 0){t="stretch"}var i=e.call(this)||this;i.width="stretch";i._computedWeight=0;i.width=t;return i}t.prototype.adjustRenderedElementSize=function(e){var t=20;if(this.isDesignMode()){e.style.minWidth="20px";e.style.minHeight=(!this.minPixelHeight?t:Math.max(this.minPixelHeight,t))+"px"}else{e.style.minWidth="0";if(this.minPixelHeight){e.style.minHeight=this.minPixelHeight+"px"}}if(this.width==="auto"){e.style.flex="0 1 auto"}else if(this.width==="stretch"){e.style.flex="1 1 50px"}else if(this.width instanceof a.SizeAndUnit){if(this.width.unit==o.SizeUnit.Pixel){e.style.flex="0 0 auto";e.style.width=this.width.physicalSize+"px"}else{e.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:this.width.physicalSize)+"%"}}};t.prototype.shouldSerialize=function(e){return true};Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return o.Orientation.Vertical},enumerable:false,configurable:true});t.prototype.getJsonTypeName=function(){return"Column"};Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){if(this.parent&&this.parent instanceof ee){return this.separatorElement!==undefined&&!this.parent.isLeftMostElement(this)}else{return false}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isStandalone",{get:function(){return false},enumerable:false,configurable:true});t.widthProperty=new c.CustomProperty(c.Versions.v1_0,"width",function(e,t,i,n){var r=t.defaultValue;var s=i[t.name];var l=false;if(typeof s==="number"&&!isNaN(s)){r=new a.SizeAndUnit(s,o.SizeUnit.Weight)}else if(s==="auto"||s==="stretch"){r=s}else if(typeof s==="string"){try{r=a.SizeAndUnit.parse(s);if(r.unit===o.SizeUnit.Pixel&&t.targetVersion.compareTo(n.targetVersion)>0){l=true}}catch(e){l=true}}else{l=true}if(l){n.logParseEvent(e,o.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidColumnWidth(s));r="auto"}return r},function(e,t,i,n,r){if(n instanceof a.SizeAndUnit){if(n.unit===o.SizeUnit.Pixel){r.serializeValue(i,"width",n.physicalSize+"px")}else{r.serializeNumber(i,"width",n.physicalSize)}}else{r.serializeValue(i,"width",n)}},"stretch");r([c.property(t.widthProperty)],t.prototype,"width",void 0);return t}(Z);t.Column=Q;var ee=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._columns=[];return t}t.prototype.createColumnInstance=function(e,t){return t.parseCardObject(this,e,[],!this.isDesignMode(),function(e){return!e||e==="Column"?new Q:undefined},function(e,i){t.logParseEvent(undefined,o.ValidationEvent.ElementTypeNotAllowed,f.Strings.errors.elementTypeNotAllowed(e))})};t.prototype.internalRender=function(){this._renderedColumns=[];if(this._columns.length>0){var e=this.hostConfig;var t=document.createElement("div");t.className=e.makeCssClassName("ac-columnSet");t.style.display="flex";if(a.GlobalSettings.useAdvancedCardBottomTruncation){t.style.minHeight="-webkit-min-content"}switch(this.horizontalAlignment){case o.HorizontalAlignment.Center:t.style.justifyContent="center";break;case o.HorizontalAlignment.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start";break}var i=0;for(var n=0,r=this._columns;n<r.length;n++){var l=r[n];if(l.width instanceof a.SizeAndUnit&&l.width.unit==o.SizeUnit.Weight){i+=l.width.physicalSize}}for(var u=0,p=this._columns;u<p.length;u++){var l=p[u];if(l.width instanceof a.SizeAndUnit&&l.width.unit==o.SizeUnit.Weight&&i>0){var c=100/i*l.width.physicalSize;l["_computedWeight"]=c}var d=l.render();if(d){if(this._renderedColumns.length>0&&l.separatorElement){l.separatorElement.style.flex="0 0 auto";s.appendChild(t,l.separatorElement)}s.appendChild(t,d);this._renderedColumns.push(l)}}return this._renderedColumns.length>0?t:undefined}else{return undefined}};t.prototype.truncateOverflow=function(e){for(var t=0,i=this._columns;t<i.length;t++){var n=i[t];n["handleOverflow"](e)}return true};t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._columns;e<t.length;e++){var i=t[e];i["resetOverflow"]()}};Object.defineProperty(t.prototype,"isSelectable",{get:function(){return true},enumerable:false,configurable:true});t.prototype.internalParse=function(t,i){e.prototype.internalParse.call(this,t,i);this._columns=[];this._renderedColumns=[];var n=t["columns"];if(Array.isArray(n)){for(var r=0,o=n;r<o.length;r++){var a=o[r];var s=this.createColumnInstance(a,i);if(s){this._columns.push(s)}}}};t.prototype.internalToJSON=function(t,i){e.prototype.internalToJSON.call(this,t,i);i.serializeArray(t,"columns",this._columns)};t.prototype.isFirstElement=function(e){for(var t=0,i=this._columns;t<i.length;t++){var n=i[t];if(n.isVisible){return n==e}}return false};t.prototype.isBleedingAtTop=function(){if(this.isBleeding()){return true}if(this._renderedColumns&&this._renderedColumns.length>0){for(var e=0,t=this._columns;e<t.length;e++){var i=t[e];if(i.isBleedingAtTop()){return true}}}return false};t.prototype.isBleedingAtBottom=function(){if(this.isBleeding()){return true}if(this._renderedColumns&&this._renderedColumns.length>0){for(var e=0,t=this._columns;e<t.length;e++){var i=t[e];if(i.isBleedingAtBottom()){return true}}}return false};t.prototype.getItemCount=function(){return this._columns.length};t.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0){return this._renderedColumns[0]}else{return undefined}};t.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0){return this._renderedColumns[this._renderedColumns.length-1]}else{return undefined}};t.prototype.getColumnAt=function(e){return this._columns[e]};t.prototype.getItemAt=function(e){return this.getColumnAt(e)};t.prototype.getJsonTypeName=function(){return"ColumnSet"};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);var i=0;var n=0;for(var r=0,a=this._columns;r<a.length;r++){var s=a[r];if(typeof s.width==="number"){i++}else if(s.width==="stretch"){n++}}if(i>0&&n>0){t.addFailure(this,o.ValidationEvent.Hint,f.Strings.hints.dontUseWeightedAndStrecthedColumnsInSameSet())}};t.prototype.addColumn=function(e){if(!e.parent){this._columns.push(e);e.setParent(this)}else{throw new Error(f.Strings.errors.columnAlreadyBelongsToAnotherSet())}};t.prototype.removeItem=function(e){if(e instanceof Q){var t=this._columns.indexOf(e);if(t>=0){this._columns.splice(t,1);e.setParent(undefined);this.updateLayout();return true}}return false};t.prototype.indexOf=function(e){return e instanceof Q?this._columns.indexOf(e):-1};t.prototype.isLeftMostElement=function(e){return this._columns.indexOf(e)==0};t.prototype.isRightMostElement=function(e){return this._columns.indexOf(e)==this._columns.length-1};t.prototype.isTopElement=function(e){return this._columns.indexOf(e)>=0};t.prototype.isBottomElement=function(e){return this._columns.indexOf(e)>=0};t.prototype.getActionById=function(e){var t=undefined;for(var i=0,n=this._columns;i<n.length;i++){var r=n[i];t=r.getActionById(e);if(t){break}}return t};Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:false,configurable:true});return t}(Y);t.ColumnSet=ee;function te(e){var t=e.getRootElement();var i=t&&t.onImageLoaded?t.onImageLoaded:fe.onImageLoaded;if(i){i(e)}}function ie(e,t,i){var n=e.getRootElement();var r=n&&n.onAnchorClicked?n.onAnchorClicked:fe.onAnchorClicked;return r!==undefined?r(e,t,i):false}function ne(e){var t=e.parent?e.parent.getRootElement():undefined;var i=t&&t.onExecuteAction?t.onExecuteAction:fe.onExecuteAction;if(e.prepareForExecution()&&i){i(e)}}function re(e,t){var i=e.parent?e.parent.getRootElement():undefined;var n=i&&i.onInlineCardExpanded?i.onInlineCardExpanded:fe.onInlineCardExpanded;if(n){n(e,t)}}function oe(e){var t=e.getRootElement();var i=t&&t.onInputValueChanged?t.onInputValueChanged:fe.onInputValueChanged;if(i){i(e)}}function ae(e,t){if(t===void 0){t=true}var i=e.getRootElement();if(t){i.updateLayout()}var n=i;var r=n&&n.onElementVisibilityChanged?n.onElementVisibilityChanged:fe.onElementVisibilityChanged;if(r!==undefined){r(e)}}var se=function(e){n(t,e);function t(){var t=e.call(this)||this;t._actionCollection=new K(t);return t}t.prototype.internalParse=function(t,i){e.prototype.internalParse.call(this,t,i);this._actionCollection.parse(t["actions"],i)};t.prototype.internalToJSON=function(t,i){e.prototype.internalToJSON.call(this,t,i);this._actionCollection.toJSON(t,"actions",i)};t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);if(t){var i=this._actionCollection.render(this.hostConfig.actions.actionsOrientation,false);if(i){s.appendChild(t,s.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},o.Orientation.Horizontal));s.appendChild(t,i)}if(this.renderIfEmpty){return t}else{return t.children.length>0?t:undefined}}else{return undefined}};t.prototype.getHasExpandedAction=function(){if(this.renderedActionCount==0){return false}else if(this.renderedActionCount==1){return this._actionCollection.expandedAction!==undefined&&!this.hostConfig.actions.preExpandSingleShowCardAction}else{return this._actionCollection.expandedAction!==undefined}};Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return false},enumerable:false,configurable:true});t.prototype.getActionCount=function(){return this._actionCollection.items.length};t.prototype.getActionAt=function(t){if(t>=0&&t<this.getActionCount()){return this._actionCollection.items[t]}else{return e.prototype.getActionAt.call(this,t)}};t.prototype.getActionById=function(t){var i=this._actionCollection.getActionById(t);return i?i:e.prototype.getActionById.call(this,t)};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(this._actionCollection){this._actionCollection.validateProperties(t)}};t.prototype.isLastElement=function(t){return e.prototype.isLastElement.call(this,t)&&this._actionCollection.items.length==0};t.prototype.addAction=function(e){this._actionCollection.addAction(e)};t.prototype.clear=function(){e.prototype.clear.call(this);this._actionCollection.clear()};t.prototype.getAllInputs=function(t){if(t===void 0){t=true}var i=e.prototype.getAllInputs.call(this,t);if(t){i=i.concat(this._actionCollection.getAllInputs(t))}return i};t.prototype.getResourceInformation=function(){return e.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation())};t.prototype.isBleedingAtBottom=function(){if(this._actionCollection.renderedActionCount==0){return e.prototype.isBleedingAtBottom.call(this)}else{if(this._actionCollection.items.length==1){return this._actionCollection.expandedAction!==undefined&&!this.hostConfig.actions.preExpandSingleShowCardAction}else{return this._actionCollection.expandedAction!==undefined}}};Object.defineProperty(t.prototype,"isStandalone",{get:function(){return false},enumerable:false,configurable:true});return t}(Z);t.ContainerWithActions=se;var le=function(e){n(t,e);function t(t,i){var n=e.call(this,t,i,undefined)||this;n.targetVersion=t;n.name=i;return n}t.prototype.parse=function(e,t,i){var n=i.parseAction(e.parent,t[this.name],[],false);if(n!==undefined){if(n instanceof F){return n}i.logParseEvent(e,o.ValidationEvent.ActionTypeNotAllowed,f.Strings.errors.actionTypeNotAllowed(n.getJsonTypeName()))}i.logParseEvent(e,o.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("action"));return undefined};t.prototype.toJSON=function(e,t,i,n){n.serializeValue(t,this.name,i?i.toJSON(n):undefined,undefined,true)};return t}(c.PropertyDefinition);t.RefreshActionProperty=le;var ue=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}Object.defineProperty(t.prototype,"action",{get:function(){return this.getValue(t.actionProperty)},set:function(e){this.setValue(t.actionProperty,e);if(e){e.setParent(this.parent)}},enumerable:false,configurable:true});t.prototype.getSchemaKey=function(){return"RefreshDefinition"};t.actionProperty=new le(c.Versions.v1_4,"action");t.userIdsProperty=new c.StringArrayProperty(c.Versions.v1_4,"userIds");r([c.property(t.actionProperty)],t.prototype,"action",null);r([c.property(t.userIdsProperty)],t.prototype,"userIds",void 0);return t}(c.SerializableObject);t.RefreshDefinition=ue;var pe=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getSchemaKey=function(){return"AuthCardButton"};t.typeProperty=new c.StringProperty(c.Versions.v1_4,"type");t.titleProperty=new c.StringProperty(c.Versions.v1_4,"title");t.imageProperty=new c.StringProperty(c.Versions.v1_4,"image");t.valueProperty=new c.StringProperty(c.Versions.v1_4,"value");r([c.property(t.typeProperty)],t.prototype,"type",void 0);r([c.property(t.titleProperty)],t.prototype,"title",void 0);r([c.property(t.imageProperty)],t.prototype,"image",void 0);r([c.property(t.valueProperty)],t.prototype,"value",void 0);return t}(c.SerializableObject);t.AuthCardButton=pe;var ce=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getSchemaKey=function(){return"TokenExchangeResource"};t.idProperty=new c.StringProperty(c.Versions.v1_4,"id");t.uriProperty=new c.StringProperty(c.Versions.v1_4,"uri");t.providerIdProperty=new c.StringProperty(c.Versions.v1_4,"providerId");r([c.property(t.idProperty)],t.prototype,"id",void 0);r([c.property(t.uriProperty)],t.prototype,"uri",void 0);r([c.property(t.providerIdProperty)],t.prototype,"providerId",void 0);return t}(c.SerializableObject);t.TokenExchangeResource=ce;var de=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getSchemaKey=function(){return"Authentication"};t.textProperty=new c.StringProperty(c.Versions.v1_4,"text");t.connectionNameProperty=new c.StringProperty(c.Versions.v1_4,"connectionName");t.buttonsProperty=new c.SerializableObjectCollectionProperty(c.Versions.v1_4,"buttons",pe);t.tokenExchangeResourceProperty=new c.SerializableObjectProperty(c.Versions.v1_4,"tokenExchangeResource",ce,true);r([c.property(t.textProperty)],t.prototype,"text",void 0);r([c.property(t.connectionNameProperty)],t.prototype,"connectionName",void 0);r([c.property(t.buttonsProperty)],t.prototype,"buttons",void 0);r([c.property(t.tokenExchangeResourceProperty)],t.prototype,"tokenExchangeResource",void 0);return t}(c.SerializableObject);t.Authentication=de;var fe=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.designMode=false;return t}Object.defineProperty(t.prototype,"refresh",{get:function(){return this.getValue(t.refreshProperty)},set:function(e){this.setValue(t.refreshProperty,e);if(e){e.parent=this}},enumerable:false,configurable:true});Object.defineProperty(t,"processMarkdown",{get:function(){throw new Error(f.Strings.errors.processMarkdownEventRemoved())},set:function(e){throw new Error(f.Strings.errors.processMarkdownEventRemoved())},enumerable:false,configurable:true});t.applyMarkdown=function(e){var i={didProcess:false};if(t.onProcessMarkdown){t.onProcessMarkdown(e,i)}else if(window.markdownit){var n=window.markdownit;i.outputHtml=n().render(e);i.didProcess=true}else{console.warn(f.Strings.errors.markdownProcessingNotEnabled)}return i};t.prototype.isVersionSupported=function(){if(this.bypassVersionCheck){return true}else{var e=!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major==this.version.major&&this.maxVersion.minor<this.version.minor;return!e}};t.prototype.getDefaultSerializationContext=function(){return new ge(this.version)};t.prototype.getItemsCollectionPropertyName=function(){return"body"};t.prototype.internalParse=function(i,n){this._fallbackCard=undefined;var r=n.parseElement(undefined,i["fallback"],!this.isDesignMode());if(r){this._fallbackCard=new t;this._fallbackCard.addItem(r)}e.prototype.internalParse.call(this,i,n)};t.prototype.internalToJSON=function(i,n){this.setValue(t.versionProperty,n.targetVersion);e.prototype.internalToJSON.call(this,i,n)};t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);if(a.GlobalSettings.useAdvancedCardBottomTruncation&&t){t.style.removeProperty("minHeight")}return t};t.prototype.getHasBackground=function(){return true};t.prototype.getDefaultPadding=function(){return new a.PaddingDefinition(o.Spacing.Padding,o.Spacing.Padding,o.Spacing.Padding,o.Spacing.Padding)};t.prototype.shouldSerialize=function(e){return true};Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return false},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"hasBackground",{get:function(){return true},enumerable:false,configurable:true});t.prototype.getJsonTypeName=function(){return"AdaptiveCard"};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(this.getValue(h.typeNameProperty)!=="AdaptiveCard"){t.addFailure(this,o.ValidationEvent.MissingCardType,f.Strings.errors.invalidCardType())}if(!this.bypassVersionCheck&&!this.version){t.addFailure(this,o.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("version"))}else if(!this.isVersionSupported()){t.addFailure(this,o.ValidationEvent.UnsupportedCardVersion,f.Strings.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString()))}};t.prototype.render=function(t){var i;if(this.shouldFallback()&&this._fallbackCard){this._fallbackCard.hostConfig=this.hostConfig;i=this._fallbackCard.render()}else{i=e.prototype.render.call(this);if(i){i.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard"));if(a.GlobalSettings.setTabIndexAtCardRoot){i.tabIndex=0}if(this.speak){i.setAttribute("aria-label",this.speak)}}}if(t){s.appendChild(t,i);this.updateLayout()}return i};t.prototype.updateLayout=function(t){if(t===void 0){t=true}e.prototype.updateLayout.call(this,t);if(a.GlobalSettings.useAdvancedCardBottomTruncation&&this.isDisplayed()){var i=this.hostConfig.getEffectiveSpacing(o.Spacing.Default);this["handleOverflow"](this.renderedElement.offsetHeight-i)}};t.prototype.shouldFallback=function(){return e.prototype.shouldFallback.call(this)||!this.isVersionSupported()};Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return false},enumerable:false,configurable:true});t.schemaUrl="http://adaptivecards.io/schemas/adaptive-card.json";t.$schemaProperty=new c.CustomProperty(c.Versions.v1_0,"$schema",function(e,i,n,r){return t.schemaUrl},function(e,i,n,r,o){o.serializeValue(n,i.name,t.schemaUrl)});t.versionProperty=new c.CustomProperty(c.Versions.v1_0,"version",function(e,t,i,n){var r=c.Version.parse(i[t.name],n);if(r===undefined){r=c.Versions.latest;n.logParseEvent(e,o.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidCardVersion(r.toString()))}return r},function(e,t,i,n,r){if(n!==undefined){r.serializeValue(i,t.name,n.toString())}},c.Versions.v1_0);t.fallbackTextProperty=new c.StringProperty(c.Versions.v1_0,"fallbackText");t.speakProperty=new c.StringProperty(c.Versions.v1_0,"speak");t.refreshProperty=new c.SerializableObjectProperty(c.Versions.v1_4,"refresh",ue,true);t.authenticationProperty=new c.SerializableObjectProperty(c.Versions.v1_4,"authentication",de,true);r([c.property(t.versionProperty)],t.prototype,"version",void 0);r([c.property(t.fallbackTextProperty)],t.prototype,"fallbackText",void 0);r([c.property(t.speakProperty)],t.prototype,"speak",void 0);r([c.property(t.refreshProperty)],t.prototype,"refresh",null);r([c.property(t.authenticationProperty)],t.prototype,"authentication",void 0);return t}(se);t.AdaptiveCard=fe;var he=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.suppressStyle=false;return t}t.prototype.getSchemaKey=function(){return"InlineAdaptiveCard"};t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t);t.remove(fe.$schemaProperty,fe.versionProperty)};t.prototype.getDefaultPadding=function(){return new a.PaddingDefinition(this.suppressStyle?o.Spacing.None:o.Spacing.Padding,o.Spacing.Padding,this.suppressStyle?o.Spacing.None:o.Spacing.Padding,o.Spacing.Padding)};Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"defaultStyle",{get:function(){if(this.suppressStyle){return o.ContainerStyle.Default}else{return this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:o.ContainerStyle.Emphasis}},enumerable:false,configurable:true});t.prototype.render=function(t){var i=e.prototype.render.call(this,t);if(i){i.setAttribute("aria-live","polite");i.removeAttribute("tabindex")}return i};return t}(fe);var ye=function(){function e(){}e.populateWithDefaultElements=function(e){e.clear();e.register("Container",Z);e.register("TextBlock",m);e.register("RichTextBlock",b,c.Versions.v1_2);e.register("TextRun",v,c.Versions.v1_2);e.register("Image",_);e.register("ImageSet",E);e.register("Media",x,c.Versions.v1_1);e.register("FactSet",S);e.register("ColumnSet",ee);e.register("ActionSet",X,c.Versions.v1_2);e.register("Input.Text",T);e.register("Input.Date",N);e.register("Input.Time",L);e.register("Input.Number",z);e.register("Input.ChoiceSet",k);e.register("Input.Toggle",V)};e.populateWithDefaultActions=function(e){e.clear();e.register(H.JsonTypeName,H);e.register(j.JsonTypeName,j);e.register(G.JsonTypeName,G);e.register(W.JsonTypeName,W,c.Versions.v1_2);e.register(F.JsonTypeName,F,c.Versions.v1_4)};e.reset=function(){e.populateWithDefaultElements(e.elements);e.populateWithDefaultActions(e.actions)};e.elements=new d.CardObjectRegistry;e.actions=new d.CardObjectRegistry;return e}();t.GlobalRegistry=ye;ye.reset();var ge=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.internalParseCardObject=function(e,t,i,n,r,o){var l=undefined;if(t&&typeof t==="object"){var u=s.parseString(t["type"]);if(u){if(i.indexOf(u)>=0){o(u,1)}else{var p=false;l=r(u);if(!l){p=a.GlobalSettings.enableFallback&&n;o(u,0)}else{l.setParent(e);l.parse(t,this);p=a.GlobalSettings.enableFallback&&n&&l.shouldFallback()}if(p){var c=t["fallback"];if(!c&&e){e.setShouldFallback(true)}if(typeof c==="string"&&c.toLowerCase()==="drop"){l=undefined}else if(typeof c==="object"){l=this.internalParseCardObject(e,c,i,true,r,o)}}}}}return l};t.prototype.cardObjectParsed=function(e,t){if(e instanceof D&&this.onParseAction){this.onParseAction(e,t,this)}else if(e instanceof h&&this.onParseElement){this.onParseElement(e,t,this)}};t.prototype.shouldSerialize=function(e){if(e instanceof D){return this.actionRegistry.findByName(e.getJsonTypeName())!==undefined}else if(e instanceof h){return this.elementRegistry.findByName(e.getJsonTypeName())!==undefined}else{return true}};t.prototype.parseCardObject=function(e,t,i,n,r,o){var a=this.internalParseCardObject(e,t,i,n,r,o);if(a!==undefined){this.cardObjectParsed(a,t)}return a};t.prototype.parseElement=function(e,t,i){var n=this;return this.parseCardObject(e,t,[],i,function(e){return n.elementRegistry.createInstance(e,n.targetVersion)},function(e,t){if(t===0){n.logParseEvent(undefined,o.ValidationEvent.UnknownElementType,f.Strings.errors.unknownElementType(e))}else{n.logParseEvent(undefined,o.ValidationEvent.ElementTypeNotAllowed,f.Strings.errors.elementTypeNotAllowed(e))}})};t.prototype.parseAction=function(e,t,i,n){var r=this;return this.parseCardObject(e,t,i,n,function(e){return r.actionRegistry.createInstance(e,r.targetVersion)},function(e,t){if(t==0){r.logParseEvent(undefined,o.ValidationEvent.UnknownActionType,f.Strings.errors.unknownActionType(e))}else{r.logParseEvent(undefined,o.ValidationEvent.ActionTypeNotAllowed,f.Strings.errors.actionTypeNotAllowed(e))}})};Object.defineProperty(t.prototype,"elementRegistry",{get:function(){return this._elementRegistry?this._elementRegistry:ye.elements},enumerable:false,configurable:true});t.prototype.setElementRegistry=function(e){this._elementRegistry=e};Object.defineProperty(t.prototype,"actionRegistry",{get:function(){return this._actionRegistry?this._actionRegistry:ye.actions},enumerable:false,configurable:true});t.prototype.setActionRegistry=function(e){this._actionRegistry=e};return t}(c.BaseSerializationContext);t.SerializationContext=ge},"./src/card-object.ts":function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return e(t,i)};return function(t,i){e(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();var r=this&&this.__decorate||function(e,t,i,n){var r=arguments.length,o=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,i):n,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)if(a=e[s])o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o;return r>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(t,"__esModule",{value:true});t.CardObject=t.ValidationResults=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var o=i("./src/enums.ts");var a=i("./src/strings.ts");var s=i("./src/shared.ts");var l=i("./src/host-capabilities.ts");var u=i("./src/serialization.ts");var p=function(){function e(){this.allIds={};this.validationEvents=[]}e.prototype.addFailure=function(e,t,i){this.validationEvents.push({phase:o.ValidationPhase.Validation,source:e,event:t,message:i})};return e}();t.ValidationResults=p;var c=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._shouldFallback=false;return t}t.prototype.getSchemaKey=function(){return this.getJsonTypeName()};Object.defineProperty(t.prototype,"requires",{get:function(){return this.getValue(t.requiresProperty)},enumerable:false,configurable:true});t.prototype.contains=function(e){if(this._renderedElement){return this._renderedElement.contains(e)}return false};t.prototype.preProcessPropertyValue=function(e,t){var i=t===undefined?this.getValue(e):t;if(s.GlobalSettings.allowPreProcessingPropertyValues){var n=this;while(n&&!n.onPreProcessPropertyValue){n=n.parent}if(n&&n.onPreProcessPropertyValue){return n.onPreProcessPropertyValue(this,e,i)}}return i};t.prototype.setParent=function(e){this._parent=e};t.prototype.setShouldFallback=function(e){this._shouldFallback=e};t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)};t.prototype.getRootObject=function(){var e=this;while(e.parent){e=e.parent}return e};t.prototype.internalValidateProperties=function(e){if(this.id){if(e.allIds.hasOwnProperty(this.id)){if(e.allIds[this.id]==1){e.addFailure(this,o.ValidationEvent.DuplicateId,a.Strings.errors.duplicateId(this.id))}e.allIds[this.id]+=1}else{e.allIds[this.id]=1}}};t.prototype.validateProperties=function(){var e=new p;this.internalValidateProperties(e);return e};t.prototype.findDOMNodeOwner=function(e){return this.contains(e)?this:undefined};Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:false,configurable:true});t.typeNameProperty=new u.StringProperty(u.Versions.v1_0,"type",undefined,undefined,undefined,function(e){return e.getJsonTypeName()});t.idProperty=new u.StringProperty(u.Versions.v1_0,"id");t.requiresProperty=new u.SerializableObjectProperty(u.Versions.v1_2,"requires",l.HostCapabilities,false,new l.HostCapabilities);r([u.property(t.idProperty)],t.prototype,"id",void 0);r([u.property(t.requiresProperty)],t.prototype,"requires",null);return t}(u.SerializableObject);t.CardObject=c},"./src/channel-adapter.ts":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ChannelAdapter=void 0;var n=function(){function e(){}return e}();t.ChannelAdapter=n},"./src/enums.ts":function(e,t,i){"use strict";
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
Object.defineProperty(t,"__esModule",{value:true});t.LogLevel=t.RefreshMode=t.ContainerFitStatus=t.ValidationEvent=t.ValidationPhase=t.ContainerStyle=t.InputTextStyle=t.ActionIconPlacement=t.FillMode=t.Orientation=t.ShowCardActionMode=t.ImageStyle=t.ActionAlignment=t.VerticalAlignment=t.HorizontalAlignment=t.TextColor=t.Spacing=t.FontType=t.TextWeight=t.TextSize=t.SizeUnit=t.ImageSize=t.Size=t.ActionStyle=void 0;var n=function(){function e(){}e.Default="default";e.Positive="positive";e.Destructive="destructive";return e}();t.ActionStyle=n;var r;(function(e){e[e["Auto"]=0]="Auto";e[e["Stretch"]=1]="Stretch";e[e["Small"]=2]="Small";e[e["Medium"]=3]="Medium";e[e["Large"]=4]="Large"})(r=t.Size||(t.Size={}));var o;(function(e){e[e["Small"]=0]="Small";e[e["Medium"]=1]="Medium";e[e["Large"]=2]="Large"})(o=t.ImageSize||(t.ImageSize={}));var a;(function(e){e[e["Weight"]=0]="Weight";e[e["Pixel"]=1]="Pixel"})(a=t.SizeUnit||(t.SizeUnit={}));var s;(function(e){e[e["Small"]=0]="Small";e[e["Default"]=1]="Default";e[e["Medium"]=2]="Medium";e[e["Large"]=3]="Large";e[e["ExtraLarge"]=4]="ExtraLarge"})(s=t.TextSize||(t.TextSize={}));var l;(function(e){e[e["Lighter"]=0]="Lighter";e[e["Default"]=1]="Default";e[e["Bolder"]=2]="Bolder"})(l=t.TextWeight||(t.TextWeight={}));var u;(function(e){e[e["Default"]=0]="Default";e[e["Monospace"]=1]="Monospace"})(u=t.FontType||(t.FontType={}));var p;(function(e){e[e["None"]=0]="None";e[e["Small"]=1]="Small";e[e["Default"]=2]="Default";e[e["Medium"]=3]="Medium";e[e["Large"]=4]="Large";e[e["ExtraLarge"]=5]="ExtraLarge";e[e["Padding"]=6]="Padding"})(p=t.Spacing||(t.Spacing={}));var c;(function(e){e[e["Default"]=0]="Default";e[e["Dark"]=1]="Dark";e[e["Light"]=2]="Light";e[e["Accent"]=3]="Accent";e[e["Good"]=4]="Good";e[e["Warning"]=5]="Warning";e[e["Attention"]=6]="Attention"})(c=t.TextColor||(t.TextColor={}));var d;(function(e){e[e["Left"]=0]="Left";e[e["Center"]=1]="Center";e[e["Right"]=2]="Right"})(d=t.HorizontalAlignment||(t.HorizontalAlignment={}));var f;(function(e){e[e["Top"]=0]="Top";e[e["Center"]=1]="Center";e[e["Bottom"]=2]="Bottom"})(f=t.VerticalAlignment||(t.VerticalAlignment={}));var h;(function(e){e[e["Left"]=0]="Left";e[e["Center"]=1]="Center";e[e["Right"]=2]="Right";e[e["Stretch"]=3]="Stretch"})(h=t.ActionAlignment||(t.ActionAlignment={}));var y;(function(e){e[e["Default"]=0]="Default";e[e["Person"]=1]="Person"})(y=t.ImageStyle||(t.ImageStyle={}));var g;(function(e){e[e["Inline"]=0]="Inline";e[e["Popup"]=1]="Popup"})(g=t.ShowCardActionMode||(t.ShowCardActionMode={}));var m;(function(e){e[e["Horizontal"]=0]="Horizontal";e[e["Vertical"]=1]="Vertical"})(m=t.Orientation||(t.Orientation={}));var v;(function(e){e[e["Cover"]=0]="Cover";e[e["RepeatHorizontally"]=1]="RepeatHorizontally";e[e["RepeatVertically"]=2]="RepeatVertically";e[e["Repeat"]=3]="Repeat"})(v=t.FillMode||(t.FillMode={}));var b;(function(e){e[e["LeftOfTitle"]=0]="LeftOfTitle";e[e["AboveTitle"]=1]="AboveTitle"})(b=t.ActionIconPlacement||(t.ActionIconPlacement={}));var C;(function(e){e[e["Text"]=0]="Text";e[e["Tel"]=1]="Tel";e[e["Url"]=2]="Url";e[e["Email"]=3]="Email"})(C=t.InputTextStyle||(t.InputTextStyle={}));var S=function(){function e(){}e.Default="default";e.Emphasis="emphasis";e.Accent="accent";e.Good="good";e.Attention="attention";e.Warning="warning";return e}();t.ContainerStyle=S;var P;(function(e){e[e["Parse"]=0]="Parse";e[e["ToJSON"]=1]="ToJSON";e[e["Validation"]=2]="Validation"})(P=t.ValidationPhase||(t.ValidationPhase={}));var _;(function(e){e[e["Hint"]=0]="Hint";e[e["ActionTypeNotAllowed"]=1]="ActionTypeNotAllowed";e[e["CollectionCantBeEmpty"]=2]="CollectionCantBeEmpty";e[e["Deprecated"]=3]="Deprecated";e[e["ElementTypeNotAllowed"]=4]="ElementTypeNotAllowed";e[e["InteractivityNotAllowed"]=5]="InteractivityNotAllowed";e[e["InvalidPropertyValue"]=6]="InvalidPropertyValue";e[e["MissingCardType"]=7]="MissingCardType";e[e["PropertyCantBeNull"]=8]="PropertyCantBeNull";e[e["TooManyActions"]=9]="TooManyActions";e[e["UnknownActionType"]=10]="UnknownActionType";e[e["UnknownElementType"]=11]="UnknownElementType";e[e["UnsupportedCardVersion"]=12]="UnsupportedCardVersion";e[e["DuplicateId"]=13]="DuplicateId";e[e["UnsupportedProperty"]=14]="UnsupportedProperty";e[e["RequiredInputsShouldHaveLabel"]=15]="RequiredInputsShouldHaveLabel";e[e["RequiredInputsShouldHaveErrorMessage"]=16]="RequiredInputsShouldHaveErrorMessage";e[e["Other"]=17]="Other"})(_=t.ValidationEvent||(t.ValidationEvent={}));var A;(function(e){e[e["FullyInContainer"]=0]="FullyInContainer";e[e["Overflowing"]=1]="Overflowing";e[e["FullyOutOfContainer"]=2]="FullyOutOfContainer"})(A=t.ContainerFitStatus||(t.ContainerFitStatus={}));var E;(function(e){e[e["Disabled"]=0]="Disabled";e[e["Manual"]=1]="Manual";e[e["Automatic"]=2]="Automatic"})(E=t.RefreshMode||(t.RefreshMode={}));var w;(function(e){e[e["Info"]=0]="Info";e[e["Warning"]=1]="Warning";e[e["Error"]=2]="Error"})(w=t.LogLevel||(t.LogLevel={}))},"./src/host-capabilities.ts":function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return e(t,i)};return function(t,i){e(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:true});t.HostCapabilities=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var r=i("./src/serialization.ts");var o=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._capabilities={};return t}t.prototype.getSchemaKey=function(){return"HostCapabilities"};t.prototype.internalParse=function(t,i){e.prototype.internalParse.call(this,t,i);if(t){for(var n in t){var o=t[n];if(typeof o==="string"){if(o=="*"){this.addCapability(n,"*")}else{var a=r.Version.parse(o,i);if(a&&a.isValid){this.addCapability(n,a)}}}}}};t.prototype.internalToJSON=function(t,i){e.prototype.internalToJSON.call(this,t,i);for(var n in this._capabilities){t[n]=this._capabilities[n]}};t.prototype.addCapability=function(e,t){this._capabilities[e]=t};t.prototype.removeCapability=function(e){delete this._capabilities[e]};t.prototype.clear=function(){this._capabilities={}};t.prototype.hasCapability=function(e,t){if(this._capabilities.hasOwnProperty(e)){if(t=="*"||this._capabilities[e]=="*"){return true}return t.compareTo(this._capabilities[e])<=0}return false};t.prototype.areAllMet=function(e){for(var t in this._capabilities){if(!e.hasCapability(t,this._capabilities[t])){return false}}return true};return t}(r.SerializableObject);t.HostCapabilities=o},"./src/host-config.ts":function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return e(t,i)};return function(t,i){e(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:true});t.defaultHostConfig=t.HostConfig=t.FontTypeSet=t.FontTypeDefinition=t.ContainerStyleSet=t.ContainerStyleDefinition=t.ColorSetDefinition=t.ActionsConfig=t.ShowCardActionConfig=t.FactSetConfig=t.FactTitleDefinition=t.FactTextDefinition=t.InputConfig=t.InputLabelConfig=t.RequiredInputLabelTextDefinition=t.BaseTextDefinition=t.MediaConfig=t.ImageSetConfig=t.AdaptiveCardConfig=t.TextColorDefinition=t.ColorDefinition=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var r=i("./src/enums.ts");var o=i("./src/utils.ts");var a=i("./src/shared.ts");var s=i("./src/host-capabilities.ts");function l(e,t,i){if(typeof t==="string"){var n=o.parseEnum(e,t,i);return n!==undefined?n:i}else if(typeof t==="number"){return t}else{return i}}var u=function(){function e(e,t){this.default="#000000";this.subtle="#666666";if(e){this.default=e}if(t){this.subtle=t}}e.prototype.parse=function(e){if(e){this.default=e["default"]||this.default;this.subtle=e["subtle"]||this.subtle}};return e}();t.ColorDefinition=u;var p=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.highlightColors=new u("#22000000","#11000000");return t}t.prototype.parse=function(t){e.prototype.parse.call(this,t);if(t){this.highlightColors.parse(t["highlightColors"])}};return t}(u);t.TextColorDefinition=p;var c=function(){function e(e){this.allowCustomStyle=false;if(e){this.allowCustomStyle=e["allowCustomStyle"]||this.allowCustomStyle}}return e}();t.AdaptiveCardConfig=c;var d=function(){function e(e){this.imageSize=r.Size.Medium;this.maxImageHeight=100;if(e){this.imageSize=e["imageSize"]!=null?e["imageSize"]:this.imageSize;this.maxImageHeight=o.parseNumber(e["maxImageHeight"],100)}}e.prototype.toJSON=function(){return{imageSize:r.Size[this.imageSize],maxImageHeight:this.maxImageHeight}};return e}();t.ImageSetConfig=d;var f=function(){function e(e){this.allowInlinePlayback=true;if(e){this.defaultPoster=e["defaultPoster"];this.allowInlinePlayback=e["allowInlinePlayback"]||this.allowInlinePlayback}}e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}};return e}();t.MediaConfig=f;var h=function(){function e(e){this.size=r.TextSize.Default;this.color=r.TextColor.Default;this.isSubtle=false;this.weight=r.TextWeight.Default;if(e){this.size=l(r.TextSize,e["size"],this.size);this.color=l(r.TextColor,e["color"],this.color);this.isSubtle=e["isSubtle"]||this.isSubtle;this.weight=l(r.TextWeight,e["weight"],this.getDefaultWeight())}}e.prototype.getDefaultWeight=function(){return r.TextWeight.Default};e.prototype.toJSON=function(){return{size:r.TextSize[this.size],color:r.TextColor[this.color],isSubtle:this.isSubtle,weight:r.TextWeight[this.weight]}};return e}();t.BaseTextDefinition=h;var y=function(e){n(t,e);function t(t){var i=e.call(this,t)||this;i.suffix=" *";i.suffixColor=r.TextColor.Attention;if(t){i.suffix=t["suffix"]||i.suffix;i.suffixColor=l(r.TextColor,t["suffixColor"],i.suffixColor)}return i}t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);t["suffix"]=this.suffix;t["suffixColor"]=r.TextColor[this.suffixColor];return t};return t}(h);t.RequiredInputLabelTextDefinition=y;var g=function(){function e(e){this.inputSpacing=r.Spacing.Small;this.requiredInputs=new y;this.optionalInputs=new h;if(e){this.inputSpacing=l(r.Spacing,e["inputSpacing"],this.inputSpacing);this.requiredInputs=new y(e["requiredInputs"]);this.optionalInputs=new h(e["optionalInputs"])}}return e}();t.InputLabelConfig=g;var m=function(){function e(e){this.label=new g;this.errorMessage=new h({color:r.TextColor.Attention});if(e){this.label=new g(e["label"]);this.errorMessage=new h(e["errorMessage"])}}return e}();t.InputConfig=m;var v=function(e){n(t,e);function t(t){var i=e.call(this,t)||this;i.wrap=true;if(t){i.wrap=t["wrap"]!=null?t["wrap"]:i.wrap}return i}t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);t["wrap"]=this.wrap;return t};return t}(h);t.FactTextDefinition=v;var b=function(e){n(t,e);function t(t){var i=e.call(this,t)||this;i.maxWidth=150;i.weight=r.TextWeight.Bolder;if(t){i.maxWidth=t["maxWidth"]!=null?t["maxWidth"]:i.maxWidth;i.weight=l(r.TextWeight,t["weight"],r.TextWeight.Bolder)}return i}t.prototype.getDefaultWeight=function(){return r.TextWeight.Bolder};return t}(v);t.FactTitleDefinition=b;var C=function(){function e(e){this.title=new b;this.value=new v;this.spacing=10;if(e){this.title=new b(e["title"]);this.value=new v(e["value"]);this.spacing=e.spacing&&e.spacing!=null?e.spacing&&e.spacing:this.spacing}}return e}();t.FactSetConfig=C;var S=function(){function e(e){this.actionMode=r.ShowCardActionMode.Inline;this.inlineTopMargin=16;this.style=r.ContainerStyle.Emphasis;if(e){this.actionMode=l(r.ShowCardActionMode,e["actionMode"],r.ShowCardActionMode.Inline);this.inlineTopMargin=e["inlineTopMargin"]!=null?e["inlineTopMargin"]:this.inlineTopMargin;this.style=e["style"]&&typeof e["style"]==="string"?e["style"]:r.ContainerStyle.Emphasis}}e.prototype.toJSON=function(){return{actionMode:r.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}};return e}();t.ShowCardActionConfig=S;var P=function(){function e(e){this.maxActions=5;this.spacing=r.Spacing.Default;this.buttonSpacing=20;this.showCard=new S;this.preExpandSingleShowCardAction=false;this.actionsOrientation=r.Orientation.Horizontal;this.actionAlignment=r.ActionAlignment.Left;this.iconPlacement=r.ActionIconPlacement.LeftOfTitle;this.allowTitleToWrap=false;this.iconSize=16;if(e){this.maxActions=e["maxActions"]!=null?e["maxActions"]:this.maxActions;this.spacing=l(r.Spacing,e.spacing&&e.spacing,r.Spacing.Default);this.buttonSpacing=e["buttonSpacing"]!=null?e["buttonSpacing"]:this.buttonSpacing;this.showCard=new S(e["showCard"]);this.preExpandSingleShowCardAction=o.parseBool(e["preExpandSingleShowCardAction"],false);this.actionsOrientation=l(r.Orientation,e["actionsOrientation"],r.Orientation.Horizontal);this.actionAlignment=l(r.ActionAlignment,e["actionAlignment"],r.ActionAlignment.Left);this.iconPlacement=l(r.ActionIconPlacement,e["iconPlacement"],r.ActionIconPlacement.LeftOfTitle);this.allowTitleToWrap=e["allowTitleToWrap"]!=null?e["allowTitleToWrap"]:this.allowTitleToWrap;try{var t=a.SizeAndUnit.parse(e["iconSize"]);if(t.unit==r.SizeUnit.Pixel){this.iconSize=t.physicalSize}}catch(e){}}}e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:r.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:r.Orientation[this.actionsOrientation],actionAlignment:r.ActionAlignment[this.actionAlignment]}};return e}();t.ActionsConfig=P;var _=function(){function e(e){this.default=new p;this.dark=new p;this.light=new p;this.accent=new p;this.good=new p;this.warning=new p;this.attention=new p;this.parse(e)}e.prototype.parseSingleColor=function(e,t){if(e){this[t].parse(e[t])}};e.prototype.parse=function(e){if(e){this.parseSingleColor(e,"default");this.parseSingleColor(e,"dark");this.parseSingleColor(e,"light");this.parseSingleColor(e,"accent");this.parseSingleColor(e,"good");this.parseSingleColor(e,"warning");this.parseSingleColor(e,"attention")}};return e}();t.ColorSetDefinition=_;var A=function(){function e(e){this.foregroundColors=new _({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}});this.parse(e)}e.prototype.parse=function(e){if(e){this.backgroundColor=e["backgroundColor"];this.foregroundColors.parse(e["foregroundColors"]);this.highlightBackgroundColor=e["highlightBackgroundColor"];this.highlightForegroundColor=e["highlightForegroundColor"]}};Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return false},enumerable:false,configurable:true});return e}();t.ContainerStyleDefinition=A;var E=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return true},enumerable:false,configurable:true});return t}(A);var w=function(){function e(e){this._allStyles={};this._allStyles[r.ContainerStyle.Default]=new E;this._allStyles[r.ContainerStyle.Emphasis]=new E;this._allStyles[r.ContainerStyle.Accent]=new E;this._allStyles[r.ContainerStyle.Good]=new E;this._allStyles[r.ContainerStyle.Attention]=new E;this._allStyles[r.ContainerStyle.Warning]=new E;if(e){this._allStyles[r.ContainerStyle.Default].parse(e[r.ContainerStyle.Default]);this._allStyles[r.ContainerStyle.Emphasis].parse(e[r.ContainerStyle.Emphasis]);this._allStyles[r.ContainerStyle.Accent].parse(e[r.ContainerStyle.Accent]);this._allStyles[r.ContainerStyle.Good].parse(e[r.ContainerStyle.Good]);this._allStyles[r.ContainerStyle.Attention].parse(e[r.ContainerStyle.Attention]);this._allStyles[r.ContainerStyle.Warning].parse(e[r.ContainerStyle.Warning]);var t=e["customStyles"];if(t&&Array.isArray(t)){for(var i=0,n=t;i<n.length;i++){var o=n[i];if(o){var a=o["name"];if(a&&typeof a==="string"){if(this._allStyles.hasOwnProperty(a)){this._allStyles[a].parse(o["style"])}else{this._allStyles[a]=new A(o["style"])}}}}}}}e.prototype.toJSON=function(){var e=this;var t=[];Object.keys(this._allStyles).forEach(function(i){if(!e._allStyles[i].isBuiltIn){t.push({name:i,style:e._allStyles[i]})}});var i={default:this.default,emphasis:this.emphasis};if(t.length>0){i.customStyles=t}return i};e.prototype.getStyleByName=function(e,t){if(e&&this._allStyles.hasOwnProperty(e)){return this._allStyles[e]}else{return t?t:this._allStyles[r.ContainerStyle.Default]}};Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[r.ContainerStyle.Default]},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[r.ContainerStyle.Emphasis]},enumerable:false,configurable:true});return e}();t.ContainerStyleSet=w;var x=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif";this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26};this.fontWeights={lighter:200,default:400,bolder:600};if(e){this.fontFamily=e}}e.prototype.parse=function(e){this.fontFamily=e["fontFamily"]||this.fontFamily;this.fontSizes={small:e.fontSizes&&e.fontSizes["small"]||this.fontSizes.small,default:e.fontSizes&&e.fontSizes["default"]||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes["medium"]||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes["large"]||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes["extraLarge"]||this.fontSizes.extraLarge};this.fontWeights={lighter:e.fontWeights&&e.fontWeights["lighter"]||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights["default"]||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights["bolder"]||this.fontWeights.bolder}};e.monospace=new e("'Courier New', Courier, monospace");return e}();t.FontTypeDefinition=x;var I=function(){function e(e){this.default=new x;this.monospace=new x("'Courier New', Courier, monospace");if(e){this.default.parse(e["default"]);this.monospace.parse(e["monospace"])}}e.prototype.getStyleDefinition=function(e){switch(e){case r.FontType.Monospace:return this.monospace;case r.FontType.Default:default:return this.default}};return e}();t.FontTypeSet=I;var T=function(){function e(e){this.hostCapabilities=new s.HostCapabilities;this.choiceSetInputValueSeparator=",";this.supportsInteractivity=true;this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15};this.separator={lineThickness:1,lineColor:"#EEEEEE"};this.imageSizes={small:40,medium:80,large:160};this.containerStyles=new w;this.inputs=new m;this.actions=new P;this.adaptiveCard=new c;this.imageSet=new d;this.media=new f;this.factSet=new C;this.alwaysAllowBleed=false;if(e){if(typeof e==="string"||e instanceof String){e=JSON.parse(e)}this.choiceSetInputValueSeparator=e&&typeof e["choiceSetInputValueSeparator"]==="string"?e["choiceSetInputValueSeparator"]:this.choiceSetInputValueSeparator;this.supportsInteractivity=e&&typeof e["supportsInteractivity"]==="boolean"?e["supportsInteractivity"]:this.supportsInteractivity;this._legacyFontType=new x;this._legacyFontType.parse(e);if(e.fontTypes){this.fontTypes=new I(e.fontTypes)}if(e.lineHeights){this.lineHeights={small:e.lineHeights["small"],default:e.lineHeights["default"],medium:e.lineHeights["medium"],large:e.lineHeights["large"],extraLarge:e.lineHeights["extraLarge"]}}this.imageSizes={small:e.imageSizes&&e.imageSizes["small"]||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes["medium"]||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes["large"]||this.imageSizes.large};this.containerStyles=new w(e["containerStyles"]);this.spacing={small:e.spacing&&e.spacing["small"]||this.spacing.small,default:e.spacing&&e.spacing["default"]||this.spacing.default,medium:e.spacing&&e.spacing["medium"]||this.spacing.medium,large:e.spacing&&e.spacing["large"]||this.spacing.large,extraLarge:e.spacing&&e.spacing["extraLarge"]||this.spacing.extraLarge,padding:e.spacing&&e.spacing["padding"]||this.spacing.padding};this.separator={lineThickness:e.separator&&e.separator["lineThickness"]||this.separator.lineThickness,lineColor:e.separator&&e.separator["lineColor"]||this.separator.lineColor};this.inputs=new m(e.inputs||this.inputs);this.actions=new P(e.actions||this.actions);this.adaptiveCard=new c(e.adaptiveCard||this.adaptiveCard);this.imageSet=new d(e["imageSet"]);this.factSet=new C(e["factSet"])}}e.prototype.getFontTypeDefinition=function(e){if(this.fontTypes){return this.fontTypes.getStyleDefinition(e)}else{return e==r.FontType.Monospace?x.monospace:this._legacyFontType}};e.prototype.getEffectiveSpacing=function(e){switch(e){case r.Spacing.Small:return this.spacing.small;case r.Spacing.Default:return this.spacing.default;case r.Spacing.Medium:return this.spacing.medium;case r.Spacing.Large:return this.spacing.large;case r.Spacing.ExtraLarge:return this.spacing.extraLarge;case r.Spacing.Padding:return this.spacing.padding;default:return 0}};e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new a.SpacingDefinition(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))};e.prototype.makeCssClassNames=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var i=[];for(var n=0,r=e;n<r.length;n++){var o=r[n];i.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+o)}return i};e.prototype.makeCssClassName=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var i=this.makeCssClassNames.apply(this,e).join(" ");return i?i:""};Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:false,configurable:true});return e}();t.HostConfig=T;t.defaultHostConfig=new T({supportsInteractivity:true,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},inputs:{label:{requiredInputs:{color:r.TextColor.Accent,size:r.TextSize.ExtraLarge,weight:r.TextWeight.Bolder,isSubtle:true,suffix:" (required)",suffixColor:r.TextColor.Good},optionalInputs:{color:r.TextColor.Warning,size:r.TextSize.Medium,weight:r.TextWeight.Lighter,isSubtle:false}},errorMessage:{color:r.TextColor.Accent,size:r.TextSize.Small,weight:r.TextWeight.Bolder}},actions:{maxActions:5,spacing:r.Spacing.Default,buttonSpacing:10,showCard:{actionMode:r.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:r.Orientation.Horizontal,actionAlignment:r.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:false},imageSet:{imageSize:r.Size.Medium,maxImageHeight:100},factSet:{title:{color:r.TextColor.Default,size:r.TextSize.Default,isSubtle:false,weight:r.TextWeight.Bolder,wrap:true,maxWidth:150},value:{color:r.TextColor.Default,size:r.TextSize.Default,isSubtle:false,weight:r.TextWeight.Default,wrap:true},spacing:10}})},"./src/registry.ts":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CardObjectRegistry=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var n=i("./src/serialization.ts");var r=function(){function e(){this._items={}}e.prototype.findByName=function(e){return this._items.hasOwnProperty(e)?this._items[e]:undefined};e.prototype.clear=function(){this._items={}};e.prototype.register=function(e,t,i){if(i===void 0){i=n.Versions.v1_0}var r=this.findByName(e);if(r!==undefined){r.objectType=t}else{r={typeName:e,objectType:t,schemaVersion:i}}this._items[e]=r};e.prototype.unregister=function(e){delete this._items[e]};e.prototype.createInstance=function(e,t){var i=this.findByName(e);return i&&i.schemaVersion.compareTo(t)<=0?new i.objectType:undefined};e.prototype.getItemCount=function(){return Object.keys(this._items).length};e.prototype.getItemAt=function(e){var t=this;return Object.keys(this._items).map(function(e){return t._items[e]})[e]};return e}();t.CardObjectRegistry=r},"./src/serialization.ts":function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return e(t,i)};return function(t,i){e(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:true});t.SerializableObject=t.property=t.SerializableObjectSchema=t.CustomProperty=t.SerializableObjectCollectionProperty=t.SerializableObjectProperty=t.EnumProperty=t.ValueSetProperty=t.StringArrayProperty=t.PixelSizeProperty=t.NumProperty=t.BoolProperty=t.StringProperty=t.PropertyDefinition=t.BaseSerializationContext=t.isVersionLessOrEqual=t.Versions=t.Version=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var r=i("./src/shared.ts");var o=i("./src/utils.ts");var a=i("./src/enums.ts");var s=i("./src/strings.ts");var l=function(){function e(e,t,i){if(e===void 0){e=1}if(t===void 0){t=1}this._isValid=true;this._major=e;this._minor=t;this._label=i}e.parse=function(t,i){if(!t){return undefined}var n=new e;n._versionString=t;var r=/(\d+).(\d+)/gi;var o=r.exec(t);if(o!=null&&o.length==3){n._major=parseInt(o[1]);n._minor=parseInt(o[2])}else{n._isValid=false}if(!n._isValid){i.logParseEvent(undefined,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidVersionString(n._versionString))}return n};e.prototype.toString=function(){return!this._isValid?this._versionString:this._major+"."+this._minor};e.prototype.toJSON=function(){return this.toString()};e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid){throw new Error("Cannot compare invalid version.")}if(this.major>e.major){return 1}else if(this.major<e.major){return-1}else if(this.minor>e.minor){return 1}else if(this.minor<e.minor){return-1}return 0};Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:false,configurable:true});return e}();t.Version=l;var u=function(){function e(){}e.v1_0=new l(1,0);e.v1_1=new l(1,1);e.v1_2=new l(1,2);e.v1_3=new l(1,3);e.v1_4=new l(1,4);e.latest=e.v1_4;return e}();t.Versions=u;function p(e,t){if(e instanceof l){if(t instanceof l){return t.compareTo(e)>=0}else{return true}}else{return true}}t.isVersionLessOrEqual=p;var c=function(){function e(e){if(e===void 0){e=u.latest}this.targetVersion=e;this._validationEvents=[]}e.prototype.serializeValue=function(e,t,i,n,o){if(n===void 0){n=undefined}if(o===void 0){o=false}if(i===null||i===undefined||i===n){if(!r.GlobalSettings.enableFullJsonRoundTrip||o){delete e[t]}}else{e[t]=i}};e.prototype.serializeString=function(e,t,i,n){if(i===null||i===undefined||i===n){delete e[t]}else{e[t]=i}};e.prototype.serializeBool=function(e,t,i,n){if(i===null||i===undefined||i===n){delete e[t]}else{e[t]=i}};e.prototype.serializeNumber=function(e,t,i,n){if(i===null||i===undefined||i===n||isNaN(i)){delete e[t]}else{e[t]=i}};e.prototype.serializeEnum=function(e,t,i,n,r){if(r===void 0){r=undefined}var o=t[i];var a=o==undefined?true:e[o]!==undefined;if(n==r){if(a){delete t[i]}}else{if(n==undefined){if(a){delete t[i]}}else{t[i]=e[n]}}};e.prototype.serializeArray=function(e,t,i){var n=[];if(i){for(var r=0,o=i;r<o.length;r++){var a=o[r];var s=undefined;if(a instanceof w){s=a.toJSON(this)}else if(a.toJSON){s=a.toJSON()}else{s=a}if(s!==undefined){n.push(s)}}}if(n.length==0){if(e.hasOwnProperty(t)&&Array.isArray(e[t])){delete e[t]}}else{this.serializeValue(e,t,n)}};e.prototype.clearEvents=function(){this._validationEvents=[]};e.prototype.logEvent=function(e,t,i,n){this._validationEvents.push({source:e,phase:t,event:i,message:n})};e.prototype.logParseEvent=function(e,t,i){this.logEvent(e,a.ValidationPhase.Parse,t,i)};e.prototype.getEventAt=function(e){return this._validationEvents[e]};Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:false,configurable:true});return e}();t.BaseSerializationContext=c;var d=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(c);var f=function(){function e(t,i,n,r){this.targetVersion=t;this.name=i;this.defaultValue=n;this.onGetInitialValue=r;this.isSerializationEnabled=true;this.sequentialNumber=e._sequentialNumber;e._sequentialNumber++}e.prototype.getInternalName=function(){return this.name};e.prototype.parse=function(e,t,i){return t[this.name]};e.prototype.toJSON=function(e,t,i,n){n.serializeValue(t,this.name,i,this.defaultValue)};e._sequentialNumber=0;return e}();t.PropertyDefinition=f;var h=function(e){n(t,e);function t(t,i,n,r,o,a){if(n===void 0){n=true}var s=e.call(this,t,i,o,a)||this;s.targetVersion=t;s.name=i;s.treatEmptyAsUndefined=n;s.regEx=r;s.defaultValue=o;s.onGetInitialValue=a;return s}t.prototype.parse=function(e,t,i){var n=o.parseString(t[this.name],this.defaultValue);var r=n===undefined||n===""&&this.treatEmptyAsUndefined;if(!r&&this.regEx!==undefined){var l=this.regEx.exec(n);if(!l){i.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(n,this.name));return undefined}}return n};t.prototype.toJSON=function(e,t,i,n){n.serializeString(t,this.name,i===""&&this.treatEmptyAsUndefined?undefined:i,this.defaultValue)};return t}(f);t.StringProperty=h;var y=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.parse=function(e,t,i){return o.parseBool(t[this.name],this.defaultValue)};t.prototype.toJSON=function(e,t,i,n){n.serializeBool(t,this.name,i,this.defaultValue)};return t}(f);t.BoolProperty=y;var g=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.parse=function(e,t,i){return o.parseNumber(t[this.name],this.defaultValue)};t.prototype.toJSON=function(e,t,i,n){n.serializeNumber(t,this.name,i,this.defaultValue)};return t}(f);t.NumProperty=g;var m=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.parse=function(e,t,i){var n=undefined;var o=t[this.name];if(typeof o==="string"){var l=false;try{var u=r.SizeAndUnit.parse(o,true);if(u.unit==a.SizeUnit.Pixel){n=u.physicalSize;l=true}}catch(e){}if(!l){i.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(t[this.name],"minHeight"))}}return n};t.prototype.toJSON=function(e,t,i,n){n.serializeValue(t,this.name,typeof i==="number"&&!isNaN(i)?i+"px":undefined)};return t}(f);t.PixelSizeProperty=m;var v=function(e){n(t,e);function t(t,i,n,r){var o=e.call(this,t,i,n,r)||this;o.targetVersion=t;o.name=i;o.defaultValue=n;o.onGetInitialValue=r;return o}t.prototype.parse=function(e,t,i){var n=t[this.name];if(n===undefined||!Array.isArray(n)){return this.defaultValue}var r=[];for(var o=0,s=n;o<s.length;o++){var l=s[o];if(typeof l==="string"){r.push(l)}else{i.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,'Invalid array value "'+l+'" of type "'+typeof l+'" ignored for "'+this.name+'".')}}return r};t.prototype.toJSON=function(e,t,i,n){n.serializeArray(t,this.name,i)};return t}(f);t.StringArrayProperty=v;var b=function(e){n(t,e);function t(t,i,n,r,o){var a=e.call(this,t,i,r,o)||this;a.targetVersion=t;a.name=i;a.values=n;a.defaultValue=r;a.onGetInitialValue=o;return a}t.prototype.isValidValue=function(e,t){for(var i=0,n=this.values;i<n.length;i++){var r=n[i];if(e.toLowerCase()===r.value.toLowerCase()){var o=r.targetVersion?r.targetVersion:this.targetVersion;return o.compareTo(t.targetVersion)<=0}}return false};t.prototype.parse=function(e,t,i){var n=t[this.name];if(n===undefined){return this.defaultValue}if(typeof n==="string"){for(var r=0,o=this.values;r<o.length;r++){var l=o[r];if(n.toLowerCase()===l.value.toLowerCase()){var u=l.targetVersion?l.targetVersion:this.targetVersion;if(u.compareTo(i.targetVersion)<=0){return l.value}else{i.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.propertyValueNotSupported(n,this.name,u.toString(),i.targetVersion.toString()));return this.defaultValue}}}}i.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(n,this.name));return this.defaultValue};t.prototype.toJSON=function(e,t,i,n){var r=false;for(var o=0,l=this.values;o<l.length;o++){var u=l[o];if(u.value===i){var p=u.targetVersion?u.targetVersion:this.targetVersion;if(p.compareTo(n.targetVersion)<=0){r=true;break}else{n.logEvent(e,a.ValidationPhase.ToJSON,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.propertyValueNotSupported(i,this.name,p.toString(),n.targetVersion.toString()))}}}if(r){n.serializeValue(t,this.name,i,this.defaultValue)}};return t}(f);t.ValueSetProperty=b;var C=function(e){n(t,e);function t(t,i,n,r,o,a){var s=e.call(this,t,i,r,a)||this;s.targetVersion=t;s.name=i;s.enumType=n;s.defaultValue=r;s.onGetInitialValue=a;s._values=[];if(!o){for(var l in n){var u=parseInt(l,10);if(u>=0){s._values.push({value:u})}}}else{s._values=o}return s}t.prototype.parse=function(e,t,i){var n=t[this.name];if(typeof n!=="string"){return this.defaultValue}var r=o.getEnumValueByName(this.enumType,n);if(r!==undefined){for(var l=0,u=this.values;l<u.length;l++){var p=u[l];if(p.value===r){var c=p.targetVersion?p.targetVersion:this.targetVersion;if(c.compareTo(i.targetVersion)<=0){return r}else{i.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.propertyValueNotSupported(n,this.name,c.toString(),i.targetVersion.toString()));return this.defaultValue}}}}i.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(n,this.name));return this.defaultValue};t.prototype.toJSON=function(e,t,i,n){if(i!==undefined){var r=false;for(var o=0,l=this.values;o<l.length;o++){var u=l[o];if(u.value===i){var p=u.targetVersion?u.targetVersion:this.targetVersion;if(p.compareTo(n.targetVersion)<=0){r=true;break}else{n.logEvent(e,a.ValidationPhase.ToJSON,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(i,this.name))}}}if(r){n.serializeEnum(this.enumType,t,this.name,i,this.defaultValue)}}};Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:false,configurable:true});return t}(f);t.EnumProperty=C;var S=function(e){n(t,e);function t(t,i,n,r,o){if(r===void 0){r=false}var a=e.call(this,t,i,o,function(e){return a.nullable?undefined:new a.objectType})||this;a.targetVersion=t;a.name=i;a.objectType=n;a.nullable=r;return a}t.prototype.parse=function(e,t,i){var n=t[this.name];if(n===undefined){return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue}var r=new this.objectType;r.parse(n,i);return r};t.prototype.toJSON=function(e,t,i,n){var r=undefined;if(i!==undefined&&!i.hasAllDefaultValues()){r=i.toJSON(n)}if(typeof r==="object"&&Object.keys(r).length===0){r=undefined}n.serializeValue(t,this.name,r,this.defaultValue,true)};return t}(f);t.SerializableObjectProperty=S;var P=function(e){n(t,e);function t(t,i,n,r){var o=e.call(this,t,i,undefined,function(e){return[]})||this;o.targetVersion=t;o.name=i;o.objectType=n;o.onItemAdded=r;return o}t.prototype.parse=function(e,t,i){var n=[];var r=t[this.name];if(Array.isArray(r)){for(var o=0,a=r;o<a.length;o++){var s=a[o];var l=new this.objectType;l.parse(s,i);n.push(l);if(this.onItemAdded){this.onItemAdded(e,l)}}}return n.length>0?n:this.onGetInitialValue?this.onGetInitialValue(e):undefined};t.prototype.toJSON=function(e,t,i,n){n.serializeArray(t,this.name,i)};return t}(f);t.SerializableObjectCollectionProperty=P;var _=function(e){n(t,e);function t(t,i,n,r,o,a){var s=e.call(this,t,i,o,a)||this;s.targetVersion=t;s.name=i;s.onParse=n;s.onToJSON=r;s.defaultValue=o;s.onGetInitialValue=a;if(!s.onParse){throw new Error("CustomPropertyDefinition instances must have an onParse handler.")}if(!s.onToJSON){throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.")}return s}t.prototype.parse=function(e,t,i){return this.onParse(e,this,t,i)};t.prototype.toJSON=function(e,t,i,n){this.onToJSON(e,this,t,i,n)};return t}(f);t.CustomProperty=_;var A=function(){function e(){this._properties=[]}e.prototype.indexOf=function(e){for(var t=0;t<this._properties.length;t++){if(this._properties[t]===e){return t}}return-1};e.prototype.add=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}for(var i=0;i<e.length;i++){if(this.indexOf(e[i])===-1){this._properties.push(e[i])}}};e.prototype.remove=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}for(var i=0,n=e;i<n.length;i++){var r=n[i];while(true){var o=this.indexOf(r);if(o>=0){this._properties.splice(o,1)}else{break}}}};e.prototype.getItemAt=function(e){return this._properties[e]};e.prototype.getCount=function(){return this._properties.length};return e}();t.SerializableObjectSchema=A;function E(e){return function(t,i){var n=Object.getOwnPropertyDescriptor(t,i)||{};if(!n.get&&!n.set){n.get=function(){return this.getValue(e)};n.set=function(t){this.setValue(e,t)};Object.defineProperty(t,i,n)}}}t.property=E;var w=function(){function e(){this._propertyBag={};this._rawProperties={};this.maxVersion=e.defaultMaxVersion;var t=this.getSchema();for(var i=0;i<t.getCount();i++){var n=t.getItemAt(i);if(n.onGetInitialValue){this.setValue(n,n.onGetInitialValue(this))}}}e.prototype.getDefaultSerializationContext=function(){return new d};e.prototype.populateSchema=function(t){var i=this.constructor;var n=[];for(var r in i){try{var o=i[r];if(o instanceof f){n.push(o)}}catch(e){}}if(n.length>0){var a=n.sort(function(e,t){if(e.sequentialNumber>t.sequentialNumber){return 1}else if(e.sequentialNumber<t.sequentialNumber){return-1}return 0});t.add.apply(t,a)}if(e.onRegisterCustomProperties){e.onRegisterCustomProperties(this,t)}};e.prototype.getValue=function(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue};e.prototype.setValue=function(e,t){if(t===undefined||t===null){delete this._propertyBag[e.getInternalName()]}else{this._propertyBag[e.getInternalName()]=t}};e.prototype.internalParse=function(e,t){this._propertyBag={};this._rawProperties=r.GlobalSettings.enableFullJsonRoundTrip?e?e:{}:{};if(e){var i=this.getSchema();for(var n=0;n<i.getCount();n++){var o=i.getItemAt(n);if(o.isSerializationEnabled){var l=o.onGetInitialValue?o.onGetInitialValue(this):undefined;if(e.hasOwnProperty(o.name)){if(o.targetVersion.compareTo(t.targetVersion)<=0){l=o.parse(this,e,t)}else{t.logParseEvent(this,a.ValidationEvent.UnsupportedProperty,s.Strings.errors.propertyNotSupported(o.name,o.targetVersion.toString(),t.targetVersion.toString()))}}this.setValue(o,l)}}}else{this.resetDefaultValues()}};e.prototype.internalToJSON=function(e,t){var i=this.getSchema();var n=[];for(var r=0;r<i.getCount();r++){var o=i.getItemAt(r);if(o.isSerializationEnabled&&o.targetVersion.compareTo(t.targetVersion)<=0&&n.indexOf(o.name)===-1){o.toJSON(this,e,this.getValue(o),t);n.push(o.name)}}};e.prototype.shouldSerialize=function(e){return true};e.prototype.parse=function(e,t){this.internalParse(e,t?t:new d)};e.prototype.toJSON=function(e){var t;if(e&&e instanceof c){t=e}else{t=this.getDefaultSerializationContext();t.toJSONOriginalParam=e}if(this.shouldSerialize(t)){var i=void 0;if(r.GlobalSettings.enableFullJsonRoundTrip&&this._rawProperties&&typeof this._rawProperties==="object"){i=this._rawProperties}else{i={}}this.internalToJSON(i,t);return i}else{return undefined}};e.prototype.hasDefaultValue=function(e){return this.getValue(e)===e.defaultValue};e.prototype.hasAllDefaultValues=function(){var e=this.getSchema();for(var t=0;t<e.getCount();t++){var i=e.getItemAt(t);if(!this.hasDefaultValue(i)){return false}}return true};e.prototype.resetDefaultValues=function(){var e=this.getSchema();for(var t=0;t<e.getCount();t++){var i=e.getItemAt(t);this.setValue(i,i.defaultValue)}};e.prototype.setCustomProperty=function(e,t){var i=typeof t==="string"&&!t||t===undefined||t===null;if(i){delete this._rawProperties[e]}else{this._rawProperties[e]=t}};e.prototype.getCustomProperty=function(e){return this._rawProperties[e]};e.prototype.getSchema=function(){var t=e._schemaCache[this.getSchemaKey()];if(!t){t=new A;this.populateSchema(t);e._schemaCache[this.getSchemaKey()]=t}return t};e.defaultMaxVersion=u.v1_3;e._schemaCache={};return e}();t.SerializableObject=w},"./src/shared.ts":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UUID=t.SizeAndUnit=t.PaddingDefinition=t.SpacingDefinition=t.StringWithSubstitutions=t.ContentTypes=t.GlobalSettings=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var n=i("./src/enums.ts");var r=function(){function e(){}e.useAdvancedTextBlockTruncation=true;e.useAdvancedCardBottomTruncation=false;e.useMarkdownInRadioButtonAndCheckbox=true;e.allowMarkForTextHighlighting=false;e.alwaysBleedSeparators=false;e.enableFullJsonRoundTrip=false;e.displayInputValidationErrors=true;e.allowPreProcessingPropertyValues=false;e.setTabIndexAtCardRoot=true;e.enableFallback=true;e.useWebkitLineClamp=true;e.applets={logEnabled:true,logLevel:n.LogLevel.Error,maximumRetryAttempts:3,defaultTimeBetweenRetryAttempts:3e3,authPromptWidth:400,authPromptHeight:600,refresh:{mode:n.RefreshMode.Manual,timeBetweenAutomaticRefreshes:3e3,maximumConsecutiveAutomaticRefreshes:3,allowManualRefreshesAfterAutomaticRefreshes:true}};return e}();t.GlobalSettings=r;t.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var o=function(){function e(){this._isProcessed=false}e.prototype.getReferencedInputs=function(e,t){if(!t){throw new Error("The referencedInputs parameter cannot be null.")}for(var i=0,n=e;i<n.length;i++){var r=n[i];var o=new RegExp("\\{{2}("+r.id+").value\\}{2}","gi").exec(this._original);if(o!=null&&r.id){t[r.id]=r}}};e.prototype.substituteInputValues=function(e,i){this._processed=this._original;if(this._original){var n=/\{{2}([a-z0-9_$@]+).value\}{2}/gi;var r=void 0;while((r=n.exec(this._original))!==null){for(var o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];if(s.toLowerCase()==r[1].toLowerCase()){var l=e[s];var u="";if(l.value){u=l.value}if(i===t.ContentTypes.applicationJson){u=JSON.stringify(u);u=u.slice(1,-1)}else if(i===t.ContentTypes.applicationXWwwFormUrlencoded){u=encodeURIComponent(u)}this._processed=this._processed.replace(r[0],u);break}}}}this._isProcessed=true};e.prototype.getOriginal=function(){return this._original};e.prototype.get=function(){if(!this._isProcessed){return this._original}else{return this._processed}};e.prototype.set=function(e){this._original=e;this._isProcessed=false};return e}();t.StringWithSubstitutions=o;var a=function(){function e(e,t,i,n){if(e===void 0){e=0}if(t===void 0){t=0}if(i===void 0){i=0}if(n===void 0){n=0}this.left=0;this.top=0;this.right=0;this.bottom=0;this.top=e;this.right=t;this.bottom=i;this.left=n}return e}();t.SpacingDefinition=a;var s=function(){function e(e,t,i,r){if(e===void 0){e=n.Spacing.None}if(t===void 0){t=n.Spacing.None}if(i===void 0){i=n.Spacing.None}if(r===void 0){r=n.Spacing.None}this.top=n.Spacing.None;this.right=n.Spacing.None;this.bottom=n.Spacing.None;this.left=n.Spacing.None;this.top=e;this.right=t;this.bottom=i;this.left=r}return e}();t.PaddingDefinition=s;var l=function(){function e(e,t){this.physicalSize=e;this.unit=t}e.parse=function(t,i){if(i===void 0){i=false}var r=new e(0,n.SizeUnit.Weight);if(typeof t==="number"){r.physicalSize=t;return r}else if(typeof t==="string"){var o=/^([0-9]+)(px|\*)?$/g;var a=o.exec(t);var s=i?3:2;if(a&&a.length>=s){r.physicalSize=parseInt(a[1]);if(a.length==3){if(a[2]=="px"){r.unit=n.SizeUnit.Pixel}}return r}}throw new Error("Invalid size: "+t)};return e}();t.SizeAndUnit=l;
/**
 * Fast UUID generator, RFC4122 version 4 compliant.
 * @author Jeff Ward (jcward.com).
 * @license MIT license
 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
 **/var u=function(){function e(){}e.generate=function(){var t=Math.random()*4294967295|0;var i=Math.random()*4294967295|0;var n=Math.random()*4294967295|0;var r=Math.random()*4294967295|0;return e.lut[t&255]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[i&255]+e.lut[i>>8&255]+"-"+e.lut[i>>16&15|64]+e.lut[i>>24&255]+"-"+e.lut[n&63|128]+e.lut[n>>8&255]+"-"+e.lut[n>>16&255]+e.lut[n>>24&255]+e.lut[r&255]+e.lut[r>>8&255]+e.lut[r>>16&255]+e.lut[r>>24&255]};e.initialize=function(){for(var t=0;t<256;t++){e.lut[t]=(t<16?"0":"")+t.toString(16)}};e.lut=[];return e}();t.UUID=u;u.initialize()},"./src/strings.ts":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Strings=void 0;var n=function(){function e(){}e.errors={unknownElementType:function(e){return'Unknown element type "'+e+'". Fallback will be used if present.'},unknownActionType:function(e){return'Unknown action type "'+e+'". Fallback will be used if present.'},elementTypeNotAllowed:function(e){return'Element type "'+e+'" is not allowed in this context.'},actionTypeNotAllowed:function(e){return'Action type "'+e+'" is not allowed in this context.'},invalidPropertyValue:function(e,t){return'Invalid value "'+e+'" for property "'+t+'".'},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(e){return'Invalid column width "'+e+'" - defaulting to "auto".'},invalidCardVersion:function(e){return'Invalid card version. Defaulting to "'+e+'".'},invalidVersionString:function(e){return'Invalid version string "'+e+'".'},propertyValueNotSupported:function(e,t,i,n){return'Value "'+e+'" for property "'+t+'" is supported in version '+i+", but you are using version "+n+"."},propertyNotSupported:function(e,t,i){return'Property "'+e+'" is supported in version '+t+", but you are using version "+i+"."},indexOutOfRange:function(e){return"Index out of range ("+e+")."},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(e){return'Property "'+e+'" must be set.'},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(e){return"Maximum number of actions exceeded ("+e+")."},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(e,t){return"The specified card version ("+e+") is not supported. The maximum supported card version is "+t+"."},duplicateId:function(e){return'Duplicate Id "'+e+'".'},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},processMarkdownEventRemoved:function(){return"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead."},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(e){return"Elements of type "+e+" cannot be used as standalone elements."}};e.magicCodeInputCard={tryAgain:function(){return"That didn't work... let's try again."},pleaseLogin:function(){return'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"'},enterMagicCode:function(){return"Enter magic code"},pleaseEnterMagicCodeYouReceived:function(){return"Please enter the magic code you received."},submit:function(){return"Submit"},cancel:function(){return"Cancel"},somethingWentWrong:function(){return"Something went wrong. This action can't be handled."},authenticationFailed:function(){return"Authentication failed."}};e.runtime={automaticRefreshPaused:function(){return"Automatic refresh paused."},clckToRestartAutomaticRefresh:function(){return"Click to restart."},refreshThisCard:function(){return"Refresh this card"}};e.hints={dontUseWeightedAndStrecthedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}};e.defaults={inlineActionTitle:function(){return"Inline Action"},mediaPlayerAriaLabel:function(){return"Media content"},mediaPlayerPlayMedia:function(){return"Play media"}};return e}();t.Strings=n},"./src/text-formatters.ts":function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return e(t,i)};return function(t,i){e(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:true});t.formatText=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var r=function(){function e(e){this._regularExpression=e}e.prototype.format=function(e,t){var i;if(t){var n=t;while((i=this._regularExpression.exec(t))!=null){n=n.replace(i[0],this.internalFormat(e,i))}return n}else{return t}};return e}();var o=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.internalFormat=function(e,t){var i=new Date(Date.parse(t[1]));var n=t[2]!=undefined?t[2].toLowerCase():"compact";if(n!="compact"){return i.toLocaleDateString(e,{day:"numeric",weekday:n,month:n,year:"numeric"})}else{return i.toLocaleDateString()}};return t}(r);var a=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.internalFormat=function(e,t){var i=new Date(Date.parse(t[1]));return i.toLocaleTimeString(e,{hour:"numeric",minute:"2-digit"})};return t}(r);function s(e,t){var i=[new o(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new a(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];var n=t;for(var r=0,s=i;r<s.length;r++){var l=s[r];n=l.format(e,n)}return n}t.formatText=s},"./src/utils.ts":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.clearElementChildren=t.getFitStatus=t.truncate=t.stringToCssColor=t.renderSeparation=t.parseEnum=t.getEnumValueByName=t.parseBool=t.parseNumber=t.parseString=t.appendChild=t.generateUniqueId=t.isMobileOS=t.isInternetExplorer=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var n=i("./src/enums.ts");var r=i("./src/shared.ts");function o(){return window.document.documentMode!==undefined}t.isInternetExplorer=o;function a(){var e=window.navigator.userAgent;return!!e.match(/Android/i)||!!e.match(/iPad/i)||!!e.match(/iPhone/i)}t.isMobileOS=a;function s(){return"__ac-"+r.UUID.generate()}t.generateUniqueId=s;function l(e,t){if(t){e.appendChild(t)}}t.appendChild=l;function u(e,t){return typeof e==="string"?e:t}t.parseString=u;function p(e,t){return typeof e==="number"?e:t}t.parseNumber=p;function c(e,t){if(typeof e==="boolean"){return e}else if(typeof e==="string"){switch(e.toLowerCase()){case"true":return true;case"false":return false;default:return t}}return t}t.parseBool=c;function d(e,t){for(var i in e){var n=parseInt(i,10);if(n>=0){var r=e[i];if(r&&typeof r==="string"&&r.toLowerCase()===t.toLowerCase()){return n}}}return undefined}t.getEnumValueByName=d;function f(e,t,i){if(!t){return i}var n=d(e,t);return n!==undefined?n:i}t.parseEnum=f;function h(e,t,i){if(t.spacing>0||t.lineThickness&&t.lineThickness>0){var r=document.createElement("div");r.className=e.makeCssClassName("ac-"+(i==n.Orientation.Horizontal?"horizontal":"vertical")+"-separator");r.setAttribute("aria-hidden","true");var o=t.lineColor?y(t.lineColor):"";if(i==n.Orientation.Horizontal){if(t.lineThickness){r.style.paddingTop=t.spacing/2+"px";r.style.marginBottom=t.spacing/2+"px";r.style.borderBottom=t.lineThickness+"px solid "+o}else{r.style.height=t.spacing+"px"}}else{if(t.lineThickness){r.style.paddingLeft=t.spacing/2+"px";r.style.marginRight=t.spacing/2+"px";r.style.borderRight=t.lineThickness+"px solid "+o}else{r.style.width=t.spacing+"px"}}r.style.overflow="hidden";r.style.flex="0 0 auto";return r}else{return undefined}}t.renderSeparation=h;function y(e){if(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi;var i=t.exec(e);if(i&&i[4]){var n=parseInt(i[1],16)/255;var r=parseInt(i[2],16);var o=parseInt(i[3],16);var a=parseInt(i[4],16);return"rgba("+r+","+o+","+a+","+n+")"}}return e}t.stringToCssColor=y;function g(e,t,i){var n=function(){return t-e.scrollHeight>=-1};if(n())return;var r=e.innerHTML;var o=function(t){e.innerHTML=r.substring(0,t)+"..."};var a=m(r);var s=0;var l=a.length;var u=0;while(s<l){var p=Math.floor((s+l)/2);o(a[p]);if(n()){u=a[p];s=p+1}else{l=p}}o(u);if(i&&t-e.scrollHeight>=i-1){var c=v(r,u);while(c<r.length){o(c);if(n()){u=c;c=v(r,c)}else{break}}o(u)}}t.truncate=g;function m(e){var t=[];var i=v(e,-1);while(i<e.length){if(e[i]==" "){t.push(i)}i=v(e,i)}return t}function v(e,t){t+=1;while(t<e.length&&e[t]=="<"){while(t<e.length&&e[t++]!=">");}return t}function b(e,t){var i=e.offsetTop;var r=i+e.clientHeight;if(r<=t){return n.ContainerFitStatus.FullyInContainer}else if(i<t){return n.ContainerFitStatus.Overflowing}else{return n.ContainerFitStatus.FullyOutOfContainer}}t.getFitStatus=b;function C(e){while(e.firstChild){e.removeChild(e.firstChild)}}t.clearElementChildren=C}})});