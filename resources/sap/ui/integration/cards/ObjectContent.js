/*!
* OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["sap/ui/integration/library","sap/ui/integration/cards/BaseContent","sap/m/library","sap/m/HBox","sap/m/VBox","sap/m/Text","sap/m/Title","sap/m/Avatar","sap/m/Link","sap/m/Label","sap/base/Log","sap/ui/core/ResizeHandler","sap/ui/layout/AlignedFlowLayout","sap/ui/dom/units/Rem","sap/ui/integration/util/BindingHelper","sap/ui/integration/util/Utils"],function(e,t,i,a,r,s,n,o,l,d,p,u,c,f,b,h){"use strict";var g=i.AvatarSize;var y=i.AvatarColor;var C=i.FlexRendertype;var m=e.CardActionArea;var v=t.extend("sap.ui.integration.cards.ObjectContent",{metadata:{library:"sap.ui.integration"},renderer:{apiVersion:2}});v.prototype._getRootContainer=function(){if(this._bIsBeingDestroyed){return null}var e=this.getAggregation("_content");if(!e){e=new c;this.setAggregation("_content",e)}this._sResizeListenerId=u.register(e,this.onAlignedFlowLayoutResize.bind(this));e.addEventDelegate({onAfterRendering:function(){this.getContent().forEach(function(e){if(!e.getVisible()){document.getElementById("sap-ui-invisible-"+e.getId()).parentElement.classList.add("sapFCardInvisibleContent")}})}},e);return e};v.prototype.onAlignedFlowLayoutResize=function(e){if(e&&e.size.width===e.oldSize.width&&!e.control){return}var t=e.control,i=t.getMinItemWidth(),a=t.getContent().length,r;if(i.lastIndexOf("rem")!==-1){r=f.toPx(i)}else if(i.lastIndexOf("px")!==-1){r=parseFloat(i)}var s=Math.floor(e.size.width/r);if(s>a){s=a}if(this._iColsOld===s){return}this._iColsOld=s;var n=s-1,o=Math.ceil(a/s);t.getContent().forEach(function(e,t){e.addStyleClass("sapFCardObjectSpaceBetweenGroup");if(n===t&&n<a){e.removeStyleClass("sapFCardObjectSpaceBetweenGroup");n+=s}if(t+1>(o-1)*s){e.addStyleClass("sapFCardObjectGroupLastInColumn")}else{e.removeStyleClass("sapFCardObjectGroupLastInColumn")}})};v.prototype.exit=function(){t.prototype.exit.apply(this,arguments);if(this._sResizeListenerId){u.deregister(this._sResizeListenerId);this._sResizeListenerId=""}};v.prototype.setConfiguration=function(e){t.prototype.setConfiguration.apply(this,arguments);if(!e){return this}if(e.groups){this._addGroups(e)}return this};v.prototype._addGroups=function(e){var t=this._getRootContainer(),i=e.groups||[];i.forEach(function(e){var i;if(typeof e.visible=="string"){i=!h.hasFalsyValueAsString(e.visible)}else{i=e.visible}var u=new r({visible:i,renderType:C.Bare}).addStyleClass("sapFCardObjectGroup");if(e.title){u.addItem(new n({text:e.title}).addStyleClass("sapFCardObjectItemTitle"));u.addStyleClass("sapFCardObjectGroupWithTitle")}e.items.forEach(function(e){var t=e.label,i=e.value,n,c,f,v,I=[];if(typeof e.visible=="string"){c=!h.hasFalsyValueAsString(e.visible)}else{c=e.visible}if(t){t=b.formattedProperty(t,function(e){return e&&e[e.length-1]===":"?e:e+":"});n=new d({text:t,visible:c}).addStyleClass("sapFCardObjectItemLabel")}if(i&&e.actions){f=new l({text:i,visible:b.reuse(c)});this._oActions.attach({area:m.ContentItemDetail,actions:e.actions,control:this,actionControl:f,enabledPropertyName:"enabled"})}if(i&&!e.actions&&e.type){p.warning("Usage of Object Group Item property 'type' is deprecated. Use Card Actions for navigation.",null,"sap.ui.integration.widgets.Card");switch(e.type){case"link":f=new l({href:e.url||i,text:i,target:e.target||"_blank",visible:b.reuse(c)});break;case"email":if(e.value){I.push(e.value)}if(e.emailSubject){I.push(e.emailSubject)}v=b.formattedProperty(I,function(e,t){if(t){return"mailto:"+e+"?subject="+t}else{return"mailto:"+e}});f=new l({href:v,text:i,visible:b.reuse(c)});break;case"phone":v=b.formattedProperty(i,function(e){return"tel:"+e});f=new l({href:v,text:i,visible:b.reuse(c)});break;default:}}if(i&&!f){f=new s({text:i,visible:b.reuse(c)})}if(f){f.addStyleClass("sapFCardObjectItemText")}if(e.icon){var w=b.formattedProperty(e.icon.src,function(e){return this._oIconFormatter.formatSrc(e)}.bind(this));var S=new o({displaySize:e.icon.size||g.XS,src:w,initials:e.icon.text,displayShape:e.icon.shape,tooltip:e.icon.alt,backgroundColor:e.icon.backgroundColor||(e.icon.text?undefined:y.Transparent)}).addStyleClass("sapFCardObjectItemAvatar sapFCardIcon");var x=new r({renderType:C.Bare,items:[n,f]});var F=new a({visible:c,renderType:C.Bare,items:[S,x]}).addStyleClass("sapFCardObjectItemLabel");u.addItem(F)}else{u.addItem(n);u.addItem(f)}},this);t.addContent(u)},this);this._oActions.attach({area:m.Content,actions:e.actions,control:this})};return v});