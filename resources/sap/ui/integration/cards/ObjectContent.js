/*!
* OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["sap/ui/integration/library","sap/ui/integration/cards/BaseContent","sap/m/library","sap/m/HBox","sap/m/VBox","sap/m/Text","sap/m/Title","sap/m/Avatar","sap/m/Link","sap/m/Label","sap/base/Log","sap/ui/core/ResizeHandler","sap/ui/layout/AlignedFlowLayout","sap/ui/dom/units/Rem","sap/ui/integration/util/BindingHelper","sap/ui/integration/util/Utils"],function(e,t,i,a,r,s,n,o,l,d,p,u,c,f,g,h){"use strict";var b=i.AvatarSize;var y=i.AvatarColor;var C=i.FlexRendertype;var m=e.CardActionArea;var v=t.extend("sap.ui.integration.cards.ObjectContent",{metadata:{library:"sap.ui.integration"},renderer:{apiVersion:2}});v.prototype._getRootContainer=function(){if(this._bIsBeingDestroyed){return null}var e=this.getAggregation("_content");if(!e){e=new c;this.setAggregation("_content",e)}this._sResizeListenerId=u.register(e,this.onAlignedFlowLayoutResize.bind(this));e.addEventDelegate({onAfterRendering:function(){this.getContent().forEach(function(e){if(!e.getVisible()){document.getElementById("sap-ui-invisible-"+e.getId()).parentElement.classList.add("sapFCardInvisibleContent")}})}},e);return e};v.prototype.onAlignedFlowLayoutResize=function(e){if(e&&e.size.width===e.oldSize.width&&!e.control){return}var t=e.control,i=t.getMinItemWidth(),a=t.getContent().length,r;if(i.lastIndexOf("rem")!==-1){r=f.toPx(i)}else if(i.lastIndexOf("px")!==-1){r=parseFloat(i)}var s=Math.floor(e.size.width/r);if(s>a){s=a}if(this._iColsOld===s){return}this._iColsOld=s;var n=s-1,o=Math.ceil(a/s);t.getContent().forEach(function(e,t){e.addStyleClass("sapFCardObjectSpaceBetweenGroup");if(n===t&&n<a){e.removeStyleClass("sapFCardObjectSpaceBetweenGroup");n+=s}if(t+1>(o-1)*s){e.addStyleClass("sapFCardObjectGroupLastInColumn")}else{e.removeStyleClass("sapFCardObjectGroupLastInColumn")}})};v.prototype.exit=function(){t.prototype.exit.apply(this,arguments);if(this._sResizeListenerId){u.deregister(this._sResizeListenerId);this._sResizeListenerId=""}};v.prototype.setConfiguration=function(e){t.prototype.setConfiguration.apply(this,arguments);e=this.getParsedConfiguration();if(!e){return this}if(e.groups){this._addGroups(e)}return this};v.prototype._addGroups=function(e){var t=this._getRootContainer(),i=e.groups||[];i.forEach(function(e){var i;if(typeof e.visible=="string"){i=!h.hasFalsyValueAsString(e.visible)}else{i=e.visible}var a=new r({visible:i,renderType:C.Bare}).addStyleClass("sapFCardObjectGroup");if(e.title){a.addItem(new n({text:e.title}).addStyleClass("sapFCardObjectItemTitle"));a.addStyleClass("sapFCardObjectGroupWithTitle")}e.items.forEach(function(e){this._createGroupItems(e).forEach(a.addItem,a)},this);t.addContent(a)},this);this._oActions.attach({area:m.Content,actions:e.actions,control:this})};v.prototype._createGroupItems=function(e){var t=e.label,i=e.value,n,o,u,c,f=[];if(typeof e.visible=="string"){o=!h.hasFalsyValueAsString(e.visible)}else{o=e.visible}if(t){t=g.formattedProperty(t,function(e){return e&&e[e.length-1]===":"?e:e+":"});n=new d({text:t,visible:o}).addStyleClass("sapFCardObjectItemLabel")}if(i&&e.actions){u=new l({text:i,visible:g.reuse(o)});if(n){u.addAriaLabelledBy(n)}else{p.warning("Missing label for Object group item with actions.",null,"sap.ui.integration.widgets.Card")}this._oActions.attach({area:m.ContentItemDetail,actions:e.actions,control:this,actionControl:u,enabledPropertyName:"enabled"})}if(i&&!e.actions&&e.type){p.warning("Usage of Object Group Item property 'type' is deprecated. Use Card Actions for navigation.",null,"sap.ui.integration.widgets.Card");switch(e.type){case"link":u=new l({href:e.url||i,text:i,target:e.target||"_blank",visible:g.reuse(o)});break;case"email":if(e.value){f.push(e.value)}if(e.emailSubject){f.push(e.emailSubject)}c=g.formattedProperty(f,function(e,t){if(t){return"mailto:"+e+"?subject="+t}else{return"mailto:"+e}});u=new l({href:c,text:i,visible:g.reuse(o)});break;case"phone":c=g.formattedProperty(i,function(e){return"tel:"+e});u=new l({href:c,text:i,visible:g.reuse(o)});break;default:}}if(i&&!u){u=new s({text:i,visible:g.reuse(o)})}if(u){u.addStyleClass("sapFCardObjectItemText")}if(e.icon){var b=new r({renderType:C.Bare,items:[n,u]});var y=new a({visible:o,renderType:C.Bare,items:[this._createGroupItemAvatar(e.icon),b]}).addStyleClass("sapFCardObjectItemLabel");return[y]}else{return[n,u]}};v.prototype._createGroupItemAvatar=function(e){var t=g.formattedProperty(e.src,function(e){return this._oIconFormatter.formatSrc(e)}.bind(this));var i=new o({displaySize:e.size||b.XS,src:t,initials:e.text,displayShape:e.shape,tooltip:e.alt,backgroundColor:e.backgroundColor||(e.text?undefined:y.Transparent)}).addStyleClass("sapFCardObjectItemAvatar sapFCardIcon");return i};return v});