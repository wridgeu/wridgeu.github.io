/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseAction","sap/base/Log","sap/ui/integration/util/BindingHelper","sap/ui/integration/util/BindingResolver","sap/ui/integration/util/Utils"],function(e,t,n,r,i){"use strict";var a=e.extend("sap.ui.integration.cards.actions.SubmitAction",{metadata:{library:"sap.ui.integration"}});a.prototype.execute=function(){var e=this.getSourceInstance(),n=this.getActionHandler();if(!n||!e.isA("sap.ui.integration.cards.BaseContent")){return}var r=this.getCardInstance()._oDataProviderFactory,i=this.getParameters();e.onActionSubmitStart(i);var a=r.create({request:this._createRequest(n,i)});a.getData().then(function(t){e.onActionSubmitEnd(t,null)},function(n){t.error(n);e.onActionSubmitEnd(null,{error:n})}).finally(function(){r.remove(a)})};a.prototype._createRequest=function(e,t){return{mode:e.mode||"cors",url:e.url,method:e.method||"POST",parameters:this._resolveActionHandlerParams(e.parameters,t)||t,headers:e.headers,xhrFields:{withCredentials:!!e.withCredentials}}};a.prototype._resolveActionHandlerParams=function(e,t){var a=this.getCardInstance();a.getModel("form").setProperty("/",t.data);e=r.resolveValue(n.createBindingInfos(e,a.getBindingNamespaces()),this.getSourceInstance());i.makeUndefinedValuesNull(e);return e};return a});