/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseAction","sap/base/Log","sap/ui/integration/util/BindingHelper","sap/ui/integration/util/BindingResolver","sap/ui/integration/util/Utils"],function(t,e,n,i,r){"use strict";var a=t.extend("sap.ui.integration.cards.actions.SubmitAction",{metadata:{library:"sap.ui.integration"}});a.prototype.execute=function(){var t=this.getCardInstance(),n=this.getActionHandler();if(!n){return}var i=this.getCardInstance()._oDataProviderFactory,r=t.getModel("form").getData();this._onActionSubmitStart(r);var a=i.create({request:this._createRequest(n,r)});a.getData().then(function(t){this._onActionSubmitEnd(t,null)}.bind(this),function(t){e.error(t);this._onActionSubmitEnd(null,{error:t})}.bind(this)).finally(function(){i.remove(a)})};a.prototype._onActionSubmitStart=function(t){var e=this.getSourceInstance();if(e.isA("sap.ui.integration.cards.BaseContent")){e.onActionSubmitStart(t)}};a.prototype._onActionSubmitEnd=function(t,e){var n=this.getSourceInstance();if(n.isA("sap.ui.integration.cards.BaseContent")){n.onActionSubmitEnd(t,e)}};a.prototype._createRequest=function(t,e){return{mode:t.mode||"cors",url:t.url,method:t.method||"POST",parameters:this._resolveActionHandlerParams(t.parameters)||e,headers:t.headers,xhrFields:{withCredentials:!!t.withCredentials}}};a.prototype._resolveActionHandlerParams=function(t){var e=this.getCardInstance();t=i.resolveValue(n.createBindingInfos(t,e.getBindingNamespaces()),this.getSourceInstance());r.makeUndefinedValuesNull(t);return t};return a});