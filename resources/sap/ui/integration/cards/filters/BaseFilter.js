/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/core/Core","sap/base/Log","sap/ui/core/Icon","sap/m/HBox","sap/m/Text","sap/ui/integration/model/ObservableModel","sap/ui/integration/util/LoadingProvider"],function(t,e,a,r,i,o,n,s){"use strict";var d=t.extend("sap.ui.integration.cards.filters.BaseFilter",{metadata:{abstract:true,library:"sap.ui.integration",properties:{key:{type:"string",defaultValue:""},config:{type:"object",defaultValue:"null"},value:{type:"object",defaultValue:null}},aggregations:{_loadingProvider:{type:"sap.ui.core.Element",multiple:false,visibility:"hidden"}},associations:{card:{type:"sap.ui.integration.widgets.Card",multiple:false}}},renderer:{apiVersion:2,render:function(t,e){var a=e.isLoading();t.openStart("div",e).class("sapFCardFilter");if(a){t.class("sapFCardFilterLoading")}t.openEnd();if(e._hasError()){t.renderControl(e._getErrorMessage())}else{t.renderControl(e.getField())}t.close("div")}}});d.prototype.init=function(){this.setAggregation("_loadingProvider",new s);this.attachEventOnce("_dataReady",function(){this.fireEvent("_ready")})};d.prototype.exit=function(){if(this._oDataProvider){this._oDataProvider.destroy();this._oDataProvider=null}};d.prototype.isLoading=function(){var t=this.getAggregation("_loadingProvider");return!t.isDataProviderJson()&&t.getLoading()};d.prototype.getField=function(){return null};d.prototype.showLoadingPlaceholders=function(){this.getAggregation("_loadingProvider").setLoading(true)};d.prototype.hideLoadingPlaceholders=function(){this.getAggregation("_loadingProvider").setLoading(false)};d.prototype.onDataChanged=function(){};d.prototype.getValueForModel=function(){};d.prototype.refreshData=function(){if(this._oDataProvider){this._oDataProvider.triggerDataUpdate()}};d.prototype.getCardInstance=function(){return e.byId(this.getCard())};d.prototype._hasError=function(){return!!this._bError};d.prototype._getErrorMessage=function(){var t="Unable to load the filter.";return new i({justifyContent:"Center",alignItems:"Center",items:[new r({src:"sap-icon://message-error",size:"1rem"}).addStyleClass("sapUiTinyMargin"),new o({text:t})]})};d.prototype._handleError=function(t){a.error(t);this._bError=true;this.invalidate()};d.prototype._onDataRequestComplete=function(){this.fireEvent("_dataReady");this.hideLoadingPlaceholders()};d.prototype._setDataConfiguration=function(t){var e=this.getCardInstance(),a;if(!t){this.fireEvent("_dataReady");return}if(this._oDataProvider){this._oDataProvider.destroy()}this._oDataProvider=e.getDataProviderFactory().create(t,null,true);this.getAggregation("_loadingProvider").setDataProvider(this._oDataProvider);if(t.name){a=e.getModel(t.name)}else if(this._oDataProvider){a=new n;this.setModel(a)}a.attachEvent("change",function(){this.onDataChanged()}.bind(this));this._oDataProvider.attachDataRequested(function(){this.showLoadingPlaceholders()}.bind(this));this._oDataProvider.attachDataChanged(function(t){a.setData(t.getParameter("data"));this._onDataRequestComplete()}.bind(this));this._oDataProvider.attachError(function(t){this._handleError(t.getParameter("message"));this._onDataRequestComplete()}.bind(this));this._oDataProvider.triggerDataUpdate()};return d});