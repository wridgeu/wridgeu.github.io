/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseFilter","sap/m/Select","sap/ui/core/ListItem","sap/ui/model/json/JSONModel"],function(e,t,i,a){"use strict";var r=e.extend("sap.ui.integration.cards.filters.SelectFilter",{metadata:{library:"sap.ui.integration",aggregations:{_select:{type:"sap.m.Select",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2}});r.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this._oItemTemplate){this._oItemTemplate.destroy()}};r.prototype.getField=function(){return this._getSelect()};r.prototype.onDataChanged=function(){var e=this._getSelect();e.setSelectedKey(this.getValue().value)};r.prototype.getValueForModel=function(){var e=this._getSelect().getSelectedItem();if(e){return{value:e.getKey(),selectedItem:{title:e.getText(),key:e.getKey()}}}return{value:this.getConfig().value}};r.prototype._getSelect=function(){var e=this.getAggregation("_select");if(!e){e=this._createSelect();this.setAggregation("_select",e)}return e};r.prototype._createSelect=function(){var e=new t,r,s,l="/",n=this.getConfig();e.attachChange(function(e){this.setValue(this.getValueForModel());var t="/sap.card/configuration/filters/"+this.getKey()+"/value",i={};i[t]=e.getParameter("selectedItem").getKey();this.getCardInstance()._fireConfigurationChange(i)}.bind(this));if(n&&n.item){l=n.item.path||l}if(n&&n.item&&n.item.template){r=n.item.template.key;s=n.item.template.title}if(n&&n.items){r="{key}";s="{title}";this.setModel(new a(n.items))}this._oItemTemplate=new i({key:r,text:s});e.bindItems({path:l,template:this._oItemTemplate});e.setSelectedKey(n.value);return e};return r});