/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseFilter","sap/ui/core/library","sap/m/DynamicDateRange","sap/m/DynamicDateUtil","sap/ui/integration/util/BindingResolver"],function(t,e,a,r,n){"use strict";var i=e.ValueState;var o=new Date(-864e13);var s=new Date("1753-01-01");var u=new Date(864e13);var l=new Date("9999-12-31");var T={DATE:"date",TODAY:"today",YESTERDAY:"yesterday",TOMORROW:"tomorrow",DATERANGE:"dateRange",FROM:"from",TO:"to",YEARTODATE:"yearToDate",LASTDAYS:"lastDays",LASTWEEKS:"lastWeeks",LASTMONTHS:"lastMonths",LASTQUARTERS:"lastQuarters",LASTYEARS:"lastYears",NEXTDAYS:"nextDays",NEXTWEEKS:"nextWeeks",NEXTMONTHS:"nextMonths",NEXTQUARTERS:"nextQuarters",NEXTYEARS:"nextYears",TODAYFROMTO:"todayFromTo",THISWEEK:"thisWeek",LASTWEEK:"lastWeek",NEXTWEEK:"nextWeek",SPECIFICMONTH:"specificMonth",THISMONTH:"thisMonth",LASTMONTH:"lastMonth",NEXTMONTH:"nextMonth",THISQUARTER:"thisQuarter",LASTQUARTER:"lastQuarter",NEXTQUARTER:"nextQuarter",QUARTER1:"quarter1",QUARTER2:"quarter2",QUARTER3:"quarter3",QUARTER4:"quarter4",THISYEAR:"thisYear",LASTYEAR:"lastYear",NEXTYEAR:"nextYear"};function g(t){return T[t]}var p=t.extend("sap.ui.integration.cards.filters.DateRangeFilter",{metadata:{library:"sap.ui.integration",aggregations:{_ddr:{type:"sap.m.DynamicDateRange",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2}});p.prototype.getField=function(){return this._getDdr()};p.prototype.getValueForModel=function(){var t=this._getDdr().getValue();var e;var a;var n;if(t){e={option:g(t.operator),values:t.values.slice()};var i=r.toDates(t),T=i[0].getJSDate?i[0].getJSDate():i[0],p=t.operator==="TO"||t.operator==="FROM"?0:1,S=i[p]&&i[p].getJSDate?i[p].getJSDate():i[p];a={start:T.toISOString(),end:S.toISOString()};n={start:T.toISOString(),end:S.toISOString()};if(t.operator==="TO"){a.start=o.toISOString();n.start=s.toISOString()}if(t.operator==="FROM"){a.end=u.toISOString();n.end=l.toISOString()}}return{value:e,range:a,rangeOData:n}};p.prototype._getDdr=function(){var t=this.getAggregation("_ddr");if(!t){t=this._createDdr();this.setAggregation("_ddr",t)}return t};p.prototype._createDdr=function(){var t=Object.assign({},this.getConfig());var e;if(t.value){t.value=n.resolveValue(t.value,this.getCardInstance());var o=t.value.option.toUpperCase();var s=r.getOption(o).getValueTypes();e={operator:o,values:t.value.values.map(function(t,e){if(s[e]==="date"){return new Date(t)}return t})}}t.options=t.options||this._getDefaultOptions();t.options=t.options.map(function(t){return t.toUpperCase()});var u=new a({value:e,options:t.options}).addStyleClass("sapFCardDateRangeField");u.attachChange(function(t){if(t.getParameter("valid")){u.setValueState(i.None);this._setValue()}else{u.setValueState(i.Error)}}.bind(this));var l=this.createLabel(t);if(l){u.addAriaLabelledBy(l)}return u};p.prototype._getDefaultOptions=function(){return["date","today","dateRange","from","to","lastDays","nextDays","lastWeeks","nextWeeks"]};p.prototype.getOptions=function(){return T};return p});