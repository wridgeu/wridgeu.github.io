/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseFilter","sap/ui/core/library","sap/m/DynamicDateRange","sap/m/DynamicDateUtil"],function(t,e,a,r){"use strict";var n=e.ValueState;var o=new Date(-864e13);var i=new Date("1753-01-01");var s=new Date(864e13);var u=new Date("9999-12-31");function T(t){var e={DATE:"date",TODAY:"today",YESTERDAY:"yesterday",TOMORROW:"tomorrow",DATERANGE:"dateRange",FROM:"from",TO:"to",YEARTODATE:"yearToDate",LASTDAYS:"lastDays",LASTWEEKS:"lastWeeks",LASTMONTHS:"lastMonths",LASTQUARTERS:"lastQuarters",LASTYEARS:"lastYears",NEXTDAYS:"nextDays",NEXTWEEKS:"nextWeeks",NEXTMONTHS:"nextMonths",NEXTQUARTERS:"nextQuarters",NEXTYEARS:"nextYears",TODAYFROMTO:"todayFromTo",THISWEEK:"thisWeek",LASTWEEK:"lastWeek",NEXTWEEK:"nextWeek",SPECIFICMONTH:"specificMonth",THISMONTH:"thisMonth",LASTMONTH:"lastMonth",NEXTMONTH:"nextMonth",THISQUARTER:"thisQuarter",LASTQUARTER:"lastQuarter",NEXTQUARTER:"nextQuarter",QUARTER1:"quarter1",QUARTER2:"quarter2",QUARTER3:"quarter3",QUARTER4:"quarter4",THISYEAR:"thisYear",LASTYEAR:"lastYear",NEXTYEAR:"nextYear"};return e[t]}var g=t.extend("sap.ui.integration.cards.filters.DateRangeFilter",{metadata:{library:"sap.ui.integration",aggregations:{_ddr:{type:"sap.m.DynamicDateRange",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2}});g.prototype.getField=function(){return this._getDdr()};g.prototype.getValueForModel=function(){var t=this._getDdr().getValue();var e;var a;var n;if(t){e=Object.assign({},t);var g=r.toDates(e),S=g[0].getJSDate?g[0].getJSDate():g[0],l=g[1].getJSDate?g[1].getJSDate():g[1];a={start:S.toISOString(),end:l.toISOString()};n={start:S.toISOString(),end:l.toISOString()};if(e.operator==="TO"){a.start=o.toISOString();n.start=i.toISOString()}if(e.operator==="FROM"){a.end=s.toISOString();n.end=u.toISOString()}e.operator=T(e.operator)}return{value:e,range:a,rangeOData:n}};g.prototype._getDdr=function(){var t=this.getAggregation("_ddr");if(!t){t=this._createDdr();this.setAggregation("_ddr",t)}return t};g.prototype._createDdr=function(){var t=Object.assign({},this.getConfig());var e;if(t.value){var o=t.value.operator.toUpperCase();var i=r.getOption(o).getValueTypes();e={operator:o,values:t.value.values.map(function(t,e){if(i[e]==="date"){return new Date(t)}return t})}}t.options=t.options||this._getDefaultOptions();t.options=t.options.map(function(t){return t.toUpperCase()});var s=new a({value:e,options:t.options});s.attachChange(function(t){if(t.getParameter("valid")){s.setValueState(n.None);this.setValue(this.getValueForModel())}else{s.setValueState(n.Error)}}.bind(this));return s};g.prototype._getDefaultOptions=function(){return["date","today","dateRange","from","to","lastDays","nextDays","lastWeeks","nextWeeks"]};return g});