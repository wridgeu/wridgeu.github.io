/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/designtime/baseEditor/propertyEditor/BasePropertyEditor","sap/ui/integration/designtime/baseEditor/propertyEditor/mapEditor/MapEditor","sap/base/util/includes","sap/base/util/restricted/_merge","sap/base/util/deepEqual"],function(e,t,a,r,i){"use strict";var l=t.extend("sap.ui.integration.designtime.cardEditor.propertyEditor.parametersEditor.ParametersEditor",{metadata:{library:"sap.ui.integration"},renderer:e.getMetadata().getRenderer().render});l.configMetadata=Object.assign({},t.configMetadata,{allowLabelChange:{defaultValue:true,mergeStrategy:"mostRestrictiveWins"}});l.prototype.getBoolenValue=function(e,t,a){if(typeof e==="boolean"){return e}if(typeof t==="boolean"){return t}return a};l.prototype.formatItemConfig=function(e){var a=t.prototype.formatItemConfig.apply(this,arguments);var r=e.key;var i=e.value.type;var l=this.getNestedDesigntimeMetadataValue(r);var o=this.getBoolenValue(e.value.visible,l.visible,true);var n=this.getBoolenValue(e.value.visibleToUser,l.visibleToUser,true);var s=this.getBoolenValue(e.value.editable,l.editable,true);var p=this.getBoolenValue(e.value.editableToUser,l.editableToUser,true);var u=this.getBoolenValue(e.value.required,l.required,false);var g=this.getBoolenValue(e.value.expanded,l.expanded,true);var E=e.value.manifestpath||l.manifestpath||"";var A=e.value.description||l.description||"";var d=this.getBoolenValue(e.value.translatable,l.translatable,false);var v=this.getBoolenValue(e.value.allowSettings,l.allowSettings,true);var R=this.getBoolenValue(e.value.allowDynamicValues,l.allowDynamicValues,false);var y=e.value.visualization||l.visualization;var b=e.value.values||l.values;var h=e.value.label||l.label;var I=e.value.placeholder||l.placeholder||"";var T=e.value.validations||l.validations;var D=e.value.hint||l.hint||"";var m=e.value.formatter||l.formatter;var P=e.value.layout||l.layout;a[2].visible=!(i==="group"||i==="array"||i==="separator");a.push({label:this.getI18nProperty("CARD_EDITOR.LABEL"),path:"label",value:h,placeholder:h?undefined:r,visible:i!=="separator",type:"string",enabled:this.getConfig().allowLabelChange,itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.DESCRIPTION"),path:"description",value:A,allowBindings:true,visible:i!=="group"&&i!=="separator",type:"string",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.HINT"),path:"hint",value:D,allowBindings:true,enabled:true,visible:i!=="separator",type:"string",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.FORMATTER"),path:"formatter",value:m,allowBindings:true,enabled:true,visible:i==="date"||i==="datetime"||i==="number"||i==="integer",type:"textArea",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.PLACEHOLDER"),path:"placeholder",value:I,allowBindings:true,visible:i==="string",type:"string",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.MANIFESTPATH"),path:"manifestpath",value:E,allowBindings:true,visible:i!=="group"&&i!=="separator",type:"string",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISIBLE"),path:"visible",value:o,allowBindings:true,type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISIBLETOUSER"),path:"visibleToUser",value:n,allowBindings:true,type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.EDITABLE"),path:"editable",allowBindings:true,value:s,enabled:true,visible:i!=="group"&&i!=="separator",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.EDITABLETOUSER"),path:"editableToUser",allowBindings:true,value:p,enabled:true,visible:i!=="group"&&i!=="separator",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.REQUIRED"),path:"required",allowBindings:true,value:u,visible:i==="string"||i==="number"||i==="integer",enabled:true,type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.EXPANDED"),path:"expanded",allowBindings:true,value:g,enabled:true,visible:i==="group",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.TRANSLATABLE"),path:"translatable",value:d,enabled:true,visible:i!=="separator",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.ALLOWDYNAMICVALUES"),path:"allowDynamicValues",allowBindings:true,enabled:true,value:R,visible:i!=="group"&&i!=="separator",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.ALLOWSETTINGS"),path:"allowSettings",allowBindings:true,value:v,visible:i!=="group"&&i!=="separator",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISUALIZATION"),path:"visualization",allowBindings:true,value:y,visible:i!=="group"&&i!=="separator",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISUALIZATION.PLACEHOLDER"),type:"textArea",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALIDATIONS"),path:"validations",allowBindings:true,value:T,visible:i==="string"||i==="number"||i==="integer",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALIDATIONS.PLACEHOLDER"),type:"textArea",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALUES"),path:"values",allowBindings:true,value:b,visible:i==="string"||i==="array",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALUES.PLACEHOLDER"),type:"textArea",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.LAYOUT"),path:"layout",allowBindings:true,value:P,visible:i!=="group"&&i!=="separator",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.LAYOUT.PLACEHOLDER"),type:"textArea",itemKey:r});return a};l.prototype.processInputValue=function(e){return e};l.prototype.processOutputValue=function(e){return e};l.prototype._configItemsFormatter=function(e){return Array.isArray(e)?e.map(function(e){var t=this.getNestedDesigntimeMetadataValue(e.key);var a=r({},e.value,t);if(!a.label){a.label=e.key}a.itemKey=e.key;a.path="value";a.designtime=this.getNestedDesigntimeMetadata(e.key);return a}.bind(this)):[]};l.prototype.getItemChangeHandlers=function(){return Object.assign({},t.prototype.getItemChangeHandlers.apply(this,arguments),{label:this._onDesigntimeChange})};l.prototype.onBeforeConfigChange=function(e){if(!e.allowTypeChange&&!e.allowKeyChange){this.setFragment("sap.ui.integration.designtime.cardEditor.propertyEditor.parametersEditor.ParametersConfigurationEditor",function(){return 1})}return e};l.prototype._isValidItem=function(e,t){var r=t.type;var i=t.value;var l=this._getAllowedTypes();return r&&a(l,r)||typeof i==="string"&&a(l,"string")};return l});