/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/editor/Editor","sap/ui/core/Core","sap/ui/integration/widgets/Card"],function(e,t,i){"use strict";var r=t.getLibraryResourceBundle("sap.ui.integration");var n=e.extend("sap.ui.integration.designtime.editor.CardEditor",{metadata:{library:"sap.ui.integration",properties:{card:{type:"any",defaultValue:null}},aggregations:{_extension:{type:"sap.ui.integration.Extension",multiple:false,visibility:"hidden"}}},renderer:e.getMetadata().getRenderer().render});n.prototype.hasPreview=function(){var e=this.getAggregation("_preview");if(e&&e.getSettings()&&e.getSettings().preview&&e.getSettings().preview.modes==="None"){return false}return true};n.prototype.setCard=function(e,r){if(e===this.getProperty("card")){return this}if(this._oEditorCard){this._oEditorCard.destroy()}this.setProperty("card",e,r);if(typeof e==="string"){try{e=JSON.parse(e)}catch(i){var n=t.byId(e);if(!n){var a=document.getElementById(e);if(a&&a.tagName&&a.tagName==="ui-integration-card"){n=a._getControl()}}e=n}}if(e&&e.isA&&e.isA("sap.ui.integration.widgets.Card")){e={manifest:e.getManifest(),manifestChanges:e.getManifestChanges(),host:e.getHost(),baseUrl:e.getBaseUrl()}}if(typeof e==="object"){this._oEditorCard=new i(e);this._oEditorCard.onBeforeRendering();this._oEditorCard.attachEventOnce("_cardReady",function(){this.setJson(e,r)}.bind(this))}};n.prototype._initPreview=function(){var e=this._oDesigntimeInstance.getSettings()||{};e.preview=e.preview||{};e.preview.position=this.getPreviewPosition();return new Promise(function(t,i){sap.ui.require(["sap/ui/integration/designtime/editor/CardPreview"],function(i){var r=new i({settings:e,card:this._oEditorCard});this.setAggregation("_preview",r);t()}.bind(this))}.bind(this))};n.prototype._loadExtension=function(){return new Promise(function(e,t){var i=this._oEditorCard.getAggregation("_extension");this.setAggregation("_extension",i);e()}.bind(this))};n.prototype._mergeContextData=function(e){var t={};t["empty"]=n._contextEntries.empty;for(var i in e){t[i]=e[i]}t["card.internal"]=n._contextEntries["card.internal"];return t};n._contextEntries={empty:{label:r.getText("CARDEDITOR_CONTEXT_EMPTY_VAL"),type:"string",description:r.getText("CARDEDITOR_CONTEXT_EMPTY_DESC"),placeholder:"",value:""},"card.internal":{label:r.getText("CARDEDITOR_CONTEXT_CARD_INTERNAL_VAL"),todayIso:{type:"string",label:r.getText("CARDEDITOR_CONTEXT_CARD_TODAY_VAL"),description:r.getText("CARDEDITOR_CONTEXT_CARD_TODAY_DESC"),tags:[],placeholder:r.getText("CARDEDITOR_CONTEXT_CARD_TODAY_VAL"),customize:["format.dataTime"],value:"{{parameters.TODAY_ISO}}"},nowIso:{type:"string",label:r.getText("CARDEDITOR_CONTEXT_CARD_NOW_VAL"),description:r.getText("CARDEDITOR_CONTEXT_CARD_NOW_DESC"),tags:[],placeholder:r.getText("CARDEDITOR_CONTEXT_CARD_NOW_VAL"),customize:["dateFormatters"],value:"{{parameters.NOW_ISO}}"},currentLanguage:{type:"string",label:r.getText("CARDEDITOR_CONTEXT_CARD_LANG_VAL"),description:r.getText("CARDEDITOR_CONTEXT_CARD_LANG_VAL"),tags:["technical"],customize:["languageFormatters"],placeholder:r.getText("CARDEDITOR_CONTEXT_CARD_LANG_VAL"),value:"{{parameters.LOCALE}}"}}};return n});