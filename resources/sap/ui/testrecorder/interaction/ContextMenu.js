/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/base/Object","sap/ui/testrecorder/Constants","sap/ui/testrecorder/interaction/Commands","sap/ui/testrecorder/interaction/CommandExecutor","sap/ui/testrecorder/CommunicationBus","sap/ui/testrecorder/CommunicationChannels"],function(e,t,o,i,n,s,r){"use strict";var c=5;var a=null;var u={};var d={};var l={};var f=t.extend("sap.ui.testrecorder.interaction.ContextMenu",{});f.show=function(t){u=t.domElementId;if(a===null&&!document.getElementById(o.CONTEXTMENU_ID)){a=p(t)}if(t.items){var i=Object.keys(d).filter(function(e){return!(t.items[e]||t.items[e]===undefined)});var n=Object.keys(d).filter(function(e){return t.items[e]||t.items[e]===undefined});if(i.length===Object.keys(d).length){this.hide();return this}i.forEach(function(e){d[e].hide()});n.forEach(function(e){d[e].show()})}var s=e(sap.ui.getCore().getStaticAreaRef());e.map(s.find(":visible"),function(t){var o=e(t);if(o.control&&o.control()[0]){var i=o.control()[0];if(i.oPopup&&i.oPopup.setAutoClose&&!l[i.getId()]){l[i.getId()]={autoClose:i.oPopup.getAutoClose()};i.oPopup.setAutoClose(false)}}});var r=e(window).width();var h=e(window).height();var v=a.width();var E=a.height();var m=t.location.x+v+c>=r?t.location.x-v:t.location.x;var b=t.location.y+E+c>=h?t.location.y-E:t.location.y;a.css("top",b+c+"px");a.css("left",m+c+"px");f._show();return this};f.hide=function(){if(a){a.hide()}Object.keys(l).forEach(function(e){var t=sap.ui.getCore().byId(e).oPopup;t.setAutoClose(l[e].autoClose);t._$().focus()});l={}};f._show=function(){if(a){a.show()}};function p(t){var c=e("<div></div>");var a=e("<div></div>");var l=e("<div></div>");var p=e("<div></div>");d={highlight:a,press:l,enterText:p};a.text("Highlight");l.text("Press");p.text("Enter Text");a.on("click",function(){f.hide();var e={domElementId:u};if(t.withEvents){s.publish(r.CONTEXT_MENU_HIGHLIGHT,e)}else{n.execute(i.HIGHLIGHT,e)}});l.on("click",function(){f.hide();var e={domElementId:u};if(t.withEvents){s.publish(r.CONTEXT_MENU_PRESS,e)}else{n.execute(i.PRESS,e)}});p.on("click",function(){f.hide();var e={domElementId:u};if(t.withEvents){s.publish(r.CONTEXT_MENU_ENTER_TEXT,e)}else{n.execute(i.ENTER_TEXT,e)}});c.attr("id",o.CONTEXTMENU_ID);c.css("min-width","150px");c.css("position","absolute");c.css("z-index",1001);c.css("border","1px solid rgb(200, 142, 250)");c.css("border-radius","3px");c.css("background","#fff");c.css("box-sizing","border-box");[a,p,l].forEach(function(e){e.css("padding","16px");e.css("cursor","pointer");e.on("mouseenter",function(){e.css("background-color","#ebf5fe")}).on("mouseleave",function(){e.css("background-color","transparent")})});[a,l].forEach(function(e){e.css("border-bottom","1px solid #d9d9d9")});c.append(a);c.append(l);c.append(p);e(document.body).append(c);return c}return f});