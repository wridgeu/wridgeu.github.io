ace.define("ace/ext/code_lens",["require","exports","module","ace/line_widgets","ace/lib/event","ace/lib/lang","ace/lib/dom","ace/editor","ace/config"],function(e,n,r){"use strict";var t=e("../line_widgets").LineWidgets;var i=e("../lib/event");var o=e("../lib/lang");var a=e("../lib/dom");function s(e){var n=e.$textLayer;var r=n.$lenses;if(r)r.forEach(function(e){e.remove()});n.$lenses=null}function c(e,n){var r=e&n.CHANGE_LINES||e&n.CHANGE_FULL||e&n.CHANGE_SCROLL||e&n.CHANGE_TEXT;if(!r)return;var t=n.session;var i=n.session.lineWidgets;var o=n.$textLayer;var c=o.$lenses;if(!i){if(c)s(n);return}var d=n.$textLayer.$lines.cells;var l=n.layerConfig;var f=n.$padding;if(!c)c=o.$lenses=[];var u=0;for(var v=0;v<d.length;v++){var g=d[v].row;var L=i[g];var p=L&&L.lenses;if(!p||!p.length)continue;var h=c[u];if(!h){h=c[u]=a.buildDom(["div",{class:"ace_codeLens"}],n.container)}h.style.height=l.lineHeight+"px";u++;for(var m=0;m<p.length;m++){var $=h.childNodes[2*m];if(!$){if(m!=0)h.appendChild(a.createTextNode(" | "));$=a.buildDom(["a"],h)}$.textContent=p[m].title;$.lensCommand=p[m]}while(h.childNodes.length>2*m-1)h.lastChild.remove();var C=n.$cursorLayer.getPixelPosition({row:g,column:0},true).top-l.lineHeight*L.rowsAbove-l.offset;h.style.top=C+"px";var w=n.gutterWidth;var x=t.getLine(g).search(/\S|$/);if(x==-1)x=0;w+=x*l.characterWidth;w-=n.scrollLeft;h.style.paddingLeft=f+w+"px"}while(u<c.length)c.pop().remove()}function d(e){if(!e.lineWidgets)return;var n=e.widgetManager;e.lineWidgets.forEach(function(e){if(e&&e.lenses)n.removeLineWidget(e)})}n.setLenses=function(e,n){var r=Number.MAX_VALUE;d(e);n&&n.forEach(function(n){var t=n.start.row;var i=n.start.column;var o=e.lineWidgets&&e.lineWidgets[t];if(!o||!o.lenses){o=e.widgetManager.$registerLineWidget({rowCount:1,rowsAbove:1,row:t,column:i,lenses:[]})}o.lenses.push(n.command);if(t<r)r=t});e._emit("changeFold",{data:{start:{row:r}}})};function l(e){e.codeLensProviders=[];e.renderer.on("afterRender",c);if(!e.$codeLensClickHandler){e.$codeLensClickHandler=function(n){var r=n.target.lensCommand;if(r)e.execCommand(r.id,r.arguments)};i.addListener(e.container,"click",e.$codeLensClickHandler,e)}e.$updateLenses=function(){var r=e.session;if(!r)return;if(!r.widgetManager){r.widgetManager=new t(r);r.widgetManager.attach(e)}var i=e.codeLensProviders.length;var o=[];e.codeLensProviders.forEach(function(e){e.provideCodeLenses(r,function(e,n){if(e)return;n.forEach(function(e){o.push(e)});i--;if(i==0){a()}})});function a(){var t=r.selection.cursor;var i=r.documentToScreenRow(t);n.setLenses(r,o);var a=r.$undoManager&&r.$undoManager.$lastDelta;if(a&&a.action=="remove"&&a.lines.length>1)return;var s=r.documentToScreenRow(t);var c=e.renderer.layerConfig.lineHeight;var d=r.getScrollTop()+(s-i)*c;r.setScrollTop(d)}};var r=o.delayedCall(e.$updateLenses);e.$updateLensesOnInput=function(){r.delay(250)};e.on("input",e.$updateLensesOnInput)}function f(e){e.off("input",e.$updateLensesOnInput);e.renderer.off("afterRender",c);if(e.$codeLensClickHandler)e.container.removeEventListener("click",e.$codeLensClickHandler)}n.registerCodeLensProvider=function(e,n){e.setOption("enableCodeLens",true);e.codeLensProviders.push(n);e.$updateLensesOnInput()};n.clear=function(e){n.setLenses(e,null)};var u=e("../editor").Editor;e("../config").defineOptions(u.prototype,"editor",{enableCodeLens:{set:function(e){if(e){l(this)}else{f(this)}}}});a.importCssString(".ace_codeLens {    position: absolute;    color: #aaa;    font-size: 88%;    background: inherit;    width: 100%;    display: flex;    align-items: flex-end;    pointer-events: none;}.ace_codeLens > a {    cursor: pointer;    pointer-events: auto;}.ace_codeLens > a:hover {    color: #0000ff;    text-decoration: underline;}.ace_dark > .ace_codeLens > a:hover {    color: #4e94ce;}","")});(function(){ace.require(["ace/ext/code_lens"],function(e){if(typeof module=="object"&&typeof exports=="object"&&module){module.exports=e}})})();