ace.define("ace/ext/beautify",[],function(e,t,a){"use strict";var r=e("../token_iterator").TokenIterator;function i(e,t){return e.type.lastIndexOf(t+".xml")>-1}t.singletonTags=["area","base","br","col","command","embed","hr","html","img","input","keygen","link","meta","param","source","track","wbr"];t.blockTags=["article","aside","blockquote","body","div","dl","fieldset","footer","form","head","header","html","nav","ol","p","script","section","style","table","tbody","tfoot","thead","ul"];t.beautify=function(e){var a=new r(e,0,0);var s=a.getCurrentToken();var f=e.getTabString();var l=t.singletonTags;var o=t.blockTags;var n;var u=false;var c=false;var m=false;var p="";var h="";var v="";var y=0;var d=0;var b=0;var g=0;var $=0;var k=0;var w=0;var x;var T=0;var R=0;var O=[];var q=false;var C;var I=false;var j=false;var B=false;var F=false;var S={0:0};var _=[];var K=false;var L=function(){if(n&&n.value&&n.type!=="string.regexp")n.value=n.value.replace(/^\s*/,"")};var V=function(){p=p.replace(/ +$/,"")};var z=function(){p=p.trimRight();u=false};while(s!==null){T=a.getCurrentTokenRow();O=a.$rowTokens;n=a.stepForward();if(typeof s!=="undefined"){h=s.value;$=0;B=v==="style"||e.$modeId==="ace/mode/css";if(i(s,"tag-open")){j=true;if(n)F=o.indexOf(n.value)!==-1;if(h==="</"){if(F&&!u&&R<1)R++;if(B)R=1;$=1;F=false}}else if(i(s,"tag-close")){j=false}else if(i(s,"comment.start")){F=true}else if(i(s,"comment.end")){F=false}if(!j&&!R&&s.type==="paren.rparen"&&s.value.substr(0,1)==="}"){R++}if(T!==x){R=T;if(x)R-=x}if(R){z();for(;R>0;R--)p+="\n";u=true;if(!i(s,"comment")&&!s.type.match(/^(comment|string)$/))h=h.trimLeft()}if(h){if(s.type==="keyword"&&h.match(/^(if|else|elseif|for|foreach|while|switch)$/)){_[y]=h;L();m=true;if(h.match(/^(else|elseif)$/)){if(p.match(/\}[\s]*$/)){z();c=true}}}else if(s.type==="paren.lparen"){L();if(h.substr(-1)==="{"){m=true;I=false;if(!j)R=1}if(h.substr(0,1)==="{"){c=true;if(p.substr(-1)!=="["&&p.trimRight().substr(-1)==="["){z();c=false}else if(p.trimRight().substr(-1)===")"){z()}else{V()}}}else if(s.type==="paren.rparen"){$=1;if(h.substr(0,1)==="}"){if(_[y-1]==="case")$++;if(p.trimRight().substr(-1)==="{"){z()}else{c=true;if(B)R+=2}}if(h.substr(0,1)==="]"){if(p.substr(-1)!=="}"&&p.trimRight().substr(-1)==="}"){c=false;g++;z()}}if(h.substr(0,1)===")"){if(p.substr(-1)!=="("&&p.trimRight().substr(-1)==="("){c=false;g++;z()}}V()}else if((s.type==="keyword.operator"||s.type==="keyword")&&h.match(/^(=|==|===|!=|!==|&&|\|\||and|or|xor|\+=|.=|>|>=|<|<=|=>)$/)){z();L();c=true;m=true}else if(s.type==="punctuation.operator"&&h===";"){z();L();m=true;if(B)R++}else if(s.type==="punctuation.operator"&&h.match(/^(:|,)$/)){z();L();if(h.match(/^(,)$/)&&w>0&&k===0){R++}else{m=true;u=false}}else if(s.type==="support.php_tag"&&h==="?>"&&!u){z();c=true}else if(i(s,"attribute-name")&&p.substr(-1).match(/^\s$/)){c=true}else if(i(s,"attribute-equals")){V();L()}else if(i(s,"tag-close")){V();if(h==="/>")c=true}else if(s.type==="keyword"&&h.match(/^(case|default)$/)){if(K)$=1}if(u&&!(s.type.match(/^(comment)$/)&&!h.substr(0,1).match(/^[/#]$/))&&!(s.type.match(/^(string)$/)&&!h.substr(0,1).match(/^['"]$/))){g=b;if(y>d){g++;for(C=y;C>d;C--)S[C]=g}else if(y<d)g=S[y];d=y;b=g;if($)g-=$;if(I&&!k){g++;I=false}for(C=0;C<g;C++)p+=f}if(s.type==="keyword"&&h.match(/^(case|default)$/)){if(K===false){_[y]=h;y++;K=true}}else if(s.type==="keyword"&&h.match(/^(break)$/)){if(_[y-1]&&_[y-1].match(/^(case|default)$/)){y--;K=false}}if(s.type==="paren.lparen"){k+=(h.match(/\(/g)||[]).length;w+=(h.match(/\{/g)||[]).length;y+=h.length}if(s.type==="keyword"&&h.match(/^(if|else|elseif|for|while)$/)){I=true;k=0}else if(!k&&h.trim()&&s.type!=="comment")I=false;if(s.type==="paren.rparen"){k-=(h.match(/\)/g)||[]).length;w-=(h.match(/\}/g)||[]).length;for(C=0;C<h.length;C++){y--;if(h.substr(C,1)==="}"&&_[y]==="case"){y--}}}if(s.type=="text")h=h.replace(/\s+$/," ");if(c&&!u){V();if(p.substr(-1)!=="\n")p+=" "}p+=h;if(m)p+=" ";u=false;c=false;m=false;if(i(s,"tag-close")&&(F||o.indexOf(v)!==-1)||i(s,"doctype")&&h===">"){if(F&&n&&n.value==="</")R=-1;else R=1}if(i(s,"tag-open")&&h==="</"){y--}else if(i(s,"tag-open")&&h==="<"&&l.indexOf(n.value)===-1){y++}else if(i(s,"tag-name")){v=h}else if(i(s,"tag-close")&&h==="/>"&&l.indexOf(v)===-1){y--}x=T}}s=n}p=p.trim();e.doc.setValue(p)};t.commands=[{name:"beautify",description:"Format selection (Beautify)",exec:function(e){t.beautify(e.session)},bindKey:"Ctrl-Shift-B"}]});(function(){ace.require(["ace/ext/beautify"],function(e){if(typeof module=="object"&&typeof exports=="object"&&module){module.exports=e}})})();