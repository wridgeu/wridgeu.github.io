/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./_CreatedContextsCache","./Context","./ODataAnnotations","./ODataContextBinding","./ODataListBinding","./ODataTreeBinding","sap/base/assert","sap/base/Log","sap/base/security/encodeURL","sap/base/util/deepEqual","sap/base/util/deepExtend","sap/base/util/each","sap/base/util/extend","sap/base/util/isEmptyObject","sap/base/util/isPlainObject","sap/base/util/merge","sap/base/util/uid","sap/base/util/UriParameters","sap/ui/base/SyncPromise","sap/ui/core/library","sap/ui/core/message/Message","sap/ui/core/message/MessageParser","sap/ui/model/BindingMode","sap/ui/model/Context","sap/ui/model/FilterProcessor","sap/ui/model/Model","sap/ui/model/odata/CountMode","sap/ui/model/odata/MessageScope","sap/ui/model/odata/ODataMetadata","sap/ui/model/odata/ODataMetaModel","sap/ui/model/odata/ODataMessageParser","sap/ui/model/odata/ODataPropertyBinding","sap/ui/model/odata/ODataUtils","sap/ui/model/odata/OperationMode","sap/ui/model/odata/UpdateMethod","sap/ui/thirdparty/datajs","sap/ui/thirdparty/URI","sap/ui/util/isCrossOriginURL"],function(e,t,a,r,s,i,n,o,d,u,h,f,c,p,l,g,_,m,y,v,b,C,P,q,R,M,E,S,x,T,U,D,A,I,O,k,H,L){"use strict";var B="sap.ui.model.odata.v2.ODataModel",F=v.MessageType,w={},G=["groupId","urlParameters"];w[F.Error]=0;w[F.Warning]=1;w[F.Success]=2;w[F.Information]=3;w[F.None]=4;var j=M.extend("sap.ui.model.odata.v2.ODataModel",{constructor:function(t,r){M.apply(this,arguments);var s,i,n,o,d,u,h,f,c,p,l,g,_,m,y,v,b,C,q,R,T,U,D,k,H,B,F,w,G,N,W=this;if(typeof t==="object"){r=t;this.sServiceUrl=r.serviceUrl}else{this.sServiceUrl=t}this.mCodeListModelParams=this.createCodeListModelParameters(r);if(r){s=r.user;i=r.password;n=r.headers;o=r.tokenHandling;d=r.withCredentials;u=r.maxDataServiceVersion;h=r.useBatch;f=r.refreshAfterChange;c=r.annotationURI;p=r.loadAnnotationsJoined;_=r.defaultBindingMode;l=r.defaultCountMode;g=r.preliminaryContext;m=r.defaultOperationMode;y=r.metadataNamespaces;v=r.serviceUrlParams;b=r.metadataUrlParams;C=r.json;q=r.messageParser;R=r.skipMetadataAnnotationParsing;T=r.defaultUpdateMethod;U=r.disableHeadRequestForToken;D=r.sequentializeRequests;k=r.disableSoftStateHeader;H=r.bindableResponseHeaders;B=r.warmupUrl;F=r.canonicalRequests;w=r.tokenHandlingForGet;G=r.earlyTokenRequest;N=r.persistTechnicalMessages}this.mPathCache={};this.mInvalidatedPaths={};this.bCanonicalRequests=!!F;this.bTokenHandlingForGet=!!w;this.sMessageScope=S.RequestedObjects;this.sWarmupUrl=B;this.bWarmup=!!B;this.mSupportedBindingModes={OneWay:true,OneTime:true,TwoWay:true};this.mUnsupportedFilterOperators={Any:true,All:true};this.sDefaultBindingMode=_||P.OneWay;this.bIsMessageScopeSupported=false;this.iPendingDeferredRequests=0;this.bJSON=C!==false;this.aPendingRequestHandles=[];this.aCallAfterUpdate=[];this.mRequests={};this.mDeferredRequests={};this.mChangedEntities={};this.mChangeHandles={};this.mDeferredGroups={};this.mLaunderingState={};this.sDefaultUpdateMethod=T||O.Merge;this.bTokenHandling=o!==false;this.bWithCredentials=d===true;this.bUseBatch=h!==false;this.bRefreshAfterChange=f!==false;this.sMaxDataServiceVersion=u;this.bLoadAnnotationsJoined=p!==false;this.sAnnotationURI=c;this.sDefaultCountMode=l||E.Request;this.sDefaultOperationMode=m||I.Default;this.sMetadataLoadEvent=null;this.oMetadataFailedEvent=null;this.sRefreshGroupId=undefined;this.bIncludeInCurrentBatch=false;this.bSkipMetadataAnnotationParsing=!!R;this.bDisableHeadRequestForToken=!!U;this.bSequentializeRequests=!!D;this.bDisableSoftStateHeader=!!k;this.aBindableResponseHeaders=H?H:null;this.bPreliminaryContext=g||false;this.mMetadataUrlParams=b||{};this.mChangedEntities4checkUpdate={};this.bPersistTechnicalMessages=N===undefined?undefined:!!N;this.oCreatedContextsCache=new e;this.aSideEffectCleanUpFunctions=[];if(q){q.setProcessor(this)}this.oMessageParser=q;this.sDefaultChangeGroup="changes";this.setDeferredGroups([this.sDefaultChangeGroup]);this.setChangeGroups({"*":{groupId:this.sDefaultChangeGroup}});this.oData={};this.oMetadata=null;this.oAnnotations=null;this.aUrlParams=[];this.pSequentialRequestCompleted=Promise.resolve();this.pReadyForRequest=Promise.resolve();var $=this.sServiceUrl.split("?");if($.length>1){this.sServiceUrl=$[0];if($[1]){this.aUrlParams.push($[1])}}this.sServiceUrl=this.sServiceUrl.replace(/\/$/,"");this.sUser=s;this.sPassword=i;if(sap.ui.getCore().getConfiguration().getStatistics()){this.aUrlParams.push("sap-statistics=true")}this.oHeaders={};this.setHeaders(n);if(!this.bDisableSoftStateHeader){this.oHeaders["sap-contextid-accept"]="header";this.mCustomHeaders["sap-contextid-accept"]="header"}var K=this._getServerUrl();this.sMetadataUrl=this.sWarmupUrl||this._createMetadataUrl("/$metadata");this.oSharedServerData=j._getSharedData("server",K);this.oSharedServiceData=j._getSharedData("service",this.sServiceUrl);this.oSharedMetaData=j._getSharedData("meta",this.sMetadataUrl);this.bUseCache=this._cacheSupported(this.sMetadataUrl);if(!this.oSharedMetaData.oMetadata||this.oSharedMetaData.oMetadata.bFailed){this.oMetadata=new x(this.sMetadataUrl,{async:true,cacheKey:this.bUseCache?this.sMetadataUrl:undefined,user:this.sUser,password:this.sPassword,headers:this.mCustomHeaders,namespaces:y,withCredentials:this.bWithCredentials});if(!this.bWarmup){this.oSharedMetaData.oMetadata=this.oMetadata}}else{this.oMetadata=this.oSharedMetaData.oMetadata}this.oAnnotations=new a(this.oMetadata,{source:this.sAnnotationURI,skipMetadata:this.bSkipMetadataAnnotationParsing,headers:this.mCustomHeaders,combineEvents:true,cacheKey:this._getAnnotationCacheKey(this.sMetadataUrl),useCache:this.bUseCache});if(!this.bDisableSoftStateHeader){delete this.mCustomHeaders["sap-contextid-accept"]}this.oAnnotations.attachAllFailed(this.onAnnotationsFailed,this);this.oAnnotations.attachSomeLoaded(this.onAnnotationsLoaded,this);this.pAnnotationsLoaded=this.oAnnotations.loaded();if(v){this.aUrlParams=this.aUrlParams.concat(A._createUrlParamsArray(v))}this.onMetadataFailed=function(e){W.fireMetadataFailed(e.getParameters())};if(!this.oMetadata.isLoaded()){this.oMetadata.attachFailed(this.onMetadataFailed)}this.oMetadata.loaded().then(function(){W._initializeMetadata()});if(this.bJSON){if(this.sMaxDataServiceVersion==="3.0"){this.oHeaders["Accept"]="application/json;odata=fullmetadata"}else{this.oHeaders["Accept"]="application/json"}}else{this.oHeaders["Accept"]="application/atom+xml,application/atomsvc+xml,application/xml"}if(this.bTokenHandling){if(this.oSharedServiceData.securityToken){this.oHeaders["x-csrf-token"]=this.oSharedServiceData.securityToken}else if(this.oSharedServerData.securityToken){this.oSharedServiceData.securityToken=this.oSharedServerData.securityToken;this.oHeaders["x-csrf-token"]=this.oSharedServiceData.securityToken}if(G){this.securityTokenAvailable()}}this.oHeaders["Accept-Language"]=sap.ui.getCore().getConfiguration().getLanguageTag();this.oHeaders["DataServiceVersion"]="2.0";this.oHeaders["MaxDataServiceVersion"]="2.0";if(this.sMaxDataServiceVersion){this.oHeaders["MaxDataServiceVersion"]=this.sMaxDataServiceVersion}if(!this.mCustomHeaders["X-Requested-With"]&&!L(this.sServiceUrl)){this.oHeaders["X-Requested-With"]="XMLHttpRequest"}},metadata:{publicMethods:["read","create","update","remove","submitChanges","getServiceMetadata","metadataLoaded","hasPendingChanges","getPendingChanges","refresh","refreshMetadata","resetChanges","setDefaultCountMode","setDefaultBindingMode","getDefaultBindingMode","getDefaultCountMode","setProperty","getSecurityToken","refreshSecurityToken","setHeaders","getHeaders","setUseBatch","setDeferredBatchGroups","getDeferredBatchGroups","setChangeBatchGroups","getChangeBatchGroups"]}});j.M_EVENTS={MetadataLoaded:"metadataLoaded",MetadataFailed:"metadataFailed",AnnotationsLoaded:"annotationsLoaded",AnnotationsFailed:"annotationsFailed",BatchRequestFailed:"batchRequestFailed",BatchRequestSent:"batchRequestSent",BatchRequestCompleted:"batchRequestCompleted"};j.prototype.attachBatchRequestFailed=function(e,t,a){this.attachEvent("batchRequestFailed",e,t,a);return this};j.prototype.detachBatchRequestFailed=function(e,t){this.detachEvent("batchRequestFailed",e,t);return this};j.prototype.fireBatchRequestFailed=function(e){this.fireEvent("batchRequestFailed",e);return this};j.prototype.attachBatchRequestSent=function(e,t,a){this.attachEvent("batchRequestSent",e,t,a);return this};j.prototype.detachBatchRequestSent=function(e,t){this.detachEvent("batchRequestSent",e,t);return this};j.prototype.fireBatchRequestSent=function(e){this.fireEvent("batchRequestSent",e);return this};j.prototype.attachBatchRequestCompleted=function(e,t,a){this.attachEvent("batchRequestCompleted",e,t,a);return this};j.prototype.detachBatchRequestCompleted=function(e,t){this.detachEvent("batchRequestCompleted",e,t);return this};j.prototype.fireBatchRequestCompleted=function(e){this.fireEvent("batchRequestCompleted",e);return this};j.mSharedData={server:{},service:{},meta:{}};j._getSharedData=function(e,t){var a=this.mSharedData[e][t];if(!a){a={};this.mSharedData[e][t]=a}return a};j.prototype._initializeMetadata=function(){if(this.bDestroyed){return}this.bIsMessageScopeSupported=this.oMetadata._isMessageScopeSupported();var e=function(){this.fireMetadataLoaded({metadata:this.oMetadata});o.debug(this+" - metadataloaded fired")}.bind(this);this.initialize();if(this.bLoadAnnotationsJoined){this.oAnnotations.loaded().then(e,this.fireMetadataFailed.bind(this))}else{e()}};j.prototype.refreshMetadata=function(){if(this.oMetadata&&this.oMetadata.refresh){return this.oMetadata.refresh()}return undefined};j.prototype.fireAnnotationsLoaded=function(e){this.fireEvent("annotationsLoaded",e);return this};j.prototype.attachAnnotationsLoaded=function(e,t,a){this.attachEvent("annotationsLoaded",e,t,a);return this};j.prototype.detachAnnotationsLoaded=function(e,t){this.detachEvent("annotationsLoaded",e,t);return this};j.prototype.fireAnnotationsFailed=function(e){this.fireEvent("annotationsFailed",e);o.debug(this+" - annotationsfailed fired");return this};j.prototype.attachAnnotationsFailed=function(e,t,a){this.attachEvent("annotationsFailed",e,t,a);return this};j.prototype.detachAnnotationsFailed=function(e,t){this.detachEvent("annotationsFailed",e,t);return this};j.prototype.fireMetadataLoaded=function(e){this.fireEvent("metadataLoaded",e);return this};j.prototype.attachMetadataLoaded=function(e,t,a){this.attachEvent("metadataLoaded",e,t,a);return this};j.prototype.detachMetadataLoaded=function(e,t){this.detachEvent("metadataLoaded",e,t);return this};j.prototype.fireMetadataFailed=function(e){this.fireEvent("metadataFailed",e);return this};j.prototype.attachMetadataFailed=function(e,t,a){this.attachEvent("metadataFailed",e,t,a);return this};j.prototype.detachMetadataFailed=function(e,t){this.detachEvent("metadataFailed",e,t);return this};j.prototype._createEventInfo=function(e,t,a){var r,s,i={};i.url=e.requestUri;i.method=e.method;i.async=e.async;i.headers=e.headers;if(a){i.requests=[];for(var n=0;n<a.length;n++){s={};if(Array.isArray(a[n])){var o=a[n];for(var d=0;d<o.length;d++){e=o[d].request;r=a[n][d].response;s={};s.url=e.requestUri;s.method=e.method;s.headers=e.headers;if(r){s.response={};if(e._aborted){s.success=false;s.response.statusCode=0;s.response.statusText="abort"}else{s.success=true;if(r.message){s.response.message=r.message;r=r.response;s.response.responseText=r.body;s.success=false}s.response.headers=r.headers;s.response.statusCode=r.statusCode;s.response.statusText=r.statusText}}i.requests.push(s)}}else{e=a[n].request;r=a[n].response;s.url=e.requestUri;s.method=e.method;s.headers=e.headers;if(r){s.response={};if(e._aborted){s.success=false;s.response.statusCode=0;s.response.statusText="abort"}else{s.success=true;if(r.message){s.response.message=r.message;r=r.response;s.response.responseText=r.body;s.success=false}s.response.headers=r.headers;s.response.statusCode=r.statusCode;s.response.statusText=r.statusText}}i.requests.push(s)}}}if(t){i.response={};i.success=true;if(t.message){i.response.message=t.message;i.success=false}if(t.response){t=t.response}if(t&&t.statusCode!=undefined){i.response.headers=t.headers;i.response.statusCode=t.statusCode;i.response.statusText=t.statusText;i.response.responseText=t.body!==undefined?t.body:t.responseText;if(t.expandAfterCreateFailed){i.response.expandAfterCreateFailed=true}if(t.expandAfterFunctionCallFailed){i.response.expandAfterFunctionCallFailed=true}}}i.ID=e.requestID;return i};j.prototype._createRequestID=function(){var e;e=_();return e};j.prototype._getServerUrl=function(){var e,t;e=new H(this.sServiceUrl).absoluteTo(document.baseURI);t=new H("/").absoluteTo(e).toString();return t};j.prototype._createMetadataUrl=function(e){if(e.indexOf(this.sServiceUrl)==-1){if(!e.startsWith("/")){e="/"+e}e=this.sServiceUrl+e}var t=m.fromURL(e||window.location.href);var a=Object.assign({},this.mMetadataUrlParams);Array.from(t.keys()).forEach(function(e){a[e]=t.get(e)});var r=A._createUrlParamsArray(a);var s=e.split("?");if(s.length>1){e=s[0]}return this._addUrlParams(e,r)};j.prototype._addUrlParams=function(e,t){var a=[];if(this.aUrlParams){a=a.concat(this.aUrlParams)}if(t){a=a.concat(t)}if(a.length>0){e+="?"+a.join("&")}return e};j.prototype._createRequestUrl=function(e,t,a,r){return this._createRequestUrlWithNormalizedPath(this._normalizePath(e,t),a,r)};j.prototype._createRequestUrlWithNormalizedPath=function(e,t,a){var r="";if(!a){r=this.sServiceUrl+e}else{r=e.substr(e.indexOf("/")+1)}return this._addUrlParams(r,t)};j.prototype._importData=function(e,t,a,r,s,i,n,o,d){var u=this,h,c,l,g;r=r||"";i=i||"";if(e.results&&Array.isArray(e.results)){h=[];f(e.results,function(e,i){var n=u._getKey(i);n=u._importData(i,t,a,r.substr(0,r.lastIndexOf("/")),s,n,undefined,undefined,d);if(n){h.push(n)}});return h}else{if(i){r="/"+i;s+=i.substr(i.indexOf("("))}else{i=this._getKey(e)}if(!i){return i}l=this._getEntity(i);g=l;if(!l||l.__metadata&&l.__metadata.invalid){if(!g){g=e}l=e;i=this._addEntity(l)}if(this.aBindableResponseHeaders){var _={};for(var m in a.headers){var y=m.toLowerCase();if(this.aBindableResponseHeaders.indexOf(y)>-1){_[y]=a.headers[m]}}if(!p(_)){if(!e.__metadata){e.__metadata={}}e.__metadata.headers=_}}f(e,function(e,n){if(n&&(n.__metadata&&n.__metadata.uri||n.results)&&!n.__deferred){var o=r+"/"+e;var h=s+"/"+e;c=u._importData(n,t,a,o,h,undefined,false,"/"+i+"/"+e,d);if(Array.isArray(c)){l[e]={__list:c};if(d){l[e].__list.sideEffects=true;u.aSideEffectCleanUpFunctions.push(function(){delete l[e]})}}else{if(g[e]&&g[e].__ref){if(g[e].__ref!==c){u.mInvalidatedPaths[r.substr(r.lastIndexOf("("))+"/"+e]="/"+c}}l[e]={__ref:c}}}else if(!n||!n.__deferred){if(g[e]&&n===null){u.mInvalidatedPaths[r.substr(r.lastIndexOf("("))+"/"+e]=null}l[e]=n}});var v={};v[i]=l;if(this.hasContext("/"+i)&&this.getContext("/"+i).isPreliminary()){var b=this.getContext("/"+i);b.setUpdated(true);b.setPreliminary(false)}this._updateChangedEntities(v);t[i]=true;r=r||"/"+i;s=s||r;var C=this.resolveFromCache(s);if(C==="/"+i||C&&C.split("/").length>2){this._writePathCache(C,"/"+i,n)}this._writePathCache(r,"/"+i,n);this._writePathCache(s,"/"+i,n,true);if(o){this._writePathCache(o,"/"+i,n)}return i}};j.prototype._writePathCache=function(e,t,a,r){var s,i,n,o,d,u;if(e&&t){if(!this.mPathCache[e]){this.mPathCache[e]={}}if(!a&&e.lastIndexOf("/")===0){t=e}this.mPathCache[e].canonicalPath=t;if(r){d=e.split("/");for(u=3;u<d.length;u+=1){n=d.slice(0,u).join("/");o=this.mPathCache[n];if(o){s=o.canonicalPath+e.slice(n.length);i=this.mPathCache[s];if(i){i.canonicalPath=t}}}}}};j.prototype._removeReferences=function(e){var t=this,a;if(!e){return e}if(e.results){a=[];f(e.results,function(e,r){a.push(t._removeReferences(r))});return a}else{f(e,function(t,a){if(a){if(a["__ref"]||a["__list"]){delete e[t]}}});return e}};j.prototype._restoreReferences=function(e,t){var a=this,r,s,i;function o(e){var r=t[e];if(!r){r=a._getObject("/"+e);n(r,"ODataModel inconsistent: "+e+" not found!");if(r){r=g({},r);t[e]=r;a._restoreReferences(r,t)}}return r}if(!t){t={}}f(e,function(t,a){if(a){if(a.__ref){r=a.__ref;s=o(r);if(s){e[t]=s}delete a.__ref}else if(a.__list){i=[];f(a.__list,function(e,t){s=o(t);if(s){i.push(s)}});delete a.__list;a.results=i}}});return e};j.prototype.removeData=function(){this.oData={}};j.prototype.initialize=function(){var e=this.getBindings();e.forEach(function(e){e.initialize()})};j.prototype.invalidate=function(e){var t;for(var a in this.oData){t=this.oData[a];if(!e||e(a,t)){t.__metadata.invalid=true}}};j.prototype.invalidateEntry=function(e){var t;if(typeof e==="string"){if(e.indexOf("/")===0){t=this._getObject(e)}else{t=this.oData[e]}}else if(e instanceof q){t=this._getObject(e.getPath())}if(t&&t.__metadata){t.__metadata.invalid=true}};j.prototype.invalidateEntityType=function(e){var t;for(var a in this.oData){t=this.oData[a];if(t.__metadata.type===e){t.__metadata.invalid=true}}};j.prototype.refresh=function(e,t,a){if(typeof e==="string"){a=e;e=false;t=false}if(t){this.removeData()}this._refresh(e,a)};j.prototype._refresh=function(e,t,a,r){var s=this.getBindings();this.sRefreshGroupId=t;s.forEach(function(t){t._refresh(e,a,r)});this.sRefreshGroupId=undefined};j.prototype.checkUpdate=function(e,t,a,r){if(t){this.bForceUpdate=this.bForceUpdate||e;Object.assign(this.mChangedEntities4checkUpdate,a);if(!this.sUpdateTimer){this.sUpdateTimer=setTimeout(function(){this.checkUpdate(this.bForceUpdate,false,this.mChangedEntities4checkUpdate)}.bind(this),0)}return}e=this.bForceUpdate||e;if(this.sUpdateTimer){clearTimeout(this.sUpdateTimer);this.sUpdateTimer=null;this.bForceUpdate=undefined;this.mChangedEntities4checkUpdate={}}var s=this.getBindings();s.forEach(function(t){if(!r||this.isMetaModelPath(t.getPath())){t.checkUpdate(e,a)}}.bind(this));this._processAfterUpdate()};j.prototype.checkDataState=function(e){var t=this.getBindings();t.forEach(function(t){if(t.checkDataState){t.checkDataState(e)}})};j.prototype.bindProperty=function(e,t,a){var r=new D(this,e,t,a);return r};j.prototype.bindList=function(e,t,a,r,i){var n=new s(this,e,t,a,r,i);return n};j.prototype.bindTree=function(e,t,a,r,s){var n=new i(this,e,t,a,r,s);return n};j.prototype.createBindingContext=function(e,t,a,r,s){var i,n,o,d,u,h,f,c,p,l=this;if(t!==null&&typeof t==="object"&&!(t instanceof q)){s=r;r=a;a=t;t=undefined}if(typeof t=="function"){s=a;r=t;a=undefined;t=undefined}if(typeof t=="boolean"){s=t;r=undefined;a=undefined;t=undefined}if(typeof a=="function"){s=r;r=a;a=undefined}if(typeof a=="boolean"){s=a;r=undefined;a=undefined}if(typeof r=="boolean"){s=r;r=undefined}if(a){i=a.canonicalRequest}i=this._isCanonicalRequestNeeded(i);p=this.resolve(e,t,i);if(!p&&i){p=this.resolve(e,t)}d=this.resolveDeep(e,t);if(!p){if(r){r(null)}return null}if(s===undefined){s=this._isReloadNeeded(p,a)}if(!s){n=this.resolve(e,t,true);if(n){f=this.getContext(n,d)}else{f=null}if(r){r(f)}return f}function g(a){var s=a?l._getKey(a):null,i=!(e===""||e.indexOf("/")>0),n=null,o,u;f=null;if(s){f=l.getContext("/"+s,d);n={__ref:s}}if(t&&h&&i){o=t.getPath();o=o.substr(1);u=l._getEntity(o);if(u){u[e]=n}}r(f)}function _(a){var s;if(a.statusCode=="404"&&t&&h){var i=t.getPath();i=i.substr(1);s=l._getEntity(i);if(s){s[e]={__ref:null}}}r(null)}if(r){h=!e.startsWith("/");c=[];o=this.createCustomParams(a);if(o){c.push(o)}if(a&&(a.batchGroupId||a.groupId)){u=a.groupId||a.batchGroupId}this.read(e,{canonicalRequest:i,context:t,error:_,groupId:u,success:g,updateAggregatedMessages:true,urlParameters:c})}if(a&&a.createPreliminaryContext){p=this.resolve(e,t,i);if(!p&&i){p=this.resolve(e,t)}f=this.getContext(p,d);return f}return undefined};j.prototype._updateContext=function(e,t,a){e.sPath=t;if(a!==undefined){e.sDeepPath=a}this.mContexts[t]=e};j.prototype._splitEntries=function(e){return e.replace(/\s/g,"").split(",").map(function(e){return e.split("/")})};j.prototype._filterOwnSelect=function(e,t){var a,r;if(!t){return[]}r=t.map(function(e){return e.name});a=e.filter(function(e){return e.length===1}).map(function(e){return e[0]});if(e.length===0||a.indexOf("*")!==-1||a.indexOf("**")!==-1){return r}else{return a.filter(function(e){return r.indexOf(e)!==-1})}};j.prototype._filterOwnExpand=function(e,t){return e.map(function(e){return e[0]}).filter(function(e,t,a){return a.indexOf(e)===t}).filter(function(e){return t.length===0||t.some(function(t){return t.indexOf(e)===0||t.indexOf("**")===0})})};j.prototype._filterSelectByNavProp=function(e,t){return e.filter(function(e){return e[0]===t}).map(function(e){return e.length>1?e.slice(1):["**"]})};j.prototype._filterExpandByNavProp=function(e,t){return e.filter(function(e){return e.length>1&&e[0]===t}).map(function(e){return e.slice(1)})};j.prototype._isReloadNeeded=function(e,t){var a=this,r=this.oMetadata,s,i=this._getObject(e),n=[],o=[];if(!this.oMetadata.isLoaded()){return true}s=this.oMetadata._getEntityTypeByPath(e);if(this._isCreatedEntity(i)){return false}function d(e,t,s,i){var n,o,u,h,f,c,p,l,g,_;if(!e){return false}if(t===null){return false}if(!t){return true}if(t.__metadata&&t.__metadata.invalid){return true}g=a._filterOwnSelect(s,e.property);for(o=0;o<g.length;o++){_=g[o];if(t[_]===undefined){return true}}l=a._filterOwnExpand(i,s);for(o=0;o<l.length;o++){n=l[o];u=t[n];if(u===null){continue}if(u===undefined||u.__deferred){return true}f=r._getEntityTypeByNavProperty(e,n);p=a._filterSelectByNavProp(s,n);c=a._filterExpandByNavProp(i,n);if(u.__ref){h=a._getEntity(u.__ref);if(d(f,h,p,c)){return true}}if(u.__list){for(var m=0;m<u.__list.length;m++){h=a._getEntity(u.__list[m]);if(d(f,h,p,c)){return true}}}}return false}if(t){if(t.select){o=this._splitEntries(t.select)}if(t.expand){n=this._splitEntries(t.expand)}}return d(s,i,o,n)};j.prototype.createCustomParams=function(e){var t=[],a,r={expand:true,select:true};for(var s in e){if(s in r){t.push("$"+s+"="+d(e[s]))}if(s==="custom"){a=e[s];for(s in a){if(s.indexOf("$")===0){o.warning(this+" - Trying to set OData parameter '"+s+"' as custom query option!")}else if(typeof a[s]==="string"){t.push(s+"="+d(a[s]))}else{t.push(s)}}}}return t.join("&")};j.prototype.bindContext=function(e,t,a){var s=new r(this,e,t,a);return s};j.prototype.setDefaultCountMode=function(e){this.sDefaultCountMode=e};j.prototype.getDefaultCountMode=function(){return this.sDefaultCountMode};j.prototype._addEntity=function(e){var t=this._getKey(e);this.oData[t]=e;return t};j.prototype._removeEntity=function(e){e=e&&A._normalizeKey(e);delete this.oData[e];delete this.mChangedEntities[e];delete this.mContexts["/"+e]};j.prototype._getEntity=function(e){var t=this.oData[e];if(!t){e=e&&A._normalizeKey(e);t=this.oData[e]}return t};j.prototype._getKey=function(e){var t,a;if(e instanceof q){t=e.getPath().substr(1)}else if(e&&e.__metadata&&e.__metadata.uri){a=e.__metadata.uri;t=a.substr(a.lastIndexOf("/")+1)}else if(typeof e==="string"){t=e.substr(e.lastIndexOf("/")+1)}if(!this.oData[t]){t=t&&A._normalizeKey(t)}return t};j.prototype.getKey=function(e){return this._getKey(e)};j.prototype.createKey=function(e,t){var a=this.oMetadata._getEntityTypeByPath(e),r=e,s=this,i,o;n(a,'Could not find entity type of collection "'+e+'" in service metadata!');r+="(";if(a.key.propertyRef.length===1){i=a.key.propertyRef[0].name;n(i in t,'Key property "'+i+'" is missing in object!');o=this.oMetadata._getPropertyMetadata(a,i);r+=encodeURIComponent(A.formatValue(t[i],o.type))}else{f(a.key.propertyRef,function(e,d){if(e>0){r+=","}i=d.name;n(i in t,'Key property "'+i+'" is missing in object!');o=s.oMetadata._getPropertyMetadata(a,i);r+=i;r+="=";r+=encodeURIComponent(A.formatValue(t[i],o.type))})}r+=")";return r};j.prototype.getProperty=function(e,t,a){var r=this._getObject(e,t);if(!a){return r}if(!l(r)){return r}r=g({},r);if(a===true){return this._restoreReferences(r)}else{return this._removeReferences(r)}};j.prototype.getObject=function(e,t,a){if(l(t)){a=t;t=undefined}var r=this,s=this.resolve(e,t),i=this._getObject(s),n=this.oMetadata._getEntityTypeByPath(s),d=[],u=[];if(!n||!l(i)||!i.__metadata||!i.__metadata.uri){return i}if(!a||!(a.select||a.expand)){return g({},i)}function h(e,t,a,s){var i,n,d,u,f,c,p,l,g,_,m,y,v,b;if(!t){return undefined}if(!e){return undefined}m=r._filterOwnSelect(a,e.property);v={};for(n=0;n<m.length;n++){b=m[n];if(t[b]!==undefined||t.__metadata.created){v[b]=t[b]}else{o.fatal("No data loaded for select property: "+b+" of entry: "+r.getKey(t));return undefined}}if(t.__metadata){v.__metadata=t.__metadata}g=r._filterOwnExpand(s,a);for(n=0;n<g.length;n++){i=g[n];d=t[i];u=r.oMetadata._getEntityTypeByNavProperty(e,i);p=r._filterSelectByNavProp(a,i);f=r._filterExpandByNavProp(s,i);if(d&&d.__ref){c=r._getObject("/"+d.__ref);l=h(u,c,p,f);if(l!==undefined){v[i]=l}else{o.fatal("No data loaded for expand property: "+i+" of entry: "+r.getKey(l));return undefined}}if(d&&d.__list){y=[];for(var C=0;C<d.__list.length;C++){c=r._getObject("/"+d.__list[C]);l=h(u,c,p,f);if(l!==undefined){y.push(l)}else{o.fatal("No data loaded for expand property: "+i+" of entry: "+r.getKey(l));return undefined}}v[i]=y}}_=r._filterOwnSelect(a,e.navigationProperty);for(var P=0;P<_.length;P++){i=_[P];if(g.indexOf(i)===-1){var q=v.__metadata.uri+"/"+i;v[i]={__deferred:{uri:q}}}}return v}if(a.select){u=this._splitEntries(a.select)}if(a.expand){d=this._splitEntries(a.expand)}i=h(n,i,u,d);return i};j.prototype._getObject=function(e,t,a,r){var s,i,n,o,d,u,h,f,c,p,_,m=r?undefined:null,y=this.isLegacySyntax()?this.oData:m;p=this.resolve(e,t,this.bCanonicalRequests);if(!p&&this.bCanonicalRequests){p=this.resolve(e,t)}if(!p){return y}if(e&&e.startsWith("@$ui5.")){return this._getInstanceAnnotationValue(e,t)}if(this._isMetadataPath(p)){if(this.oMetadata&&this.oMetadata.isLoaded()){if(this.isMetaModelPath(p)){h=this.getMetaModel();n=T.getCodeListTerm(p);if(n){i=h.fetchCodeList(n);if(i.isFulfilled()){return i.getResult()}if(i.isRejected()){i.caught()}return undefined}if(!this.bMetaModelLoaded){return null}_=p.indexOf("/##");o=p.substr(0,_);f=p.substr(_+3);u=h.getMetaContext(o);y=h.getProperty(f,u)}else{y=this.oMetadata._getAnnotation(p)}}else if(T.getCodeListTerm(p)){return undefined}}else{if(p==="/"){return this.oData}var v=p.split("/"),b=0;d=v[1];v.splice(0,2);s=this.mChangedEntities[d];c=this._getEntity(d);y=a?c:s||c;while(y&&v[b]){var C=s&&s.hasOwnProperty(v[b]);s=s&&s[v[b]];c=c&&c[v[b]];y=a||!C?c:s;if(y){if(y.__ref){s=this.mChangedEntities[y.__ref];c=this._getEntity(y.__ref);y=a?c:s||c}else if(y.__list){y=y.__list}else if(y.__deferred){y=undefined}}b++}}if(l(s)){y=a?c:g({},c,s)}return y};j.prototype._getInstanceAnnotationValue=function(e,t){if(e==="@$ui5.context.isInactive"){return t.isInactive()}if(e==="@$ui5.context.isTransient"){return t.isTransient()}throw new Error("Unsupported instance annotation: "+e)};j.prototype.updateSecurityToken=function(){if(this.bTokenHandling){if(!this.oSharedServiceData.securityToken){this.refreshSecurityToken()}if(this.bTokenHandling){this.oHeaders["x-csrf-token"]=this.oSharedServiceData.securityToken}}};j.prototype.resetSecurityToken=function(){delete this.oSharedServiceData.securityToken;delete this.oHeaders["x-csrf-token"];delete this.pSecurityToken};j.prototype.getSecurityToken=function(){var e=this.oSharedServiceData.securityToken;if(!e){this.refreshSecurityToken();e=this.oSharedServiceData.securityToken}return e};j.prototype.securityTokenAvailable=function(){if(!this.pSecurityToken){if(this.oSharedServiceData.securityToken){this.pSecurityToken=Promise.resolve(this.oSharedServiceData.securityToken)}else{this.pSecurityToken=new Promise(function(e,t){this.refreshSecurityToken(function(){e(this.oSharedServiceData.securityToken)}.bind(this),function(){t()},true)}.bind(this))}}return this.pSecurityToken};j.prototype.refreshSecurityToken=function(e,t,a){var r,s,i={abort:function(){this.request.abort()}},n=this._createRequestUrlWithNormalizedPath("/"),o=this;function d(t,a){if(a){s=o._getHeader("x-csrf-token",a.headers);o._setSessionContextIdHeader(o._getHeader("sap-contextid",a.headers));if(s){o.oSharedServerData.securityToken=s;o.oSharedServiceData.securityToken=s;o.pSecurityToken=Promise.resolve(s);o.oHeaders["x-csrf-token"]=s}else{o.resetSecurityToken();o.bTokenHandling=false}}if(e){e(t,a)}}function u(e){o.resetSecurityToken();o.bTokenHandling=false;o._handleError(e,r);if(t){t(e)}}function h(e){i.request=f("GET",u)}function f(e,t){r=o._createRequest(n,"",e,o._getHeaders(undefined,true),null,null,!!a);r.headers["x-csrf-token"]="Fetch";return o._request(r,d,t,undefined,undefined,o.getServiceMetadata())}if(this.bDisableHeadRequestForToken){i.request=f("GET",u)}else{i.request=f("HEAD",h)}return i};j.prototype._submitRequest=function(e,t,a){var r=this,s,i,n,o,d;o=new Promise(function(e,t){d=e});function u(e,a){if(t){t(e,a)}r.aSideEffectCleanUpFunctions.forEach(function(e){e()});r.aSideEffectCleanUpFunctions=[];d()}function h(t){if(r.bTokenHandling&&t.response){var s=r._getHeader("x-csrf-token",t.response.headers);if(!e.bTokenReset&&t.response.statusCode=="403"&&s&&s.toLowerCase()==="required"){r.resetSecurityToken();e.bTokenReset=true;p();return}}if(a){a(t)}d()}function c(e){if(r.bTokenHandling&&(e.method!=="GET"||r.bTokenHandlingForGet)){r.pReadyForRequest=r.securityTokenAvailable()}return r.pReadyForRequest}function p(){if(r.bTokenHandling){delete e.headers["x-csrf-token"]}c(e).then(function(t){if(r.bTokenHandling&&(e.method!=="GET"||r.bTokenHandlingForGet)){e.headers["x-csrf-token"]=t}g()},function(){g()})}function l(e,t,a){var s,i=t.eventInfo.requests;if(i){f(i,function(t,a){if(Array.isArray(a)){a.forEach(function(t){f(t.parts,function(a,i){s=r._createEventInfo(t.request,i.fnError);r["fireRequest"+e](s)})})}else if(a.parts){f(a.parts,function(t,i){s=r._createEventInfo(a.request,i.fnError);r["fireRequest"+e](s)})}else{s=r._createEventInfo(a.request,a.fnError);r["fireRequest"+e](s)}});if(t.eventInfo.batch){s=r._createEventInfo(t,a,i);r["fireBatchRequest"+e](s)}}}function g(){if(r.sSessionContextId){e.headers["sap-contextid"]=r.sSessionContextId}i=r._request(e,u,h,s,undefined,r.getServiceMetadata());if(e.eventInfo){l("Sent",e,null);delete e.eventInfo}if(n&&i){i.abort()}}s=r._getODataHandler(e.requestUri);if(this.bSequentializeRequests){this.pSequentialRequestCompleted.then(function(){p()});this.pSequentialRequestCompleted=o}else{p()}return{abort:function(){if(i){i.abort()}n=true}}};j.prototype._setSessionContextIdHeader=function(e){if(e){this.sSessionContextId=e}};j.prototype._submitSingleRequest=function(e){var t=this,a,r={},s={},i={};function n(a,n){if(a===undefined&&n.statusCode===200){o({message:"Response did not contain a valid OData result",response:n});return}function d(a,n){for(var o=0;o<e.parts.length;o++){if(e.parts[o].request._aborted){t._processAborted(e.parts[o].request,n)}else if(e.parts[o].fnSuccess){e.parts[o].fnSuccess(a,n)}}if(e.request.requestUri.indexOf("$count")===-1){t.checkUpdate(false,false,s);if(e.bRefreshAfterChange){t._refresh(false,undefined,r,i)}}}t._processSuccess(e.request,n,d,s,r,i);t._invalidatePathCache();t._setSessionContextIdHeader(t._getHeader("sap-contextid",n.headers))}function o(a){var r;if(a.message=="Request aborted"){for(r=0;r<e.parts.length;r++){t._processAborted(e.parts[r].request,a)}}else{for(r=0;r<e.parts.length;r++){t._processError(e.parts[r].request,a,e.parts[r].fnError)}}t._processAfterUpdate()}e.request.eventInfo={requests:e.parts,batch:false};a=this._submitRequest(e.request,n,o);return a};j.prototype._submitBatchRequest=function(e,t,a,r){var s=this,i={},n={},o={},d={};function u(e,t,a){var r,u,h;for(h=0;h<e.parts.length;h++){if(a||e.parts[h].request._aborted){s._processAborted(e.parts[h].request,t)}else if(t.message){s._processError(e.parts[h].request,t,e.parts[h].fnError)}else{if(e.request.contentID){r=e.request.contentID;if(e.request.created||e.request.functionMetadata){u=s._getKey(t.data);n[r]={key:u,deepPath:e.request.deepPath.replace("('"+r+"')",u.slice(u.indexOf("(")))}}else{u=n[r].key;e.request.requestUri=e.request.requestUri.replace("$"+r,u);e.request.deepPath=n[r].deepPath}}s._processSuccess(e.parts[h].request,t,e.parts[h].fnSuccess,o,i,d,false,undefined,n)}}}function h(r,n){if(r===undefined&&n.statusCode===200){c({message:"Response did not contain a valid OData batch result",response:n});return}var h,f,p,l=r.__batchResponses;if(l){var g,_;for(g=0;g<l.length;g++){h=l[g];if(Array.isArray(t[g])){if(h.message){for(_=0;_<t[g].length;_++){h.$reported=false;f=t[g][_];u(f,h);f.response=h}}else{p=h.__changeResponses;for(_=0;_<p.length;_++){var m=p[_];f=t[g][_];u(f,m);f.response=m}}}else{f=t[g];u(f,h);f.response=h}}s._invalidatePathCache();s.checkUpdate(false,false,o)}s._processSuccess(e,n,a,o,i,d,true,t);s._setSessionContextIdHeader(s._getHeader("sap-contextid",n.headers))}function c(a){var i=a.message=="Request aborted";a.$reported=true;f(t,function(e,t){if(Array.isArray(t)){t.forEach(function(e){u(e,a,i)})}else{u(t,a,i)}});s._processAfterUpdate();if(i){s._processAborted(e,a,true)}else{a.$reported=false;s._processError(e,a,r,true,t)}}e.eventInfo={requests:t,batch:true};var p=this._submitRequest(e,h,c);function l(e){var t;for(var a=0;a<e.parts.length;a++){t=e.parts[a].fnError;if(!e.parts[a].request._aborted&&t){t(j._createAbortedError())}}}var g={abort:function(e){f(t,function(e,t){if(Array.isArray(t)){t.forEach(function(e){l(e)})}else{l(t)}});if(r&&!e){r(j._createAbortedError())}p.abort()}};return g};j.prototype._invalidatePathCache=function(){var e=this,t;if(Object.keys(this.mInvalidatedPaths).length>0){Object.keys(this.mPathCache).forEach(function(a){for(var r in e.mInvalidatedPaths){t=a.indexOf(r);if(t>-1){if(t+r.length!==a.length){var s=a.substr(t+r.length);e.mPathCache[a].canonicalPath=e.mInvalidatedPaths[r]===null?null:e.mInvalidatedPaths[r]+s}else{e.mPathCache[a].canonicalPath=e.mInvalidatedPaths[r]}}}})}this.mInvalidatedPaths={}};j.prototype._createBatchRequest=function(e){var t,a,r={},s={},i=true;s.__batchRequests=e;for(var n in e){if(e[n]&&e[n].__changeRequests||e[n]&&e[n].headers&&!e[n].headers["sap-cancel-on-close"]){i=false;break}}t=this.sServiceUrl+"/$batch";if(this.aUrlParams.length>0){t+="?"+this.aUrlParams.join("&")}c(r,this.mCustomHeaders,this.oHeaders);r["Accept"]="multipart/mixed";delete r["Content-Type"];r["sap-cancel-on-close"]=i;a={headers:r,requestUri:t,method:"POST",data:s,user:this.sUser,password:this.sPassword,async:true};a.withCredentials=this.bWithCredentials;return a};j.prototype.abortInternalRequest=function(e,t){var a=this.mRequests;var r,s;if(t){r=t.requestKey;s=t.path}if(e in this.mDeferredGroups){a=this.mDeferredRequests}var i=function(e){for(var t=0;t<e.parts.length;t++){e.parts[t].requestHandle.abort()}};var n=a[e];if(n){if(r in n.map){i(n.map[r])}else if(s){f(n.map,function(e,t){if(e.indexOf(s)>=0){i(t)}})}else if(e&&!t){f(n.map,function(e,t){i(t)})}}};j.prototype._pushToRequestQueue=function(e,t,a,r,s,i,n,o){var d,u=e[t],h=r.key?r.key:r.method+":"+r.requestUri;if(this.bWarmup){return}if(!u){u={};u.map={};u.requests=[];e[t]=u}if(h in u.map&&(r.key||r.method==="GET")){d=u.map[h];var f=d.request;r.deepPath=f.deepPath;if(this.sMessageScope===S.BusinessObject){r.headers["sap-message-scope"]=f.headers["sap-message-scope"]}if(d.bRefreshAfterChange===undefined){d.bRefreshAfterChange=o}if(!r.key){d.parts.push({request:r,fnSuccess:s,fnError:i,requestHandle:n})}if(r.method==="GET"){delete f.data}else{f.method=r.method;f.headers=r.headers;f.data=r.data;if(r.method==="PUT"){delete f.headers["x-http-method"]}if(f._aborted){delete f._aborted}}if(f.functionMetadata){f.requestUri=r.requestUri;f.functionTarget=r.functionTarget}}else{d={request:r,bRefreshAfterChange:o,parts:[{request:r,fnSuccess:s,fnError:i,requestHandle:n}]};if(r.method==="GET"){u.requests.push(d)}else{if(!u.changes){u.changes={}}var c=u.changes[a];if(!c){c=[];u.changes[a]=c}d.changeSetId=a;c.push(d)}u.map[h]=d}};j.prototype._collectChangedEntities=function(e,t,a){var r=this;if(e.changes){f(e.changes,function(e,s){for(var i=0;i<s.length;i++){if(s[i].bRefreshAfterChange){var n=s[i].request,o="/"+n.requestUri.split("?")[0],d,u;if(n.method==="POST"||n.method==="DELETE"){var h=r.oMetadata._getEntityTypeByPath(o);if(h){a[h.entityType]=true}}else{d=r._getObject(o);if(d){u=r._getKey(d)}else if(o.lastIndexOf("/")===0){u=r._getKey(o)}if(u){t[u]=true}}}}})}};j.prototype._processRequestQueue=function(e,t,a,r){var s=this,i,n=[];function o(e,t){for(var a=0;a<e.parts.length;a++){var r=e.parts[a];if(r.request._aborted){s._processAborted(e.request,null);e.parts.splice(a,1);a--}else if(t){r.request._handle=t;t.iRelevantRequests++}}}function d(){return{iRelevantRequests:0,oRequestHandle:{},abort:function(){this.iRelevantRequests--;if(this.iRelevantRequests===0&&this.oRequestHandle){this.oRequestHandle.abort(true);if(a){a({},undefined)}}}}}if(this.bUseBatch){f(e,function(e,a){if(e===t||!t){var r={},i={};s._collectChangedEntities(a,r,i);if(Object.keys(r).length||Object.keys(i).length){s.bIncludeInCurrentBatch=true;s._refresh(false,e,r,i);s.bIncludeInCurrentBatch=false}}});f(e,function(u,h){if(u===t||!t){var c=[],p=[],l,g;var _=d();if(h.changes){f(h.changes,function(t,a){var r,n,d;l={__changeRequests:[]};g=[];for(n=0;n<a.length;n++){r=a[n].request;i="/"+s.getKey(r.data);s.increaseLaundering(i,r.data);o(a[n],_);if(a[n].parts.length>0){s.removeInternalMetadata(r.data);l.__changeRequests.push(r);if(r.expandRequest){d=a[n].parts[0];s._pushToRequestQueue(e,u,undefined,r.expandRequest,d.fnSuccess,d.fnError,d.requestHandle,false)}g.push(a[n])}}if(l.__changeRequests&&l.__changeRequests.length>0){c.push(l);p.push(g)}})}if(h.requests){var m=h.requests;for(var y=0;y<m.length;y++){o(m[y],_);if(m[y].parts.length>0){c.push(m[y].request);p.push(m[y])}}}if(c.length>0){var v=s._createBatchRequest(c);_.oRequestHandle=s._submitBatchRequest(v,p,a,r);n.push(_.oRequestHandle)}delete e[u]}})}else{f(e,function(a,r){if(a===t||!t){if(r.changes){f(r.changes,function(e,t){for(var a=0;a<t.length;a++){var r=d();i="/"+s.getKey(t[a].request.data);s.increaseLaundering(i,t[a].request.data);o(t[a],r);if(t[a].parts.length>0){s.removeInternalMetadata(t[a].request.data);r.oRequestHandle=s._submitSingleRequest(t[a]);n.push(r.oRequestHandle)}}})}if(r.requests){var u=r.requests;for(var h=0;h<u.length;h++){var c=d();o(u[h],c);if(u[h].parts.length>0){c.oRequestHandle=s._submitSingleRequest(u[h]);n.push(c.oRequestHandle)}}}delete e[a]}})}this.checkDataState(this.mLaunderingState);return n.length==1?n[0]:n};j.prototype._processRequestQueueAsync=function(e){var t=this;if(!this.pCallAsync){this.pCallAsync=this.oMetadata.loaded().then(function(){return Promise.resolve().then(function(){t._processRequestQueue(e);t.pCallAsync=undefined})})}};j.prototype._processSuccess=function(e,t,a,r,s,i,n,d,u){var h,p,l,_,m,y,v,b,C,P,q,R,M,E={},S={},x=t.data,T=this;if(!n){p=!(t.statusCode===204||t.statusCode==="204");M=e.requestUri;q=M.replace(this.sServiceUrl,"");if(!q.startsWith("/")){q="/"+q}C=this._normalizePath(q);m=this.oMetadata._getEntityTypeByPath(C);b=m&&m.isFunction;q=this._normalizePath(q,undefined,!b);this.decreaseLaundering(q,e.data);this._decreaseDeferredRequestCount(e);if(e.functionMetadata){if(t.headers&&t.headers.location){y=t.headers.location;R=y.lastIndexOf(this.sServiceUrl);if(R>-1){h=y.slice(R+this.sServiceUrl.length);if(e.functionTarget===h){l=this.getDeepPathForCanonicalPath(h);if(l){e.deepPath=l}}e.functionTarget=h}}if(e.adjustDeepPath){e.deepPath=e.adjustDeepPath({deepPath:l||e.functionTarget,response:g({},t)})}else if(!l){e.deepPath=e.functionTarget}if(u&&e.contentID){u[e.contentID].deepPath=e.deepPath}}if(p&&x===undefined&&t){this._parseResponse(t,e);o.fatal(this+" - No data was retrieved by service: '"+t.requestUri+"'");T.fireRequestCompleted({url:t.requestUri,type:"GET",async:t.async,info:"Accept headers:"+this.oHeaders["Accept"],infoObject:{acceptHeaders:this.oHeaders["Accept"]},success:false});return false}if(x&&!x.__metadata&&x.results&&!Array.isArray(x.results)){x=x.results}if(!t._imported&&x&&(Array.isArray(x)||typeof x=="object")){v=g({},x);if(e.key||e.created){T._importData(v,S,t,undefined,undefined,undefined,b)}else{T._importData(v,S,t,q,e.deepPath,undefined,b,undefined,e.sideEffects)}t._imported=true}_=this._getEntity(e.key);if(S&&_&&_.__metadata.created&&_.__metadata.created.functionImport){var U=[];var D=_["$result"];if(D&&D.__list){f(S,function(e){U.push(e)});D.__list=U}else if(D&&D.__ref){f(S,function(e){D.__ref=e})}}if(!p){P=q.split("/");if(P[1]){E[P[1]]=e;var A={};A[P[1]]=e.data;this._updateChangedEntities(A)}if(e.method==="DELETE"&&P[2]!=="$links"){this._removeEntity(P[1])}}if(p&&e.method==="POST"||e.functionMetadata){if(m){i[m.entityType]=true}if(e.key){if(e.created){var I=this._getKey(x);var O=this.getContext("/"+e.key);l=e.deepPath;if(O.isTransient()&&l.endsWith(")")){e.deepPath=l.slice(0,l.lastIndexOf("("))+I.slice(I.indexOf("("))}this._updateContext(O,"/"+I,e.deepPath);O.setUpdated(true);this.callAfterUpdate(function(){O.setUpdated(false)});_=this._getEntity(I);if(_){delete _.__metadata.created}this._removeEntity(e.key)}else{delete this.mChangedEntities[e.key]}}}this._parseResponse(t,e,S,E);c(r,S);c(s,E);this._updateETag(e,t)}if(a){a(x,t)}var k=this._createEventInfo(e,t,d);if(n){this.fireBatchRequestCompleted(k)}else{this.fireRequestCompleted(k)}return true};j.prototype._processError=function(e,t,a,r,s){var i,n;if(e.functionMetadata){e.deepPath=e.functionTarget}i=this._handleError(t,e);if(!r){n="/"+this.getKey(e.data);this.decreaseLaundering(n,e.data);this._decreaseDeferredRequestCount(e)}if(a){a(i)}var o=this._createEventInfo(e,i,s);if(r){this.fireBatchRequestCompleted(o);this.fireBatchRequestFailed(o)}else{this.fireRequestCompleted(o);this.fireRequestFailed(o)}};j.prototype._processAborted=function(e,t,a){var r,s;if(!a){s="/"+this.getKey(e.data);this.decreaseLaundering(s,e.data);this._decreaseDeferredRequestCount(e)}if(t){r=this._createEventInfo(e,j._createAbortedError());r.success=false;if(a){this.fireBatchRequestCompleted(r)}else{this.fireRequestCompleted(r)}}};j.prototype._processAfterUpdate=function(){var e=this.aCallAfterUpdate;this.aCallAfterUpdate=[];for(var t=0;t<e.length;t++){e[t]()}};j.prototype._processChange=function(e,t,a,r){var s,i,n,o,d,h,c,p,l,_,m,y,v,b=this;if(r&&this.mChangedEntities[e]&&this.mChangedEntities[e].__metadata){this.mChangedEntities[e].__metadata.deepPath=r}else if(!r&&this.mChangedEntities[e]&&this.mChangedEntities[e].__metadata&&this.mChangedEntities[e].__metadata.deepPath){r=this.mChangedEntities[e].__metadata.deepPath}n=this.oMetadata._getEntityTypeByPath(e);if(!a){a="MERGE"}l=g({},this._getObject("/"+e,true),t);if(t.__metadata&&t.__metadata.created){c=t.__metadata.created.method?t.__metadata.created.method:"POST";e=t.__metadata.created.key;i=true;p=t.__metadata.created;d=t.__metadata.created.expandRequest;s=t.__metadata.created.contentID;if(t.__metadata.created.functionImport){p.urlParameters=this._createFunctionImportParameters(t.__metadata.created.key,c,l);l=undefined}else{delete l.__metadata["uri"]}}else if(a==="MERGE"){c="MERGE";m=this._getEntity(e)}else{c="PUT"}if(l&&l.__metadata){for(var C in l.__metadata){if(C!=="type"&&C!=="uri"&&C!=="etag"&&C!=="content_type"&&C!=="media_src"){delete l.__metadata[C]}}}if(l&&n){var P=this.oMetadata._getNavigationPropertyNames(n);P.forEach(function(e){delete l[e]})}if(c==="MERGE"&&n&&m){f(l,function(t,a){if(t!=="__metadata"){if(u(m[t],a)&&!b.isLaundering("/"+e+"/"+t)){delete l[t]}}});var q="/"+e,R;f(l,function(e,t){if(e!=="__metadata"){R=b.getProperty(q+"/"+e+"/#@sap:unit");if(R){if(l[R]===undefined){l[R]=m[R]}}}});if(m.__metadata.etag){l.__metadata.etag=m.__metadata.etag}}l=this._removeReferences(l);v=p&&p.urlParameters?A._createUrlParamsArray(p.urlParameters):undefined;h=p?this._getHeaders(p.headers):this._getHeaders();o=p&&p.eTag?p.eTag:this.getETag(l);y=this._createRequestUrl("/"+e,null,v,this.bUseBatch);_=this._createRequest(y,r,c,h,l,o,undefined,true);if(i){_.created=true;if(d){_.expandRequest=d;_.contentID=s}if(t.__metadata.created.functionMetadata){_.functionTarget=this.oMetadata._getCanonicalPathOfFunctionImport(t.__metadata.created.functionMetadata,p.urlParameters)}}if(this.bUseBatch){_.requestUri=_.requestUri.replace(this.sServiceUrl+"/","")}return _};j.prototype._resolveGroup=function(e){var t,a,r,s,i,n;a=this.oMetadata._getEntityTypeByPath(e);n=this._getObject("/"+e);if(n){r=n.__metadata.created;if(r){return{groupId:r.groupId,changeSetId:r.changeSetId}}}if(this.mChangeGroups[a.name]){t=this.mChangeGroups[a.name];s=t.groupId;i=t.single?_():t.changeSetId}else if(this.mChangeGroups["*"]){t=this.mChangeGroups["*"];s=t.groupId;i=t.single?_():t.changeSetId}return{groupId:s,changeSetId:i}};j.prototype._updateETag=function(e,t){var a,r,s;a=e.requestUri.replace(this.sServiceUrl+"/","");if(!a.startsWith("/")){a="/"+a}r=this._getObject(a.split("?")[0],undefined,true);s=this._getHeader("etag",t.headers);if(r&&r.__metadata&&s){r.__metadata.etag=s}};j.prototype._handleError=function(e,t){var a,r={message:e.message};if(e.response){if(!e.$reported){this._parseResponse(e.response,t);if(this.bTokenHandling){a=this._getHeader("x-csrf-token",e.response.headers);if(e.response.statusCode=="403"&&a&&a.toLowerCase()==="required"){this.resetSecurityToken()}}}r.statusCode=e.response.statusCode;r.statusText=e.response.statusText;r.headers=e.response.headers;r.responseText=e.response.body}else if(!e.$reported){o.error("The following problem occurred: "+e.message,undefined,B)}e.$reported=true;return r};j.prototype.getData=function(e,t,a){return this.getProperty(e,t,a)};j.prototype._getODataHandler=function(e){if(e.indexOf("$batch")>-1){return k.batchHandler}else if(e.indexOf("$count")>-1){return undefined}else if(this.bJSON){return k.jsonHandler}else{return k.atomHandler}};j.prototype.getETag=function(e,t,a){if(typeof e=="object"){a=e;e=""}return this._getETag(e,t,a)};j.prototype._getETag=function(e,t,a){if(!a||!a.__metadata){a=this._getObject(e,t)}if(a&&a.__metadata){return a.__metadata.etag}return null};j.prototype.forceEntityUpdate=function(e){var t=this.mChangedEntities[e];if(t&&t.__metadata){t.__metadata.etag="*"}else{o.error(this+" - Entity with key "+e+" does not exist or has no change")}};j.prototype._createRequest=function(e,t,a,r,s,i,n,d,u){var h;n=n!==false;if(i&&a!=="GET"){r["If-Match"]=i}if(!r["Content-Type"]&&a!=="DELETE"&&a!=="GET"){if(this.bJSON){r["Content-Type"]="application/json"}else{r["Content-Type"]="application/atom+xml"}}if(e.indexOf("$count")>-1){r["Accept"]="text/plain, */*;q=0.5"}if(a==="MERGE"&&!this.bUseBatch){r["x-http-method"]="MERGE";a="POST"}if(this.sMessageScope===S.BusinessObject){if(this.bIsMessageScopeSupported){r["sap-message-scope"]=this.sMessageScope}else{o.error("Message scope 'sap.ui.model.odata.MessageScope.BusinessObject' is not"+" supported by the service: "+this.sServiceUrl,undefined,B)}}d=d&&this.sMessageScope===S.BusinessObject&&this.bIsMessageScopeSupported;if(this.bUseBatch&&a!=="GET"&&a!=="HEAD"&&!r["Content-ID"]){r["Content-ID"]=_()}h={async:n,deepPath:t,headers:r,method:a,password:this.sPassword,requestUri:e,updateAggregatedMessages:d,user:this.sUser};if(u){h.sideEffects=true}if(s){h.data=s}if(this.bWithCredentials){h.withCredentials=this.bWithCredentials}h.requestID=this._createRequestID();return h};j.prototype._processRequest=function(e,t,a){var r,s,i=false,n=this;if(this.bWarmup){return{abort:function(){}}}if(a){this.iPendingDeferredRequests+=1}s={abort:function(){if(a&&!i){n.iPendingDeferredRequests-=1}if(!i&&t){t(j._createAbortedError())}if(r){r._aborted=true;if(r._handle){r._handle.abort()}}i=true}};this.oMetadata.loaded().then(function(){r=e(s);if(r){r.deferred=!!a}n._processRequestQueueAsync(n.mRequests);if(i){s.abort()}});return s};j.prototype.update=function(e,t,a){var r,s,i,n,o,d,u,h,f,c,p,l,g,_,m,y=this,v,b,C;if(a){h=a.groupId||a.batchGroupId;f=a.changeSetId;o=a.context;r=a.success;s=a.error;d=a.eTag;p=a.headers;c=a.urlParameters;_=a.refreshAfterChange;C=a.canonicalRequest;if(a.merge!==undefined){l=a.merge?"MERGE":"PUT"}}C=this._isCanonicalRequestNeeded(C);m=h in y.mDeferredGroups;_=this._getRefreshAfterChange(_,h);u=A._createUrlParamsArray(c);p=this._getHeaders(p);l=l?l:this.sDefaultUpdateMethod;d=d||this._getETag(e,o,t);v=this._normalizePath(e,o,C);b=this.resolveDeep(e,o);return this._processRequest(function(e){n=y._createRequestUrlWithNormalizedPath(v,u,y.bUseBatch);i=y._createRequest(n,b,l,p,t,d);g=y.mRequests;if(m){g=y.mDeferredRequests}y._pushToRequestQueue(g,h,f,i,r,s,e,_);return i},s,m)};j.prototype.create=function(e,t,a){var r,s,i,n,o,d,u,h,f,c,p,l,g,_,m,y,v=this,b,C,P;if(a){n=a.context;u=a.urlParameters;o=a.success;d=a.error;l=a.groupId||a.batchGroupId;_=a.changeSetId;p=a.eTag;f=a.headers;m=a.refreshAfterChange;P=a.canonicalRequest}P=this._isCanonicalRequestNeeded(P);m=this._getRefreshAfterChange(m,l);c=A._createUrlParamsArray(u);f=this._getHeaders(f);g="POST";y=l in v.mDeferredGroups;b=v._normalizePath(e,n,P);C=this.resolveDeep(e,n);return this._processRequest(function(e){s=v._createRequestUrlWithNormalizedPath(b,c,v.bUseBatch);r=v._createRequest(s,C,g,f,t,p);r.created=true;i=v.oMetadata._getEntityTypeByPath(b);r.entityTypes={};if(i){r.entityTypes[i.entityType]=true}h=v.mRequests;if(y){h=v.mDeferredRequests}v._pushToRequestQueue(h,l,_,r,o,d,e,m);return r},d,y)};j.prototype.remove=function(e,t){var a,r,s,i,n,o,d,u,h,f,c,p,l,g,_,m,y,v,b,C=this.bCanonicalRequests,P=this;if(t){u=t.groupId||t.batchGroupId;a=t.changeSetId;r=t.context;m=t.success;o=t.error;d=t.eTag;h=t.headers;b=t.urlParameters;l=t.refreshAfterChange;C=t.canonicalRequest}C=this._isCanonicalRequestNeeded(C);l=this._getRefreshAfterChange(l,u);v=A._createUrlParamsArray(b);h=this._getHeaders(h);c="DELETE";d=d||this._getETag(e,r);n=u in P.mDeferredGroups;p=this._normalizePath(e,r,C);i=this.resolveDeep(e,r);function q(e,t){P._removeEntity(f);if(s&&s.isTransient()===false){P.oCreatedContextsCache.findAndRemoveContext(s)}if(m){m(e,t)}}return this._processRequest(function(e){y=P._createRequestUrlWithNormalizedPath(p,v,P.bUseBatch);f=y.substr(y.lastIndexOf("/")+1);f=f.split("?")[0];s=P.mContexts["/"+f];g=P._createRequest(y,i,c,h,undefined,d,undefined,true);_=P.mRequests;if(n){_=P.mDeferredRequests}P._pushToRequestQueue(_,u,a,g,q,o,e,l);return g},o,n)};j.prototype.callFunction=function(e,t){var a,r,s,i,n,d,u,h,f,c,p,l,g,m,y=this;if(!e.startsWith("/")){o.fatal("callFunction: sFunctionName has to be absolute, but the given '"+e+"' is not absolute",this,B);return undefined}t=t||{};a=t.changeSetId;s=t.error;i=t.eTag;n=t.expand;d=t.groupId||t.batchGroupId;u=t.headers;h=t.method||"GET";f=t.refreshAfterChange;g=t.success;m=Object.assign({},t.urlParameters);if(n){if(!this.bUseBatch){throw new Error("Use 'expand' parameter only with 'useBatch' set to 'true'")}if(h!=="POST"){throw new Error("Use 'expand' parameter only with HTTP method 'POST'")}}f=this._getRefreshAfterChange(f,d);r=new Promise(function(e,t){l=e;c=t});p=this._processRequest(function(r){var p,v,b,C,P,q,R,M,E,S,x,T={},U=s,D=false,I=g;b=y.oMetadata._getFunctionImportMetadata(e,h);if(!b){o.error("Function '"+e+"' not found in the metadata",y,B);c();return undefined}if(b.entitySet||b.entitySetPath){T.$result={__list:[]};if(b.returnType&&!b.returnType.startsWith("Collection")){T.$result={__ref:{}}}}if(n&&(!T.$result||!T.$result.__ref)){c(new Error("Use 'expand' parameter only for functions returning a single"+" entity"));return undefined}if(b.parameter!=null){b.parameter.forEach(function(t){T[t.name]=y._createPropertyValue(t.type);if(m[t.name]!==undefined){T[t.name]=m[t.name];m[t.name]=A.formatValue(m[t.name],t.type)}else{o.warning("No value given for parameter '"+t.name+"' of function import '"+e+"'",y,B)}})}E=_();if(n){u=Object.assign({},u,{"Content-ID":E,"sap-messages":"transientOnly"});g=function(e,t){if(!P){P=e;C=t;return}if(I){e=Object.assign({},P,e);I(e,C)}};s=function(t){if(P){C.expandAfterFunctionCallFailed=true;t.expandAfterFunctionCallFailed=true;o.error("Function '"+e+"' was called successfully, but"+" expansion of navigation properties ("+n+") failed",t,B);if(I){I(P,C)}return}if(!D){D=true;if(U){U(t)}}else{t.expandAfterFunctionCallFailed=true}}}T.__metadata={uri:y.sServiceUrl+e+"('"+E+"')",created:{changeSetId:a,error:s,eTag:i,functionImport:true,groupId:d,headers:Object.assign({},u),key:e.substring(1),method:h,success:g}};q=y._addEntity(T);p=y.getContext("/"+q);y._writePathCache("/"+q,"/"+q);l(p);x=A._createUrlParamsArray(m);S=y._createRequestUrlWithNormalizedPath(e,x,y.bUseBatch);R=y._createRequest(S,e,h,y._getHeaders(u),undefined,i,undefined,true);R.adjustDeepPath=t.adjustDeepPath;R.functionMetadata=b;T.__metadata.created.functionMetadata=b;R.functionTarget=y.oMetadata._getCanonicalPathOfFunctionImport(b,m);R.key=q;if(n){v=y._createRequest("$"+E+"?"+A._encodeURLParameters({$expand:n,$select:n}),"/$"+E,"GET",y._getHeaders(undefined,true),undefined,undefined,undefined,true);v.contentID=E;R.expandRequest=v;R.contentID=E}M=y.mRequests;if(d in y.mDeferredGroups){M=y.mDeferredRequests}y._pushToRequestQueue(M,d,a,R,g,s,r,f);return R},s);p.contextCreated=function(){return r};return p};j.prototype._createFunctionImportParameters=function(e,t,a){var r=h({},a);delete r.__metadata;delete r["$result"];var s=this.oMetadata._getFunctionImportMetadata(e,t);n(s,this+": Function "+e+" not found in the metadata !");if(!s){return undefined}if(s.parameter!=null){f(s.parameter,function(e,t){if(r&&r[t.name]!==undefined){r[t.name]=A.formatValue(r[t.name],t.type)}})}return r};j.prototype._getResourcePath=function(e,t,a,r){var s,i,n,o;if(!e){return this.resolve(a,r)}n=this.oMetadata._splitByLastNavigationProperty(t);i=n.pathBeforeLastNavigationProperty;s=n.lastNavigationProperty;if(s.includes("(")&&n.addressable){o=this.resolve(i+s,undefined,true);if(o){return o+n.pathAfterLastNavigationProperty}}o=this.resolve(i,undefined,true)||i;return o+s+n.pathAfterLastNavigationProperty};j.prototype.read=function(e,t){return this._read(e,t)};j.prototype._read=function(e,t,a){var r,s,i,n,o,d,u,h,f,c,p,l,g,_,m=this;if(t){r=t.canonicalRequest;s=t.context;i=t.error;o=t.filters;d=t.groupId||t.batchGroupId;u=t.headers;c=t.sorters;p=t.success;l=t.updateAggregatedMessages;_=t.urlParameters}r=this._isCanonicalRequestNeeded(r);if(e&&e.indexOf("?")!==-1){e=e.slice(0,e.indexOf("?"))}if(this.sRefreshGroupId){d=this.sRefreshGroupId}g=A._createUrlParamsArray(_);u=this._getHeaders(u,true);h="GET";n=this._getETag(e,s);var y={abort:function(){if(f){f._aborted=true}}};function v(t){var _,y,v,b,C,P,q=m.resolveDeep(e,s),M=m._getResourcePath(r,q,e,s);C=A.createSortParams(c);if(C){g.push(C)}_=m.oMetadata._getEntityTypeByPath(M);y=R.groupFilters(o);v=A.createFilterParams(y,m.oMetadata,_);if(v){g.push(v)}P=m._createRequestUrlWithNormalizedPath(M,g,m.bUseBatch);f=m._createRequest(P,q,h,u,null,n,undefined,l,a);b=m.mRequests;if(d in m.mDeferredGroups){b=m.mDeferredRequests}m._pushToRequestQueue(b,d,null,f,p,i,t,false);return f}if(this.bUseBatch&&this.bIncludeInCurrentBatch){f=v(y);return y}else{return this._processRequest(v,i)}};j.prototype.requestSideEffects=function(e,t){var a,r=this;t=t||{};for(a in t){if(!G.includes(a)){throw new Error("Parameter '"+a+"' is not supported")}}return new Promise(function(a,s){var i=new Set,n=t.urlParameters&&t.urlParameters["$expand"];r._read("",{context:e,error:s,groupId:t.groupId,success:function(){a()},updateAggregatedMessages:true,urlParameters:t.urlParameters},true);if(n){n.split(",").forEach(function(t){var a=r.oMetadata._getEntityTypeByPath(r.resolve(t,e));i.add(a)});r.getBindings().forEach(function(e){if(e.isA("sap.ui.model.odata.v2.ODataListBinding")){e._refreshForSideEffects(i,t.groupId)}})}})};j.prototype.getServiceMetadata=function(){if(this.oMetadata&&this.oMetadata.isLoaded()){return this.oMetadata.getServiceMetadata()}return undefined};j.prototype.metadataLoaded=function(e){var t=this.oMetadata.loaded(e);if(this.bLoadAnnotationsJoined){if(e){return Promise.all([t,this.pAnnotationsLoaded])}var a=function(){return t};return this.pAnnotationsLoaded.then(a,a)}else{return t}};j.prototype.annotationsLoaded=function(){return this.pAnnotationsLoaded};j.prototype.isMetadataLoadingFailed=function(){return this.oMetadata.isFailed()};j.prototype.getServiceAnnotations=function(){var e=this.oAnnotations.getData();return p(e)?null:e};j.prototype.onAnnotationsFailed=function(e){this.fireAnnotationsFailed(e.getParameters())};j.prototype.onAnnotationsLoaded=function(e){this.fireAnnotationsLoaded(e.getParameters())};j.prototype.addAnnotationUrl=function(e){var t=[].concat(e),a=[],r=[],s=[],i=this;t.forEach(function(e){var t=e.indexOf("$metadata");if(t>=0){e=i._createMetadataUrl(e);a.push(e)}else{r.push(e)}});return this.oMetadata._addUrl(a).then(function(e){return Promise.all(e.map(function(e){s=s.concat(e.entitySets);return i.oAnnotations.addSource({type:"xml",data:e["metadataString"]})}))}).then(function(){return i.oAnnotations.addSource(r)}).then(function(e){return{annotations:i.oAnnotations.getData(),entitySets:s}})};j.prototype.addAnnotationXML=function(e,t){return this.oAnnotations.addSource({type:"xml",data:e})};j.prototype.submitChanges=function(e){var t,a,r,s,i,n,d,u=false,h=this.bRefreshAfterChange,c=this;if(e){r=e.groupId||e.batchGroupId;d=e.success;a=e.error;if(e.merge!==undefined){s=e.merge?"MERGE":"PUT"}}if(r&&!this.mDeferredGroups[r]){o.fatal(this+' submitChanges: "'+r+'" is not a deferred group!')}t=g({},c.mChangedEntities);this.oMetadata.loaded().then(function(){var e,o,p,l,g,_;f(t,function(e,t){var a,i,n,o=c._resolveGroup(e);if(o.groupId===r||!r){i=c._processChange(e,t,s||c.sDefaultUpdateMethod);i.key=e;a=t.__metadata&&t.__metadata.created?t.__metadata.created:{};n={abort:function(){i._aborted=true}};if(o.groupId in c.mDeferredGroups){c._pushToRequestQueue(c.mDeferredRequests,o.groupId,o.changeSetId,i,a.success,a.error,n,a.refreshAfterChange===undefined?h:a.refreshAfterChange)}}});for(g in c.mDeferredRequests){_=c.mDeferredRequests[g];for(p in _.changes){o=_.changes[p];for(l=o.length-1;l>=0;l--){e=o[l];if(e.bRefreshAfterChange===undefined){e.bRefreshAfterChange=h}}}}n=c._processRequestQueue(c.mDeferredRequests,r,d,a);if(u){i.abort()}if(Array.isArray(n)&&n.length==0&&d){d({},undefined)}});i={abort:function(){if(n){if(Array.isArray(n)){n.forEach(function(e){e.abort()})}else{n.abort()}}else{u=true}}};return i};j.prototype._updateChangedEntities=function(e){var t=this,a,r,s;function i(e,n,o){f(n,function(d){var h=o+"/"+d;if(l(n[d])&&l(e[d])){i(e[d],n[d],h);if(p(n[d])){delete n[d]}}else if(o.endsWith("__metadata")||u(n[d],e[d])&&!t.isLaundering(h)){delete n[d];if(o===a){r=t.oMetadata._getEntityTypeByPath(a);s=r&&t.oMetadata._getNavPropertyRefInfo(r,d);if(s&&n[s.name]){e[s.name]=n[s.name];delete n[s.name]}}}})}f(e,function(e,r){if(e in t.mChangedEntities){var s=t._getObject("/"+e,null,true);var n=t._getObject("/"+e);g(s,r);a="/"+e;var o=t.removeInternalMetadata(n).deepPath;i(s,n,a);if(p(n)){delete t.mChangedEntities[e];t.abortInternalRequest(t._resolveGroup(e).groupId,{requestKey:e})}else{t.mChangedEntities[e]=n;n.__metadata={deepPath:o};c(n.__metadata,s.__metadata)}}})};j.prototype._discardEntityChanges=function(e,t){var a,r=this._resolveGroup(e).groupId,s=this.oMetadata.loaded(),i=this;s.then(function(){i.abortInternalRequest(r,{requestKey:e})});if(t){this.oCreatedContextsCache.findAndRemoveContext(this.mContexts["/"+e]);a=this.mChangedEntities[e]&&this.mChangedEntities[e].__metadata.created;this._removeEntity(e);if(a&&a.abort){a.abort(j._createAbortedError())}}else{delete this.mChangedEntities[e]}sap.ui.getCore().getMessageManager().removeMessages(this.getMessagesByEntity(e,!t));return s};j.prototype.resetChanges=function(e,t,a){var r=this.oMetadata.loaded(),s=this;if(t){r.then(function(){f(s.mDeferredGroups,function(t){if(e){e.forEach(function(e){s.abortInternalRequest(t,{path:e.substring(1)})})}else{s.abortInternalRequest(t)}})})}if(e){f(e,function(e,t){var r,i,n,o,d,u={};if(s.getEntityByPath(t,null,u)){d=u.propertyPath.split("/");o=d[d.length-1];n=u.key;r=s.mChangedEntities[n];if(r){for(i=0;i<d.length-1;i+=1){if(r&&r.hasOwnProperty(d[i])){r=r[d[i]]}else{r=undefined;break}}if(r&&r.hasOwnProperty(o)){delete r[o]}r=s.mChangedEntities[n];if(j._isChangedEntityEmpty(r)||!u.propertyPath){s._discardEntityChanges(n,r.__metadata.created&&a)}}}})}else{f(this.mChangedEntities,function(e,t){s._discardEntityChanges(e,t.__metadata.created&&a)})}this.checkUpdate(true);return r};j.prototype.setProperty=function(e,t,a,r){var s,i,n,o,d,h,c,g,_,m,y,v,b,C,P,q,R,M,E,S,x,T,U,D={},A={},I=false,O=this;function k(e,t){f(t,function(a){if(l(t[a])&&l(e[a])){k(e[a],t[a]);if(p(t[a])){delete t[a]}}else if(u(t[a],e[a])){delete t[a]}})}U=this.resolve(e,a);o=this.resolveDeep(e,a);c=this.getEntityByPath(U,null,A);if(!c){return false}R=U.substring(U.lastIndexOf("/")+1);if(R.startsWith("@$ui5.")){throw new Error("Setting a value for an instance annotation starting with '@$ui5' is "+"not allowed: "+R)}m=A.key;b=this._getObject("/"+m,null,true);C=this._getObject(e,a,true);if(!this.mChangedEntities[m]){d=c.__metadata;c={};c.__metadata=Object.assign({},d);if(A.propertyPath.length>0){var H=o.lastIndexOf(A.propertyPath);c.__metadata.deepPath=o.substring(0,H-1)}this.mChangedEntities[m]=c}i=this.mChangedEntities[m];q=A.propertyPath.split("/");for(var L=0;L<q.length-1;L++){if(!i.hasOwnProperty(q[L])){i[q[L]]={}}i=i[q[L]]}I=b.__metadata.created&&b.__metadata.created.functionImport;i[R]=t;h=this.oMetadata._getEntityTypeByPath(A.key);v=h&&this.oMetadata._getNavPropertyRefInfo(h,R);_=v&&b[v.name]&&b[v.name].__ref;if(_&&v.keys.length===1){if(t===null){M=null}else{y={};v.keys.forEach(function(e){y[e]=c[e]!==undefined?c[e]:b[e]});y[v.keys[0]]=t;M=this.createKey(v.entitySet,y)}i[v.name]={__ref:M}}if(u(t,C)&&!this.isLaundering("/"+m)&&!I){d=this.mChangedEntities[m].__metadata;n=d&&d.created;delete this.mChangedEntities[m].__metadata;if(!n){k(b,this.mChangedEntities[m])}if(p(this.mChangedEntities[m])){delete this.mChangedEntities[m];D[m]=true;this.checkUpdate(false,r,D);O.oMetadata.loaded().then(function(){O.abortInternalRequest(O._resolveGroup(m).groupId,{requestKey:m})});return true}this.mChangedEntities[m].__metadata=d}g=this._resolveGroup(m);x=this.mRequests;if(g.groupId in this.mDeferredGroups){x=this.mDeferredRequests;S=this._processChange(m,{__metadata:c.__metadata},this.sDefaultUpdateMethod)}else{S=this._processChange(m,this._getObject("/"+m),this.sDefaultUpdateMethod)}S.key=m;P=i.__metadata&&i.__metadata.created?i.__metadata.created:{};E=this._getRefreshAfterChange(undefined,g.groupId);if(c.__metadata.created&&!c.__metadata.created.functionImport){s=this.oCreatedContextsCache.findCreatedContext(U);if(s){s.activate()}}this.oMetadata.loaded().then(function(){T={abort:function(){S._aborted=true}};O._pushToRequestQueue(x,g.groupId,g.changeSetId,S,P.success,P.error,T,E);O._processRequestQueueAsync(O.mRequests)});D[m]=true;this.checkUpdate(false,r,D);return true};j.prototype._isHeaderPrivate=function(e){switch(e.toLowerCase()){case"accept":case"accept-language":case"maxdataserviceversion":case"dataserviceversion":return true;case"x-csrf-token":return this.bTokenHandling;case"sap-contextid-accept":case"sap-contextid":return!this.bDisableSoftStateHeader;default:return false}};j.prototype.setHeaders=function(e){var t={},a=this;this.mCustomHeaders={};if(e){f(e,function(e,r){if(a._isHeaderPrivate(e)){o.warning(this+" - modifying private header: '"+e+"' not allowed!")}else{t[e]=r}});this.mCustomHeaders=t}if(this.oAnnotations){this.oAnnotations.setHeaders(this.mCustomHeaders)}};j.prototype._getHeaders=function(e,t){var a={},r=this;if(e){f(e,function(e,t){if(r._isHeaderPrivate(e)){o.warning(this+" - modifying private header: '"+e+"' not allowed!")}else{a[e]=t}})}return c({"sap-cancel-on-close":!!t},this.mCustomHeaders,a,this.oHeaders)};j.prototype.getHeaders=function(){return c({},this.mCustomHeaders,this.oHeaders)};j.prototype._getHeader=function(e,t){var a;for(a in t){if(a.toLowerCase()===e.toLowerCase()){return t[a]}}return null};j.prototype.hasPendingChanges=function(e){var t=!p(this.mChangedEntities);if(e){t=t||this.iPendingDeferredRequests>0}return t};j.prototype.hasPendingRequests=function(){return this.aPendingRequestHandles.length>0};j.prototype.getPendingChanges=function(){return g({},this.mChangedEntities)};j.prototype.updateBindings=function(e){this.checkUpdate(e)};j.prototype.setTokenHandlingEnabled=function(e){this.bTokenHandling=e};j.prototype.setUseBatch=function(e){this.bUseBatch=e};j.prototype.formatValue=function(e,t){return A.formatValue(e,t)};j.prototype.deleteCreatedEntry=function(e){var t,a,r=this;if(e){a=e.getPath().substr(1);t=this._resolveGroup(a).groupId;r.oMetadata.loaded().then(function(){r.abortInternalRequest(t,{requestKey:a})});r._removeEntity(a);sap.ui.getCore().getMessageManager().removeMessages(this.getMessagesByEntity(e.getPath(),true))}};j.prototype.createEntry=function(e,t){var a,r,s,i,d,u,h,f,c,p,l,m,v,b,C,P,q,R,M,E,S,x,T,U={},D="POST",I=this;if(t){P=t.properties;l=t.groupId||t.batchGroupId;r=t.changeSetId;s=t.context;E=t.success;f=t.error;i=t.created;c=t.eTag;m=t.headers;T=t.urlParameters;q=t.refreshAfterChange;a=t.canonicalRequest;p=t.expand;v=t.inactive}if(p&&!this.bUseBatch){throw new Error("The 'expand' parameter is only supported if batch mode is used")}a=this._isCanonicalRequestNeeded(a);m=m||{};q=this._getRefreshAfterChange(q,l);l=l?l:this.sDefaultChangeGroup;x=A._createUrlParamsArray(T);var O={abort:function(){if(R){R._aborted=true;if(R.expandRequest){R.expandRequest._aborted=true}}}};if(!e.startsWith("/")&&!s){e="/"+e}C=I._normalizePath(e,s,a);h=I.resolveDeep(e,s);function k(){var e,t,a,s,i,k,H=false,L=f,F=E;var w=I.oMetadata._getEntityTypeByPath(C);if(!w){n(w,"No Metadata for collection "+C+" found");return undefined}if(typeof P==="object"&&!Array.isArray(P)){U=g({},P)}else{for(var G=0;G<w.property.length;G++){var j=w.property[G];var N=(P?P.indexOf(j.name):-1)>-1;if(!P||N){U[j.name]=I._createPropertyValue(j.type);if(N){P.splice(P.indexOf(j.name),1)}}}if(P){n(P.length===0,"No metadata for the following properties found: "+P.join(","))}}s=I.oMetadata._getEntitySetByType(w);k=_();b=s.name+"('"+k+"')";if(h&&I.oMetadata._isCollection(h)){h=h+"('"+k+"')"}if(p){m=Object.assign({},m,{"Content-ID":k,"sap-messages":"transientOnly"});E=function(t,r){if(!e){e=t;a=r;return}if(F){t=Object.assign({},e,t);F(t,a)}u()};f=function(t){if(e){a.expandAfterCreateFailed=true;t.expandAfterCreateFailed=true;o.error("Entity creation was successful but expansion of navigation"+" properties failed",t,B);if(F){F(e,a)}u();return}if(!H){H=true;if(L){L(t)}}else{t.expandAfterCreateFailed=true;H=false}}}else{E=function(e,t){if(F){F(e,t)}u()}}U.__metadata={type:""+w.entityType,uri:I.sServiceUrl+"/"+b,created:{changeSetId:r,error:f,eTag:c,groupId:l,headers:m,key:C.substring(1),refreshAfterChange:q,success:E,urlParameters:T},deepPath:h};d=new y(function(e,a){u=function(){if(!I.oCreatedContextsCache.getCacheInfo(t)){t.resetCreatedPromise()}e()};U.__metadata.created.abort=a});d.catch(function(){});b=I._addEntity(g({},U));if(!v){I.mChangedEntities[b]=U}S=I._createRequestUrlWithNormalizedPath(C,x,I.bUseBatch);R=I._createRequest(S,h,D,m,U,c);if(p){i=I._createRequest("$"+k+"?"+A._encodeURLParameters({$expand:p,$select:p}),"/$"+k,"GET",I._getHeaders(undefined,true),null,undefined,undefined,true);i.contentID=k;R.expandRequest=i;R.contentID=k;U.__metadata.created.expandRequest=i;U.__metadata.created.contentID=k}t=I.getContext("/"+b,h,d,v);R.key=b;R.created=true;M=I.mRequests;if(l in I.mDeferredGroups){M=I.mDeferredRequests}I.oMetadata.loaded().then(function(){t.fetchActivated().then(function(){I._pushToRequestQueue(M,l,r,R,E,f,O,q);I._processRequestQueueAsync(I.mRequests)})});return t}if(i){this.oMetadata.loaded().then(function(){i(k())})}else if(this.oMetadata.isLoaded()){return k()}else{o.error("Tried to use createEntry without created-callback, before metadata is "+"available!")}return undefined};j.prototype._isCreatedEntity=function(e){return!!(e&&e.__metadata&&e.__metadata.created)};j.prototype._createPropertyValue=function(e){var t=this.oMetadata._splitName(e);var a=t.namespace;var r=t.name;if(a.toUpperCase()!=="EDM"){var s={};var i=this.oMetadata._getObjectMetadata("complexType",r,a);n(i,"Complex type "+e+" not found in the metadata !");for(var o=0;o<i.property.length;o++){var d=i.property[o];s[d.name]=this._createPropertyValue(d.type)}return s}else{return this._getDefaultPropertyValue(r,a)}};j.prototype._getDefaultPropertyValue=function(e,t){return undefined};j.prototype._normalizePath=function(e,t,a){if(e&&e.indexOf("?")!==-1){e=e.substr(0,e.indexOf("?"))}if(!t&&!e.startsWith("/")){o.fatal(this+" path "+e+" must be absolute if no Context is set")}return this.resolve(e,t,a)||this.resolve(e,t)};j.prototype.getRefreshAfterChange=function(){return this.bRefreshAfterChange};j.prototype.setRefreshAfterChange=function(e){this.bRefreshAfterChange=e};j.prototype.isList=function(e,t){e=this.resolve(e,t);return e&&e.substr(e.lastIndexOf("/")).indexOf("(")===-1};j.prototype._isMetadataPath=function(e){var t=false;if(e&&e.indexOf("/#")>-1){t=true}return t};j.prototype.isMetaModelPath=function(e){return e.indexOf("##")==0||e.indexOf("/##")>-1};j.prototype._request=function(e,t,a,r,s,i){var n;if(this.bDestroyed){return{abort:function(){}}}var o=this;function d(e){return function(){if(o.aPendingRequestHandles){var t=o.aPendingRequestHandles.indexOf(n);if(t>-1){o.aPendingRequestHandles.splice(t,1)}}if(!(n&&n.bSuppressErrorHandlerCall)){e.apply(this,arguments)}}}n=k.request(e,d(t||k.defaultSuccess),d(a||k.defaultError),r,s,i);if(e.async!==false){this.aPendingRequestHandles.push(n)}return n};j.prototype.destroy=function(){this.bDestroyed=true;M.prototype.destroy.apply(this,arguments);if(this.aPendingRequestHandles){for(var e=this.aPendingRequestHandles.length-1;e>=0;e--){var t=this.aPendingRequestHandles[e];if(t&&t.abort){t.bSuppressErrorHandlerCall=true;t.abort()}}delete this.aPendingRequestHandles}if(this.sMetadataLoadEvent){clearTimeout(this.sMetadataLoadEvent)}if(this.oMetadataFailedEvent){clearTimeout(this.oMetadataFailedEvent)}if(this.oMetadata){this.oMetadata.detachFailed(this.onMetadataFailed);if(!this.oMetadata.isLoaded()&&!this.oMetadata.hasListeners("loaded")){this.oMetadata.destroy();delete this.oSharedMetaData.oMetadata}delete this.oMetadata;delete this.pMetadataLoaded}if(this.oMetaModel){this.oMetaModel.destroy();delete this.oMetaModel}if(this.oAnnotations){this.oAnnotations.detachSomeLoaded(this.onAnnotationsLoaded);this.oAnnotations.detachAllFailed(this.onAnnotationsFailed);this.oAnnotations.destroy();delete this.oAnnotations;delete this.pAnnotationsLoaded}};j.prototype.setDeferredBatchGroups=function(e){this.setDeferredGroups(e)};j.prototype.setDeferredGroups=function(e){var t=this;this.mDeferredGroups={};f(e,function(e,a){t.mDeferredGroups[a]=a})};j.prototype.getDeferredBatchGroups=function(){return this.getDeferredGroups()};j.prototype.getDeferredGroups=function(){return Object.keys(this.mDeferredGroups)};j.prototype.setChangeBatchGroups=function(e){f(e,function(e,t){t.groupId=t.batchGroupId});this.setChangeGroups(e)};j.prototype.setChangeGroups=function(e){this.mChangeGroups=e};j.prototype.getChangeBatchGroups=function(){return this.getChangeGroups()};j.prototype.getChangeGroups=function(){return this.mChangeGroups};j.prototype.setMessageParser=function(e){if(!(e instanceof C)){o.error("Given MessageParser is not of type sap.ui.core.message.MessageParser");return this}e.setProcessor(this);this.oMessageParser=e;return this};j.prototype._parseResponse=function(e,t,a,r){try{if(!this.oMessageParser){this.oMessageParser=new U(this.sServiceUrl,this.oMetadata,!!this.bPersistTechnicalMessages);this.oMessageParser.setProcessor(this)}this.oMessageParser.parse(e,t,a,r,this.bIsMessageScopeSupported)}catch(e){o.error("Error parsing OData messages: "+e)}};j.prototype.callAfterUpdate=function(e){this.aCallAfterUpdate.push(e)};j.prototype.getMetaModel=function(){var e=this;if(!this.oMetaModel){this.oMetaModel=new T(this.oMetadata,this.oAnnotations,this);this.oMetaModel.loaded().then(function(){e.bMetaModelLoaded=true;e.checkUpdate(false,false,null,true)},function(e){var t=e.message,a;if(!t&&e.xmlDoc&&e.xmlDoc.parseError){t=e.xmlDoc.parseError.reason;a=e.xmlDoc.parseError.srcText}o.error("error in ODataMetaModel.loaded(): "+t,a,B)})}return this.oMetaModel};j.prototype.getOriginalProperty=function(e,t){return this._getObject(e,t,true)};j.prototype.getEntityByPath=function(e,t,a){var r,s=M.prototype.resolve.call(this,e,t);if(!s){return null}var i=s.split("/"),n=null,o=[];while(i.length>0){var d=i.join("/"),u=this._getObject(d);if(l(u)){r=this._getKey(u);if(r){n=u;break}}o.unshift(i.pop())}if(n){a.propertyPath=o.join("/");a.key=r;return n}return null};j.prototype.resolveFromCache=function(e){if(!this.mPathCache){return undefined}var t,a="",r,s,i;r=this.mPathCache[e]?this.mPathCache[e].canonicalPath:undefined;if(e&&r!==e){t=r||e;if(!r){i=t.lastIndexOf("/");a=t.substr(i);t=t.substr(0,i)}s=this.resolveFromCache(t);if(s&&s!==t){r=s+a}}return r};j.prototype.resolve=function(e,t,a){var r=M.prototype.resolve.call(this,e,t);if(r&&!this._isMetadataPath(r)&&a){var s=this.resolveFromCache(r);if(!s){s=this.oMetadata._calculateCanonicalPath(r);s=this.resolveFromCache(s)||s}this._writePathCache(r,s);return s}return r};j.prototype.resolveDeep=function(e,t){var a=M.prototype.resolve.call(this,e,t);if(e&&!e.startsWith("/")){a=t?t.sDeepPath+"/"+e:a}if(e===""){a=t?t.sDeepPath:a}return a};j.prototype.isLaundering=function(e,t){var a=this.resolve(e,t);return a in this.mLaunderingState&&this.mLaunderingState[a]>0};j.prototype.increaseLaundering=function(e,t){if(!l(t)){return}for(var a in t){if(a==="__metadata"){continue}var r=t[a];if(l(r)){this.increaseLaundering(e+"/"+a,r)}else{var s=e+"/"+a;if(!(s in this.mLaunderingState)){this.mLaunderingState[s]=0}this.mLaunderingState[s]++}}if(!(e in this.mLaunderingState)){this.mLaunderingState[e]=0}this.mLaunderingState[e]++};j.prototype.decreaseLaundering=function(e,t){if(!l(t)){return}for(var a in t){if(a==="__metadata"){continue}var r=t[a],s=e+"/"+a;if(l(r)){this.decreaseLaundering(s,r)}else if(s in this.mLaunderingState){this.mLaunderingState[s]--;if(this.mLaunderingState[s]===0){delete this.mLaunderingState[s]}}}this.mLaunderingState[e]--;if(this.mLaunderingState[e]===0){delete this.mLaunderingState[e]}};j.prototype._getRefreshAfterChange=function(e,t){if(e===undefined&&!(t in this.mDeferredGroups)){return this.bRefreshAfterChange}return e};j.prototype.getMessagesByEntity=function(e,t){var a=e,r=[],s;function i(e){var a=[];for(var r=0;r<e.length;r++){if(!t||t&&!e[r].persistent){a.push(e[r])}}return a}if(!a.startsWith("/")){a="/"+a}if(this.mMessages){for(s in this.mMessages){if(typeof a=="string"&&a.length>0&&s.startsWith(a)){r=r.concat(i(this.mMessages[s]))}}return r}return null};j.prototype._cacheSupported=function(e){var t=/\/~[\w\-]+~[A-Z0-9]?/;var a=[e];if(this.sAnnotationURI){if(!Array.isArray(this.sAnnotationURI)){this.sAnnotationURI=[this.sAnnotationURI]}a=a.concat(this.sAnnotationURI)}a=a.filter(function(e){return e.indexOf("sap-context-token")===-1});a=a.filter(function(e){return!t.test(e)});return a.length===0?true:false};j.prototype._getAnnotationCacheKey=function(e){var t;if(this.bUseCache){if(!this.bSkipMetadataAnnotationParsing){t=e+"#annotations"}if(this.sAnnotationURI){if(!Array.isArray(this.sAnnotationURI)){this.sAnnotationURI=[this.sAnnotationURI]}this.sAnnotationURI=this.sAnnotationURI.map(function(e){return e+"#annotations"});t=this.bSkipMetadataAnnotationParsing?this.sAnnotationURI.join("_"):t+"_"+this.sAnnotationURI.join("_")}}return t};j.prototype.canonicalRequestsEnabled=function(){return this.bCanonicalRequests};j.prototype._decreaseDeferredRequestCount=function(e){if(e.deferred){this.iPendingDeferredRequests--}};j.prototype.enableCanonicalRequests=function(e){this.bCanonicalRequests=!!e};j.prototype.getMessageScope=function(){return this.sMessageScope};j.prototype.setMessageScope=function(e){if(e!==S.RequestedObjects&&e!==S.BusinessObject){throw new Error("Unsupported message scope: "+e)}this.sMessageScope=e};j.prototype.messageScopeSupported=function(){var e=this;return this.metadataLoaded().then(function(){return e.bIsMessageScopeSupported})};j.prototype.getContext=function(e,a,r,s){var i=this.mContexts[e];if(!i){i=this.mContexts[e]=new t(this,e,a,r,s)}else{i.setDeepPath(a||i.getDeepPath()||e)}return i};j.prototype.hasContext=function(e){return this.mContexts[e]};j.prototype.removeInternalMetadata=function(e){var t,a,r,s,i;if(e&&e.__metadata){t=e.__metadata.created;a=e.__metadata.deepPath;r=e.__metadata.invalid;delete e.__metadata.created;delete e.__metadata.deepPath;delete e.__metadata.invalid}for(s in e){i=e[s];if(Array.isArray(i)){i.forEach(j.prototype.removeInternalMetadata)}else if(typeof i==="object"){j.prototype.removeInternalMetadata(i)}}return{created:t,deepPath:a,invalid:r}};j.prototype._isCanonicalRequestNeeded=function(e){if(e!==undefined){return!!e}else{return!!this.bCanonicalRequests}};j.prototype.filterMatchingMessages=function(e,t){var a=this;return this.mMessages[e].filter(function(e){return a.isMessageMatching(e,t)})};j.prototype.isMessageMatching=function(e,t){var a=t.length;return e.aFullTargets.some(function(e){return e===t||e.startsWith(t)&&(t==="/"||e[a]==="/"||e[a]==="(")})};j.prototype.getMessages=function(e){return this.getMessagesByPath(e.sDeepPath,true).sort(b.compare)};j.prototype.getDeepPathForCanonicalPath=function(e){var t,a,i,n,o,d,u,h=e.slice(e.indexOf("("));o=this.aBindings.filter(function(e){return(e instanceof r||e instanceof s)&&e.isResolved()});for(d=0,u=o.length;d<u;d+=1){t=o[d];i=this.resolveDeep(t instanceof s?t.sPath+h:t.sPath,t.oContext);a=this.resolveFromCache(i);if(a===e){if(n&&n!==i){return undefined}n=i}}return n};j.prototype.getPersistTechnicalMessages=function(){return this.bPersistTechnicalMessages};j.prototype.setPersistTechnicalMessages=function(e){e=!!e;if(this.bPersistTechnicalMessages===e){return}if(this.bPersistTechnicalMessages!==undefined){o.warning("The flag whether technical messages should always be treated as persistent"+" has been overwritten to "+e,undefined,B)}this.bPersistTechnicalMessages=e;if(this.oMessageParser){this.oMessageParser._setPersistTechnicalMessages(e)}};j.prototype.createCodeListModelParameters=function(e){e=e||{};return{defaultCountMode:E.None,disableSoftStateHeader:true,headers:e.headers&&Object.assign({},e.headers),json:e.json,metadataUrlParams:e.metadataUrlParams&&Object.assign({},e.metadataUrlParams),persistTechnicalMessages:e.persistTechnicalMessages,serviceUrl:this.sServiceUrl,serviceUrlParams:e.serviceUrlParams&&Object.assign({},e.serviceUrlParams),tokenHandling:false,useBatch:false,warmupUrl:e.warmupUrl}};j.prototype.getCodeListModelParameters=function(){return this.mCodeListModelParams};j.prototype.getMetadataUrl=function(){return this.sMetadataUrl};j._createAbortedError=function(){return{aborted:true,headers:{},message:"Request aborted",responseText:"",statusCode:0,statusText:"abort"}};j.prototype._getCreatedContextsCache=function(){return this.oCreatedContextsCache};j._isChangedEntityEmpty=function(e){return Object.keys(e).every(function(e){return e==="__metadata"})};return j});