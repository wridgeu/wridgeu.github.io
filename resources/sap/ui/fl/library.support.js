/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/support/library","sap/ui/fl/Utils","sap/ui/dt/DesignTime","sap/ui/rta/util/validateStableIds","sap/base/util/ObjectPath","sap/m/InstanceManager"],function(e,t,n,a,o,i){"use strict";var r=e.Categories;var s=e.Audiences;var l=e.Severity;function c(e){var n;e.some(function(e){n=t.getAppComponentForControl(e);return!!n});return n}function u(e){return(!e.isPopupAdaptationAllowed||e.isPopupAdaptationAllowed())&&t.getAppComponentForControl(e)&&(e.isA("sap.m.Dialog")||e.isA("sap.m.Popover"))}var p={id:"stableId",audiences:[s.Application],categories:[r.Functionality],enabled:true,minversion:"1.28",title:"Stable control IDs are required for SAPUI5 flexibility services",description:"Checks whether the IDs of controls support SAPUI5 flexibility services",resolution:"Replace the generated control ID with a stable ID. We strongly recommend that you use stable IDs for all controls in your app.",resolutionurls:[{text:"Documentation: Stable IDs: All You Need to Know",href:"https://sapui5.hana.ondemand.com/#topic/f51dbb78e7d5448e838cdc04bdf65403"}],async:true,check:function(e,t,r,s){var p;var d=o.get("sap.ushell.Container");if(d){var f=d.getService("AppLifeCycle").getCurrentApplication();if(!f.homePage){p=f.componentInstance}}else{p=c(r.getElements())}if(!p){return}var h=i.getOpenPopovers();var v=i.getOpenDialogs();var g=h.concat(v).filter(u);var m=new n({rootElements:[p].concat(g)});m.attachEventOnce("synced",function(){var t=a(m.getElementOverlays(),p);t.forEach(function(t){var n=t.getElement();var a=n.getId();var o=a.includes("--");if(!o){e.addIssue({severity:l.High,details:"The ID '"+a+"' for the control was generated and flexibility features "+"cannot support controls with generated IDs.",context:{id:a}})}else{e.addIssue({severity:l.Low,details:"The ID '"+a+"' for the control was concatenated and has a generated onset.\n"+"To enable the control for flexibility features, you must specify an ID for the control providing the onset, which is marked as high issue.",context:{id:a}})}});m.destroy();s()})}};return{name:"sap.ui.fl",niceName:"UI5 Flexibility Library",ruleset:[p]}},true);