/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/security/encodeURLParameters"],function(e){"use strict";var s=0;var t=function(e,s){var t=new Error(e.statusText);t.status=e.status;t.userMessage=s;return t};var r=function(e){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl").getText(e)};return{addLanguageInfo:function(e){if(!e){e={}}e["sap-language"]=sap.ui.getCore().getConfiguration().getLanguage()},getUrl:function(s,t,r){if(!s||!t.url){throw new Error("Not all necessary parameters were passed")}var n=t.url+s;if(t.cacheKey){n+="~"+t.cacheKey+"~/"}if(t.reference){n+=t.reference}else if(t.fileName){n+=t.fileName}if(r){Object.keys(r).forEach(function(e){if(r[e]===undefined){delete r[e]}});var a=e(r);if(a.length>0){n+="?"+a}}return n},sendRequest:function(e,n,a){n=n||"GET";n=n.toUpperCase();return new Promise(function(o,i){var p=new XMLHttpRequest;p.open(n,e);p.timeout=s;if((n==="GET"||n==="HEAD")&&(!a||!a.xsrfToken)){p.setRequestHeader("X-CSRF-Token","fetch")}if((n==="POST"||n==="PUT"||n==="DELETE")&&a&&a.xsrfToken){p.setRequestHeader("X-CSRF-Token",a.xsrfToken)}if(a&&a.contentType){p.setRequestHeader("Content-Type",a.contentType)}if(a&&a.siteId){p.setRequestHeader("X-LRep-Site-Id",a.siteId)}if(a&&a.sAppDescriptorId){p.setRequestHeader("X-LRep-AppDescriptor-Id",a.sAppDescriptorId)}if(a&&a.dataType){p.responseType=a.dataType}p.onload=function(){if(p.status>=200&&p.status<400){try{var e={};if(p.status!==204&&p.status!==205){if(!p.response&&p.responseText){p.response=p.responseText}e.response=p.response;if(typeof e.response==="string"&&p.getResponseHeader("content-type")&&p.getResponseHeader("content-type").indexOf("json")>0){e.response=JSON.parse(e.response)}}e.status=p.status;if(p.getResponseHeader("X-CSRF-Token")){e.xsrfToken=p.getResponseHeader("X-CSRF-Token")}if(p.getResponseHeader("Etag")){e.etag=p.getResponseHeader("Etag")}o(e)}catch(e){e.userMessage=r("MSG_LOADING_SERVER_RESPONSE_ERROR");i(e)}}else{var s="";try{var n=typeof p.response==="string"?JSON.parse(p.response):p.response;if(Array.isArray(n.messages)&&n.messages.length){s=n.messages.reduce(function(e,s){return e.concat(s.severity==="Error"?s.text+"\n":"")},s)}}catch(e){}i(t(p,s))}};p.ontimeout=function(){i(t(p,r("MSG_CONNECTION_TIMEOUT_ERROR")))};p.onerror=function(){i(t(p,r("MSG_NETWORK_ERROR")))};if(a&&a.payload){p.send(a.payload)}else{p.send()}})}}});