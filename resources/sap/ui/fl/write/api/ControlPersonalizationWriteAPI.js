/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/ControlPersonalizationAPI","sap/ui/fl/FlexControllerFactory","sap/ui/fl/Layer","sap/ui/fl/registry/Settings","sap/ui/fl/Utils"],function(e,n,t,r,o){"use strict";var s={add:function(n){n.changes.forEach(function(e){e.selectorControl=e.selectorElement});n.controlChanges=n.changes;return e.addPersonalizationChanges(n)},reset:function(n){n.selectors=n.selectors||[];return e.resetChanges(n.selectors,n.changeTypes)},restore:function(e){if(!e||!e.selector){return Promise.reject("No selector was provided")}var r=o.getAppComponentForControl(e.selector);if(!r){return Promise.reject("App Component could not be determined")}var s=n.createForControl(r);return s.removeDirtyChanges(t.USER,r,e.selector,e.generator,e.changeTypes)},save:function(n){var t=n.selector.appComponent||o.getAppComponentForControl(n.selector);return e.saveChanges(n.changes,t)},buildSelectorFromElementIdAndType:function(e){var n=o.getAppComponentForControl(e.element);if(!n||!e.elementId||!e.elementType){throw new Error("Not enough information given to build selector.")}return{elementId:e.elementId,elementType:e.elementType,appComponent:n,id:e.elementId,controlType:e.elementType}},isCondensingEnabled:function(){return r.getInstance().then(function(e){return e.isCondensingEnabled(t.USER)})}};return s},true);