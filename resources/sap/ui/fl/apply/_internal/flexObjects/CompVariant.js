/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/registry/Settings","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,t,n,i,a,r,s){"use strict";function o(e){var t=a.getInstanceOrUndef();var n=t&&t.getUserId();return!n||n.toUpperCase()===e.toUpperCase()}function u(e,t,n,s){if(t){return s||e===t}else if(e===i.USER){return true}var u=a.getInstanceOrUndef();if(r.isSapUiLayerParameterProvided()){t=r.getCurrentLayer()}else if(!t){t=u.isPublicLayerAvailable()?i.PUBLIC:i.CUSTOMER}var l=e===t;var c=u.isKeyUser()||o(n);return l&&c}function l(e){return!e||s.getCurrentLanguage()===e}function c(e,t){var n=a.getInstanceOrUndef();if(!n){return true}if(!e||!t){return true}var i=n.getSystem();var r=n.getClient();return i===e&&t===r}var f=n.extend("sap.ui.fl.apply._internal.flexObjects.Variant",{metadata:{properties:{favorite:{type:"boolean",defaultValue:false},executeOnSelection:{type:"boolean",defaultValue:false},standardVariant:{type:"boolean",defaultValue:false},contexts:{type:"object",defaultValue:{}},persisted:{type:"boolean",defaultValue:true},name:{type:"string",defaultValue:""},content:{type:"object",defaultValue:{}}},aggregations:{revertInfo:{type:"sap.ui.fl.apply._internal.flexObjects.CompVariantRevertData",multiple:true,singularName:"revertInfo",defaultValue:[]},changes:{type:"sap.ui.fl.Change",multiple:true,defaultValue:[]}}},constructor:function(e){n.apply(this,arguments);var t=e.content&&(e.content.executeOnSelect||e.content.executeOnSelection);if(e.executeOnSelection!==undefined){t=e.executeOnSelection}this.setExecuteOnSelection(t);this.setContexts(e.contexts||{});this.setContent(e.content||{});this.setName(this.getText("variantName"));if(e.layer===i.VENDOR||e.layer===i.CUSTOMER_BASE){this.setFavorite(true)}if(e.favorite!==undefined){this.setFavorite(!!e.favorite)}if(e.persisted!==undefined){this.setPersisted(!!e.persisted)}}});f.STANDARD_VARIANT_ID="*standard*";f.prototype.isRenameEnabled=function(e){return this.isEditEnabled(e)&&l(this.getOriginalLanguage())&&!this.getStandardVariant()};f.prototype.isEditEnabled=function(e){return c(this.getSourceSystem(),this.getSourceClient())&&u(this.getLayer(),e,this.getOwnerId(),true)&&(e&&r.isDeveloperLayer(e)||!this.getStandardVariant())};f.prototype.isDeleteEnabled=function(e){return c(this.getSourceSystem(),this.getSourceClient())&&u(this.getLayer(),e,this.getOwnerId())&&!this.getStandardVariant()};f.prototype.storeFavorite=function(e){if(e!==undefined){this._oDefinition.favorite=e}else{delete this._oDefinition.favorite}this.setState(t.DIRTY);this.setFavorite(e)};f.prototype.setContent=function(e){this.setProperty("content",e||{})};f.prototype.getContent=function(){return this.getProperty("content")};f.prototype.storeContent=function(e){this._oDefinition.content=e||{};this.setState(t.DIRTY);this.setContent(e)};f.prototype.storeExecuteOnSelection=function(e){if(e!==undefined){this._oDefinition.executeOnSelection=e}else{delete this._oDefinition.executeOnSelection}delete this._oDefinition.content.executeOnSelection;this.setState(t.DIRTY);this.setExecuteOnSelection(e)};f.prototype.storeName=function(e){this._oDefinition.texts.variantName.value=e;this.setState(t.DIRTY);this.setName(e)};f.prototype.storeContexts=function(e){if(e!==undefined){this._oDefinition.contexts=e}else{delete this._oDefinition.contexts}this.setContexts(e);this.setState(t.DIRTY)};f.createInitialFileContent=function(t){var i=n.createInitialFileContent(t);if(t.contexts){i.contexts=t.contexts}if(t.favorite!==undefined){i.favorite=t.favorite}if(t.executeOnSelection!==undefined){i.executeOnSelection=t.executeOnSelection}return e(i,["changeType","namespace","service","content","reference","fileName","fileType","packageName","layer","favorite","executeOnSelection","selector","texts","support","contexts"])};return f});