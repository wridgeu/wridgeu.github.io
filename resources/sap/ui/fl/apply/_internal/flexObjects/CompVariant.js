/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/registry/Settings","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,t,n,i,o,r,a){"use strict";function s(e){var t=o.getInstanceOrUndef();var n=t&&t.getUserId();return!n||n.toUpperCase()===e.toUpperCase()}function u(e,t,n){if(t){return e===t}else if(e===i.USER){return true}var a=o.getInstanceOrUndef();if(r.isSapUiLayerParameterProvided()){t=r.getCurrentLayer()}else if(!t){t=a.isPublicLayerAvailable()?i.PUBLIC:i.CUSTOMER}var u=e===t;var f=a.isKeyUser()||s(n);return u&&f}function f(e){return!e||a.getCurrentLanguage()===e}function l(e,t){var n=o.getInstanceOrUndef();if(!n){return true}if(!e||!t){return true}var i=n.getSystem();var r=n.getClient();return i===e&&t===r}var c=n.extend("sap.ui.fl.apply._internal.flexObjects.Variant",{metadata:{properties:{favorite:{type:"boolean",defaultValue:false},executeOnSelection:{type:"boolean",defaultValue:false},standardVariant:{type:"boolean",defaultValue:false},contexts:{type:"object",defaultValue:{}},persisted:{type:"boolean",defaultValue:true},name:{type:"string",defaultValue:""},content:{type:"object",defaultValue:{}}},aggregations:{revertInfo:{type:"sap.ui.fl.apply._internal.flexObjects.CompVariantRevertData",multiple:true,singularName:"revertInfo",defaultValue:[]},changes:{type:"sap.ui.fl.Change",multiple:true,defaultValue:[]}}},constructor:function(e){n.apply(this,arguments);var t=e.content&&(e.content.executeOnSelect||e.content.executeOnSelection);if(e.executeOnSelection!==undefined){t=e.executeOnSelection}this.setExecuteOnSelection(t);this.setContexts(e.contexts||{});this.setContent(e.content||{});this.setName(this.getText("variantName"));if(e.layer===i.VENDOR||e.layer===i.CUSTOMER_BASE){this.setFavorite(true)}if(e.favorite!==undefined){this.setFavorite(!!e.favorite)}if(e.persisted!==undefined){this.setPersisted(!!e.persisted)}}});c.STANDARD_VARIANT_ID="*standard*";c.prototype.getVariantId=function(){return this.getId()};c.prototype.isRenameEnabled=function(e){return!this.getStandardVariant()&&this.isEditEnabled(e)&&f(this._oDefinition.content.originalLanguage)};c.prototype.isEditEnabled=function(e){var t=e&&r.isDeveloperLayer(e);var n=l(this._oDefinition.sourceSystem,this._oDefinition.sourceClient);var i=u(this.getLayer(),e,this.getOwnerId());return t||n&&i};c.prototype.isDeleteEnabled=function(e){return l(this._oDefinition.sourceSystem,this._oDefinition.sourceClient)&&u(this.getLayer(),e,this.getOwnerId())&&!this.getStandardVariant()};c.prototype.storeFavorite=function(e){if(e!==undefined){this._oDefinition.favorite=e}else{delete this._oDefinition.favorite}this.setState(t.DIRTY);this.setFavorite(e)};c.prototype.setContent=function(e){this.setProperty("content",e||{})};c.prototype.getContent=function(){return this.getProperty("content")};c.prototype.getOwnerId=function(){return this._oDefinition.support?this._oDefinition.support.user:""};c.prototype.storeContent=function(e){this._oDefinition.content=e||{};this.setState(t.DIRTY);this.setContent(e)};c.prototype.storeExecuteOnSelection=function(e){if(e!==undefined){this._oDefinition.executeOnSelection=e}else{delete this._oDefinition.executeOnSelection}delete this._oDefinition.content.executeOnSelection;this.setState(t.DIRTY);this.setExecuteOnSelection(e)};c.prototype.storeName=function(e){this._oDefinition.texts.variantName.value=e;this.setState(t.DIRTY);this.setName(e)};c.prototype.storeContexts=function(e){if(e!==undefined){this._oDefinition.contexts=e}else{delete this._oDefinition.contexts}this.setContexts(e);this.setState(t.DIRTY)};c.createInitialFileContent=function(t){var i=n.createInitialFileContent(t);if(t.contexts){i.contexts=t.contexts}if(t.favorite!==undefined){i.favorite=t.favorite}if(t.executeOnSelection!==undefined){i.executeOnSelection=t.executeOnSelection}return e(i,["changeType","namespace","service","content","reference","fileName","fileType","packageName","layer","favorite","executeOnSelection","selector","texts","support","contexts"])};return c});