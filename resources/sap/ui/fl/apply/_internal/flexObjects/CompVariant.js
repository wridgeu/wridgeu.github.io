/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/restricted/_pick","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/registry/Settings","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,t,n,i,a,s){"use strict";function r(e){var t=s.getUshellContainer();var n=t&&t.getUser();return!n||n.getId().toUpperCase()===e.toUpperCase()}function o(e,t,s,o){if(t){return o||e===t}else if(e===n.USER){return true}var u=i.getInstanceOrUndef();if(a.isSapUiLayerParameterProvided()){t=a.getCurrentLayer()}else if(!t){t=u.isPublicLayerAvailable()?n.PUBLIC:n.CUSTOMER}var l=e===t;var c=u.isKeyUser()||r(s);return l&&c}function u(e){return!e||s.getCurrentLanguage()===e}function l(e,t){var n=i.getInstanceOrUndef();if(!n){return true}if(!e||!t){return true}var a=n.getSystem();var s=n.getClient();return a===e&&t===s}var c=t.extend("sap.ui.fl.apply._internal.flexObjects.Variant",{metadata:{properties:{favorite:{type:"boolean",defaultValue:false},executeOnSelection:{type:"boolean",defaultValue:false},standardVariant:{type:"boolean",defaultValue:false},contexts:{type:"object",defaultValue:{}},persisted:{type:"boolean",defaultValue:true},name:{type:"string",defaultValue:""},content:{type:"object",defaultValue:{}}},aggregations:{revertInfo:{type:"sap.ui.fl.apply._internal.flexObjects.CompVariantRevertData",multiple:true,singularName:"revertInfo",defaultValue:[]},changes:{type:"sap.ui.fl.Change",multiple:true,defaultValue:[]}}},constructor:function(e){t.apply(this,arguments);var i=e.content&&(e.content.executeOnSelect||e.content.executeOnSelection);if(e.executeOnSelection!==undefined){i=e.executeOnSelection}this.setExecuteOnSelection(i);this.setContexts(e.contexts||{});this.setContent(e.content||{});this.setName(this.getText("variantName"));if(e.layer===n.VENDOR||e.layer===n.CUSTOMER_BASE){this.setFavorite(true)}if(e.favorite!==undefined){this.setFavorite(!!e.favorite)}if(e.persisted!==undefined){this.setPersisted(!!e.persisted)}}});c.STANDARD_VARIANT_ID="*standard*";c.prototype.isRenameEnabled=function(e){return this.isEditEnabled(e)&&u(this.getOriginalLanguage())&&!this.getStandardVariant()};c.prototype.isEditEnabled=function(e){return l(this.getSourceSystem(),this.getSourceClient())&&o(this.getLayer(),e,this.getOwnerId(),true)&&(e&&a.isDeveloperLayer(e)||!this.getStandardVariant())};c.prototype.isDeleteEnabled=function(e){return l(this.getSourceSystem(),this.getSourceClient())&&o(this.getLayer(),e,this.getOwnerId())&&!this.getStandardVariant()};c.prototype.storeFavorite=function(e){if(e!==undefined){this._oDefinition.favorite=e}else{delete this._oDefinition.favorite}this.setState(t.states.DIRTY);this.setFavorite(e)};c.prototype.setContent=function(e){this.setProperty("content",e||{})};c.prototype.getContent=function(){return this.getProperty("content")};c.prototype.storeContent=function(e){this._oDefinition.content=e||{};this.setState(t.states.DIRTY);this.setContent(e)};c.prototype.storeExecuteOnSelection=function(e){if(e!==undefined){this._oDefinition.executeOnSelection=e}else{delete this._oDefinition.executeOnSelection}delete this._oDefinition.content.executeOnSelection;this.setState(t.states.DIRTY);this.setExecuteOnSelection(e)};c.prototype.storeName=function(e){this._oDefinition.texts.variantName.value=e;this.setState(t.states.DIRTY);this.setName(e)};c.prototype.storeContexts=function(e){if(e!==undefined){this._oDefinition.contexts=e}else{delete this._oDefinition.contexts}this.setContexts(e);this.setState(t.states.DIRTY)};c.createInitialFileContent=function(n){var i=t.createInitialFileContent(n);if(n.contexts){i.contexts=n.contexts}if(n.favorite!==undefined){i.favorite=n.favorite}if(n.executeOnSelection!==undefined){i.executeOnSelection=n.executeOnSelection}return e(i,["changeType","namespace","service","content","reference","fileName","fileType","packageName","layer","favorite","executeOnSelection","selector","texts","support","contexts"])};return c});