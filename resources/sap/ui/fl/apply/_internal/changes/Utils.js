/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/Utils"],function(e,n,t){"use strict";function r(e,n){if(n||e.hasApplyProcessStarted()){return false}return true}var a={getControlIfTemplateAffected:function(e,n,t){var r=t.modifier;var a=e.getDefinition();var o={originalControl:n};var i=a.dependentSelector&&a.dependentSelector.originalSelector;if(e.getContent().boundAggregation&&i){o.control=r.bySelector(i,t.appComponent,t.view);o.controlType=r.getControlType(o.control);o.bTemplateAffected=true}else{o.control=n;o.controlType=r.getControlType(n);o.bTemplateAffected=false}return o},getChangeHandler:function(e,r,a){var o=a.modifier.getLibraryName(r.control);return t.requireAsync("sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerRegistration").then(function(e){return e.waitForChangeHandlerRegistration(o)}).then(function(){var t=e.getChangeType();var o=e.getLayer();return n.getChangeHandler(t,r.controlType,r.control,a.modifier,o)})},checkIfDependencyIsStillValidSync:function(n,a,o,i){var l=t.getChangeFromChangesMap(o.mChanges,i);var c=a.bySelector(l.getSelector(),n);var g=e.sync.hasChangeApplyFinishedCustomData(c,l);return r(l,g)},checkIfDependencyIsStillValid:function(n,a,o,i){var l=t.getChangeFromChangesMap(o.mChanges,i);var c=a.bySelector(l.getSelector(),n);return e.hasChangeApplyFinishedCustomData(c,l,a).then(r.bind(null,l))}};return a});