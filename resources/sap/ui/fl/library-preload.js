//@ui5-bundle sap/ui/fl/library-preload.js
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/Cache",["sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/Utils","sap/base/Log"],function(e,n,t){"use strict";var r=function(){};function a(n,t){var r=e.getFlexObjectsFromStorageResponse(n);if(t.fileType==="variant"){return r.comp.variants}if(t.selector.persistencyKey){return r.comp.changes}return r.changes}function i(e,n){if(!n){return e}return e===r.NOTAG?e.replace(/>$/,"".concat("-",n,">")):e.concat("-",n)}function c(e){return e.replace(/(^W\/|")/g,"")}r.NOTAG="<NoTag>";r.clearEntries=function(){e.clearState()};r.getChangesFillingCache=function(n,t,r){var a=Promise.resolve();if(r){a=e.clearAndInitialize(t)}return a.then(function(){return e.getStorageResponse(n.name)}).catch(function(){return{}})};r.getCacheKey=function(e,a){if(!e||!e.name||!a){t.warning("Not all parameters were passed to determine a flexibility cache key.");return Promise.resolve(r.NOTAG)}return this.getChangesFillingCache(e).then(function(e){if(e&&e.cacheKey){return c(e.cacheKey)}return r.NOTAG}).then(function(e){var t=a.getModel(n.VARIANT_MODEL_NAME);var r=t?t.getCurrentControlVariantIds():[];return i(e,r.join("-"))})};r.addChange=function(e,n){var t=a(e.name,n);if(!t){return}t.push(n)};r.updateChange=function(e,n){var t=a(e.name,n);if(!t){return}for(var r=0;r<t.length;r++){if(t[r].fileName===n.fileName){t.splice(r,1,n);break}}};r.deleteChange=function(e,n){var t=a(e.name,n);if(!t){return}for(var r=0;r<t.length;r++){if(t[r].fileName===n.fileName){t.splice(r,1);break}}};r.removeChanges=function(n,t){var r=e.getFlexObjectsFromStorageResponse(n.name);r.changes=r.changes.filter(function(e){return t.indexOf(e.fileName)===-1});var a=e.getVariantsState(n.name);Object.keys(a).forEach(function(e){a[e].variants.forEach(function(e){e.controlChanges=e.controlChanges.filter(function(e){return t.indexOf(e.getFileName())===-1})})})};return r},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/Change",["sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/registry/Settings","sap/base/Log","sap/ui/fl/apply/_internal/appVariant/DescriptorChangeTypes","sap/ui/fl/apply/_internal/flexObjects/States","sap/base/util/includes"],function(e,t,i,n,o,r,s,a,p,u){"use strict";var f=t.extend("sap.ui.fl.Change",{constructor:function(n){t.apply(this);if(!e.isPlainObject(n)){s.error("Constructor : sap.ui.fl.Change : oFile is not defined")}this._oDefinition=n;this._sRequest="";this._bUserDependent=n.layer===i.USER;this._vRevertData=null;this._aUndoOperations=null;this._oExtensionPointInfo=null;this.setState(f.states.NEW);this._sPreviousState=null;this._oChangeProcessedPromise=null;this.setInitialApplyState();this._oChangeProcessingPromises={}},metadata:{properties:{state:{type:"string"},applyState:{type:"int"}}}});f.states={NEW:p.NEW,PERSISTED:p.PERSISTED,DELETED:p.DELETED,DIRTY:p.DIRTY};f.applyState={INITIAL:0,APPLYING:1,APPLY_FINISHED:2,REVERTING:3,REVERT_FINISHED:4};f.operations={APPLY:0,REVERT:1};f.prototype.setState=function(e){var t=this.getState();if(t!==e&&this._isValidState(e)){this._sPreviousState=t;this.setProperty("state",e)}return this};f.prototype.setQueuedForRevert=function(){if(this._aQueuedProcesses[this._aQueuedProcesses.length-1]!==f.operations.REVERT){this._aQueuedProcesses.unshift(f.operations.REVERT)}};f.prototype.isQueuedForRevert=function(){return this._aQueuedProcesses.indexOf(f.operations.REVERT)>-1};f.prototype.setQueuedForApply=function(){if(this._aQueuedProcesses[this._aQueuedProcesses.length-1]!==f.operations.APPLY){this._aQueuedProcesses.unshift(f.operations.APPLY)}};f.prototype.isQueuedForApply=function(){return this._aQueuedProcesses.indexOf(f.operations.APPLY)>-1};f.prototype.setInitialApplyState=function(){this._aQueuedProcesses=[];delete this._ignoreOnce;this.setApplyState(f.applyState.INITIAL);this._oChangeProcessedPromise={};this._oChangeProcessedPromise.promise=new Promise(function(e){this._oChangeProcessedPromise.resolveFunction={resolve:e}}.bind(this))};f.prototype.isInInitialState=function(){return this._aQueuedProcesses.length===0&&this.getApplyState()===f.applyState.INITIAL};f.prototype.isValidForDependencyMap=function(){return this._oDefinition.selector&&this._oDefinition.selector.id};f.prototype.startApplying=function(){this.setApplyState(f.applyState.APPLYING)};f.prototype.markFinished=function(e){this._aQueuedProcesses.pop();this._resolveChangeProcessingPromiseWithError(f.operations.APPLY,e);this.setApplyState(f.applyState.APPLY_FINISHED)};f.prototype.startReverting=function(){this.setApplyState(f.applyState.REVERTING)};f.prototype.markRevertFinished=function(e){this._aQueuedProcesses.pop();this._resolveChangeProcessingPromiseWithError(f.operations.REVERT,e);this.setApplyState(f.applyState.REVERT_FINISHED)};f.prototype.hasApplyProcessStarted=function(){return this.getApplyState()===f.applyState.APPLYING};f.prototype.isApplyProcessFinished=function(){return this.getApplyState()===f.applyState.APPLY_FINISHED};f.prototype.hasRevertProcessStarted=function(){return this.getApplyState()===f.applyState.REVERTING};f.prototype.isRevertProcessFinished=function(){return this.getApplyState()===f.applyState.REVERT_FINISHED};f.prototype.isCurrentProcessFinished=function(){return this._aQueuedProcesses.length===0&&this.getApplyState()!==f.applyState.INITIAL};f.prototype.addChangeProcessingPromise=function(e){if(!this._oChangeProcessingPromises[e]){this._oChangeProcessingPromises[e]={};this._oChangeProcessingPromises[e].promise=new Promise(function(t){this._oChangeProcessingPromises[e].resolveFunction={resolve:t}}.bind(this))}return this._oChangeProcessingPromises[e].promise};f.prototype.addChangeProcessingPromises=function(){var e=[];if(this.getApplyState()===f.applyState.INITIAL&&this._oChangeProcessedPromise){e.push(this._oChangeProcessedPromise.promise)}this._aQueuedProcesses.forEach(function(t){e.push(this.addChangeProcessingPromise(t))},this);return e};f.prototype.addPromiseForApplyProcessing=function(){return this.addChangeProcessingPromise(f.operations.APPLY)};f.prototype._resolveChangeProcessingPromiseWithError=function(e,t){if(this._oChangeProcessingPromises[e]){this._oChangeProcessingPromises[e].resolveFunction.resolve(t);delete this._oChangeProcessingPromises[e]}if(this._oChangeProcessedPromise){this._oChangeProcessedPromise.resolveFunction.resolve(t);this._oChangeProcessedPromise=null}};f.prototype._isValidState=function(e){var t=false;Object.keys(f.states).some(function(i){if(f.states[i]===e){t=true}return t});if(!t){return false}if(this.getState()===f.states.NEW&&e===f.states.DIRTY){return false}return true};f.prototype.isValid=function(){var e=true;if(typeof this._oDefinition!=="object"){e=false}if(!this._oDefinition.fileType){e=false}if(!this._oDefinition.fileName){e=false}if(!this._oDefinition.changeType){e=false}if(!this._oDefinition.layer){e=false}if(!this._oDefinition.originalLanguage){e=false}return e};f.prototype.isVariant=function(){return this._oDefinition.fileType==="variant"};f.prototype.getChangeType=function(){if(this._oDefinition){return this._oDefinition.changeType}};f.prototype.getFileName=function(){if(this._oDefinition){return this._oDefinition.fileName}};f.prototype.getFileType=function(){if(this._oDefinition){return this._oDefinition.fileType}};f.prototype.getOriginalLanguage=function(){if(this._oDefinition&&this._oDefinition.originalLanguage){return this._oDefinition.originalLanguage}return""};f.prototype.getPackage=function(){return this._oDefinition.packageName};f.prototype.setPackage=function(e){if(typeof e!=="string"){s.error("sap.ui.fl.Change.setPackage : sPackage is not defined")}this._oDefinition.packageName=e};f.prototype.getNamespace=function(){return this._oDefinition.namespace};f.prototype.setNamespace=function(e){this._oDefinition.namespace=e};f.prototype.getModuleName=function(){return this._oDefinition.moduleName};f.prototype.setModuleName=function(e){this._oDefinition.moduleName=e};f.prototype.getProjectId=function(){return this._oDefinition.projectId};f.prototype.setProjectId=function(e){this._oDefinition.projectId=e};f.prototype.getId=function(){return this._oDefinition.fileName};f.prototype.getContent=function(){return this._oDefinition.content};f.prototype.setContent=function(e){this._oDefinition.content=e;this.setState(f.states.DIRTY)};f.prototype.getVariantReference=function(){return this._oDefinition.variantReference||""};f.prototype.setVariantReference=function(e){this._oDefinition.variantReference=e;this.setState(f.states.DIRTY)};f.prototype.getSelector=function(){return this._oDefinition.selector};f.prototype.setSelector=function(e){this._oDefinition.selector=e};f.prototype.getSourceSystem=function(){return this._oDefinition.sourceSystem};f.prototype.getSourceClient=function(){return this._oDefinition.sourceClient};f.prototype.getOwnerId=function(){return this._oDefinition.support?this._oDefinition.support.user:""};f.prototype.getText=function(e){if(typeof e!=="string"){s.error("sap.ui.fl.Change.getTexts : sTextId is not defined")}if(this._oDefinition.texts){if(this._oDefinition.texts[e]){return this._oDefinition.texts[e].value}}return""};f.prototype.getTexts=function(){return this._oDefinition.texts};f.prototype.setText=function(e,t){if(typeof e!=="string"){s.error("sap.ui.fl.Change.setTexts : sTextId is not defined");return}if(this._oDefinition.texts){if(this._oDefinition.texts[e]){this._oDefinition.texts[e].value=t;this.setState(f.states.DIRTY)}}};f.prototype.isReadOnly=function(){return this._isReadOnlyDueToLayer()||this._isReadOnlyWhenNotKeyUser()||this.isChangeFromOtherSystem()};f.prototype._isReadOnlyWhenNotKeyUser=function(){if(this.isUserDependent()){return false}var e=this.getDefinition().reference;if(!e){return true}var t=r.getInstanceOrUndef();if(!t){return true}return!t.isKeyUser()};f.prototype.isLabelReadOnly=function(){if(this._isReadOnlyDueToLayer()){return true}return this._isReadOnlyDueToOriginalLanguage()};f.prototype._isReadOnlyDueToLayer=function(){var e;e=this._bUserDependent?i.USER:o.getCurrentLayer();return this._oDefinition.layer!==e};f.prototype.isChangeFromOtherSystem=function(){var e=this.getSourceSystem();var t=this.getSourceClient();if(!e||!t){return false}var i=r.getInstanceOrUndef();if(!i){return true}var n=i.getSystem();var o=i.getClient();if(!n||!o){return false}return e!==n||t!==o};f.prototype._isReadOnlyDueToOriginalLanguage=function(){var e;var t;t=this.getOriginalLanguage();if(!t){return false}e=n.getCurrentLanguage();return e!==t};f.prototype.markForDeletion=function(){this.setState(f.states.DELETED)};f.prototype.restorePreviousState=function(){if(this._sPreviousState){this.setState(this._sPreviousState);delete this._sPreviousState}};f.prototype.setRequest=function(e){if(typeof e!=="string"){s.error("sap.ui.fl.Change.setRequest : sRequest is not defined")}this._sRequest=e};f.prototype.getRequest=function(){return this._sRequest};f.prototype.getLayer=function(){return this._oDefinition.layer};f.prototype.getComponent=function(){return this._oDefinition.reference};f.prototype.setComponent=function(e){this._oDefinition.reference=e};f.prototype.getCreation=function(){return this._oDefinition.creation};f.prototype.isUserDependent=function(){return this._bUserDependent};f.prototype.getDefinition=function(){return this._oDefinition};f.prototype.setResponse=function(e){var t=JSON.stringify(e);if(t){this._oDefinition=JSON.parse(t);this.setState(f.states.PERSISTED)}};f.prototype.getFullFileIdentifier=function(){var e=this.getLayer();var t=this.getNamespace();var i=this.getDefinition().fileName;var n=this.getDefinition().fileType;return e+"/"+t+"/"+i+"."+n};f.prototype.addDependentControl=function(e,t,i,n){if(!e){throw new Error("Parameter vControl is mandatory")}if(!t){throw new Error("Parameter sAlias is mandatory")}if(!i){throw new Error("Parameter mPropertyBag is mandatory")}if(!this._oDefinition.dependentSelector){this._oDefinition.dependentSelector={}}if(this._oDefinition.dependentSelector[t]){throw new Error("Alias '"+t+"' already exists in the change.")}var o=i.modifier;var r=i.appComponent;if(Array.isArray(e)){var s=[];e.forEach(function(e){s.push(o.getSelector(e,r,n))});this._oDefinition.dependentSelector[t]=s}else{this._oDefinition.dependentSelector[t]=o.getSelector(e,r,n)}delete this._aDependentSelectorList};f.prototype.getDependentControl=function(e,t){var i=[];var n;if(!e){throw new Error("Parameter sAlias is mandatory")}if(!t){throw new Error("Parameter mPropertyBag is mandatory")}var o=t.modifier;var r=t.appComponent;if(!this._oDefinition.dependentSelector){return undefined}n=this._oDefinition.dependentSelector[e];if(Array.isArray(n)){n.forEach(function(e){i.push(o.bySelector(e,r,t.view))});return i}return o.bySelector(n,r,t.view)};f.prototype.getOriginalSelector=function(){return this.getDefinition().dependentSelector&&this.getDefinition().dependentSelector.originalSelector};f.prototype.getDependentSelectorList=function(){var e=this;var t=[this.getSelector()];if(!this._aDependentSelectorList){if(this._oDefinition.dependentSelector){Object.keys(this._oDefinition.dependentSelector).some(function(i){if(i==="originalSelector"){t=[this.getSelector()];return true}var o=e._oDefinition.dependentSelector[i];if(!Array.isArray(o)){o=[o]}o.forEach(function(e){if(e&&n.indexOfObject(t,e)===-1){t.push(e)}})}.bind(this))}this._aDependentSelectorList=t}return this._aDependentSelectorList};f.prototype.getDependentControlSelectorList=function(){var e=this.getDependentSelectorList().concat();if(e.length>0){var t=this.getSelector();var i=n.indexOfObject(e,t);if(i>-1){e.splice(i,1)}}return e};f.prototype.getRevertData=function(){return this._vRevertData};f.prototype.hasRevertData=function(){return this._vRevertData!==null};f.prototype.setRevertData=function(e){if(e===undefined){throw new Error("Change cannot be applied in XML as revert data is not available yet. Retrying in JS.")}this._vRevertData=e};f.prototype.resetRevertData=function(){this.setRevertData(null)};f.prototype.getUndoOperations=function(){return this._aUndoOperations};f.prototype.setUndoOperations=function(e){this._aUndoOperations=e};f.prototype.getExtensionPointInfo=function(){return this._oExtensionPointInfo};f.prototype.setExtensionPointInfo=function(e){this._oExtensionPointInfo=e};f.prototype.resetUndoOperations=function(){this.setUndoOperations(null)};f.createInitialFileContent=function(e){if(!e){e={}}var t;if(e.fileType){t=e.fileType}else{t=e.isVariant?"variant":"change"}var r={fileName:e.id||n.createDefaultFileName(e.changeType),fileType:t,changeType:e.changeType||"",moduleName:e.moduleName||"",reference:e.reference||"",packageName:e.packageName||"",content:e.content||{},selector:e.selector||{id:""},layer:e.layer||(e.isUserDependent?i.USER:o.getCurrentLayer()),texts:e.texts||{},namespace:e.namespace||n.createNamespace(e,t),projectId:e.projectId||e.reference&&e.reference.replace(".Component","")||"",creation:"",originalLanguage:n.getCurrentLanguage(),support:{generator:e.generator||"Change.createInitialFileContent",service:e.service||"",user:"",sapui5Version:sap.ui.version,sourceChangeFileName:e.support&&e.support.sourceChangeFileName||"",compositeCommand:e.support&&e.support.compositeCommand||"",command:e.command||""},oDataInformation:e.oDataInformation||{},dependentSelector:e.dependentSelector||{},jsOnly:e.jsOnly||false,variantReference:e.variantReference||"",appDescriptorChange:u(a.getChangeTypes(),e.changeType)};return r};return f},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/ChangePersistence",["sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/Variant","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/Cache","sap/ui/fl/registry/Settings","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/write/_internal/Storage","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Component","sap/ui/model/json/JSONModel","sap/ui/performance/Measurement","sap/base/util/includes","sap/base/util/merge","sap/base/util/restricted/_union","sap/base/util/UriParameters","sap/base/Log","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/write/_internal/condenser/Condenser"],function(e,t,n,r,a,i,s,o,h,g,p,c,l,f,u,d,C,m,y,_,v,D,S){"use strict";var b=function(t){this._mComponent=t;this._mChanges=e.createEmptyDependencyMap();this._bChangesMapCreated=false;this._mChangesInitial=C({},this._mChanges);if(!this._mComponent||!this._mComponent.name){_.error("The Control does not belong to an SAPUI5 component. Personalization and changes for this control might not work as expected.");throw new Error("Missing component name.")}this._aDirtyChanges=[];this._oMessagebundle=undefined;this._mChangesEntries={};this._bHasChangesOverMaxLayer=false;this.HIGHER_LAYER_CHANGES_EXIST="higher_layer_changes_exist"};function I(e,t){var r;if(t instanceof n){r=t;this._mChangesEntries[r.getFileName()]=r}else{if(!this._mChangesEntries[t.fileName]){this._mChangesEntries[t.fileName]=new n(t)}r=this._mChangesEntries[t.fileName];r.setState(n.states.PERSISTED)}return r}b.prototype.getComponentName=function(){return this._mComponent.name};b.prototype.getCacheKey=function(e){return o.getCacheKey(this._mComponent,e)};b.prototype._preconditionsFulfilled=function(e){var t=e instanceof n?e.getDefinition():e;function r(){if(t.fileType==="ctrl_variant"||t.fileType==="ctrl_variant_change"||t.fileType==="ctrl_variant_management_change"){return t.variantManagementReference||t.variantReference||t.selector&&t.selector.id}}return t.fileType==="change"||r()};b.prototype.getChangesForComponent=function(e,n){return i.getUShellService("URLParsing").then(function(t){this._oUShellURLParsingService=t;return o.getChangesFillingCache(this._mComponent,e,n)}.bind(this)).then(function(e,n){var a=C({},n);var o=e&&e.component&&i.getAppComponentForControl(e.component);var h=t.isStorageResponseFilled(a.changes);if(!h){return[]}var g=a.changes.changes;if(!this._oMessagebundle&&a.messagebundle&&o){if(!o.getModel("i18nFlexVendor")){if(g.some(function(e){return e.layer===r.VENDOR})){this._oMessagebundle=a.messagebundle;var p=new f(this._oMessagebundle);o.setModel(p,"i18nFlexVendor")}}}var c=e&&e.currentLayer;var l=!(e&&e.ignoreMaxLayerParameter);var u=function(){return true};if(c){g=s.filterChangeOrChangeDefinitionsByCurrentLayer(g,c)}else if(s.isLayerFilteringRequired(this._oUShellURLParsingService)&&l){u=this._filterChangeForMaxLayer.bind(this);g=g.filter(u)}else if(this._bHasChangesOverMaxLayer&&!l){this._bHasChangesOverMaxLayer=false;return this.HIGHER_LAYER_CHANGES_EXIST}var d=a.changes&&e&&e.includeCtrlVariants;var m=this._getAllCtrlVariantChanges(a,d,u);g=g.concat(m);return this._checkAndGetChangeInstances(g,a)}.bind(this,e))};b.prototype._checkAndGetChangeInstances=function(e,t){return e.filter(this._preconditionsFulfilled).map(I.bind(this,t))};b.prototype._filterChangeForMaxLayer=function(e){if(s.isOverMaxLayer(this._getLayerFromChangeOrChangeContent(e),this._oUShellURLParsingService)){if(!this._bHasChangesOverMaxLayer){this._bHasChangesOverMaxLayer=true}return false}return true};b.prototype._getLayerFromChangeOrChangeContent=function(e){var t;if(e instanceof a||e instanceof n){t=e.getLayer()}else{t=e.layer}return t};b.prototype._getAllCtrlVariantChanges=function(e,t,n){if(!t){return v.getInitialChanges({reference:this._mComponent.name})}return["variants","variantChanges","variantDependentControlChanges","variantManagementChanges"].reduce(function(t,n){if(e.changes[n]){return t.concat(e.changes[n])}return t},[]).filter(n)};b.prototype.loadChangesMapForComponent=function(t){return this.getChangesForComponent({component:t}).then(n.bind(this));function n(n){u.start("fl.createDependencyMap","Measurement of creating initial dependency map");this._mChanges=e.createEmptyDependencyMap();n.forEach(this.addChangeAndUpdateDependencies.bind(this,t));this._mChangesInitial=C({},this._mChanges);u.end("fl.createDependencyMap","Measurement of creating initial dependency map");this._bChangesMapCreated=true;return this.getChangesMapForComponent.bind(this)}};b.prototype.checkForOpenDependenciesForControl=function(t,n){return e.checkForOpenDependenciesForControl(this._mChanges,c.getControlIdBySelector(t,n),n)};function M(e){var t=C({},this._mChangesInitial.mDependencies);return t[e.getId()]}function E(e,t,n,r){var a;var i=[];e.controlsDependencies.forEach(function(e){if(!c.bySelector(e,n)){a=c.getControlIdBySelector(e,n);i.push(e);this._mChanges.mControlsWithDependencies[a]=this._mChanges.mControlsWithDependencies[a]||[];if(!d(this._mChanges.mControlsWithDependencies[a],r.getId())){this._mChanges.mControlsWithDependencies[a].push(r.getId())}}}.bind(this));e.dependencies=t;e.controlsDependencies=i;if(t.length||i.length){this._mChanges.mDependencies[r.getId()]=e}}b.prototype.copyDependenciesFromInitialChangesMapSync=function(e,t,n){var r=M.call(this,e);if(r){var a=[];r.dependencies.forEach(function(n){if(t(n)){this._mChanges.mDependentChangesOnMe[n]=this._mChanges.mDependentChangesOnMe[n]||[];this._mChanges.mDependentChangesOnMe[n].push(e.getId());a.push(n)}}.bind(this));E.call(this,r,a,n,e)}return this._mChanges};b.prototype.copyDependenciesFromInitialChangesMap=function(e,t,n){var r=M.call(this,e);if(r){var a=[];return r.dependencies.reduce(function(n,r){return n.then(function(){return t(r)}).then(function(t){if(t){this._mChanges.mDependentChangesOnMe[r]=this._mChanges.mDependentChangesOnMe[r]||[];this._mChanges.mDependentChangesOnMe[r].push(e.getId());a.push(r)}}.bind(this))}.bind(this),Promise.resolve()).then(function(){E.call(this,r,a,n,e);return this._mChanges}.bind(this))}return Promise.resolve(this._mChanges)};b.prototype.addChangeAndUpdateDependencies=function(t,n,r){n.setInitialApplyState();if(r){e.insertChange(n,this._mChanges,r)}e.addChangeAndUpdateDependencies(n,t,this._mChanges)};b.prototype._addRunTimeCreatedChangeAndUpdateDependencies=function(t,n){e.addRuntimeChangeAndUpdateDependencies(n,t,this._mChanges,this._mChangesInitial)};b.prototype.getChangesMapForComponent=function(){return this._mChanges};b.prototype.getAllUIChanges=function(e){var t=m(this.getChangesMapForComponent().aChanges,e.includeDirtyChanges&&this.getDirtyChanges()).filter(function(t){return Boolean(t)&&t.getFileType()==="change"&&s.compareAgainstCurrentLayer(t.getLayer(),e.layer)===0});return t};b.prototype.isChangeMapCreated=function(){return this._bChangesMapCreated};b.prototype.changesHavingCorrectViewPrefix=function(e,t){var n=e.modifier;var r=e.appComponent;var a=t.getSelector();if(!a||!e){return false}if(a.viewSelector){var i=n.getControlIdBySelector(a.viewSelector,r);return i===e.viewId}var s=a.id;if(s){var o;if(t.getSelector().idIsLocal){if(r){o=r.getLocalId(e.viewId)}}else{o=e.viewId}var h=0;var g;do{h=s.indexOf("--",h);g=s.slice(0,h);h++}while(g!==o&&h>0);return g===o}return false};b.prototype.getChangesForView=function(e){return this.getChangesForComponent(e).then(function(t){return t.filter(this.changesHavingCorrectViewPrefix.bind(this,e))}.bind(this))};b.prototype.addChange=function(e,t){var n=this.addDirtyChange(e);this._addRunTimeCreatedChangeAndUpdateDependencies(t,n);this._mChangesEntries[n.getFileName()]=n;this._addPropagationListener(t);return n};b.prototype.addDirtyChange=function(e){var t;if(e instanceof n||e instanceof a){t=e}else{t=new n(e)}if(this._aDirtyChanges.indexOf(t)===-1){this._aDirtyChanges.push(t)}return t};b.prototype._addPropagationListener=function(e){var t=i.getAppComponentForControl(e);if(t instanceof l){var n=function(e){return!e._bIsSapUiFlFlexControllerApplyChangesOnControl};var r=t.getPropagationListeners().every(n);if(r){var a=sap.ui.require("sap/ui/fl/FlexControllerFactory");var s=a.create(this.getComponentName());var o=g.applyAllChangesForControl.bind(g,this.getChangesMapForComponent.bind(this),t,s);o._bIsSapUiFlFlexControllerApplyChangesOnControl=true;t.addPropagationListener(o)}}};b.prototype._deleteNotSavedChanges=function(e,t,n){e.filter(function(e){return!t.some(function(t){return e.getId()===t.getId()})}).forEach(function(e){if(n){this.removeChange(e);o.deleteChange(this._mComponent,e.getDefinition())}else{this.deleteChange(e)}}.bind(this))};function L(e,t){var n=e.map(function(e){return e[t]()});var r=n.filter(function(e,t,n){return n.indexOf(e)===t});return r.length===1}function F(e,t){var n=false;if(!e||t.length<2){return false}if(!L(t,"getLayer")){return false}var r=t[0].getLayer();if(r==="CUSTOMER"||r==="USER"){n=true}var a=y.fromURL(window.location.href);if(a.has("sap-ui-xx-condense-changes")){n=a.get("sap-ui-xx-condense-changes")==="true"}return n}function x(e){var t=h.getInstanceOrUndef()&&h.getInstanceOrUndef().isCondensingEnabled();if(t&&!L(e,"getNamespace")){t=false}return t}function O(e,t,n,r){this._massUpdateCacheAndDirtyState(t,n);this._deleteNotSavedChanges(e,t,r)}function A(e){if(!e.length){return[]}var t=e[0].getLayer();var r=this._mChanges.aChanges.filter(function(e){return e.getState()===n.states.PERSISTED&&s.compareAgainstCurrentLayer(e.getLayer(),t)===0});return r.concat(e)}b.prototype.saveDirtyChanges=function(e,t,r,a){var i=r||this._aDirtyChanges;var s=A.call(this,i);var o=x(s)&&F(e,s);var h=o?s:i;var g=h.slice(0);var c=i.slice(0);var l=this._getRequests(i);var f=this._getStates(i);if(f.length===1&&l.length===1&&f[0]===n.states.NEW){var u=Promise.resolve(g);if(F(e,g)){u=S.condense(e,g)}return u.then(function(e){var n=l[0];var r=i[0].getDefinition().layer;if(o){return p.condense({allChanges:h,condensedChanges:e,layer:r,transport:n,isLegacyVariant:false,parentVersion:a}).then(function(n){O.call(this,h,e,t,true);return n}.bind(this))}if(e.length){return p.write({layer:r,flexObjects:this._prepareDirtyChanges(e),transport:n,isLegacyVariant:false,parentVersion:a}).then(function(n){O.call(this,h,e,t);return n}.bind(this))}this._deleteNotSavedChanges(h,e)}.bind(this))}return this.saveSequenceOfDirtyChanges(c,t,a)};b.prototype.saveSequenceOfDirtyChanges=function(e,t,r){var a;if(r){var i=e.filter(function(e){return e.getState()===n.states.NEW});a=[].concat(i).shift()}return e.reduce(function(e,n){return e.then(this._performSingleSaveAction(n,a,r)).then(this._updateCacheAndDirtyState.bind(this,n,t))}.bind(this),Promise.resolve())};b.prototype._performSingleSaveAction=function(e,t,r){return function(){switch(e.getState()){case n.states.NEW:if(r!==undefined){r=e===t?r:sap.ui.fl.Versions.Draft}return p.write({layer:e.getLayer(),flexObjects:[e.getDefinition()],transport:e.getRequest(),parentVersion:r});case n.states.DELETED:return p.remove({flexObject:e.getDefinition(),layer:e.getLayer(),transport:e.getRequest()})}}};b.prototype._updateCacheAndDirtyState=function(e,t){if(!t){if(i.isChangeRelatedToVariants(e)){v.updateVariantsState({reference:this._mComponent.name,changeToBeAddedOrDeleted:e})}else{switch(e.getState()){case n.states.NEW:e.setState(n.states.PERSISTED);o.addChange(this._mComponent,e.getDefinition());break;case n.states.DELETED:o.deleteChange(this._mComponent,e.getDefinition());break;case n.states.DIRTY:e.setState(n.states.PERSISTED);o.updateChange(this._mComponent,e.getDefinition());break}}}this._aDirtyChanges=this._aDirtyChanges.filter(function(t){return e.getId()!==t.getId()})};b.prototype._massUpdateCacheAndDirtyState=function(e,t){e.forEach(function(e){this._updateCacheAndDirtyState(e,t)},this)};b.prototype._getRequests=function(e){var t=[];e.forEach(function(e){var n=e.getRequest();if(t.indexOf(n)===-1){t.push(n)}});return t};b.prototype._getStates=function(e){var t=[];e.forEach(function(e){var n=e.getState();if(t.indexOf(n)===-1){t.push(n)}});return t};b.prototype._prepareDirtyChanges=function(e){var t=[];e.forEach(function(e){t.push(e.getDefinition())});return t};b.prototype.getDirtyChanges=function(){return this._aDirtyChanges};b.prototype.deleteChange=function(e,t){var r=this._aDirtyChanges.indexOf(e);if(r>-1){if(e.getState()===n.states.DELETED){return}this._aDirtyChanges.splice(r,1);this._deleteChangeInMap(e,t);return}e.markForDeletion();this.addDirtyChange(e);this._deleteChangeInMap(e,t)};b.prototype.removeChange=function(e){var t=this._aDirtyChanges.indexOf(e);if(t>-1){this._aDirtyChanges.splice(t,1)}this._deleteChangeInMap(e)};b.prototype._deleteChangeInMap=function(t,n){var r=t.getId();e.removeChangeFromMap(this._mChanges,r);e.removeChangeFromDependencies(n?this._mChangesInitial:this._mChanges,r)};function R(e,t){return(t.getRequest()==="$TMP"||t.getRequest()==="")&&t.getLayer()===e}b.prototype.transportAllUIChanges=function(e,t,n,r){return Promise.all([this.getChangesForComponent({currentLayer:n,includeCtrlVariants:true}),D.getCompVariantsMap(this.getComponentName())]).then(function(a){var i=a[0];var s=a[1];var o=[];for(var h in s){for(var g in s[h].byId){o.push(s[h].byId[g])}}i=i.concat(o.filter(R.bind(this,n)));return p.publish({transportDialogSettings:{rootControl:e,styleClass:t},layer:n,reference:this.getComponentName(),localChanges:i,appVariantDescriptors:r})}.bind(this))};b.prototype._getChangesFromMapByNames=function(e){return this._mChanges.aChanges.filter(function(t){return e.indexOf(t.getFileName())!==-1})};b.prototype.removeDirtyChanges=function(e,t,n,r,a){if(!n){_.error("The selectorId must be provided");return Promise.reject("The selectorId must be provided")}var i=this._aDirtyChanges;var s=i.filter(function(i){var s=true;if(i.getLayer()!==e){return false}if(r&&i.getDefinition().support.generator!==r){return false}var o=i.getSelector();s=n.getId()===c.getControlIdBySelector(o,t);if(a){s=s&&a.indexOf(i.getChangeType())!==-1}return s});s.forEach(function(e){var t=i.indexOf(e);i.splice(t,1)});return Promise.resolve(s)};b.prototype.resetChanges=function(e,t,n,r){var a=n&&n.length>0;var i=r&&r.length>0;return this.getChangesForComponent({currentLayer:e,includeCtrlVariants:true}).then(function(s){var o={reference:this.getComponentName(),layer:e,changes:s};if(t){o.generator=t}if(a){o.selectorIds=n}if(i){o.changeTypes=r}return p.reset(o)}.bind(this)).then(function(e){var t=[];if(n||r){var a=[];if(e&&e.response&&e.response.length>0){e.response.forEach(function(e){a.push(e.fileName)})}o.removeChanges(this._mComponent,a);t=this._getChangesFromMapByNames(a)}return t}.bind(this))};b.prototype.getResetAndPublishInfo=function(e){return p.getFlexInfo(e)};return b});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/ChangePersistenceFactory",["sap/ui/core/Component","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/ChangePersistence","sap/ui/fl/Utils","sap/ui/fl/apply/_internal/changes/descriptor/ApplyStrategyFactory","sap/ui/fl/apply/_internal/changes/descriptor/Applier"],function(n,e,t,a,i,o){"use strict";var s={};s._instanceCache={};s.getChangePersistenceForComponent=function(n){var e=s._instanceCache[n];if(!e){var a={name:n};e=new t(a);s._instanceCache[n]=e}return e};s.getChangePersistenceForControl=function(n){var e;e=a.getComponentClassName(n);return s.getChangePersistenceForComponent(e)};s.registerLoadComponentEventHandler=function(){n._fnLoadComponentCallback=this._onLoadComponent.bind(this)};s._onLoadComponent=function(n,t){if(!a.isApplication(t)||!n.id){return Promise.resolve()}e.initialize({componentData:n.componentData||n.settings&&n.settings.componentData,asyncHints:n.asyncHints,manifest:t,componentId:n.id});return o.applyChangesIncludedInManifest(t,i.getRuntimeStrategy())};return s},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/EventHistory",function(){"use strict";var e=function(){};e._aEventIds=["ControlForPersonalizationRendered"];e._aUnsubscribedEventIds=[];e._oHistory={};e.start=function(){e._aEventIds.forEach(function(n){if(e._aUnsubscribedEventIds.indexOf(n)===-1){sap.ui.getCore().getEventBus().subscribe("sap.ui",n,e.saveEvent);e._oHistory[n]=[]}})};e.saveEvent=function(n,t,s){var r={channelId:n,eventId:t,parameters:s.getId()};if(e._oHistory[t]){var i=e._oHistory[t].some(function(e){return e.channelId===r.channelId&&e.eventId===r.eventId&&e.parameters===r.parameters});if(!i){e._oHistory[t].push(r)}}};e.getHistoryAndStop=function(n){sap.ui.getCore().getEventBus().unsubscribe("sap.ui",n,e.saveEvent);e._addUnsubscribedEvent(n);return e._oHistory[n]||[]};e._addUnsubscribedEvent=function(n){if(e._aUnsubscribedEventIds.indexOf(n)===-1){e._aUnsubscribedEventIds.push(n)}};return e},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/FlexController",["sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/Utils","sap/ui/fl/Layer","sap/ui/fl/Change","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/write/_internal/Versions","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/util/reflection/XmlTreeModifier","sap/ui/core/Component","sap/base/Log"],function(e,n,t,r,o,i,a,s,h,p,c,l,u){"use strict";function g(e,t){return Promise.resolve().then(function(){if(t.length!==0){t.reverse();return s.revertMultipleChanges(t,{appComponent:e,modifier:p,flexController:this})}}.bind(this)).then(function(){if(e){var r=e.getModel(n.VARIANT_MODEL_NAME);if(r){t.forEach(function(e){var n=e.getVariantReference();if(n){r.removeChange(e)}});h.update({parameters:[],updateURL:true,updateHashEntry:true,model:r})}}return t})}var f=function(e){this._oChangePersistence=undefined;this._sComponentName=e||"";if(this._sComponentName){this._createChangePersistence()}};f.prototype.getComponentName=function(){return this._sComponentName};f.prototype.setVariantSwitchPromise=function(e){this._oVariantSwitchPromise=e};f.prototype.waitForVariantSwitch=function(){if(!this._oVariantSwitchPromise){this._oVariantSwitchPromise=Promise.resolve()}return this._oVariantSwitchPromise};f.prototype.createBaseChange=function(e,n){var t;var o;if(!n){throw new Error("No application component found. To offer flexibility a valid relation to its owning component must be present.")}e.reference=this.getComponentName();e.packageName="$TMP";t=r.createInitialFileContent(e);o=new r(t);if(e.variantReference){o.setVariantReference(e.variantReference)}return o};f.prototype._createChange=function(e,t,r){var o=r&&(r.controlType||n.getControlType(r));var i=this.createBaseChange(e,t);return this._getChangeHandler(i,o,r,p).then(function(o){if(o){return o.completeChangeContent(i,e,{modifier:p,appComponent:t,view:n.getViewForControl(r)})}throw new Error("Change handler could not be retrieved for change "+JSON.stringify(e)+".")}).then(function(){return i}).catch(function(e){return Promise.reject(e)})};f.prototype.createChangeWithExtensionPointSelector=function(e,t){return Promise.resolve().then(function(){if(!t){throw new Error("A flexibility change on extension point cannot be created without a valid extension point reference.")}var r=t.view;var o=n.getAppComponentForControl(r);e.selector={name:t.name,viewSelector:p.getSelector(r.getId(),o)};return o}).then(function(n){return this._createChange(e,n)}.bind(this))};f.prototype.createChangeWithControlSelector=function(e,t){var r;return(new n.FakePromise).then(function(){if(!t){throw new Error("A flexibility change cannot be created without a targeted control.")}var o=t.id||t.getId();if(!e.selector){e.selector={}}r=t.appComponent||n.getAppComponentForControl(t);if(!r){throw new Error("No application component found. To offer flexibility, the control with the ID '"+o+"' has to have a valid relation to its owning application component.")}Object.assign(e.selector,p.getSelector(o,r));return r}).then(function(n){return this._createChange(e,n,t)}.bind(this))};f.prototype.addChange=function(e,t){return this.createChangeWithControlSelector(e,t).then(function(e){var r=n.getAppComponentForControl(t);e._ignoreOnce=true;this.addPreparedChange(e,r);e.setQueuedForApply();return e}.bind(this))};f.prototype.addPreparedChange=function(e,t){if(e.getVariantReference()){var r=t.getModel(n.VARIANT_MODEL_NAME);r.addChange(e)}this._oChangePersistence.addChange(e,t);return e};f.prototype.deleteChange=function(e,t){this._oChangePersistence.deleteChange(e);if(e.getVariantReference()){t.getModel(n.VARIANT_MODEL_NAME).removeChange(e)}};f.prototype.applyChange=function(e,t){var r={modifier:p,appComponent:n.getAppComponentForControl(t),view:n.getViewForControl(t)};return a.applyChangeOnControl(e,t,r).then(function(n){if(!n.success){var t=n.error||new Error("The change could not be applied.");this._oChangePersistence.deleteChange(e,true);throw t}return e}.bind(this))};function C(e,t,r,o,i){var a=d(e,o);if(!a){return[]}i.push(e);var s=e.getId();var h=t[s]&&t[s].dependencies||[];for(var p=0,c=h.length;p<c;p++){var l=n.getChangeFromChangesMap(r,h[p]);a=C(l,t,r,o,i);if(a.length===0){i=[];break}delete t[s]}return i}function d(e,n){var t=e.getDependentControlSelectorList();t.push(e.getSelector());return!t.some(function(e){return!p.bySelector(e,n)})}f.prototype.waitForChangesToBeApplied=function(e){var n=e.map(function(e){return this._waitForChangesToBeApplied(e)}.bind(this));return Promise.all(n).then(function(){return undefined})};f.prototype._waitForChangesToBeApplied=function(e){function t(n){return!n.isCurrentProcessFinished()&&(e.changeTypes.length===0||e.changeTypes.includes(n.getChangeType()))}e.changeTypes=e.changeTypes||[];var r=e.selector.id&&sap.ui.getCore().byId(e.selector.id)||e.selector;var o=this._oChangePersistence.getChangesMapForComponent();var i=[];var a=Object.assign({},o.mDependencies);var s=o.mChanges;var h=s[r.getId()]||[];var p=h.filter(t);var c=e.selector.appComponent||n.getAppComponentForControl(r);var l=[];p.forEach(function(e){var n=C(e,a,o.mChanges,c,[]);n.forEach(function(e){if(l.indexOf(e)===-1){l.push(e)}})});l.forEach(function(e){i=i.concat(e.addChangeProcessingPromises())},this);i.push(this.waitForVariantSwitch());return Promise.all(i)};f.prototype.saveAll=function(e,r,o){var a=o?i.getVersionsModel({reference:n.normalizeReference(this._sComponentName),layer:t.CUSTOMER}).getProperty("/persistedVersion"):undefined;return this._oChangePersistence.saveDirtyChanges(e,r,undefined,a).then(function(e){if(o&&e&&e.response){var n=e.response;if(Array.isArray(n)){n=n[0]}i.onAllChangesSaved({reference:n.reference,layer:n.layer})}return e})};f.prototype.processXmlView=function(e,t){var r=l.get(t.componentId);var o=n.getAppComponentForControl(r);t.appComponent=o;t.modifier=c;t.view=e;return this._oChangePersistence.getChangesForView(t).then(a.applyAllChangesForXMLView.bind(a,t)).catch(this._handlePromiseChainError.bind(this,t.view))};f.prototype._handlePromiseChainError=function(e,n){u.error("Error processing view "+n+".");return e};f.prototype._getChangeHandler=function(n,t,r,o){var i=n.getChangeType();var a=n.getLayer();return e.getChangeHandler(i,t,r,o,a)};f.prototype.getComponentChanges=function(e,n){return this._oChangePersistence.getChangesForComponent(e,n)};f.prototype.checkForOpenDependenciesForControl=function(e,n){return this._oChangePersistence.checkForOpenDependenciesForControl(e,n)};f.prototype._createChangePersistence=function(){this._oChangePersistence=o.getChangePersistenceForComponent(this.getComponentName());return this._oChangePersistence};f.prototype.resetChanges=function(e,n,t,r,o){return this._oChangePersistence.resetChanges(e,n,r,o).then(g.bind(this,t))};f.prototype.removeDirtyChanges=function(e,n,t,r,o){return this._oChangePersistence.removeDirtyChanges(e,n,t,r,o).then(g.bind(this,n))};f.prototype.applyVariantChanges=function(e,t){var r;return e.reduce(function(e,n){return e.then(function(){var e={modifier:p,appComponent:t};this._oChangePersistence._addRunTimeCreatedChangeAndUpdateDependencies(t,n);r=e.modifier.bySelector(n.getSelector(),t);if(r){return a.applyChangeOnControl(n,r,e)}u.error("A flexibility change tries to change a nonexistent control.")}.bind(this))}.bind(this),new n.FakePromise)};f.prototype.saveSequenceOfDirtyChanges=function(e,n){return this._oChangePersistence.saveDirtyChanges(n,false,e)};f.prototype.getResetAndPublishInfo=function(e){e.reference=this._sComponentName;return this._oChangePersistence.getResetAndPublishInfo(e)};return f},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/FlexControllerFactory",["sap/ui/fl/FlexController","sap/ui/fl/Utils","sap/ui/fl/Layer","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/variants/VariantModel","sap/base/Log","sap/ui/performance/Measurement"],function(e,n,t,r,o,a,i,s){"use strict";var l={};l._instanceCache={};l._componentInstantiationPromises=new WeakMap;l.create=function(n){var t=l._instanceCache[n];if(!t){t=new e(n);l._instanceCache[n]=t}return t};l.createForControl=function(e){try{var t=n.getAppComponentForControl(e);var r=n.getComponentClassName(t||e);return l.create(r)}catch(e){i.error(e.message,undefined,"sap.ui.fl.FlexControllerFactory")}};function p(e,r){if(n.getUshellContainer()){return Promise.resolve(e)}var o=window.sessionStorage.getItem("sap.ui.rta.restart."+t.CUSTOMER);if(o){var a=n.getComponentClassName(r);if(o!==a&&o!=="true"){i.error("an application component was started "+"which does not match the component for which the restart was triggered:\n"+"Triggering component: "+o+"\n"+"Started component: "+a);return Promise.resolve(e)}window.sessionStorage.removeItem("sap.ui.rta.restart."+t.CUSTOMER);return new Promise(function(n,t){Promise.all([sap.ui.getCore().loadLibrary("sap.ui.rta",{async:true}),r.rootControlLoaded()]).then(function(){sap.ui.require(["sap/ui/rta/api/startKeyUserAdaptation"],function(t){t({rootControl:r});n(e)})}).catch(function(e){t(e)})})}return Promise.resolve(e)}l.getChangesAndPropagate=function(e,t){if(n.isApplicationComponent(e)){var r=e.getId();var a=o.initialize({componentId:r,asyncHints:t.asyncHints}).then(c.bind(this,e));l._componentInstantiationPromises.set(e,a);return a}else if(n.isEmbeddedComponent(e)){var i=n.getAppComponentForControl(e);if(i&&n.isApplicationComponent(i)){var s=Promise.resolve();if(l._componentInstantiationPromises.has(i)){s=l._componentInstantiationPromises.get(i)}return s.then(function(){var e=i.getModel(n.VARIANT_MODEL_NAME);if(!e){return c(i)}return e}).then(function(t){e.setModel(t,n.VARIANT_MODEL_NAME)})}return Promise.resolve()}};function c(e){var t=e.getManifestObject();var o=l.createForControl(e,t);var i;return o._oChangePersistence.loadChangesMapForComponent(e).then(function(n){var t=r.applyAllChangesForControl.bind(r,n,e,o);t._bIsSapUiFlFlexControllerApplyChangesOnControl=true;e.addPropagationListener(t);i=new a({},{flexController:o,appComponent:e});return i.initialize()}).then(function(){e.setModel(i,n.VARIANT_MODEL_NAME);s.end("flexProcessing");return i}).then(function(n){return p(n,e)})}return l},true);
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/Layer",[],function(){"use strict";return{USER:"USER",PUBLIC:"PUBLIC",CUSTOMER:"CUSTOMER",CUSTOMER_BASE:"CUSTOMER_BASE",PARTNER:"PARTNER",VENDOR:"VENDOR",BASE:"BASE"}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/LayerUtils",["sap/base/util/UriParameters","sap/ui/thirdparty/hasher","sap/ui/fl/Layer"],function(e,r,t){"use strict";var a=[t.BASE,t.VENDOR,t.PARTNER,t.CUSTOMER_BASE,t.CUSTOMER,t.PUBLIC,t.USER];var n={};a.forEach(function(e,r){n[e]=r});function i(r){return e.fromQuery(window.location.search).get(r)}var u={_mLayersIndex:n,_sTopLayer:a[a.length-1],FL_MAX_LAYER_PARAM:"sap-ui-fl-max-layer",isValidLayer:function(e){return Object.keys(t).some(function(r){return r===e})},isVendorLayer:function(){return this.getCurrentLayer()===t.VENDOR},isCustomerDependentLayer:function(e){return[t.PUBLIC,t.CUSTOMER,t.CUSTOMER_BASE].indexOf(e)>-1},isDeveloperLayer:function(e){return u.compareAgainstCurrentLayer(e,t.CUSTOMER)===-1},doesCurrentLayerRequirePackage:function(){var e=this.getCurrentLayer();return e===t.VENDOR||e===t.PARTNER||e===t.CUSTOMER_BASE},getMaxLayer:function(e){var t=u.getMaxLayerTechnicalParameter(r.getHash(),e);return t||i(this.FL_MAX_LAYER_PARAM)||u._sTopLayer},getLayerIndex:function(e){return this._mLayersIndex[e]},isOverMaxLayer:function(e,r){return this.isOverLayer(e,this.getMaxLayer(r))},isOverLayer:function(e,r){return this.getLayerIndex(e)>this.getLayerIndex(r)},compareAgainstCurrentLayer:function(e,r){var t=r||u.getCurrentLayer();if(this.getLayerIndex(t)>this.getLayerIndex(e)||!e){return-1}else if(this.getLayerIndex(t)===this.getLayerIndex(e)){return 0}return 1},isLayerFilteringRequired:function(e){return this._sTopLayer!==this.getMaxLayer(e)},isSapUiLayerParameterProvided:function(){return!!i("sap-ui-layer")},getCurrentLayer:function(){var e=i("sap-ui-layer")||"";return e.toUpperCase()||t.CUSTOMER},filterChangeDefinitionsByMaxLayer:function(e,r){return e.filter(function(e){return!e.layer||!u.isOverMaxLayer(e.layer,r)})},filterChangeOrChangeDefinitionsByCurrentLayer:function(e,r){if(!r){return e}return e.filter(function(e){var t=e.getLayer&&e.getLayer()||e.layer;return r===t})},getMaxLayerTechnicalParameter:function(e,r){if(r){var t=r.parseShellHash(e)||{};if(t.params&&t.params.hasOwnProperty(this.FL_MAX_LAYER_PARAM)){return t.params[this.FL_MAX_LAYER_PARAM][0]}}return undefined}};return u});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/PreprocessorImpl",["sap/ui/core/Component","sap/ui/fl/Utils","sap/ui/fl/ChangePersistenceFactory","sap/base/Log"],function(e,n,o,r){"use strict";function t(e){return e.getChangeType()==="codeExt"}function i(e,n){var o=n.getSelector().controllerName;return e===o}var s=function(){};s.prototype.getControllerExtensions=function(a,u,p){if(p){if(!u){r.warning("No component ID for determining the anchor of the code extensions was passed.");return Promise.resolve([])}var c=e.get(u);var f=n.getAppComponentForControl(c);if(!f){r.warning("No application component for determining the anchor of the code extensions was identified.");return Promise.resolve([])}if(!n.isApplication(f.getManifestObject())){return Promise.resolve([])}var l=n.getComponentClassName(f);var g=o.getChangePersistenceForComponent(l);return g.getChangesForComponent().then(function(e){var n=e.filter(function(e){return t(e)&&i(a,e)}).map(function(e){return e.getModuleName()});return s.getExtensionModules(n)})}r.warning("Synchronous extensions are not supported by sap.ui.fl.PreprocessorImpl");return[]};s.getExtensionModules=function(e){if(e.length===0){return Promise.resolve([])}return new Promise(function(n){sap.ui.require(e,function(){var e=Array.prototype.slice.call(arguments);n(e)},function(e){r.error("Code Extension not found",e.message);n([])})})};return s},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/RegistrationDelegator",["sap/ui/fl/FlexControllerFactory","sap/ui/core/Component","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerRegistration","sap/ui/fl/ChangePersistenceFactory","sap/ui/core/mvc/Controller","sap/ui/core/mvc/XMLView","sap/ui/core/ExtensionPoint","sap/ui/fl/EventHistory","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/apply/_internal/changes/descriptor/Preprocessor","sap/ui/fl/apply/_internal/DelegateMediator","sap/ui/fl/apply/api/DelegateMediatorAPI","sap/ui/fl/PreprocessorImpl","sap/ui/fl/XmlPreprocessorImpl"],function(e,n,r,i,t,a,s,o,l,p,u,f){"use strict";var c={};function d(){n._fnOnInstanceCreated=e.getChangesAndPropagate}function g(){r.registerPredefinedChangeHandlers();r.getChangeHandlersOfLoadedLibsAndRegisterOnNewLoadedLibs()}function P(){n._fnLoadComponentCallback=i._onLoadComponent.bind(i)}function m(){t.registerExtensionProvider("sap.ui.fl.PreprocessorImpl")}function C(){if(a.registerPreprocessor){a.registerPreprocessor("viewxml","sap.ui.fl.XmlPreprocessorImpl",true)}}function y(){o.start()}function _(){n._fnPreprocessManifest=p.preprocessManifest}function x(e){if(l.isFlexExtensionPointHandlingEnabled(e)){return"sap/ui/fl/apply/_internal/extensionPoint/Processor"}if(sap.ui.getCore().getConfiguration().getDesignMode()){return"sap/ui/fl/write/_internal/extensionPoint/Processor"}return undefined}function D(){s.registerExtensionProvider(x)}function v(){f.registerDefaultDelegate({modelType:"sap.ui.model.odata.v4.ODataModel",delegate:"sap/ui/fl/write/_internal/delegates/ODataV4ReadDelegate",delegateType:u.types.READONLY})}c.registerAll=function(){y();g();P();m();d();C();_();D();v()};return c},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/Utils",["sap/ui/thirdparty/jquery","sap/ui/core/Component","sap/ui/core/util/reflection/BaseTreeModifier","sap/ui/thirdparty/hasher","sap/base/Log","sap/base/util/UriParameters","sap/base/util/uid","sap/base/strings/formatMessage","sap/ui/base/ManagedObject","sap/ui/core/mvc/View","sap/base/util/isPlainObject","sap/ui/base/SyncPromise"],function(e,t,r,n,a,i,o,s,u,p,f,c){"use strict";function g(e){if(e.length>0&&e.indexOf(".Component")<0){e+=".Component"}return e}var l={APP_ID_AT_DESIGN_TIME:"${pro"+"ject.art"+"ifactId}",VARIANT_MODEL_NAME:"$FlexVariants",formatAndLogMessage:function(e,t,r,n){var i=t.join(" ");i=s(i,r);a[e](i,n||"")},getXSRFTokenFromControl:function(e){var t;if(!e){return""}if(e&&typeof e.getModel==="function"){t=e.getModel();return l._getXSRFTokenFromModel(t)}return""},_getXSRFTokenFromModel:function(e){var t;if(!e){return""}if(typeof e.getHeaders==="function"){t=e.getHeaders();if(t){return t["x-csrf-token"]}}return""},getComponentClassName:function(e){var t;if(e){t=this.getAppComponentForControl(e);if(t){var r=this._getComponentStartUpParameter(t,"sap-app-id");if(r){return r}if(t.getManifestEntry("sap.ui5")&&t.getManifestEntry("sap.ui5").appVariantId){return t.getManifestEntry("sap.ui5").appVariantId}}}return l.getComponentName(t)},isVariantByStartupParameter:function(e){if(e){var t=this.getAppComponentForControl(e);if(t){return!!this._getComponentStartUpParameter(t,"sap-app-id")}}return false},getAppComponentClassNameForComponent:function(e){return l.getComponentClassName(e)},getAppDescriptor:function(e){var t=null;var r=null;var n=null;if(e){r=this.getAppComponentForControl(e);if(r&&r.getMetadata){n=r.getMetadata();if(n&&n.getManifest){t=n.getManifest()}}}return t},getSiteId:function(e){var t=null;var r=null;if(e){r=this.getAppComponentForControl(e);if(r){t=this._getComponentStartUpParameter(r,"hcpApplicationId")}}return t},getSiteIdByComponentData:function(e){return this._getStartUpParameter(e,"hcpApplicationId")},isBinding:function(e){return typeof e==="string"&&!!u.bindingParser(e)||f(e)&&((e.hasOwnProperty("path")||e.hasOwnProperty("parts"))&&!e.hasOwnProperty("ui5object"))},isApplicationVariant:function(e){var t=l.getComponentClassName(e);var r=l.getAppComponentForControl(e);var n=l.getComponentName(r);return t!==n},isChangeRelatedToVariants:function(e){return e.getFileType()==="ctrl_variant_change"||e.getFileType()==="ctrl_variant_management_change"||e.getFileType()==="ctrl_variant"||e.getVariantReference()},_getComponentStartUpParameter:function(e,t){var r=null;if(t){if(e&&e.getComponentData){r=this._getStartUpParameter(e.getComponentData(),t)}}return r},_getStartUpParameter:function(e,t){if(e&&e.startupParameters&&t){if(Array.isArray(e.startupParameters[t])){return e.startupParameters[t][0]}}},getComponentName:function(e){var t="";if(e){t=e.getMetadata().getName()}return g(t)},_getComponent:function(e){var r;if(e){r=t.get(e)}return r},_getComponentIdForControl:function(e){var t=l._getOwnerIdForControl(e);if(!t){if(e&&typeof e.getParent==="function"){var r=e.getParent();if(r){return l._getComponentIdForControl(r)}}}return t||""},getComponentForControl:function(e){return l._getComponentForControl(e)},getAppComponentForControl:function(e){var r=e instanceof t?e:this._getComponentForControl(e);return this._getAppComponentForComponent(r)},getAppDescriptorComponentObjectForControl:function(e){var t=this.getAppComponentForControl(e);var r=t.getManifest();return{name:this.getAppIdFromManifest(r)}},_getComponentForControl:function(e){var t=null;var r=null;if(e){r=l._getComponentIdForControl(e);if(r){t=l._getComponent(r)}}return t},_getAppComponentForComponent:function(e){var r=null;if(e&&e.getAppComponent&&e.getAppComponent()instanceof t){return e.getAppComponent()}if(e&&e.oComponentData&&e.oComponentData.appComponent){return e.oComponentData.appComponent}if(e&&e.getManifestEntry){r=e.getManifestEntry("sap.app")}else{return e}if(r&&r.type&&r.type!=="application"){if(e instanceof t){e=this._getComponentForControl(e)}return this.getAppComponentForControl(e)}return e},getViewForControl:function(e){return l.getFirstAncestorOfControlWithControlType(e,sap.ui.core.mvc.View)},getFirstAncestorOfControlWithControlType:function(e,t){if(e instanceof t){return e}if(e&&typeof e.getParent==="function"){e=e.getParent();return l.getFirstAncestorOfControlWithControlType(e,t)}},hasControlAncestorWithId:function(e,t){var r;if(e===t){return true}r=sap.ui.getCore().byId(e);while(r){if(r.getId()===t){return true}if(typeof r.getParent==="function"){r=r.getParent()}else{return false}}return false},_isView:function(e){return e instanceof p},_getOwnerIdForControl:function(e){return t.getOwnerIdFor(e)},getClient:function(){var e;var t;e=this._getUriParameters();t=e.get("sap-client");return t||undefined},_getUriParameters:function(){return i.fromQuery(window.location.search)},isHotfixMode:function(){var e;var t;e=this._getUriParameters();t=e.get("hotfix");return t==="true"},convertBrowserLanguageToISO639_1:function(e){if(!e||typeof e!=="string"){return""}var t=e.indexOf("-");if(t<0&&e.length<=2){return e.toUpperCase()}if(t>0&&t<=2){return e.substring(0,t).toUpperCase()}return""},getLrepUrl:function(){var e=sap.ui.getCore().getConfiguration().getFlexibilityServices();var t=e.find(function(e){return e.connector==="LrepConnector"});return t?t.url:""},getCurrentLanguage:function(){var e=sap.ui.getCore().getConfiguration().getLanguage();return l.convertBrowserLanguageToISO639_1(e)},getControlType:function(e){var t;if(e&&typeof e.getMetadata==="function"){t=e.getMetadata();if(t&&typeof t.getElementName==="function"){return t.getElementName()}}},asciiToString:function(t){var r=t.split(",");var n="";e.each(r,function(e,t){n+=String.fromCharCode(t)});return n},stringToAscii:function(e){var t="";for(var r=0;r<e.length;r++){t+=e.charCodeAt(r)+","}t=t.substring(0,t.length-1);return t},checkControlId:function(e,t){if(!t){e=e instanceof u?e:sap.ui.getCore().byId(e);t=l.getAppComponentForControl(e)}return r.checkControlId(e,t)},hasLocalIdSuffix:r.hasLocalIdSuffix,_getAllUrlParameters:function(){return window.location.search.substring(1)},getTechnicalParametersForComponent:function(e){return e&&e.getComponentData&&e.getComponentData()&&e.getComponentData().technicalParameters},getParsedURLHash:function(e){if(e){return e.parseShellHash(n.getHash())||{}}return{}},isDebugEnabled:function(){var e=this._getUriParameters();var t=e.get("sap-ui-debug")||"";if(sap.ui.getCore().getConfiguration().getDebug()||t==="true"){return true}var r=t.split(",");return r.indexOf("sap/ui/fl")!==-1||r.indexOf("sap/ui/fl/")!==-1},getUrlParameter:function(e){return i.fromQuery(window.location.search).get(e)},getUshellContainer:function(){return sap.ushell&&sap.ushell.Container},createDefaultFileName:function(e){var t=o().replace(/-/g,"_");if(e){t+="_"+e}return t},createNamespace:function(e,t){var r="changes";if(t==="ctrl_variant"){r="variants"}var n=e.reference.replace(".Component","");var a="apps/"+n+"/"+r+"/";return a},buildLrepRootNamespace:function(e,t,r){var n="apps/";var a=new Error("Error in sap.ui.fl.Utils#buildLrepRootNamespace: ");if(!e){a.message+="for every scenario you need a base ID";throw a}switch(t){case sap.ui.fl.Scenario.VersionedAppVariant:if(!r){a.message+="in a versioned app variant scenario you additionally need a project ID";throw a}n+=e+"/appVariants/"+r+"/";break;case sap.ui.fl.Scenario.AppVariant:if(!r){a.message+="in an app variant scenario you additionally need a project ID";throw a}n+=e+"/appVariants/"+r+"/";break;case sap.ui.fl.Scenario.AdaptationProject:if(!r){a.message+="in a adaptation project scenario you additionally need a project ID";throw a}n+=e+"/adapt/"+r+"/";break;case sap.ui.fl.Scenario.FioriElementsFromScratch:case sap.ui.fl.Scenario.UiAdaptation:default:n+=e+"/"}return n},_getComponentTypeFromManifest:function(e){return e&&e.getEntry&&e.getEntry("sap.app")&&e.getEntry("sap.app").type},_getComponentTypeFromRawManifest:function(e){return e&&e["sap.app"]&&e["sap.app"].type},isApplication:function(e,t){var r=t?l._getComponentTypeFromRawManifest(e):l._getComponentTypeFromManifest(e);return r==="application"},isApplicationComponent:function(e){return e instanceof t&&l.isApplication(e.getManifestObject())},isEmbeddedComponent:function(e){return e instanceof t&&l._getComponentTypeFromManifest(e.getManifestObject())==="component"},getFlexReference:function(e){if(e){if(e.getEntry("sap.ui5")){if(e.getEntry("sap.ui5").appVariantId){return e.getEntry("sap.ui5").appVariantId}if(e.getEntry("sap.ui5").componentName){return g(e.getEntry("sap.ui5").componentName)}}if(e.getEntry("sap.app")&&e.getEntry("sap.app").id){return g(l.getAppIdFromManifest(e))}}a.warning("No Manifest received.");return""},getAppIdFromManifest:function(e){if(e){var t=e.getEntry?e.getEntry("sap.app"):e["sap.app"];var r=t&&t.id;if(r===l.APP_ID_AT_DESIGN_TIME&&e.getComponentName){r=e.getComponentName()}return r}throw new Error("No Manifest received, descriptor changes are not possible")},getODataServiceUriFromManifest:function(e){var t="";if(e){var r=e.getEntry?e.getEntry("sap.app"):e["sap.app"];if(r&&r.dataSources&&r.dataSources.mainService&&r.dataSources.mainService.uri){t=r.dataSources.mainService.uri}}else{a.warning("No Manifest received.")}return t},indexOfObject:function(e,t){var r=-1;e.some(function(e,n){var a;var i;if(!e){a=[]}else{a=Object.keys(e)}if(!t){i=[]}else{i=Object.keys(t)}var o=a.length===i.length;var s=o&&!a.some(function(r){return e[r]!==t[r]});if(s){r=n}return s});return r},execPromiseQueueSequentially:function(e,t,r){if(e.length===0){if(r){return Promise.resolve()}return new l.FakePromise}var n=e.shift();if(typeof n==="function"){var i;try{i=n()}catch(e){i=Promise.reject(e)}return i.then(function(){if(!r&&i instanceof Promise){r=true}}).catch(function(e){var r="Error during execPromiseQueueSequentially processing occured";r+=e?": "+e.message:"";a.error(r);if(t){throw new Error(r)}}).then(function(){return this.execPromiseQueueSequentially(e,t,r)}.bind(this))}a.error("Changes could not be applied, promise not wrapped inside function.");return this.execPromiseQueueSequentially(e,t,r)},FakePromise:function(e,t,r){l.FakePromise.fakePromiseIdentifier="sap.ui.fl.Utils.FakePromise";this.vValue=e;this.vError=t;this.bContinueWithFakePromise=arguments.length<3||r===l.FakePromise.fakePromiseIdentifier;var n=function(e,t){try{var r=t(e,l.FakePromise.fakePromiseIdentifier);if(c.isThenable(r)){return r}return new l.FakePromise(r)}catch(e){var n=e;return new l.FakePromise(undefined,n)}};l.FakePromise.prototype.then=function(e,t){if(!this.bContinueWithFakePromise){return Promise.resolve(e(this.vValue))}if(!this.vError){return n(this.vValue,e)}else if(t){return n(this.vError,t)}return this};l.FakePromise.prototype.catch=function(e){if(!this.bContinueWithFakePromise){return Promise.reject(e(this.vError))}if(this.vError){return n(this.vError,e)}return this};if(this.vValue instanceof Promise||this.vValue instanceof l.FakePromise){return this.vValue}},getChangeFromChangesMap:function(e,t){var r;Object.keys(e).forEach(function(n){e[n].some(function(e){if(e.getId()===t){r=e;return true}})});return r},requireAsync:function(e){var t=sap.ui.require(e);if(t){return Promise.resolve(t)}return new Promise(function(t,r){sap.ui.require([e],function(e){t(e)},function(e){r(e)})})},normalizeReference:function(e){return e.replace(/(.Component)$/g,"")},handleUrlParameters:function(e,t,r,n){if(this.hasParameterAndValue(t,r,n)){if(e.startsWith("?")){e=e.substr(1,e.length)}var a=e.split("&").filter(function(e){return e!==t+"="+r});e="";if(a.length>0){e="?"+a.toString()}}else{e+=(e.length>0?"&":"?")+t+"="+r}return e},hasParameterAndValue:function(e,t,r){return this.getParameter(e,r)===t},getParameter:function(e,t){if(t){var r=l.getParsedURLHash(t);return r.params&&r.params[e]&&r.params[e][0]}var n=i.fromQuery(document.location.search);if(!n){return false}return n.get(e)},findAggregation:function(e,t){if(e){if(e.getMetadata){var r=e.getMetadata();var n=r.getAllAggregations();if(n){return n[t]}}}return undefined},getAggregation:function(e,t){var r=l.findAggregation(e,t);if(r){return e[r._sGetter]()}return undefined},getProperty:function(e,t){var r=e.getMetadata().getPropertyLikeSetting(t);if(r){var n=r._sGetter;return e[n]()}return undefined},getUShellService:function(e){if(e){var t=this.getUshellContainer();if(t){return t.getServiceAsync(e)}}return Promise.resolve()},getUShellServices:function(e){var t=e.map(function(e){return this.getUShellService(e)}.bind(this));return Promise.all(t).then(function(t){return e.reduce(function(e,r,n){e[r]=t&&t[n];return e},{})})}};return l},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/Variant",["sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/registry/Settings","sap/base/util/merge","sap/base/Log"],function(t,e,n,i,o,r,a,s){"use strict";var f=e.extend("sap.ui.fl.Variant",{constructor:function(i){e.apply(this);if(!t.isPlainObject(i)){s.error("Constructor : sap.ui.fl.Variant : oFile is not defined")}this._oDefinition=i;this._oOriginDefinition=a({},i);this._sRequest="";this._bUserDependent=i.content.layer===n.USER;this._vRevertData=null;this.setState(f.states.NEW)},metadata:{properties:{state:{type:"string"}}}});f.states={NEW:"NEW",PERSISTED:"NONE",DELETED:"DELETE",DIRTY:"UPDATE"};f.events={markForDeletion:"markForDeletion"};f.prototype.setState=function(t){if(this._isValidState(t)){this.setProperty("state",t)}return this};f.prototype._isValidState=function(t){var e=false;Object.keys(f.states).some(function(n){if(f.states[n]===t){e=true}return e});if(!e){return false}if(this.getState()===f.states.NEW&&t===f.states.DIRTY){return false}return true};f.prototype.isValid=function(){var t=true;if(typeof this._oDefinition!=="object"){t=false}if(!this._oDefinition.content.fileType||this._oDefinition.content.fileType!=="ctrl_variant"){t=false}if(!this._oDefinition.content.fileName){t=false}if(!this._oDefinition.content.content.title){t=false}if(!this._oDefinition.content.variantManagementReference){t=false}if(!this._oDefinition.content.layer){t=false}if(!this._oDefinition.content.originalLanguage){t=false}return t};f.prototype.isVariant=function(){return true};f.prototype.getDefinitionWithChanges=function(){return this._oDefinition};f.prototype.getTitle=function(){if(this._oDefinition){return this._oDefinition.content.content.title}};f.prototype.getFileType=function(){if(this._oDefinition){return this._oDefinition.content.fileType}};f.prototype.getControlChanges=function(){return this._oDefinition.controlChanges};f.prototype.getOriginalLanguage=function(){if(this._oDefinition&&this._oDefinition.content.originalLanguage){return this._oDefinition.content.originalLanguage}return""};f.prototype.getPackage=function(){return this._oDefinition.content.packageName};f.prototype.getNamespace=function(){return this._oDefinition.content.namespace};f.prototype.setNamespace=function(t){this._oDefinition.content.namespace=t};f.prototype.getId=function(){return this._oDefinition.content.fileName};f.prototype.getContent=function(){return this._oDefinition.content.content};f.prototype.setContent=function(t){this._oDefinition.content.content=t;this.setState(f.states.DIRTY)};f.prototype.getVariantManagementReference=function(){return this._oDefinition.content.variantManagementReference};f.prototype.getVariantReference=function(){return this._oDefinition.content.variantReference};f.prototype.getOwnerId=function(){return this._oDefinition.content.support?this._oDefinition.content.support.user:""};f.prototype.getText=function(t){if(typeof t!=="string"){s.error("sap.ui.fl.Variant.getTexts : sTextId is not defined")}if(this._oDefinition.content.texts){if(this._oDefinition.content.texts[t]){return this._oDefinition.content.texts[t].value}}return""};f.prototype.setText=function(t,e){if(typeof t!=="string"){s.error("sap.ui.fl.Variant.setTexts : sTextId is not defined");return}if(this._oDefinition.content.texts){if(this._oDefinition.content.texts[t]){this._oDefinition.content.texts[t].value=e;this.setState(f.states.DIRTY)}}};f.prototype.isReadOnly=function(){return this._isReadOnlyDueToLayer()||this._isReadOnlyWhenNotKeyUser()};f.prototype._isReadOnlyWhenNotKeyUser=function(){if(this.isUserDependent()){return false}var t=this.getDefinition().reference;if(!t){return true}var e=r.getInstanceOrUndef();if(!e){return true}return!e.isKeyUser()};f.prototype._isReadOnlyDueToLayer=function(){var t;t=this._bUserDependent?n.USER:o.getCurrentLayer();return this._oDefinition.content.layer!==t};f.prototype._isReadOnlyDueToOriginalLanguage=function(){var t;var e;e=this.getOriginalLanguage();if(!e){return false}t=i.getCurrentLanguage();return t!==e};f.prototype.markForDeletion=function(){this.setState(f.states.DELETED)};f.prototype.setRequest=function(t){if(typeof t!=="string"){s.error("sap.ui.fl.Variant.setRequest : sRequest is not defined")}this._sRequest=t};f.prototype.getRequest=function(){return this._sRequest};f.prototype.getLayer=function(){return this._oDefinition.content.layer};f.prototype.getComponent=function(){return this._oDefinition.content.reference};f.prototype.setComponent=function(t){this._oDefinition.content.reference=t};f.prototype.getCreation=function(){return this._oDefinition.content.creation};f.prototype.isUserDependent=function(){return this._bUserDependent};f.prototype.getDefinition=function(){return this._oDefinition.content};f.prototype.setResponse=function(t){var e=JSON.stringify(t);if(e){this._oDefinition=JSON.parse(e);this._oOriginDefinition=JSON.parse(e);this.setState(f.states.PERSISTED)}};f.prototype.getFullFileIdentifier=function(){var t=this.getLayer();var e=this.getNamespace();var n=this.getDefinition().content.fileName;var i=this.getDefinition().content.fileType;return t+"/"+e+"/"+n+"."+i};f.prototype.getRevertData=function(){return this._vRevertData};f.prototype.setRevertData=function(t){this._vRevertData=t};f.prototype.resetRevertData=function(){this.setRevertData(null)};f.createInitialFileContent=function(t){if(!t){t={}}var e=t.content.fileName||i.createDefaultFileName();var r=t.content.namespace||i.createNamespace(t.content,"ctrl_variant");var a={content:{fileName:e,fileType:"ctrl_variant",variantManagementReference:t.content.variantManagementReference,variantReference:t.content.variantReference||"",reference:t.content.reference||"",packageName:t.content.packageName||"",content:{title:t.content.content.title||""},self:r+e+"."+"ctrl_variant",layer:t.content.layer||(t.isUserDependent?n.USER:o.getCurrentLayer()),texts:t.content.texts||{},namespace:r,creation:"",originalLanguage:i.getCurrentLanguage(),conditions:{},contexts:t.content.contexts||{},support:{generator:t.generator||"Change.createInitialFileContent",service:t.service||"",user:"",sapui5Version:sap.ui.version}},controlChanges:t.controlChanges||[],variantChanges:{}};return a};return f},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/XmlPreprocessorImpl",["sap/ui/core/Component","sap/ui/fl/FlexControllerFactory","sap/ui/fl/Utils","sap/ui/fl/ChangePersistenceFactory","sap/base/Log"],function(e,r,n,t,o){"use strict";var i=function(){};i.process=function(t,i){try{if(!i||i.sync){o.warning("Flexibility feature for applying changes on an XML view is only available for "+"asynchronous views; merge is be done later on the JS controls.");return t}i.viewId=i.id;var s=e.get(i.componentId);if(!s){o.warning("View is generated without a component. Flexibility features are not possible.");return Promise.resolve(t)}var a=n.getAppComponentForControl(s);if(!n.isApplication(a.getManifestObject())){return Promise.resolve(t)}var l=n.getComponentClassName(a);var p=r.create(l);return p.processXmlView(t,i).then(function(){o.debug("flex processing view "+i.id+" finished");return t}).catch(function(){o.warning("Error happens when getting flex cache key! flexibility XML view preprocessing is skipped. "+"The processing will be done later on the JS controls.");return Promise.resolve(t)})}catch(e){var c="view "+i.id+": "+e;o.info(c);return Promise.resolve(t)}};i.getCacheKey=function(r){var o=e.get(r.componentId);var i=n.getAppComponentForControl(o);if(n.isVariantByStartupParameter(i)){return Promise.resolve()}var s=n.getComponentClassName(i);var a=t.getChangePersistenceForComponent(s);return a.getCacheKey(i)};return i},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/DelegateMediator",["sap/base/Log","sap/base/util/merge","sap/base/util/restricted/_pick","sap/ui/fl/Utils","sap/ui/core/util/reflection/JsControlTreeModifier"],function(e,t,r,n,a){"use strict";var i={};i._mDefaultDelegateItems={};i.types={READONLY:"readonly",WRITEONLY:"writeonly",COMPLETE:"complete"};function o(e,t){if(t){return t}if(e.getModel){var r=e.getModel();if(!r){return undefined}return r.getMetadata().getName()}}function u(e,t){t=o(e,t);var r=i._mDefaultDelegateItems[t];return(r||[]).map(function(e){e.payload={};return e})}function l(t,r,a){if(!a.length){return Promise.resolve([])}var i=[];a.forEach(function(a){i.push(function(i){return n.requireAsync(a.name).then(function(e){a.instance=e||{};i.push(a);return i}).catch(function(n){e.error("Failed to load the delegate for the control "+t.getId(r)+"\n"+n.message);return i})})});return i.reduce(function(e,t){return e.then(t)},Promise.resolve([]))}function s(e){return e&&typeof e==="function"}function f(e){return e.delegateType===i.types.COMPLETE||s(e.instance.getPropertyInfo)&&(s(e.instance.createLabel)||s(e.instance.createLayout))}function c(e){return e.delegateType===i.types.READONLY||s(e.instance.getPropertyInfo)}function d(e){return e.delegateType===i.types.WRITEONLY||s(e.instance.createLabel)||s(e.instance.createLayout)}function p(e,t){e.names.push(t.name);if(t.requiredLibraries){e.requiredLibraries=Object.assign(e.requiredLibraries||{},t.requiredLibraries)}if(t.payload&&!e.payload){e.payload=t.payload}return e}function g(e,n){e=p(e,n);return t(e,{instance:r(n.instance,["getPropertyInfo","getRepresentedProperties"])})}function m(e,n){e=p(e,n);return t(e,{instance:r(n.instance,["createLabel","createControlForProperty","createLayout"])})}function y(e,n){e=p(e,n);return t(e,r(n,"instance"))}function T(e){var t={names:[],instance:{},modelType:e.length&&e[0].modelType};var r=true;var n=true;for(var a=e.length-1;a>=0;a--){var i=e[a];if(f(i)){if(r&&n){t=y(t,i)}else if(r){t=g(t,i)}else if(n){t=m(t,i)}break}else if(c(i)&&r){t=g(t,i);r=false}else if(d(i)&&n){t=m(t,i);n=false}}return e.length?t:undefined}function D(e,t){return new Promise(function(r,n){if(!e){n(new Error("The control parameter is missing"))}if(!t){n(new Error("The modifier parameter is missing"))}if(!e){n(new Error("The input control should be available"))}if(t===a&&(!e.isA||!e.isA("sap.ui.base.ManagedObject"))){n(new Error("The input control should be a managed object"))}r()})}function h(e){return Object.values(i.types).some(function(t){return t===e.delegateType})}function b(e){var t=i._mDefaultDelegateItems[e.modelType]||[];var r=t.map(function(e){return e.delegateType});return r.indexOf(i.types.COMPLETE)>-1||r.indexOf(e.delegateType)>-1||e.delegateType===i.types.COMPLETE&&r.length}i.getKnownDefaultDelegateLibraries=function(){return["sap.ui.comp"]};i.getRequiredLibrariesForDefaultDelegate=function(e,t,r){r=o(t,r);var n=i._mDefaultDelegateItems[r]||[];return n.reduce(function(t,r){var n=e.indexOf(r.name)>-1;return t.concat(Object.keys(n&&r.requiredLibraries||{}))},[])};i.isDelegateRegistered=function(e){return!!i._mDefaultDelegateItems[e]};i.registerDefaultDelegate=function(e){if(!(e.modelType&&e.delegate)){throw new Error("'modelType' and 'delegate' properties are required for registration!")}e.delegateType=e.delegateType||i.types.COMPLETE;if(e.delegateType&&!h(e)){throw new Error("default 'delegateType': "+e.delegateType+" is invalid!")}if(b(e)){throw new Error("modelType "+e.modelType+"is already defined!")}if(!i._mDefaultDelegateItems[e.modelType]){i._mDefaultDelegateItems[e.modelType]=[]}i._mDefaultDelegateItems[e.modelType].push({name:e.delegate,requiredLibraries:e.requiredLibraries,delegateType:e.delegateType,modelType:e.modelType})};i.getDelegateForControl=function(e,t,r,n){return D(e,t).then(function(){return t.getFlexDelegate(e)}).then(function(a){var i=n&&u(e,r)||[];if(a){i.push(a)}return l(t,e,i)}).then(T.bind(this))};i.clear=function(){i._mDefaultDelegateItems={}};return i},false);
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/appVariant/DescriptorChangeTypes",[],function(){"use strict";return{getChangeTypes:function(){return["appdescr_ovp_addNewCard","appdescr_ovp_removeCard","appdescr_ovp_changeCard","appdescr_app_addNewInbound","appdescr_app_changeInbound","appdescr_app_removeInbound","appdescr_app_removeAllInboundsExceptOne","appdescr_app_addNewOutbound","appdescr_app_changeOutbound","appdescr_app_removeOutbound","appdescr_app_addNewDataSource","appdescr_app_changeDataSource","appdescr_app_removeDataSource","appdescr_app_addAnnotationsToOData","appdescr_app_addTechnicalAttributes","appdescr_app_removeTechnicalAttributes","appdescr_app_setTitle","appdescr_app_setSubTitle","appdescr_app_setShortTitle","appdescr_app_setDescription","appdescr_app_setInfo","appdescr_app_setDestination","appdescr_app_setKeywords","appdescr_app_setAch","appdescr_app_addCdsViews","appdescr_app_removeCdsViews","appdescr_flp_setConfig","appdescr_ui5_addNewModelEnhanceWith","appdescr_ui5_removeModel","appdescr_ui5_replaceComponentUsage","appdescr_ui5_setMinUI5Version","appdescr_smb_addNamespace","appdescr_smb_changeNamespace","appdescr_ui_generic_app_setMainPage","appdescr_ui_setIcon","appdescr_ui_setDeviceTypes","appdescr_ui5_addLibraries","appdescr_ui5_addNewModel","appdescr_app_addAnnotationsToOData","appdescr_ui5_addComponentUsages","appdescr_ui5_setFlexExtensionPointEnabled","appdescr_url_setUri","appdescr_fiori_setRegistrationIds","appdescr_card","appdescr_card_designtime","appdescr_fiori_setAbstract"]},getCondensableChangeTypes:function(){return["appdescr_app_setTitle","appdescr_app_setInfo","appdescr_app_setShortTitle","appdescr_app_setSubTitle","appdescr_app_setDescription","appdescr_app_setDestination","appdescr_app_setKeywords","appdescr_app_setAch","appdescr_ui_setIcon","appdescr_ui_setDeviceTypes","appdescr_ui_setIcon","appdescr_ui_setDeviceTypes","appdescr_fiori_setRegistrationIds","appdescr_smb_changeNamespace"]}}});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/Applier",["sap/base/Log","sap/ui/core/Element","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/Utils"],function(e,n,t,r,i,a,o){"use strict";var s=new o.FakePromise;function l(e,n){var t=e.getSelector&&e.getSelector();if(!t||!t.id&&!t.name){return Promise.reject(Error("No selector in change found or no selector ID."))}return n.modifier.bySelectorTypeIndependent(t,n.appComponent,n.view).then(function(t){if(!t){throw Error("A flexibility change tries to change a nonexistent control.")}var r=e.getDependentControlSelectorList();r.forEach(function(e){var t=n.modifier.bySelector(e,n.appComponent,n.view);if(!t){throw new Error("A dependent selector control of the flexibility change is not available.")}});return t})}function c(e,n,t,a,o){var s=i.getControlIfTemplateAffected(n,e,o);var l=o.modifier;var c=!!r.sync.getAppliedCustomDataValue(s.control,n);var p=c||r.sync.hasChangeApplyFinishedCustomData(s.control,n);var u=n.isApplyProcessFinished();if(u&&!p){var d=i.checkIfDependencyIsStillValidSync.bind(null,o.appComponent,l,t);a._oChangePersistence.copyDependenciesFromInitialChangesMapSync(n,d,o.appComponent);n.setInitialApplyState()}else if(!u&&p){if(c){n.setRevertData(r.sync.getParsedRevertDataFromCustomData(e,n))}n.markFinished()}}function p(e){return e.modifier.targets==="xmlTree"}function u(e,n,t,a,s){var l=p(s);var c=i.getControlIfTemplateAffected(n,e,s);var u=s.modifier;return r.getAppliedCustomDataValue(c.control,n,u).then(function(e){var t=!!e;return Promise.all([t,t||r.hasChangeApplyFinishedCustomData(c.control,n,u)])}).then(function(c){var p=c[0];var u=c[1];var d=n.isApplyProcessFinished();var f=s.modifier;var g=s.appComponent;if(d&&!u){var h=new o.FakePromise;if(!l){var m=i.checkIfDependencyIsStillValid.bind(null,g,f,t);h=h.then(function(){return a._oChangePersistence.copyDependenciesFromInitialChangesMap(n,m,g)})}return h.then(n.setInitialApplyState.bind(n))}else if(!d&&u){if(p){return r.getParsedRevertDataFromCustomData(e,n,f).then(function(e){n.setRevertData(e);n.markFinished()})}n.markFinished();return undefined}else if(d&&u){n.markFinished()}return undefined})}function d(e,n){var t;if(p(n)&&e.getDefinition().jsOnly){t="Change cannot be applied in XML. Retrying in JS."}if(t){e.setInitialApplyState();throw Error(t)}}function f(e,t,i,a){return Promise.resolve().then(function(){if(i instanceof n){t.control=i}if(t.control){return a.modifier.updateAggregation(t.originalControl,e.getContent().boundAggregation)}return undefined}).then(function(){return r.addAppliedCustomData(t.control,e,a,p(a))}).then(function(){var n={success:true};e.markFinished(n);return n})}function g(e,n,t,i){var a=p(i);var s={success:false,error:e};var l=n.getId();var c="Change ''{0}'' could not be applied.";var u=e instanceof Error;var d=r.getCustomDataIdentifier(false,u,a);switch(d){case r.notApplicableChangesCustomDataKey:o.formatAndLogMessage("info",[c,e.message],[l]);break;case r.failedChangesCustomDataKeyXml:o.formatAndLogMessage("warning",[c,"Merge error detected while processing the XML tree."],[l],e.stack);break;case r.failedChangesCustomDataKeyJs:o.formatAndLogMessage("error",[c,"Merge error detected while processing the JS control tree."],[l],e.stack);break}return r.addFailedCustomData(t.control,n,i,d).then(function(){if(a){n.setInitialApplyState()}else{n.markFinished(s)}return s})}function h(n,t){var r=t.getDefinition();var i=r.changeType;var a=r.selector.id;var o=r.namespace+r.fileName+"."+r.fileType;var s="A flexibility change could not be applied.";s+="\nThe displayed UI might not be displayed as intedend.";if(n.message){s+="\n   occurred error message: '"+n.message+"'"}s+="\n   type of change: '"+i+"'";s+="\n   LRep location of the change: "+o;s+="\n   id of targeted control: '"+a+"'.";e.warning(s,undefined,"sap.ui.fl.apply._internal.changes.Applier")}function m(e,n,r){var i={appComponent:r,modifier:t};var a=t.bySelector(e.originalSelectorToBeAdjusted,r);var o=n.getBindingInfo(e.getContent().boundAggregation).template;if(a.getParent()){var s=[];var l=a;do{s.push({aggregation:l.sParentAggregationName,index:l.getParent().getAggregation(l.sParentAggregationName).indexOf(l)});l=l.getParent()}while(l.getParent());s.reverse();s.forEach(function(e){o=o.getAggregation(e.aggregation)[e.index]})}e.addDependentControl(o,"originalSelector",i)}var v={addPreConditionForInitialChangeApplying:function(e){s=s.then(function(){return e})},applyChangeOnControl:function(e,n,t){var r=i.getControlIfTemplateAffected(e,n,t);return i.getChangeHandler(e,r,t).then(function(n){d(e,t);return n}).then(function(n){if(e.hasApplyProcessStarted()){return e.addPromiseForApplyProcessing().then(function(n){e.markFinished();return n})}else if(!e.isApplyProcessFinished()){return(new o.FakePromise).then(function(){e.startApplying();return n.applyChange(e,r.control,t)}).then(function(n){return f(e,r,n,t)}).catch(function(n){return g(n,e,r,t)})}var i={success:true};e.markFinished(i);return i}).catch(function(e){return{success:false,error:e}})},applyAllChangesForControl:function(e,n,r,i){var l=e();var p=i.getId();var u=l.mChanges[p]||[];var d={modifier:t,appComponent:n,view:o.getViewForControl(i)};u.forEach(function(e){c(i,e,l,r,d);if(!e.isApplyProcessFinished()&&!e._ignoreOnce){e.setQueuedForApply()}});s=s.then(function(e,t){var r=[];var i=e.getId();var s=l.mChanges[i]||[];var c;if(l.mControlsWithDependencies[i]){a.removeControlsDependencies(l,i);c=true}s.forEach(function(o){if(o.originalSelectorToBeAdjusted){m(o,e,n);delete o.originalSelectorToBeAdjusted}if(o._ignoreOnce){delete o._ignoreOnce}else if(o.isApplyProcessFinished()){a.resolveDependenciesForChange(l,o.getId(),i)}else if(!l.mDependencies[o.getId()]){r.push(function(){return v.applyChangeOnControl(o,e,t).then(function(){a.resolveDependenciesForChange(l,o.getId(),i)})})}else{var s=v.applyChangeOnControl.bind(v,o,e,t);a.addChangeApplyCallbackToDependency(l,o.getId(),s)}});if(s.length||c){return o.execPromiseQueueSequentially(r).then(function(){return a.processDependentQueue(l,n,i)})}return undefined}.bind(null,i,d));return s},applyAllChangesForXMLView:function(n,t){if(!Array.isArray(t)){var r="No list of changes was passed for processing the flexibility on view: "+n.view+".";e.error(r,undefined,"sap.ui.fl.apply._internal.changes.Applier");t=[]}return t.reduce(function(e,t){var r;return e.then(l.bind(null,t,n)).then(function(e){r=e;t.setQueuedForApply();return u(r,t,undefined,undefined,n)}).then(function(){if(!t.isApplyProcessFinished()){return v.applyChangeOnControl(t,r,n)}return{success:true}}).then(function(e){if(!e.success){throw Error(e.error)}}).catch(function(e){h(e,t)})},new o.FakePromise).then(function(){return n.view})}};return v});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/FlexCustomData",["sap/ui/fl/Utils","sap/base/Log","sap/ui/core/CustomData"],function(t,e){"use strict";var a={};a.sync={};a.appliedChangesCustomDataKey="sap.ui.fl.appliedChanges";a.failedChangesCustomDataKeyJs="sap.ui.fl.failedChanges.js";a.failedChangesCustomDataKeyXml="sap.ui.fl.failedChanges.xml";a.notApplicableChangesCustomDataKey="sap.ui.fl.notApplicableChanges";a.sync.getAppliedCustomDataValue=function(t,e){var n=r(t,a._getCustomDataKey(e,a.appliedChangesCustomDataKey));return n.customDataValue};a.getAppliedCustomDataValue=function(t,e,n){return o(t,n,a._getCustomDataKey(e,a.appliedChangesCustomDataKey)).then(function(t){return t.customDataValue})};a.sync.getParsedRevertDataFromCustomData=function(t,n){var u=a.sync.getAppliedCustomDataValue(t,n);try{return u&&JSON.parse(u)}catch(t){e.error("Could not parse revert data from custom data",u);return undefined}};a.getParsedRevertDataFromCustomData=function(t,e,n){return a.getAppliedCustomDataValue(t,e,n).then(function(t){return t&&JSON.parse(t)})};a.sync.hasChangeApplyFinishedCustomData=function(e,n){var u=t.getAggregation(e,"customData")||[];var r=[a._getCustomDataKey(n,a.appliedChangesCustomDataKey),a._getCustomDataKey(n,a.failedChangesCustomDataKeyJs),a._getCustomDataKey(n,a.notApplicableChangesCustomDataKey)];return u.some(function(e){var a=t.getProperty(e,"key");if(r.indexOf(a)>-1){return!!t.getProperty(e,"value")}return false})};a.hasChangeApplyFinishedCustomData=function(t,e,n){return Promise.resolve().then(n.getAggregation.bind(n,t,"customData")).then(function(t){t=t||[];var u=[a._getCustomDataKey(e,a.appliedChangesCustomDataKey),a._getCustomDataKey(e,a.failedChangesCustomDataKeyJs),a._getCustomDataKey(e,a.notApplicableChangesCustomDataKey)];return Promise.all(t.map(function(t){return Promise.resolve().then(n.getProperty.bind(n,t,"key")).then(function(e){if(u.indexOf(e)>-1){return n.getProperty(t,"value")}return undefined}).then(function(t){return!!t})})).then(function(t){return t.includes(true)})})};function n(t,e){var a=e.getRevertData();if(t&&a!==undefined){return JSON.stringify(a)}return"true"}a.addAppliedCustomData=function(t,e,r,o){var s=n(o,e);var i=a._getCustomDataKey(e,a.appliedChangesCustomDataKey);return u(t,i,s,r)};a.addFailedCustomData=function(t,e,n,r){var o=a._getCustomDataKey(e,r);return u(t,o,"true",n)};a.sync.destroyAppliedCustomData=function(t,e,n){var u=a._getCustomDataKey(e,a.appliedChangesCustomDataKey);var o=r(t,u);if(o.customData){n.destroy(o.customData)}};a.destroyAppliedCustomData=function(t,e,n){var u=a._getCustomDataKey(e,a.appliedChangesCustomDataKey);return o(t,n,u).then(function(t){if(t.customData){n.destroy(t.customData)}})};a.getCustomDataIdentifier=function(t,e,n){if(t){return a.appliedChangesCustomDataKey}if(!e){return a.notApplicableChangesCustomDataKey}if(n){return a.failedChangesCustomDataKeyXml}return a.failedChangesCustomDataKeyJs};a._getCustomDataKey=function(t,e){return e+"."+t.getId()};function u(t,e,a,n){return o(t,n.modifier,e).then(function(u){if(!u.customData){return n.modifier.createAndAddCustomData(t,e,a,n.appComponent)}return n.modifier.setProperty(u.customData,"value",a)})}function r(e,a){var n=t.getAggregation(e,"customData")||[];var u={};n.some(function(e){var n=t.getProperty(e,"key");if(n===a){u.customData=e;u.customDataValue=t.getProperty(e,"value");return true}return false});return u}function o(t,e,a){return Promise.resolve().then(e.getAggregation.bind(e,t,"customData")).then(function(t){t=t||[];var n={};return t.reduce(function(t,u){return t.then(e.getProperty.bind(e,u,"key")).then(function(t){if(t===a){n.customData=u;return e.getProperty(u,"value")}return undefined}).then(function(t){if(t){n.customDataValue=t}})},Promise.resolve()).then(function(){return n})})}return a},true);
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/Reverter",["sap/base/Log","sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/Utils"],function(e,r,n,t){"use strict";var o={};function i(e){if(!e.isApplyProcessFinished()&&e.hasApplyProcessStarted()){return e.addPromiseForApplyProcessing().then(function(r){if(r&&r.error){e.markRevertFinished(r.error);throw Error(r.error)}})}return Promise.resolve()}function a(e,n,t,i){return o.revertChangeOnControl(e,n,t).then(function(t){return r.destroyAppliedCustomData(t||n,e,i.modifier).then(function(){return!!t})}).then(function(r){if(r){i.flexController._oChangePersistence._deleteChangeInMap(e)}})}o.revertChangeOnControl=function(r,t,o){var a=n.getControlIfTemplateAffected(r,t,o);var l;return n.getChangeHandler(r,a,o).then(function(e){l=e}).then(i.bind(null,r)).then(function(){if(r.isApplyProcessFinished()){r.startReverting();return l.revertChange(r,a.control,o)}throw Error("Change was never applied")}).then(function(){a.control=o.modifier.bySelector(r.getSelector(),o.appComponent,o.view);if(a.bTemplateAffected){return o.modifier.updateAggregation(a.control,r.getContent().boundAggregation)}return undefined}).then(function(){r.markRevertFinished();return a.control}).catch(function(n){var t="Change could not be reverted: "+n.message;e.error(t);r.markRevertFinished(t);return false})};o.revertMultipleChanges=function(r,n){var o=[];r.forEach(function(r){r.setQueuedForRevert();o.push(function(){var o=r.getSelector&&r.getSelector();var i=n.modifier.bySelector(o,n.appComponent);if(!i){e.warning("A flexibility change tries to revert changes on a nonexistent control with id "+o.id);return new t.FakePromise}var l={modifier:n.modifier,appComponent:n.appComponent,view:t.getViewForControl(i)};return a(r,i,l,n)})});return t.execPromiseQueueSequentially(o)};return o});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/Utils",["sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/Utils"],function(e,n,t){"use strict";function r(e,n){if(n||e.hasApplyProcessStarted()){return false}return true}var a={getControlIfTemplateAffected:function(e,n,t){var r=t.modifier;var a=e.getDefinition();var l={originalControl:n};var i=a.dependentSelector&&a.dependentSelector.originalSelector;if(e.getContent().boundAggregation&&i){l.control=r.bySelector(i,t.appComponent,t.view);l.controlType=r.getControlType(l.control);l.bTemplateAffected=true}else{l.control=n;l.controlType=r.getControlType(n);l.bTemplateAffected=false}return l},getChangeHandler:function(e,r,a){var l=a.modifier.getLibraryName(r.control);return t.requireAsync("sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerRegistration").then(function(e){return e.waitForChangeHandlerRegistration(l)}).then(function(){var t=e.getChangeType();var l=e.getLayer();return n.getChangeHandler(t,r.controlType,r.control,a.modifier,l)})},checkIfDependencyIsStillValidSync:function(n,a,l,i){var o=t.getChangeFromChangesMap(l.mChanges,i);var c=a.bySelector(o.getSelector(),n);var g=e.sync.hasChangeApplyFinishedCustomData(c,o);return r(o,g)},checkIfDependencyIsStillValid:function(n,a,l,i){var o=t.getChangeFromChangesMap(l.mChanges,i);var c=a.bySelector(o.getSelector(),n);return e.hasChangeApplyFinishedCustomData(c,o,a).then(r.bind(null,o))}};return a});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/descriptor/Applier",["sap/ui/fl/Change"],function(e){"use strict";var n="$sap.ui.fl.changes";function r(r){var t=r&&r.getEntry&&r.getEntry(n)&&r.getEntry(n).descriptor||[];return t.map(function(n){return new e(n)})}var t={applyChanges:function(e,n,r){return r.registry().then(function(e){var r=n.map(function(n){return e[n.getChangeType()]&&e[n.getChangeType()]()});return Promise.all(r)}).then(function(t){t.forEach(function(t,a){try{var i=n[a];e=t.applyChange(e,i);if(!t.skipPostprocessing&&i.getTexts()){e=r.processTexts(e,i.getTexts())}}catch(e){r.handleError(e)}});return e})},applyChangesIncludedInManifest:function(e,t){var a=r(e);var i=e.getJson();delete i[n];if(a.length>0){return this.applyChanges(i,a,t).then(function(){return})}return Promise.resolve()}};return t});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/descriptor/ApplyStrategyFactory",["sap/ui/fl/requireAsync","sap/base/Log"],function(e,r){"use strict";var t={registry:function(){return e("sap/ui/fl/apply/_internal/changes/descriptor/Registration")},handleError:function(e){r.error(e)},processTexts:function(e,t){var n=JSON.stringify(e);Object.keys(t).forEach(function(e){if(t[e].value[""]){n=n.replace("{{"+e+"}}",t[e].value[""])}else{r.error("Text change has to contain default language")}});return JSON.parse(n)}};var n={getRuntimeStrategy:function(){return t}};return n});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/descriptor/Preprocessor",["sap/ui/fl/apply/_internal/changes/descriptor/Applier","sap/ui/fl/apply/_internal/changes/descriptor/ApplyStrategyFactory","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/performance/Measurement","sap/ui/fl/Utils"],function(e,t,n,a,i,r){"use strict";var s={preprocessManifest:function(s,p){if(!r.isApplication(s,true)||!p.id){return Promise.resolve(s)}i.start("flexStateInitialize","Initialization of flex state",["sap.ui.fl"]);var l=p.componentData||{};var c=a.getFlexReference({manifest:s,componentData:l});if(!a.getChangeManifestFromAsyncHints(p.asyncHints)){n.initialize({componentData:l,asyncHints:p.asyncHints,rawManifest:s,componentId:p.id,reference:c,partialFlexState:true}).then(i.end.bind(undefined,"flexStateInitialize"));return Promise.resolve(s)}return n.initialize({componentData:l,asyncHints:p.asyncHints,rawManifest:s,componentId:p.id,reference:c,partialFlexState:true}).then(function(){i.end("flexStateInitialize");i.start("flexAppDescriptorMerger","Client side app descriptor merger",["sap.ui.fl"]);var a=Object.assign({},s);var r=n.getAppDescriptorChanges(c);return e.applyChanges(a,r,t.getRuntimeStrategy())}).then(function(e){i.end("flexAppDescriptorMerger");return e})}};return s});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/controlVariants/URLHandler",["sap/ui/core/Component","sap/ui/fl/Utils","sap/base/Log","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/util/isEmptyObject","sap/ui/base/ManagedObjectObserver","sap/ui/thirdparty/hasher","sap/base/util/includes","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState"],function(e,a,r,t,n,o,i,s,l,c,m){"use strict";var p={};var d={};function u(e,a){var r=[];return e.reduce(function(e,t){var n=a.getVariantManagementReference(t).variantManagementReference;if(n){if(l(r,n)){e.updateRequired=true;return e}r.push(n)}if(n&&a.oData[n].currentVariant!==t){e.updateRequired=true;if(a.oData[n].currentVariant!==a.oData[n].defaultVariant){e.parameters.push(a.oData[n].currentVariant)}}else{e.parameters.push(t)}return e},{updateRequired:false,parameters:[]})}function f(e,a){var r=n.get(["params",c.VARIANT_TECHNICAL_PARAMETER],e);if(r){var t=u(r,a);if(t.updateRequired){d.update({updateURL:!a._bDesignTimeMode,parameters:t.parameters,updateHashEntry:true,model:a})}}}function v(e,a){try{var t=e.getUShellService("URLParsing");if(t){var n=t.parseShellHash(a);f(n,e)}}catch(e){r.error(e.message)}var o=e.getUShellService("ShellNavigation");return o&&o.NavigationFilterStatus.Continue}function h(e){var a=e.getUShellService("ShellNavigation");if(!p[e.sFlexReference]){p[e.sFlexReference]=v.bind(null,e);if(a){a.registerNavigationFilter(p[e.sFlexReference])}}}function R(e){var a=e.getUShellService("ShellNavigation");if(a){a.unregisterNavigationFilter(p[e.sFlexReference]);delete p[e.sFlexReference]}}function A(e){var t=e.model;var n=t.getUShellService("URLParsing");var o=t.getUShellService("CrossApplicationNavigation");var i=n&&n.parseShellHash(s.getHash());if(i&&i.params){var l=a.getTechnicalParametersForComponent(t.oAppComponent);if(!l){r.warning("Component instance not provided, so technical parameters in component data and browser history remain unchanged")}if(e.parameters.length===0){delete i.params[c.VARIANT_TECHNICAL_PARAMETER];l&&delete l[c.VARIANT_TECHNICAL_PARAMETER]}else{i.params[c.VARIANT_TECHNICAL_PARAMETER]=e.parameters;l&&(l[c.VARIANT_TECHNICAL_PARAMETER]=e.parameters)}if(e.silent){s.changed.active=false;s.replaceHash(n.constructShellHash(i));s.changed.active=true}else{o.toExternal({target:{semanticObject:i.semanticObject,action:i.action,context:i.contextRaw},params:i.params,appSpecificRoute:i.appSpecificRoute,writeHistory:false})}}}function g(e){var a={index:-1};var r=e.model;var n=r.getUShellService("URLParsing");var o=n&&n.parseShellHash(s.getHash()).params;if(o){a.parameters=[];if(r._bDesignTimeMode){o[c.VARIANT_TECHNICAL_PARAMETER]=d.getStoredHashParams(e)}if(Array.isArray(o[c.VARIANT_TECHNICAL_PARAMETER])){o[c.VARIANT_TECHNICAL_PARAMETER]=o[c.VARIANT_TECHNICAL_PARAMETER].map(decodeURIComponent);o[c.VARIANT_TECHNICAL_PARAMETER].some(function(t,n){var o=m.getVariant({vmReference:e.vmReference,vReference:t,reference:r.oChangePersistence.getComponentName()});if(o){a.index=n;return true}})}}return t(a,o&&o[c.VARIANT_TECHNICAL_PARAMETER]&&{parameters:o[c.VARIANT_TECHNICAL_PARAMETER]})}d.variantTechnicalParameterName="sap-ui-fl-control-variant-id";d.initialize=function(e){var a=e.model;var r=a.getUShellService("URLParsing");var t=r&&r.parseShellHash(s.getHash());var n=t&&t.params&&t.params[c.VARIANT_TECHNICAL_PARAMETER];d.attachHandlers(e);d.update({model:a,parameters:n,updateHashEntry:Array.isArray(n)&&n.length>0});f(t,a)};d.updateVariantInURL=function(e){var a=d.removeURLParameterForVariantManagement(e);if(!a.parameters){return}var r=a.parameters||[];var t=a.index;var n=e.newVReference===e.model.oData[e.vmReference].defaultVariant;if(!n){if(t===-1){r=r.concat([e.newVReference])}else{r=r.slice(0,t).concat([e.newVReference],r.slice(t))}}if(!n||t>-1){d.update({parameters:r,updateURL:!e.model._bDesignTimeMode,updateHashEntry:true,model:e.model})}};d.removeURLParameterForVariantManagement=function(e){var a=g(e);if(a.index>-1){a.parameters.splice(a.index,1)}return a};d.attachHandlers=function(a){function r(){return a.model._oVariantSwitchPromise.then(function(){a.model._oHashData.controlPropertyObservers.forEach(function(e){e.destroy()});R(a.model);a.model.resetMap(true).then(a.model.destroy.bind(a.model));a.model.oComponentDestroyObserver.unobserve(a.model.oAppComponent,{destroy:true});a.model.oComponentDestroyObserver.destroy()})}h(a.model);if(!a.model.oComponentDestroyObserver&&a.model.oAppComponent instanceof e){a.model.oComponentDestroyObserver=new i(r.bind(null));a.model.oComponentDestroyObserver.observe(a.model.oAppComponent,{destroy:true})}};d.registerControl=function(e){if(e.updateURL){e.model._oHashData.variantControlIds.push(e.vmReference)}};d.update=function(e){if(!e.model._oHashData){e.model._oHashData={hashParams:[],controlPropertyObservers:[],variantControlIds:[]}}if(!e||!Array.isArray(e.parameters)){r.info("Variant URL parameters could not be updated since invalid parameters were received");return}if(e.updateURL){A(e)}if(e.updateHashEntry&&!o(e.model)){e.model._oHashData.hashParams=e.parameters}};d.getStoredHashParams=function(e){return Array.prototype.slice.call(e.model._oHashData.hashParams)};d.handleModelContextChange=function(e){var a="modelContextChange";function r(a,r){var t=r.model.getVariantManagementReferenceForControl(a.getSource());var n=r.model._oHashData.variantControlIds;var o=n.indexOf(t);if(o>-1){n.slice(o).forEach(function(a){if(g({vmReference:a,model:e.model}).index===-1){r.model.switchToDefaultForVariantManagement(a)}})}}var t=new i(function(t){if(t.current===true&&t.old===false){t.object.attachEvent(a,{model:e.model},r)}else if(t.current===false&&t.old===true){t.object.detachEvent(a,r)}});t.observe(e.vmControl,{properties:["resetOnContextChange"]});e.model._oHashData.controlPropertyObservers.push(t);if(e.vmControl.getResetOnContextChange()!==false){e.vmControl.attachEvent(a,{model:e.model},r)}};d.clearAllVariantURLParameters=function(e){d.update({updateURL:true,parameters:[],updateHashEntry:false,model:e.model})};return d});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/controlVariants/Utils",["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Core","sap/ui/fl/Variant","sap/ui/fl/Utils"],function(t,e,n,r){"use strict";function a(t,e){if(!e){return undefined}if(t.indexOf(e.getId())>-1){return e.getId()}return a(t,e.getParent())}function o(t,n){var a=r.getAppComponentForControl(t);var o=a.getRootControl();var i=[];if(!n&&o.getDomRef()){i=Array.from(o.getDomRef().querySelectorAll(".sapUiFlVarMngmt"))}if(n||i.length===0){i=Array.from(e.getStaticAreaRef().querySelectorAll(".sapUiFlVarMngmt"))}return i.map(function(t){return t.id})}var i={DEFAULT_AUTHOR:"SAP",VARIANT_TECHNICAL_PARAMETER:"sap-ui-fl-control-variant-id",compareVariants:function(t,e){if(t.content.content.title.toLowerCase()<e.content.content.title.toLowerCase()){return-1}else if(t.content.content.title.toLowerCase()>e.content.content.title.toLowerCase()){return 1}return 0},getIndexToSortVariant:function(t,e){var n=t.length;t.some(function(t,r){if(i.compareVariants(e,t)<0){n=r;return true}});return n},createVariant:function(e){var r;var a;var o=e.variantSpecificData.content.variantManagementReference;if(o){var i=t.checkControlId(o,e.model.oAppComponent);if(!i){throw new Error("Generated ID attribute found - to offer flexibility a stable VariantManagement ID is needed to assign the changes to, but for this VariantManagement control the ID was generated by SAPUI5 "+o)}}e.variantSpecificData.content.reference=e.model.sFlexReference;e.variantSpecificData.content.packageName="$TMP";a=n.createInitialFileContent(e.variantSpecificData);r=new n(a);return r},getRelevantVariantManagementControlId:function(t,n,r){var i={};if(!n||!n.length){n=o(t,r)}var c=n.reduce(function(t,n){var r=e.byId(n);var a=r.getFor();a.forEach(function(t){i[t]=n});return t.concat(a)},[]);var f=a(c,t);return i[f]},belongsToVariantManagement:function(t){var e=o(t);return!!i.getRelevantVariantManagementControlId(t,e)},getAllVariantManagementControlIds:function(t){return o(t)}};return i});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/CompVariant",["sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/registry/Settings","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,t,n,i,a,r,s){"use strict";function o(e){var t=a.getInstanceOrUndef();var n=t&&t.getUserId();return!n||n.toUpperCase()===e.toUpperCase()}function u(e,t,n,s){if(t){return s||e===t}else if(e===i.USER){return true}var u=a.getInstanceOrUndef();if(r.isSapUiLayerParameterProvided()){t=r.getCurrentLayer()}else if(!t){t=u.isPublicLayerAvailable()?i.PUBLIC:i.CUSTOMER}var l=e===t;var f=u.isKeyUser()||o(n);return l&&f}function l(e){return!e||s.getCurrentLanguage()===e}function f(e,t){var n=a.getInstanceOrUndef();if(!n){return true}if(!e||!t){return true}var i=n.getSystem();var r=n.getClient();return i===e&&t===r}var c=n.extend("sap.ui.fl.apply._internal.flexObjects.Variant",{metadata:{properties:{favorite:{type:"boolean",defaultValue:false},executeOnSelection:{type:"boolean",defaultValue:false},standardVariant:{type:"boolean",defaultValue:false},contexts:{type:"object",defaultValue:{}},persisted:{type:"boolean",defaultValue:true},name:{type:"string",defaultValue:""},content:{type:"object",defaultValue:{}}},aggregations:{revertInfo:{type:"sap.ui.fl.apply._internal.flexObjects.CompVariantRevertData",multiple:true,singularName:"revertInfo",defaultValue:[]},changes:{type:"sap.ui.fl.Change",multiple:true,defaultValue:[]}}},constructor:function(e){n.apply(this,arguments);var t=e.content&&(e.content.executeOnSelect||e.content.executeOnSelection);if(e.executeOnSelection!==undefined){t=e.executeOnSelection}this.setExecuteOnSelection(t);this.setContexts(e.contexts||{});this.setContent(e.content||{});this.setName(this.getText("variantName"));if(e.layer===i.VENDOR||e.layer===i.CUSTOMER_BASE){this.setFavorite(true)}if(e.favorite!==undefined){this.setFavorite(!!e.favorite)}if(e.persisted!==undefined){this.setPersisted(!!e.persisted)}}});c.STANDARD_VARIANT_ID="*standard*";c.prototype.isRenameEnabled=function(e){return this.isEditEnabled(e)&&l(this.getOriginalLanguage())&&!this.getStandardVariant()};c.prototype.isEditEnabled=function(e){return f(this.getSourceSystem(),this.getSourceClient())&&u(this.getLayer(),e,this.getOwnerId(),true)&&(e&&r.isDeveloperLayer(e)||!this.getStandardVariant())};c.prototype.isDeleteEnabled=function(e){return f(this.getSourceSystem(),this.getSourceClient())&&u(this.getLayer(),e,this.getOwnerId())&&!this.getStandardVariant()};c.prototype.storeFavorite=function(e){if(e!==undefined){this._oDefinition.favorite=e}else{delete this._oDefinition.favorite}this.setState(t.DIRTY);this.setFavorite(e)};c.prototype.setContent=function(e){this.setProperty("content",e||{})};c.prototype.getContent=function(){return this.getProperty("content")};c.prototype.storeContent=function(e){this._oDefinition.content=e||{};this.setState(t.DIRTY);this.setContent(e)};c.prototype.storeExecuteOnSelection=function(e){if(e!==undefined){this._oDefinition.executeOnSelection=e}else{delete this._oDefinition.executeOnSelection}delete this._oDefinition.content.executeOnSelection;this.setState(t.DIRTY);this.setExecuteOnSelection(e)};c.prototype.storeName=function(e){this._oDefinition.texts.variantName.value=e;this.setState(t.DIRTY);this.setName(e)};c.prototype.storeContexts=function(e){if(e!==undefined){this._oDefinition.contexts=e}else{delete this._oDefinition.contexts}this.setContexts(e);this.setState(t.DIRTY)};c.createInitialFileContent=function(t){var i=n.createInitialFileContent(t);if(t.contexts){i.contexts=t.contexts}if(t.favorite!==undefined){i.favorite=t.favorite}if(t.executeOnSelection!==undefined){i.executeOnSelection=t.executeOnSelection}return e(i,["changeType","namespace","service","content","reference","fileName","fileType","packageName","layer","favorite","executeOnSelection","selector","texts","support","contexts"])};return c});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/States",[],function(){"use strict";return{NEW:"NEW",PERSISTED:"NONE",DELETED:"DELETE",DIRTY:"UPDATE"}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/UpdatableChange",["sap/ui/fl/Change"],function(e){"use strict";var t=e.extend("sap.ui.fl.apply._internal.flexObjects.UpdatableChange",{metadata:{aggregations:{revertInfo:{type:"sap.ui.fl.apply._internal.flexObjects.RevertData",multiple:true,singularName:"revertInfo",defaultValue:[]}}}});t.prototype.popLatestRevertInfo=function(){var e=this.getRevertInfo().pop();this.removeRevertInfo(e);return e};return t});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/FlexState",["sap/base/util/restricted/_omit","sap/base/util/each","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/Component","sap/ui/fl/apply/_internal/flexState/appDescriptorChanges/prepareAppDescriptorMap","sap/ui/fl/apply/_internal/flexState/changes/prepareChangesMap","sap/ui/fl/apply/_internal/flexState/compVariants/prepareCompVariantsMap","sap/ui/fl/apply/_internal/flexState/controlVariants/prepareVariantsMap","sap/ui/fl/apply/_internal/flexState/Loader","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,n,t,a,r,i,o,s,p,c,l,f,u,g,d){"use strict";var m={};var h={};var v={};var S={};var R;var F;var I={appDescriptorChanges:{prepareFunction:o,pathInResponse:[]},changes:{prepareFunction:s,pathInResponse:["changes"]},variants:{prepareFunction:c,pathInResponse:["variants","variantChanges","variantDependentControlChanges","variantManagementChanges"]},compVariants:{prepareFunction:p,pathInResponse:["comp.variants","comp.standardVariants","comp.defaultVariants","comp.changes"]}};var x={compVariants:{},variants:{}};function D(e){var n=i.get(e.componentId);h[e.reference].componentData=n?n.getComponentData():e.componentData}function C(e){var n=i.get(e.componentId);e.componentData=e.componentData||n.getComponentData()||{};e.manifest=e.manifest||e.rawManifest||n.getManifestObject();e.reference=e.reference||f.getFlexReference(e)}function V(e,n){if(!h[e]){throw new Error("State is not yet initialized")}if(!h[e].preparedMaps[n]){var t={unfilteredStorageResponse:h[e].unfilteredStorageResponse,storageResponse:h[e].storageResponse,componentId:h[e].componentId,componentData:h[e].componentData};h[e].preparedMaps[n]=m.callPrepareFunction(n,t)}return h[e].preparedMaps[n]}function y(e){return V(e,"appDescriptorChanges")}function M(e){return V(e,"changes")}function U(e){return V(e,"variants")}function b(e){return V(e,"compVariants")}function L(e){if(e.reference.endsWith(".Component")){var n=e.reference.split(".");n.pop();var a=n.join(".");h[a]=t({},{storageResponse:{changes:u.getEmptyFlexDataResponse()},unfilteredStorageResponse:{changes:u.getEmptyFlexDataResponse()},preparedMaps:{},componentId:e.componentId,partialFlexState:e.partialFlexState});S[a]=S[e.reference]}}function P(e){var r=t({},e);var i=r.changes;var o=A("URLParsing");if(g.isLayerFilteringRequired(o)){n(I,function(e,n){n.pathInResponse.forEach(function(e){a.set(e,g.filterChangeDefinitionsByMaxLayer(a.get(e,i),o),i)})})}return r}function z(e){S[e.reference]=l.loadFlexData(e).then(function(n){h[e.reference]=t({},{unfilteredStorageResponse:n,preparedMaps:{},componentId:e.componentId,componentData:e.componentData,partialFlexState:e.partialFlexState});L(e);N(e.reference);return n});return S[e.reference]}function N(e){var n=A("ShellNavigation");if(n){v[e]=j.bind(null,e);n.registerNavigationFilter(v[e])}}function _(e){var n=A("ShellNavigation");if(n){if(v[e]){n.unregisterNavigationFilter(v[e]);delete v[e]}}}function j(e,n,t){var a=A("ShellNavigation");if(a){try{var i=g.getMaxLayerTechnicalParameter(n,A("URLParsing"));var o=g.getMaxLayerTechnicalParameter(t,A("URLParsing"));if(i!==o){m.clearFilteredResponse(e)}}catch(e){r.error(e.message)}return a.NavigationFilterStatus.Continue}return undefined}function E(e){h[e].preparedMaps={}}function O(e){var n=h[e.reference];if(n.partialFlexState===true&&e.partialFlexState!==true){n.partialFlexState=false;e.partialFlexData=t({},n.unfilteredStorageResponse.changes);e.reInitialize=true}return e}function k(e){var n=h[e.reference].componentId;if(!e.reInitialize&&n!==e.componentId){e.reInitialize=true}return e}function w(){return Promise.all([d.getUShellService("ShellNavigation"),d.getUShellService("URLParsing")]).then(function(e){R=e[0];F=e[1]}).catch(function(e){r.error("Error getting service from Unified Shell: "+e.message)})}function A(e){if(d.getUshellContainer()){if(e==="ShellNavigation"){return R}else if(e==="URLParsing"){return F}}return undefined}m.initialize=function(e){return w().then(function(){C(e);var n=e.reference;if(S[n]){return S[n].then(O.bind(null,e)).then(k).then(function(e){return e.reInitialize?z(e):h[n].unfilteredStorageResponse})}return z(e)}).then(function(e,n){if(!h[e.reference].storageResponse){h[e.reference].storageResponse=P(n);D(e)}}.bind(null,e))};m.clearAndInitialize=function(e){C(e);m.clearState(e.reference);m.clearState(d.normalizeReference(e.reference));return m.initialize(e)};m.clearState=function(e){if(e){_(e);delete h[e];delete S[e]}else{Object.keys(h).forEach(function(e){_(e)});h={};S={}}};m.setInitialNonFlCompVariantData=function(e,n,t,a){x.compVariants[e]={};x.compVariants[e][n]={};x.compVariants[e][n].standardVariant=t;x.compVariants[e][n].variants=a};m.getInitialNonFlCompVariantData=function(e){return x.compVariants[e]};m.setFakeStandardVariant=function(e,n,a){var r=m.getVariantsState(e);if(!r[Object.keys(a)[0]]){t(r,a);x.variants[e]=x.variants[e]||{};x.variants[e][n]=x.variants[e][n]||{};t(x.variants[e][n],a)}};m.resetFakedStandardVariants=function(e,n){if(x.variants[e]){delete x.variants[e][n]}};m.clearFilteredResponse=function(e,n){if(h[e]&&(!n||n===h[e].componentId)){E(e);delete h[e].storageResponse}};m.getUIChanges=function(e){return M(e).changes};m.getAppDescriptorChanges=function(e){return y(e).appDescriptorChanges};m.getVariantsState=function(e){var t=U(e);if(x.variants[e]){n(x.variants[e],function(a,r){if(h[e].componentId===a){n(r,function(e,n){if(!t[e]){t[e]=n}})}})}return t};m.getUI2Personalization=function(e){return h[e].unfilteredStorageResponse.changes.ui2personalization};m.getCompVariantsMap=function(e){return b(e)};m.callPrepareFunction=function(e,n){return I[e].prepareFunction(n)};m.getStorageResponse=function(e){if(S[e]){return S[e].then(function(){return h[e].unfilteredStorageResponse})}};m.getFlexObjectsFromStorageResponse=function(e){return h[e]&&h[e].unfilteredStorageResponse.changes};return m});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/Loader",["sap/base/util/deepClone","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/initial/_internal/Storage","sap/ui/fl/Utils"],function(e,n,t,a){"use strict";function i(e){if(typeof e==="string"){e={id:e}}e.idIsLocal=true;return e}function r(e,n){if(e){[n.changes,n.variantChanges,n.variantDependentControlChanges,n.variantManagementChanges].forEach(function(e){e.forEach(function(e){if(!e.selector.idIsLocal){e.selector=i(e.selector);if(e.dependentSelector){Object.keys(e.dependentSelector).forEach(function(n){e.dependentSelector[n]=e.dependentSelector[n].map(i)})}}})})}return n}function o(e){return e&&!!n.getOvpEntry(e)}function c(e){return{changes:e,cacheKey:e.cacheKey}}return{loadFlexData:function(e){var i=n.getBaseComponentNameFromManifest(e.manifest);if(e.partialFlexData){return t.completeFlexData({reference:e.reference,componentName:i,partialFlexData:e.partialFlexData}).then(c)}var l=e.reInitialize?undefined:n.getCacheKeyFromAsyncHints(e.reference,e.asyncHints);return t.loadFlexData({reference:e.reference,componentName:i,cacheKey:l,siteId:a.getSiteIdByComponentData(e.componentData),appDescriptor:e.manifest.getRawJson?e.manifest.getRawJson():e.manifest,version:e.version,allContexts:e.allContexts}).then(r.bind(undefined,o(e.manifest))).then(c)}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/ManifestUtils",["sap/ui/fl/Utils"],function(e){"use strict";function t(e){if(e&&e.indexOf(".Component")<0){e+=".Component"}return e}function n(e){var t;e.requests.some(function(e){if(e.name==="sap.ui.fl.changes"){t=e}});return t}var r={getFlexReferenceForControl:function(t){var n=e.getAppComponentForControl(t);return r.getFlexReference({manifest:n.getManifest(),componentData:n.getComponentData()})},getFlexReference:function(n){var r=n.manifest;var a=n.componentData||{};if(a.startupParameters){if(Array.isArray(a.startupParameters["sap-app-id"])){return a.startupParameters["sap-app-id"][0]}}var i=r.getEntry?r.getEntry("sap.ui5"):r["sap.ui5"];if(i){if(i.appVariantId){return i.appVariantId}if(i.componentName){return t(i.componentName)}}return t(e.getAppIdFromManifest(r))},getOvpEntry:function(e){return e.getEntry?e.getEntry("sap.ovp"):e["sap.ovp"]},getCacheKeyFromAsyncHints:function(e,t){if(t&&t.requests&&Array.isArray(t.requests)){var r=n(t);if(r&&r.reference===e){return r.cachebusterToken||"<NO CHANGES>"}}},getChangeManifestFromAsyncHints:function(e){if(e&&e.requests&&Array.isArray(e.requests)){var t=n(e);if(t){return false}}return true},getBaseComponentNameFromManifest:function(t){var n=t.getEntry?t.getEntry("sap.ui5"):t["sap.ui5"];return n&&n.componentName||e.getAppIdFromManifest(t)},isFlexExtensionPointHandlingEnabled:function(t){var n=e.getAppComponentForControl(t);return!!(n&&n.getManifestEntry("sap.ui5")&&n.getManifestEntry("sap.ui5").flexExtensionPointEnabled)}};return r});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/appDescriptorChanges/prepareAppDescriptorMap",["sap/ui/fl/Change"],function(e){"use strict";return function(p){var r=p.storageResponse.changes.appDescriptorChanges||[];var a=r.map(function(p){return new e(p)});return{appDescriptorChanges:a}}});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler",["sap/base/util/includes","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/Utils"],function(e,n,t){"use strict";var d="sap.ui.fl:PendingChange";var i={};function c(e,t){return n.getControlIdBySelector(e,t)}function s(e){return{changeObject:e,dependencies:[],controlsDependencies:[],dependentIds:[]}}function a(e,n,t){r(t,n,e);o(t,n)}function o(n,t){if(!e(n.aChanges,t)){n.aChanges.push(t)}}function r(n,t,d){if(!n.mChanges[d]){n.mChanges[d]=[]}if(!e(n.mChanges[d],t)){n.mChanges[d].push(t)}}function p(e,n,t){var d=e.getSelector();if(d){if(d.id){a(c(d,n),e,t)}else{o(t,e)}}return t.aChanges}function u(e,n){return e.some(function(e){return e.id===n.id&&e.idIsLocal===n.idIsLocal})}function f(e,n,t,d,i,s,a){var o=t.getDependentSelectorList();n.some(function(n){if(u(o,n)){var r=c(n,i);var p=d&&s.indexOf(e)<s.indexOf(t);if(p){g(t,e,r,a,true)}else{g(e,t,r,a)}return true}})}function h(e,n,t,d){if(e.isValidForDependencyMap()){var i=e.getDependentSelectorList();l(e,i,n,d);var c=t.indexOf(e);var s=c<t.length-1;var a=t.slice();a.splice(c,1);a.reverse().forEach(function(c){if(c.isValidForDependencyMap()){f(e,i,c,s,n,t,d)}})}}function l(e,n,t,d){if(n.length){var i=n.map(function(e){return c(e,t)});if(!d.mDependencies[e.getId()]){d.mDependencies[e.getId()]=s(e)}d.mDependencies[e.getId()].controlsDependencies=i;i.forEach(function(n){d.mControlsWithDependencies[n]=d.mControlsWithDependencies[n]||[];d.mControlsWithDependencies[n].push(e.getId())})}}function g(n,t,d,i,c){if(m(n,t,d,i,c)){i.mDependencies[n.getId()].dependencies.push(t.getId());if(!e(i.mDependencies[n.getId()].dependentIds,d)){i.mDependencies[n.getId()].dependentIds.push(d)}if(!i.mDependentChangesOnMe[t.getId()]){i.mDependentChangesOnMe[t.getId()]=[]}i.mDependentChangesOnMe[t.getId()].push(n.getId())}}function m(n,t,d,i,c){var s=!c&&e(i.mDependencies[n.getId()].dependentIds,d);var a=false;if(i.mDependentChangesOnMe[t.getId()]){i.mDependentChangesOnMe[t.getId()].some(function(t){a=e(i.mDependencies[n.getId()].dependencies,t);return a})}return!s&&!a}function D(e,n){var c=[];var s=[];var a=[];if(e.dependencyRemovedInLastBatch[n]){e.dependencyRemovedInLastBatch[n].forEach(function(n){var t=e.mDependencies[n];if(t&&t.dependencies.length===0&&!(t.controlsDependencies&&t.controlsDependencies.length)){s.push(n);c.push(t.changeObject.getId());if(t[d]){a.push(function(){return t[d]()})}}})}return t.execPromiseQueueSequentially(a).then(function(n,t,d){delete e.dependencyRemovedInLastBatch[d];t.forEach(function(n){delete e.mDependencies[n]});n.forEach(function(n){i.resolveDependenciesForChange(e,n,d)});return!!n.length}.bind(undefined,c,s,n))}i.createEmptyDependencyMap=function(){return{aChanges:[],mChanges:{},mDependencies:{},mDependentChangesOnMe:{},mControlsWithDependencies:{},dependencyRemovedInLastBatch:{}}};i.addChangeAndUpdateDependencies=function(e,n,t){var d=p(e,n,t);h(e,n,d,t)};i.insertChange=function(e,n,t){var d=n&&n.aChanges&&n.aChanges.indexOf(t);if(d>-1){n.aChanges.splice(d+1,0,e)}};i.addRuntimeChangeAndUpdateDependencies=function(e,n,t,d){var i=p(e,n,t);h(e,n,i,d)};i.processDependentQueue=function(e,n,t){return D(e,t).then(function(t,d){if(d){return i.processDependentQueue(e,n,t)}}.bind(undefined,t))};i.addChangeApplyCallbackToDependency=function(e,n,t){e.mDependencies[n][d]=t};i.removeControlsDependencies=function(n,t){var d=n.mControlsWithDependencies[t];if(d){d.forEach(function(d){var i=n.mDependencies[d];if(i&&i.controlsDependencies&&i.controlsDependencies.length){var c=i.controlsDependencies.indexOf(t);if(c>-1){i.controlsDependencies.splice(c,1);delete n.mControlsWithDependencies[t];n.dependencyRemovedInLastBatch[t]=n.dependencyRemovedInLastBatch[t]||[];if(!e(n.dependencyRemovedInLastBatch[t],d)){n.dependencyRemovedInLastBatch[t].push(d)}}}});delete n.mControlsWithDependencies[t]}};i.resolveDependenciesForChange=function(n,t,d){var i=n.mDependentChangesOnMe[t];if(i){i.forEach(function(i){var c=n.mDependencies[i];var s=c?c.dependencies.indexOf(t):-1;if(s>-1){c.dependencies.splice(s,1);n.dependencyRemovedInLastBatch[d]=n.dependencyRemovedInLastBatch[d]||[];if(!e(n.dependencyRemovedInLastBatch[d],i)){n.dependencyRemovedInLastBatch[d].push(i)}}});delete n.mDependentChangesOnMe[t]}};i.removeChangeFromMap=function(e,n){Object.keys(e.mChanges).some(function(t){var d=e.mChanges[t];var i=d.map(function(e){return e.getId()}).indexOf(n);if(i!==-1){d.splice(i,1);return true}});var t=e.aChanges.map(function(e){return e.getId()}).indexOf(n);if(t!==-1){e.aChanges.splice(t,1)}};i.removeChangeFromDependencies=function(e,n,t){i.resolveDependenciesForChange(e,n,t);delete e.mDependencies[n]};i.checkForOpenDependenciesForControl=function(e,t,d){return Object.keys(e.mDependencies).some(function(i){return e.mDependencies[i].changeObject.getDependentSelectorList().some(function(e){return n.getControlIdBySelector(e,d)===t})})};return i});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/changes/prepareChangesMap",["sap/ui/fl/Change"],function(e){"use strict";return function(n){var a=n.storageResponse.changes.changes;var r=a.map(function(n){return new e(n)});return{changes:r}}});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantMerger",["sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/base/Log"],function(e,t){"use strict";var n={addFavorite:function(e){e.setFavorite(true)},removeFavorite:function(e){e.setFavorite(false)},updateVariant:function(e,t){var n=t.getContent();if(n.executeOnSelection!==undefined){e.setExecuteOnSelection(n.executeOnSelection)}if(n.favorite!==undefined){e.setFavorite(n.favorite)}if(n.contexts){e.setContexts(n.contexts)}if(n.variantContent){e.setContent(n.variantContent)}var a=t.getText("variantName");if(a){e.setName(a)}},standardVariant:function(e,t){e.setExecuteOnSelection(t.getContent().executeOnSelect)}};function a(e){var t={};e.changes.forEach(function(e){var n=e.getSelector().variantId||e.getContent().key;if(!t[n]){t[n]=[]}t[n].push(e)});return t}function i(e,n){t.error("No change handler for change with the ID '"+n.getId()+"' and type '"+n.getChangeType()+"' defined.\n"+"The variant '"+e.getId()+"'was not modified'")}function r(t,n){var a={fileName:n.id||e.STANDARD_VARIANT_ID,persisted:n.persisted,content:n.content||{},texts:{variantName:{value:n.name||""}},selector:{persistencyKey:t}};if(n.favorite!==undefined){a.favorite=n.favorite}if(n.executeOnSelection!==undefined){a.executeOnSelection=n.executeOnSelection}return new e(a)}function o(e,t){var a=n[t.getChangeType()]||i;a(e,t);e.addChange(t)}function f(e,t){var n=t.getId();if(e[n]){e[n].forEach(function(e){o(t,e)})}}return{merge:function(e,t,n){var i=t.nonPersistedVariants.concat(t.variants);var o=a(t);var c;i.forEach(function(e){if(e.getContent()&&e.getContent().standardvariant){c=e}});if(!c){c=r(e,n)}else{i=i.filter(function(e){return!e.getContent()||!e.getContent().standardvariant})}i.forEach(f.bind(undefined,o));c.setFavorite(true);c.setStandardVariant(true);t.byId[c.getId()]=c;var d=t.standardVariantChange;if(d){o[c.getId()]=o[c.getId()]||[];o[c.getId()].push(d);o[c.getId()].sort(function(e,t){if(e.getDefinition().creation<t.getDefinition().creation){return-1}if(e.getDefinition().creation>t.getDefinition().creation){return 1}return 0})}f(o,c);t.standardVariant=c;return{standardVariant:c,variants:i}},createVariant:function(e,t){return r(e,t)},applyChangeOnVariant:o}});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/compVariants/prepareCompVariantsMap",["sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexObjects/UpdatableChange","sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantMerger"],function(a,n,e,t){"use strict";function r(a,n){a[n]=a[n]||{byId:{},variants:[],nonPersistedVariants:[],changes:[],defaultVariants:[],standardVariantChange:undefined,standardVariant:undefined};return a[n]}function i(a,n,e){e=e||[];var i=r(a,n);i.nonPersistedVariants.forEach(function(a){delete i.byId[a.getId()]});i.nonPersistedVariants=e.map(function(a){var e=Object.assign({id:a.id,persisted:false},a);e=t.createVariant(n,e);i.byId[a.id]=e;return e});return i}function s(t,i,s){var d=i==="variants"?a:e;var p=t[i].map(function(a){var e=new d(a);e.setState(n.PERSISTED);return e});p.forEach(function(a){var n=a.getSelector().persistencyKey;r(s,n).byId[a.getId()]=a;switch(i){case"standardVariants":r(s,n).standardVariantChange=a;break;default:r(s,n)[i].push(a)}})}return function(a){var n={};n._getOrCreate=r.bind(undefined,n);n._initialize=i.bind(undefined,n);if(a.storageResponse.changes.comp){["variants","changes","defaultVariants","standardVariants"].forEach(function(e){s(a.storageResponse.changes.comp,e,n)})}return n}});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/controlVariants/Switcher",["sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/changes/Reverter"],function(e,n,r){"use strict";function t(r){var t=n.getControlChangesForVariant(Object.assign(e(r,["vmReference","variantsMap","reference"]),{changeInstance:true,vReference:r.currentVReference}));var a=n.getControlChangesForVariant(Object.assign(e(r,["vmReference","variantsMap","reference"]),{changeInstance:true,vReference:r.newVReference}));var i=Object.keys(r.changesMap).reduce(function(e,n){return e.concat(r.changesMap[n])},[]);var c=i.map(function(e){return e.getId()});var s=t.reduce(function(e,n){var r=c.indexOf(n.getId());if(r>-1){e=e.concat(i[r])}return e},[]);var o=[];if(a.length>0){o=s.slice();s.some(function(e){if(a[0]&&e.getId()===a[0].getId()){a.shift();o.shift()}else{return true}})}else{o=s}var l={changesToBeReverted:o.reverse(),changesToBeApplied:a};return l}var a={switchVariant:function(e){return Promise.resolve().then(function(){e.changesMap=e.flexController._oChangePersistence.getChangesMapForComponent().mChanges;e.variantsMap=n.getContent(e.reference);var a=t(e);return r.revertMultipleChanges(a.changesToBeReverted,e).then(e.flexController.applyVariantChanges.bind(e.flexController,a.changesToBeApplied,e.appComponent)).then(n.setCurrentVariant.bind(null,e))})}};return a});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState",["sap/base/util/restricted/_omit","sap/base/util/restricted/_pick","sap/base/util/includes","sap/base/util/isEmptyObject","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/Change","sap/ui/fl/LayerUtils","sap/ui/fl/Utils","sap/ui/fl/Variant"],function(e,n,t,a,r,i,c,o,f,s,u,l,g,v){"use strict";var d={};function p(e){var n=[];if(e.variantData.content.variantReference){n=d.getControlChangesForVariant(Object.assign(e,{vReference:e.variantData.content.variantReference,changeInstance:true}));return n.filter(function(n){return l.compareAgainstCurrentLayer(n.getDefinition().layer,e.variantData.content.layer)===-1})}return n}function h(e){var n=d.getContent(e.reference);var t=r.get([e.vmReference,"variants"],n);return t||[]}function C(e,n,t){var a=n.changeType;if(!e){e={}}if(!e[a]){e[a]=[]}if(t){e[a].push(n);return true}return e[a].some(function(t,r){if(t.fileName===n.fileName){e[a].splice(r,1);return true}})}function m(e,n){var t=R(e);n[t].push(e)}function V(e,n){var t=R(e);var a=-1;n[t].some(function(n,t){if(n.fileName===e.fileName){a=t;return true}});if(a>-1){n[t].splice(a,1)}}function R(e){switch(e.fileType){case"change":return"variantDependentControlChanges";case"ctrl_variant":return"variants";case"ctrl_variant_change":return"variantChanges";case"ctrl_variant_management_change":return"variantManagementChanges";default:}}d.getContent=function(e){return s.getVariantsState(e)};d.addFakeStandardVariant=function(e,n,t){s.setFakeStandardVariant(e,n,t)};d.clearFakedStandardVariants=function(e,n){s.resetFakedStandardVariants(e,n)};d.resetContent=function(e,n){s.clearFilteredResponse(e,n)};d.getControlChangesForVariant=function(e){var n=[];var t=d.getVariant(e);if(t){n=t.controlChanges.filter(function(n){return e.includeDirtyChanges!==false||n.getState()===u.states.PERSISTED});if(!e.changeInstance){n=n.map(function(e){return e.getDefinition()})}}return n};d.getVariantChangesForVariant=function(e){var n=d.getVariant(e);return n&&n.variantChanges||{}};d.getVariant=function(e){var n;var t=d.getContent(e.reference);e.vReference=e.vReference||t[e.vmReference].defaultVariant;var a=h(e);a.some(function(t){if(t.content.fileName===e.vReference){n=t;return true}});return n};d.getCurrentVariantReference=function(e){var n=d.getContent(e.reference);var t=n[e.vmReference];return t.currentVariant||t.defaultVariant};d.getVariantManagementReferences=function(e){var n=d.getContent(e);return Object.keys(n)};d.addVariantToVariantManagement=function(e){var n=d.getContent(e.reference);var t=n[e.vmReference].variants.slice().splice(1);var a=o.getIndexToSortVariant(t,e.variantData);if(e.variantData.content.variantReference){var r=p(e);e.variantData.controlChanges=r.concat(e.variantData.controlChanges)}n[e.vmReference].variants.splice(a+1,0,e.variantData);return a+1};d.removeVariantFromVariantManagement=function(e){var n;var t=d.getContent(e.reference);var a=t[e.vmReference].variants.some(function(t,a){var r=new v(t);if(r.getId()===e.variant.getId()){n=a;return true}});if(a){t[e.vmReference].variants.splice(n,1)}return n};d.setVariantData=function(e){var n=d.getContent(e.reference);var t=n[e.vmReference].variants;var a=t[e.previousIndex];Object.keys(e.variantData).forEach(function(n){if(a.content.content[n]){a.content.content[n]=e.variantData[n]}});if(a.content.fileName!==e.vmReference){t.splice(e.previousIndex,1);var r=o.getIndexToSortVariant(t.slice(1),a);t.splice(r+1,0,a);return r+1}t.splice(e.previousIndex,1,a);return e.previousIndex};d.addChangeToVariant=function(e){var n=d.getControlChangesForVariant(Object.assign(e,{changeInstance:true}));var a=n.map(function(e){return e.getDefinition().fileName});if(!t(a,e.change.getDefinition().fileName)){var r=d.getVariant(e);r.controlChanges=n.concat([e.change]);return true}return false};d.removeChangeFromVariant=function(e){var n=d.getControlChangesForVariant(Object.assign(e,{changeInstance:true}));var t=d.getVariant(e);var a=false;if(t){t.controlChanges=n.filter(function(n){if(!a&&n.getId()===e.change.getId()){a=true;return false}return true})}return a};d.getInitialChanges=function(e){var n=d.getContent(e.reference);return Object.keys(n).reduce(function(t,a){if(e.vmReference&&e.vmReference===a||!e.vmReference){var r=n[a].currentVariant?"currentVariant":"defaultVariant";var i=Object.assign({},e,{vmReference:a,vReference:n[a][r],includeDirtyChanges:false});return t.concat(d.getControlChangesForVariant(i))}return t},[])};d.fillVariantModel=function(e){var n=d.getContent(e.reference);return Object.keys(n).reduce(function(t,a){t[a]={defaultVariant:n[a].defaultVariant,variants:[]};if(n[a].currentVariant){t[a].currentVariant=n[a].currentVariant}h(Object.assign(e,{vmReference:a})).forEach(function(e,n){t[a].variants[n]=JSON.parse(JSON.stringify({key:e.content.fileName,title:e.content.content.title,layer:e.content.layer,favorite:e.content.content.favorite,executeOnSelect:e.content.content.executeOnSelect,visible:e.content.content.visible,author:r.get("content.support.user",e)}))});return t},{})};d.updateChangesForVariantManagementInMap=function(e){var n=d.getContent(e.reference);var t=n[e.vmReference];if(e.changeContent.fileType==="ctrl_variant_change"){t.variants.some(function(n){if(n.content.fileName===e.changeContent.selector.id){C(n.variantChanges,e.changeContent,e.add)}})}else if(e.changeContent.fileType==="ctrl_variant_management_change"){C(t.variantManagementChanges,e.changeContent,e.add)}};d.setCurrentVariant=function(e){var n=d.getContent(e.reference);if(r.get([e.vmReference],n)){n[e.vmReference].currentVariant=e.newVReference}};d.updateVariantsState=function(e){var n=d.getContent(e.reference);if(a(n)){i.error("Variant state is not initialized yet");return}var t=s.getFlexObjectsFromStorageResponse(e.reference);if(e.changeToBeAddedOrDeleted){switch(e.changeToBeAddedOrDeleted.getState()){case f.NEW:m(e.changeToBeAddedOrDeleted.getDefinition(),t);break;case f.DELETE:V(e.changeToBeAddedOrDeleted.getDefinition(),t);break;default:}}};d.waitForInitialVariantChanges=function(e){var n=d.getInitialChanges({vmReference:e.vmReference,reference:e.reference,changeInstance:true});var t=n.reduce(function(e,n){if(g.indexOfObject(e,n.getSelector())===-1){e.push(n.getSelector())}return e},[]);var a=[];t.map(function(n){var t=c.bySelector(n,e.appComponent);if(t){a.push(t)}});return e.flexController.waitForChangesToBeApplied(a)};return d});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/controlVariants/prepareVariantsMap",["sap/base/util/ObjectPath","sap/base/Log","sap/ui/fl/Change","sap/base/util/includes","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/base/util/isEmptyObject","sap/base/util/each","sap/base/util/values","sap/base/util/merge","sap/ui/fl/LayerUtils"],function(e,t,n,a,r,i,c,o,s,u){"use strict";function f(e,t){var n=s({},e);t.forEach(function(e){n[e.fileName]={content:e,controlChanges:[],variantChanges:{}}});return n}function l(e,t){var a=s({},e);t.forEach(function(e){var t=new n(e);t.setState(n.states.PERSISTED);a[e.variantReference]=a[e.variantReference]||A(e.variantReference);a[e.variantReference].controlChanges.push(t)});return a}function v(e,t){var n=s({},e);t.forEach(function(e){n[e.selector.id]=n[e.selector.id]||A(e.selector.id);var t=n[e.selector.id].variantChanges[e.changeType]||[];t.push(e);n[e.selector.id].variantChanges[e.changeType]=t});return n}function g(t){var n=s({},t);o(t).forEach(function(t){var a=e.get("variantChanges.setVisible",t);if(a&&a.length>0){var r=M(a);if(!r.getContent().visible&&r.getContent().createdByReset){delete n[t.content.fileName]}}});return n}function h(e){var t=s({},e);o(t).forEach(function(e){var n=e.content.variantReference;var a;if(n){a=C(t,n,e.content.variantManagementReference)}e.controlChanges=p(a,e.content.layer).concat(e.controlChanges)});return t}function p(e,t){if(!e){return[]}return o(s({},e.controlChanges)).filter(function(e){return u.compareAgainstCurrentLayer(e.getLayer(),t)===-1})}function C(e,t,n){var a=e[t];if(!a&&t===n){a=A(t);e[t]=a}return a}function b(e){var t={};t=f(t,e.variants);t=l(t,e.variantDependentControlChanges);t=v(t,e.variantChanges);t=g(t);t=h(t);return t}function R(){return{variantManagementChanges:{},variants:[]}}function m(e,t,n){var i=s({},e);o(t).forEach(function(e){var t=e.content.variantManagementReference;if(!i[t]){i[t]=R()}e=x(e);e=V(e);if(!i[t].currentVariant&&e.content.content.visible&&a(n,e.content.fileName)){i[t].currentVariant=e.content.fileName}i[t].defaultVariant=t;var c=r.getIndexToSortVariant(i[t].variants,e);i[t].variants.splice(c,0,e)});return i}function d(e,t){var n=s({},e);t.forEach(function(e){var t=e.selector.id;if(!n[t]){n[t]=R()}var a=e.changeType;if(!n[t].variantManagementChanges[a]){n[t].variantManagementChanges[a]=[]}n[t].variantManagementChanges[a].push(e);n[t]=y(n[t])});return n}function T(e){var t=s({},e);c(t,function(e,t){var n=t.variants.findIndex(function(t){return t.content.fileName===e});var a;if(n===-1){a=A(e)}else{a=t.variants[n];t.variants.splice(n,1)}t.variants.unshift(a)});return t}function E(e,t,n){var a={};a=m(a,e,n);a=d(a,t);a=T(a);return a}function A(e){var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");return{content:{fileName:e,variantManagementReference:e,variantReference:"",content:{title:t.getText("STANDARD_VARIANT_TITLE"),favorite:true,visible:true},support:{user:r.DEFAULT_AUTHOR}},variantChanges:{},controlChanges:[]}}function y(e){var t=s({},e);var n=t.variantManagementChanges;var a;if(!i(n)){a=M(n["setDefault"]);if(a){t.defaultVariant=a.getContent().defaultVariant}}return t}function V(e){var n=s({},e);var a=n.variantChanges;var r;c(a,function(e,a){switch(e){case"setTitle":r=M(a);if(r){n.content.content.title=r.getText("title")}break;case"setFavorite":r=M(a);if(r){n.content.content.favorite=r.getContent().favorite}break;case"setExecuteOnSelect":r=M(a);if(r){n.content.content.executeOnSelect=r.getContent().executeOnSelect}break;case"setVisible":r=M(a);if(r){n.content.content.visible=r.getContent().visible}break;default:t.error("No valid changes on variant "+n.content.content.title+" available")}});return n}function M(e){if(e.length>0){return new n(e[e.length-1])}return false}function N(e){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl").getText(e)}function x(t){var n=s({},t);if(n.content.fileName===n.content.variantManagementReference){if(!e.get("content.support.user",n)){var a={support:{user:r.DEFAULT_AUTHOR}};s(n.content,a)}}if(!n.content.content.favorite){n.content.content.favorite=true}if(!n.content.content.visible){n.content.content.visible=true}if(!n.content.content.executeOnSelect){n.content.content.executeOnSelect=false}var i=n.content.content.title.match(/.i18n>(\w+)./);if(i){n.content.content.title=N(i[1])}return n}return function(t){if(i(t)||!e.get("storageResponse.changes.variants",t)){return{}}var n=e.get(["technicalParameters",r.VARIANT_TECHNICAL_PARAMETER],t.componentData)||[];var a=b(t.storageResponse.changes);a=E(a,t.storageResponse.changes.variantManagementChanges,n);return a}});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/api/DelegateMediatorAPI",["sap/ui/fl/apply/_internal/DelegateMediator"],function(e){"use strict";var t={registerDefaultDelegate:function(t){e.registerDefaultDelegate(t)},getDelegateForControl:function(t){return e.getDelegateForControl(t.control,t.modifier,t.modelType,t.supportsDefault)},getKnownDefaultDelegateLibraries:function(){return e.getKnownDefaultDelegateLibraries()},getRequiredLibrariesForDefaultDelegate:function(t){return e.getRequiredLibrariesForDefaultDelegate(t.delegateName,t.control,t.modelType)}};return t},false);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/AddIFrame",["sap/ui/fl/changeHandler/common/revertAddedControls","sap/ui/fl/changeHandler/common/getTargetAggregationIndex","sap/ui/fl/changeHandler/common/createIFrame"],function(e,n,t){"use strict";var r={};r.applyChange=function(e,r,o){var a=o.modifier;var i=e.getDefinition();var g=o.view;var c=i.content.targetAggregation;var f;var s;return Promise.resolve().then(a.findAggregation.bind(a,r,c)).then(function(t){if(!t){throw new Error("The given Aggregation is not available in the given control: "+a.getId(r))}return n(e,r,o)}).then(function(n){f=n;return t(e,o,i.content.selector)}).then(function(e){s=e;return a.insertAggregation(r,c,s,f,g)}).then(function(){e.setRevertData([a.getId(s)])})};r.revertChange=e;r.completeChangeContent=function(e,n,t){var r=e.getDefinition();var o=t.modifier;var a=t.appComponent;["targetAggregation","baseId","url"].forEach(function(e){if(!Object.prototype.hasOwnProperty.call(n.content,e)){throw new Error("Attribute missing from the change specific content '"+e+"'")}});r.content=Object.assign(r.content||{},n.content);r.content.selector=o.getSelector(r.content.baseId,a)};r.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().selector]}};return r},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/AddXML",["sap/ui/fl/changeHandler/BaseAddXml"],function(e){"use strict";var t={};t.applyChange=function(t,n,r){var i=t.getDefinition();var g={aggregationName:i.content.targetAggregation,index:i.content.index};return e.applyChange(t,n,r,g)};t.revertChange=e.revertChange;t.completeChangeContent=function(t,n){var r=t.getDefinition();if(!r.content){r.content={}}if(n.targetAggregation){r.content.targetAggregation=n.targetAggregation}else{e._throwMissingAttributeError("targetAggregation")}if(n.index!==undefined){r.content.index=n.index}else{e._throwMissingAttributeError("index")}e.completeChangeContent(t,n,r)};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/AddXMLAtExtensionPoint",["sap/ui/fl/changeHandler/BaseAddXml"],function(e){"use strict";var n={};function t(e){var n=e.index;if(e.referencedExtensionPoint){n+=t(e.referencedExtensionPoint)}return n}n.applyChange=function(n,i,r){var o=r.view;var a=r.modifier;var u=n.getDefinition().selector;var f;return Promise.resolve().then(function(){var e=n.getExtensionPointInfo&&n.getExtensionPointInfo();if(!e){return a.getExtensionPointInfo(u.name,o)}return e}).then(function(s){f=s;if(!f){throw new Error("AddXMLAtExtensionPoint-Error: Either no Extension-Point found by name '"+(u&&u.name)+"' or multiple Extension-Points available with the given name in the view (view.id='"+(o&&a.getId(o))+"'). Multiple Extension-points with the same name in one view are not supported!")}(f.defaultContent||[]).forEach(function(e){if(e){a.destroy(e)}});f.defaultContent=[];f.index=t(f);if(a.targets==="xmlTree"){f.skipAdjustIndex=true}return e.applyChange(n,i,r,f)}).then(function(e){if(f.ready){f.ready(e)}return true})};n.revertChange=e.revertChange;n.completeChangeContent=function(n,t){e.completeChangeContent(n,t)};return n},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/Base",["sap/base/util/LoaderExtensions"],function(e){"use strict";var t={setTextInChange:function(e,t,n,r){if(!e.texts){e.texts={}}if(!e.texts[t]){e.texts[t]={}}e.texts[t].value=n;e.texts[t].type=r},instantiateFragment:function(t,n){var r=t.getModuleName();if(!r){return Promise.reject(new Error("The module name of the fragment is not set. This should happen in the backend"))}var a=n.viewId?n.viewId+"--":"";var i=t.getProjectId()||"";var o=t.getExtensionPointInfo&&t.getExtensionPointInfo()&&t.getExtensionPointInfo().fragmentId||"";var s=i&&o?".":"";var u=a+i+s+o;var f=n.modifier;var c=n.view;return Promise.resolve().then(function(){var t=e.loadResource(r,{dataType:"text"});return f.instantiateFragment(t,u,c).catch(function(e){throw new Error("The following XML Fragment could not be instantiated: "+t+" Reason: "+e.message)})})},markAsNotApplicable:function(e,t){var n={message:e};if(!t){throw n}return Promise.reject(n)}};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/BaseAddViaDelegate",["sap/ui/fl/changeHandler/Base","sap/ui/fl/apply/api/DelegateMediatorAPI","sap/base/util/merge","sap/base/util/ObjectPath"],function(e,t,n,r){"use strict";function o(e){return typeof e==="function"}function i(e){if(e.modelType){return e.modelType}else if(e.oDataServiceVersion){return"sap.ui.model.odata.v2.ODataModel"}}var a={createAddViaDelegateChangeHandler:function(a){function l(e){return e+a.fieldSuffix}function d(e,t){if(o(a[t])){return!!a[t]({changeDefinition:e})}return!!a[t]}function c(e){return d(e,"skipCreateLabel")}function u(e){return d(e,"skipCreateLayout")}function f(e,n){var r=n.modifier.bySelector(e.getSelector(),n.appComponent);var l=i(e.getDefinition().content);return t.getDelegateForControl({control:r,modifier:n.modifier,modelType:l,supportsDefault:a.supportsDefault}).then(function(t){var n=!o(t.instance.createLayout);return n||u(e.getDefinition())})}function p(e,t,r){var o=n({},t);o.fieldSelector.id=l(o.fieldSelector.id);return r.createControlForProperty(o).then(function(n){if(c(e)){return n}var o=t.modifier.getId(n.control);t.labelFor=o;return r.createLabel(t).then(function(e){return{label:e,control:n.control,valueHelp:n.valueHelp}})})}function g(e,t,i){var l=n({aggregationName:a.aggregationName,payload:t.payload||{},parentSelector:e.content.parentId},i);var d=t.instance;return Promise.resolve().then(function(){if(o(d.createLayout)&&!u(e)){return d.createLayout(l)}}).then(function(t){if(r.get("control",t)){t.layoutControl=true;return t}return p(e,l,d)})}return{applyChange:function(r,o,l){var d=r.getDefinition();var c=l.appComponent;var u=d.content;var f=u.newFieldSelector;var p={appComponent:l.appComponent,view:l.view,fieldSelector:f,bindingPath:u.bindingPath,modifier:l.modifier,element:o};if(l.modifier.bySelector(f,c,l.view)){return e.markAsNotApplicable("Control to be created already exists:"+(f.id||f),true)}var s={newFieldSelector:f};r.setRevertData(s);var v=i(u);return t.getDelegateForControl({control:o,modifier:l.modifier,modelType:v,supportsDefault:a.supportsDefault}).then(function(e){return g(d,e,p)}).then(function(e){var t=n({},{control:o,innerControls:e,change:r},l);return Promise.resolve().then(function(){return a.addProperty(t)}).then(function(){if(e.valueHelp){var t=l.modifier.getSelector(l.modifier.getId(e.valueHelp),c);s.valueHelpSelector=t}})})},revertChange:function(e,t,r){var i=r.appComponent;var l=r.modifier;var d=e.getRevertData().newFieldSelector;var c=e.getRevertData().valueHelpSelector;var u=l.bySelector(d,i);var f=e.getDependentControl(a.parentAlias,r)||t;return Promise.resolve().then(l.removeAggregation.bind(l,f,a.aggregationName,u)).then(l.destroy.bind(l,u)).then(function(){if(c){var e=l.bySelector(c,i);return Promise.resolve().then(l.removeAggregation.bind(l,f,"dependents",e)).then(l.destroy.bind(l,e))}}).then(function(){var i=n({},{control:t,change:e},r);if(o(a.revertAdditionalControls)){return Promise.resolve().then(function(){return a.revertAdditionalControls(i)}).then(function(){e.resetRevertData()})}})},completeChangeContent:function(e,t,n){var r=n.appComponent;var i=e.getDefinition();if(!i.content){i.content={}}if(t.parentId){if(o(a.mapParentIdIntoChange)){a.mapParentIdIntoChange(e,t,n)}else{e.addDependentControl(t.parentId,a.parentAlias,n)}try{i.content.parentId=n.modifier.getSelector(t.parentId,r)}catch(e){}}else{throw new Error("mSpecificChangeInfo.parentId attribute required")}if(t.bindingPath){i.content.bindingPath=t.bindingPath}else{throw new Error("mSpecificChangeInfo.bindingPath attribute required")}if(t.newControlId){i.content.newFieldSelector=n.modifier.getSelector(t.newControlId,r)}else{throw new Error("mSpecificChangeInfo.newControlId attribute required")}if(t.index===undefined){throw new Error("mSpecificChangeInfo.targetIndex attribute required")}else{i.content.newFieldIndex=t.index}if(t.oDataServiceVersion){i.content.oDataServiceVersion=t.oDataServiceVersion}if(t.modelType&&a.supportsDefault){i.content.modelType=t.modelType}},getChangeVisualizationInfo:function(e){var t=e.getRevertData();if(t&&t.labelSelector){return{affectedControls:[t.labelSelector]}}return{affectedControls:[e.getContent().newFieldSelector]}},getCondenserInfo:function(e,t){return f(e,t).then(function(t){if(!t){return undefined}if(!e.getContent().newFieldSelector||!e.getContent().parentId||!a.aggregationName){return undefined}return{affectedControl:e.getContent().newFieldSelector,classification:sap.ui.fl.condenser.Classification.Create,targetContainer:e.getContent().parentId,targetAggregation:a.aggregationName,setTargetIndex:function(e,t){e.getContent().newFieldIndex=t},getTargetIndex:function(e){return e.getContent().newFieldIndex}}})}}}};return a});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/BaseAddXml",["sap/ui/fl/changeHandler/Base","sap/base/util/LoaderExtensions","sap/ui/fl/changeHandler/common/revertAddedControls","sap/ui/fl/Utils"],function(e,t,n,r){"use strict";var a={};a.applyChange=function(n,o,i,u){var s=i.modifier;var f=i.view;var c=u.aggregationName;var g;var h=u.index;var l=[];var d=n.getModuleName();var m;var v;var p=function(){var e=[];v.forEach(function(t,n){var r=function(){return Promise.resolve().then(s.insertAggregation.bind(s,o,c,t,h+n,f,u.skipAdjustIndex)).then(function(){l.push({id:s.getId(t),aggregationName:c})})};e.push(r)});return r.execPromiseQueueSequentially(e,true,true).then(function(){n.setRevertData(l);return v})};return Promise.resolve().then(s.findAggregation.bind(s,o,c)).then(function(e){g=e;if(!g){return Promise.reject(new Error("The given Aggregation is not available in the given control: "+s.getId(o)))}return t.loadResource(d,{dataType:"text"})}).then(function(t){m=t;return e.instantiateFragment(n,i)}).then(function(e){v=e;var t=[];v.forEach(function(e,n){var r=function(){return Promise.resolve().then(s.validateType.bind(s,e,g,o,m,n)).then(function(e){if(!e){a._destroyArrayOfControls(v);return Promise.reject(new Error("The content of the xml fragment does not match the type of the targetAggregation: "+g.type))}})};t.push(r)});return r.execPromiseQueueSequentially(t,true,true).then(p)})};a.revertChange=n;a._throwMissingAttributeError=function(e){throw new Error("Attribute missing from the change specific content'"+e+"'")};a._destroyArrayOfControls=function(e){e.forEach(function(e){if(e.destroy){e.destroy()}})};a.completeChangeContent=function(e,t,n){if(!n){n=e.getDefinition();if(!n.content){n.content={}}}if(t.fragmentPath){n.content.fragmentPath=t.fragmentPath}else{a._throwMissingAttributeError("fragmentPath")}var r=n.reference.replace(/\.Component/g,"").replace(/\./g,"/");r+="/changes/";r+=n.content.fragmentPath;e.setModuleName(r)};return a},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/BaseRename",["sap/ui/fl/changeHandler/Base","sap/base/Log"],function(e,t){"use strict";var n={createRenameChangeHandler:function(n){n.changePropertyName=n.changePropertyName||"newText";return{applyChange:function(e,r,a){var i=a.modifier;var o=n.propertyName;var f=e.getDefinition();var p=f.texts[n.changePropertyName];var s=p.value;return Promise.resolve().then(function(){if(f.texts&&p&&typeof s==="string"){return i.getPropertyBindingOrProperty(r,o).then(function(t){e.setRevertData(t);return i.setPropertyBindingOrProperty(r,o,s)})}t.error("Change does not contain sufficient information to be applied: ["+f.layer+"]"+f.namespace+"/"+f.fileName+"."+f.fileType);return undefined})},revertChange:function(e,r,a){var i=a.modifier;var o=n.propertyName;var f=e.getRevertData();if(f||f===""){i.setPropertyBindingOrProperty(r,o,f);e.resetRevertData();return}t.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.")},completeChangeContent:function(t,r,a){var i=t.getDefinition();var o=n.changePropertyName;var f=n.translationTextType;return Promise.resolve().then(function(){return a.modifier.bySelector(t.getSelector(),a.appComponent)}).then(function(t){i.content.originalControlType=a.modifier.getControlType(t);if(typeof r.value==="string"){e.setTextInChange(i,o,r.value,f)}else{return Promise.reject(new Error("oSpecificChangeInfo.value attribute required"))}})},getCondenserInfo:function(e){return{affectedControl:e.getSelector(),classification:sap.ui.fl.condenser.Classification.LastOneWins,uniqueKey:n.propertyName||n.changePropertyName}},getChangeVisualizationInfo:function(e){var t=e.getDefinition().texts&&e.getDefinition().texts[n.changePropertyName];return{payload:{originalLabel:e.getRevertData(),newLabel:t&&t.value}}}}}};return n},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/BaseTreeModifier",["sap/ui/core/util/reflection/BaseTreeModifier"],function(e){"use strict";return e});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/HideControl",["sap/base/Log","sap/ui/fl/changeHandler/JsControlTreeModifier"],function(e,t){"use strict";var n="visible";var r={};r.applyChange=function(e,t,n){var r=n.modifier;return Promise.resolve().then(r.getVisible.bind(r,t)).then(function(n){e.setRevertData({originalValue:n});r.setVisible(t,false)})};r.revertChange=function(t,n,r){var i=t.getRevertData();return Promise.resolve().then(function(){if(i){r.modifier.setVisible(n,i.originalValue);t.resetRevertData()}else{e.error("Attempt to revert an unapplied change.")}})};r.completeChangeContent=function(){};r.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:sap.ui.fl.condenser.Classification.Reverse,uniqueKey:n}};r.getChangeVisualizationInfo=function(e,n){var r=e.getSelector();var i=t.bySelector(r,n);return{affectedControls:[r],displayControls:[i.getParent().getId()]}};return r},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/JsControlTreeModifier",["sap/ui/core/util/reflection/JsControlTreeModifier"],function(e){"use strict";return e},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/MoveControls",["sap/base/Log","sap/ui/fl/Utils"],function(e,r){"use strict";var t={};t.SOURCE_ALIAS="source";t.TARGET_ALIAS="target";t.MOVED_ELEMENTS_ALIAS="movedElements";function n(e,r,t,n){if(!e){return Promise.reject(new Error("No change instance"))}var o=e.getContent();if(!o||!o.movedElements||o.movedElements.length===0){return Promise.reject(new Error("Change format invalid"))}if(!o.source||!o.source.selector){return Promise.reject(new Error("No source supplied for move"))}if(!o.target||!o.target.selector){return Promise.reject(new Error("No target supplied for move"))}if(!r.bySelector(o.source.selector,n,t)){return Promise.reject(new Error("Move source parent not found"))}if(!r.bySelector(o.target.selector,n,t)){return Promise.reject(new Error("Move target parent not found"))}if(!o.source.selector.aggregation){return Promise.reject(new Error("No source aggregation supplied for move"))}if(!o.target.selector.aggregation){return Promise.reject(new Error("No target aggregation supplied for move"))}return Promise.resolve()}function o(e,r,t,n){if(!e.selector&&!e.id){return Promise.reject(new Error("Change format invalid - moveElements element has no id attribute"))}if(typeof e.targetIndex!=="number"){return Promise.reject(new Error("Missing targetIndex for element with id '"+e.selector.id+"' in movedElements supplied"))}return Promise.resolve().then(r.bySelector.bind(r,e.selector||e.id,t,n)).then(function(r){if(!r){return Promise.reject(new Error("Control to move was not found. Id: '"+e.selector.id+"'"))}return r})}function i(e){if(!e.movedElements){return Promise.reject(new Error("mSpecificChangeInfo.movedElements attribute required"))}if(e.movedElements.length===0){return Promise.reject(new Error("MovedElements array is empty"))}e.movedElements.forEach(function(e){if(!e.id){throw new Error("MovedControls element has no id attribute")}if(typeof e.sourceIndex!=="number"){throw new Error("SourceIndex attribute at MovedElements element is no number")}if(typeof e.targetIndex!=="number"){throw new Error("TargetIndex attribute at MovedElements element is no number")}});return Promise.resolve()}function a(e,r,t){delete r.source.publicAggregation;delete r.target.publicAggregation;var n;var o;return Promise.resolve().then(function(){return r.source.parent||e.bySelector(r.source.id,t)}).then(function(o){n=o;return r.target.parent||e.bySelector(r.target.id,t)}).then(function(i){o=i;var a=r.source.aggregation;var s=r.target.aggregation;var g={aggregation:r.source.aggregation,type:e.getControlType(n)};var u={aggregation:r.target.aggregation,type:e.getControlType(o)};var c={source:{id:n.getId(),aggregation:a,type:g.type,selector:e.getSelector(r.source.id,t,g)},target:{id:o.getId(),aggregation:s,type:u.type,selector:e.getSelector(r.target.id,t,u)},movedElements:r.movedElements};return c})}t.applyChange=function(e,t,i){var a=i.modifier;var s=i.view;var g=i.appComponent;var u;var c;var l;var d;var m;var v;var f;var h=false;var E=e.getContent();var p=[];var C=[];return n(e,a,s,g).then(function(){E.movedElements.forEach(function(e){var r=function(){return Promise.resolve().then(o.bind(null,e,a,g,s)).then(function(e){u=e;c=a.getParent(u);return i.sourceAggregation||a.getParentAggregationName(u,c)}).then(function(e){d=e;return a.bySelector(E.target.selector,g,s)}).then(function(e){l=e;m=i.targetAggregation||E.target.selector.aggregation;return a.findIndexInParentAggregation(u)}).then(function(r){v=r;f=e.targetIndex;if(v>-1){if(v===f&&d===m&&a.getParent(u)===l){v=e.sourceIndex;d=i.sourceAggregation||E.source.selector.aggregation;h=true;return a.bySelector(E.source.selector,g,s)}}return Promise.resolve()}).then(function(e){if(e){c=e}if(v>-1){p.unshift({index:v,aggregation:d,sourceParent:a.getSelector(c,g)})}if(!h){return Promise.resolve().then(a.removeAggregation.bind(a,c,d,u)).then(a.insertAggregation.bind(a,l,m,u,f,s))}return Promise.resolve()})};C.push(r)},this);return r.execPromiseQueueSequentially(C,true,true)}.bind(this)).then(function(){e.setRevertData(p)})};t.revertChange=function(t,i,a){var s=a.modifier;var g=a.view;var u=a.appComponent;var c=t.getContent();var l;var d;var m;var v;var f;var h;return n(t,s,g,u).then(s.bySelector.bind(s,c.source.selector,u,g)).then(function(e){l=e;m=c.source.selector.aggregation;v=c.target.selector.aggregation;return s.bySelector(c.target.selector,u,g)}).then(function(n){d=n;var i=t.getRevertData();t.getContent().movedElements.reverse();var a=[];c.movedElements.forEach(function(r,t){var n=function(){return Promise.resolve().then(o.bind(this,r,s,u,g)).then(function(n){f=n;if(!f){e.warning("Element to move not found");return Promise.reject()}h=r.sourceIndex;if(i){var o=i[t];m=o.aggregation;h=o.index;return s.bySelector(o.sourceParent,u,g)}return Promise.resolve()}).then(function(e){if(e){l=e}return s.removeAggregation(d,v,f)}).then(function(){return s.insertAggregation(l,m,f,h,g)})}.bind(this);a.push(n)},this);return r.execPromiseQueueSequentially(a,true,true)}.bind(this)).then(function(){t.resetRevertData()})};t.completeChangeContent=function(e,r,n){var o=n.modifier;var s=n.appComponent;var g=e.getDefinition();return i(r).then(a.bind(this,o,r,s)).then(function(r){g.content={movedElements:[],source:{selector:r.source.selector},target:{selector:r.target.selector}};var i=[];r.movedElements.forEach(function(a){var u=Promise.resolve().then(function(){return a.element||o.bySelector(a.id,s)}).then(function(i){g.content.movedElements.push({selector:o.getSelector(i,s),sourceIndex:a.sourceIndex,targetIndex:a.targetIndex});e.addDependentControl(r.source.id,t.SOURCE_ALIAS,n);e.addDependentControl(r.target.id,t.TARGET_ALIAS,n);e.addDependentControl(r.movedElements.map(function(e){return e.id}),t.MOVED_ELEMENTS_ALIAS,n)});i.push(u)});return Promise.all(i)})};t.getCondenserInfo=function(e){var r=e.getContent();var t=e.getRevertData()[0];return{affectedControl:r.movedElements[0].selector,classification:sap.ui.fl.condenser.Classification.Move,sourceContainer:t.sourceParent,targetContainer:r.target.selector,sourceIndex:t.index,sourceAggregation:t.aggregation,targetAggregation:r.target.selector.aggregation,setTargetIndex:function(e,r){e.getContent().movedElements[0].targetIndex=r},getTargetIndex:function(e){return e.getContent().movedElements[0].targetIndex}}};t.getChangeVisualizationInfo=function(e){var r=e.getContent();return{affectedControls:[r.movedElements[0].selector],dependentControls:[r.source.selector]}};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/MoveElements",["sap/base/Log","sap/ui/fl/Utils"],function(e,r){"use strict";var t={};t.CHANGE_TYPE="moveElements";function n(e,r,t,n){if(!e){return Promise.reject(new Error("No change instance"))}var o=e.getContent();if(!o||!o.movedElements||o.movedElements.length===0){return Promise.reject(new Error("Change format invalid"))}if(!e.getSelector().aggregation){return Promise.reject(new Error("No source aggregation supplied via selector for move"))}if(!o.target||!o.target.selector){return Promise.reject(new Error("No target supplied for move"))}if(!r.bySelector(o.target.selector,n,t)){return Promise.reject(new Error("Move target parent not found"))}if(!o.target.selector.aggregation){return Promise.reject(new Error("No target aggregation supplied for move"))}return Promise.resolve()}function o(e,r,t,n){if(!e.selector&&!e.id){return Promise.reject(new Error("Change format invalid - moveElements element has no id attribute"))}if(typeof e.targetIndex!=="number"){return Promise.reject(new Error("Missing targetIndex for element with id '"+e.selector.id+"' in movedElements supplied"))}return Promise.resolve().then(function(){return r.bySelector(e.selector||e.id,t,n)})}function i(r,t,n,i,a,g,s,u){var c;return o(r,t,n,i).then(function(n){c=n;if(!c){e.warning("Element to move not found");return Promise.reject()}return Promise.resolve().then(t.removeAggregation.bind(t,a,s,c)).then(t.insertAggregation.bind(t,g,u,c,r.targetIndex,i))})}t.applyChange=function(e,t,o){var a=o.modifier;var g=o.view;var s=o.appComponent;var u=e.getContent();var c;var l;var m;return n(e,a,g,s).then(function(){c=e.getSelector().aggregation;l=u.target.selector.aggregation;return a.bySelector(u.target.selector,s,g)}).then(function(e){m=e;var n=[];u.movedElements.forEach(function(e){n.push(i.bind(null,e,a,s,g,t,m,c,l))});return r.execPromiseQueueSequentially(n,true,true)})};t.completeChangeContent=function(){throw new Error("Using deprecated change handler. Please consider using 'MoveControls' instead")};t.getSpecificChangeInfo=function(e,r){var t=r.source.parent||e.bySelector(r.source.id);var n=r.target.parent||e.bySelector(r.target.id);var o=r.source.aggregation;var i=r.target.aggregation;var a={source:{id:t.getId(),aggregation:o,type:e.getControlType(t)},target:{id:n.getId(),aggregation:i,type:e.getControlType(n)},movedElements:r.movedElements};return a};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/PropertyBindingChange",["sap/base/Log"],function(e){"use strict";var n={};n.applyChange=function(e,n,t){var r=e.getDefinition();var i=r.content.property;var o=r.content.newBinding;var a=t.modifier;return Promise.resolve().then(a.getPropertyBindingOrProperty.bind(a,n,i)).then(function(t){e.setRevertData({originalValue:t});a.setPropertyBinding(n,i,o)})};n.revertChange=function(n,t,r){var i=n.getRevertData();if(i){var o=n.getDefinition();var a=o.content.property;var c=i.originalValue;var p=r.modifier;p.setPropertyBindingOrProperty(t,a,c);n.resetRevertData()}else{e.error("Attempt to revert an unapplied change.")}};n.completeChangeContent=function(e,n){var t=e.getDefinition();if(!n.content){throw new Error("oSpecificChangeInfo attribute required")}t.content=n.content};n.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:sap.ui.fl.condenser.Classification.LastOneWins,uniqueKey:e.getContent().property}};return n},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/PropertyChange",["sap/ui/thirdparty/jquery","sap/ui/fl/Utils","sap/base/Log"],function(e,t,n){"use strict";var r={};function i(n){return t.isBinding(n)||e.isPlainObject(n)}function o(e,t,n,r){try{if(i(n)){r.setPropertyBinding(e,t,n)}else{r.setProperty(e,t,n)}}catch(e){throw new Error("Applying property changes failed: "+e)}}r.applyChange=function(e,t,n){var r=e.getDefinition();var i=r.content.property;var a=r.content.newValue;var c=n.modifier;return Promise.resolve().then(c.getPropertyBindingOrProperty.bind(c,t,i)).then(function(n){e.setRevertData({originalValue:n});o(t,i,a,c)})};r.revertChange=function(e,t,r){var i=e.getRevertData();if(i){var a=e.getDefinition();var c=a.content.property;var s=i.originalValue;var p=r.modifier;o(t,c,s,p);e.resetRevertData()}else{n.error("Attempt to revert an unapplied change.")}};r.completeChangeContent=function(e,t){return Promise.resolve().then(function(){var n=e.getDefinition();if(!t.content){throw new Error("oSpecificChangeInfo attribute required")}n.content=t.content})};r.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:sap.ui.fl.condenser.Classification.LastOneWins,uniqueKey:e.getContent().property}};return r},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/StashControl",["sap/ui/fl/LayerUtils"],function(e){"use strict";var n={};n.applyChange=function(n,t,r){var i;var a=r.modifier;return Promise.resolve().then(a.getStashed.bind(a,t)).then(function(e){i=e;return a.findIndexInParentAggregation(t)}).then(function(r){this.setChangeRevertData(n,i,r);if(e.isDeveloperLayer(n.getLayer())){return a.setStashed(t,true)}return a.setVisible(t,false)}.bind(this))};function t(e,n,t,r){var i;if(e!==n.originalIndex){var a=r.getParent(t);return Promise.return().then(r.getParentAggregationName.bind(r,t)).then(function(e){i=e;return r.removeAggregation(a,i,t)}).then(r.insertAggregation.bind(r,a,i,t,n.originalIndex))}return Promise.resolve()}n.revertChange=function(n,r,i){var a=n.getRevertData();var o=i.modifier;return Promise.resolve().then(function(){if(e.isDeveloperLayer(n.getLayer())){var s=o.setStashed(r,a.originalValue,i.appComponent);if(s){return Promise.resolve().then(o.findIndexInParentAggregation.bind(o,s)).then(function(e){return t(e,a,s,o)})}return Promise.resolve()}return o.setVisible(r,!a.originalValue)}).then(function(){n.resetRevertData()})};n.completeChangeContent=function(){};n.setChangeRevertData=function(e,n,t){e.setRevertData({originalValue:n,originalIndex:t})};n.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:sap.ui.fl.condenser.Classification.Reverse,uniqueKey:"stashed"}};return n});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/UnhideControl",["sap/base/Log"],function(e){"use strict";var t="visible";var n={};n.applyChange=function(e,n,r){var i=r.modifier;return Promise.resolve().then(i.getProperty.bind(i,n,t)).then(function(t){e.setRevertData({originalValue:t});r.modifier.setVisible(n,true)})};n.revertChange=function(t,n,r){var i=t.getRevertData();if(i){r.modifier.setVisible(n,i.originalValue);t.resetRevertData()}else{e.error("Attempt to revert an unapplied change.")}};n.completeChangeContent=function(){};n.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:sap.ui.fl.condenser.Classification.Reverse,uniqueKey:t}};return n},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/UnstashControl",[],function(){"use strict";var e={};e.applyChange=function(e,n,t){var r=e.getContent();var a=t.modifier;var i=false;var o;return Promise.resolve().then(a.getStashed.bind(a,n)).then(function(s){e.setRevertData({originalValue:s});o=a.setStashed(n,i,t.appComponent)||n;if(r.parentAggregationName){var g=r.parentAggregationName;var f=a.getParent(o);return Promise.resolve().then(a.removeAggregation.bind(a,f,g,o)).then(a.insertAggregation.bind(a,f,g,o,r.index,t.view))}return undefined}).then(function(){return o})};e.revertChange=function(e,n,t){var r=e.getRevertData();t.modifier.setStashed(n,r.originalValue);e.resetRevertData()};e.completeChangeContent=function(e,n){var t=e.getDefinition();if(n.content){t.content=n.content}};e.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:sap.ui.fl.condenser.Classification.Reverse,uniqueKey:"stashed"}};return e});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/UpdateIFrame",["sap/base/util/extend"],function(e){"use strict";var t={};var n=["width","height","url","_settings"];function r(e,t){var r={};var i=[];n.forEach(function(n){var a=Promise.resolve().then(e.getProperty.bind(e,t,n)).then(function(e){if(e!==undefined){r[n]=e}});i.push(a)});return Promise.all(i).then(function(){return r})}function i(t,n,r){var i=e({_settings:r},r);return Promise.resolve().then(t.applySettings.bind(t,n,i))}t.applyChange=function(e,t,n){var a=n.modifier;var o=e.getDefinition();return a.getControlMetadata(t).then(function(e){if(e.getName()!=="sap.ui.fl.util.IFrame"){return Promise.reject(new Error("UpdateIFrame only for sap.ui.fl.util.IFrame"))}return r(a,t)}).then(function(n){e.setRevertData({originalSettings:n});return i(a,t,o.settings)})};t.revertChange=function(e,t,n){var r=e.getRevertData();return Promise.resolve().then(function(){if(r){if(r.originalSettings._settings&&r.originalSettings._settings.url){r.originalSettings.url=r.originalSettings._settings.url}return i(n.modifier,t,r.originalSettings)}return Promise.reject(new Error("Attempt to revert an unapplied change."))}).then(function(){e.resetRevertData()})};t.completeChangeContent=function(e,t){var r=e.getDefinition();if(!t.content||!Object.keys(t.content).some(function(e){return n.indexOf(e)!==-1})){throw new Error("oSpecificChangeInfo attribute required")}r.settings=t.content};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/XmlTreeModifier",["sap/ui/core/util/reflection/XmlTreeModifier"],function(e){"use strict";return e},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/common/createIFrame",["sap/ui/fl/util/IFrame"],function(){"use strict";return function(e,r,t){var n=r.modifier;var i=e.getDefinition();var a=r.view;var o=r.appComponent;var u={_settings:{}};["url","width","height"].forEach(function(e){var r=i.content[e];u[e]=r;u._settings[e]=r});return Promise.resolve().then(function(){return n.createControl("sap.ui.fl.util.IFrame",o,a,t,u,false)})}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/common/getTargetAggregationIndex",[],function(){"use strict";return function(e,n,t){var r=t.modifier;var i=e.getDefinition();var g=i.content.targetAggregation;var o=i.content.index;if(o===undefined){return Promise.resolve().then(r.getAggregation.bind(r,n,g)).then(function(e){return e.length})}return Promise.resolve(o)}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/common/revertAddedControls",["sap/ui/fl/Utils"],function(e){"use strict";return function(r,t,n){var o=n.modifier;var a=r.getDefinition();var i=a.content.targetAggregation;var u=n.view||e.getViewForControl(t);var c=n.appComponent;var f=r.getRevertData()||[];var s=f.map(function(e){var r;if(typeof e==="string"){r=e}else{r=e.id;i=i||e.aggregationName}return o.bySelector(r,c,u)||u&&u.createId&&o.bySelector(u.createId(r))});var v=[];s.forEach(function(e){var r=function(){return Promise.resolve().then(o.removeAggregation.bind(o,t,i,e)).then(function(){if(e.destroy){e.destroy()}})};v.push(r)});return e.execPromiseQueueSequentially(v,true,true).then(function(){r.resetRevertData();return true})}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/codeExt/CodeExtManager",["sap/ui/fl/write/_internal/Storage","sap/ui/fl/Change"],function(e,n){"use strict";var t;t={createOrUpdateCodeExtChange:function(t,r){if(!t.content||!t.content.codeRef){throw new Error("no code reference passed for the code extension change")}if(!t.selector||!t.selector.id){throw new Error("no controller name passed for the code extension change")}if(!t.reference){throw new Error("no reference passed for the code extension change")}t.changeType=t.changeType||"codeExt";var o=n.createInitialFileContent(t);return e.write({layer:o.layer,transport:r.transportId,flexObjects:[o]})},createCodeExtChanges:function(t,r){t=t||[];if(t.length===0){return Promise.resolve()}var o=[];t.forEach(function(e){e.changeType=e.changeType||"codeExt";e.packageName=r.packageName;e.content={codeRef:r.codeRef};o.push(n.createInitialFileContent(e))});return e.write({layer:o[0].layer,transport:r.transportId,flexObjects:o})},deleteCodeExtChange:function(n,t){if(n.changeType!=="codeExt"||n.fileType!=="change"){throw new Error("the change is not of type 'code extension'")}if(!n.fileName){throw new Error("the extension does not contains a file name")}if(n.namespace===undefined){throw new Error("the extension does not contains a namespace")}return e.remove({layer:n.layer,transport:t.transportId,flexObject:n})}};return t});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/Storage",["sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/Utils","sap/ui/fl/initial/_internal/StorageResultMerger","sap/ui/fl/initial/_internal/storageResultDisassemble"],function(e,n,r,t){"use strict";function i(e,r,t){if(!r.layers||r.layers[0]!=="ALL"&&r.layers.indexOf("CUSTOMER")===-1){delete e.version;return e}if(t.version!==undefined){e.version=t.version;return e}var i=n.getUrlParameter(sap.ui.fl.Versions.UrlParameter);if(i===null){delete e.version}else{e.version=parseInt(i)}return e}function a(n,r){var t=r.map(function(r){var t=Object.assign({},n,{url:r.url,path:r.path});t=i(t,r,n);return r.loadConnectorModule.loadFlexData(t).then(function(n){return n||e.getEmptyFlexDataResponse()}).catch(e.logAndResolveDefault.bind(undefined,e.getEmptyFlexDataResponse(),r,"loadFlexData"))});return Promise.all(t)}function l(e){var n=[];e.forEach(function(e){if(Array.isArray(e)){n=n.concat(e)}else{n.push(e)}});return n}function o(e){return e.map(function(e){return t(e)})}function s(e){return Promise.resolve(e).then(l).then(o).then(l).then(r.merge)}function u(n){return e.getStaticFileConnector().then(a.bind(this,n))}var f={};f.completeFlexData=function(e){if(!e||!e.reference){return Promise.reject("No reference was provided")}return Promise.all([u(e),e.partialFlexData]).then(s)};f.loadFlexData=function(n){if(!n||!n.reference){return Promise.reject("No reference was provided")}return e.getLoadConnectors().then(a.bind(this,n)).then(s)};return f});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/StorageResultMerger",["sap/base/util/merge","sap/base/util/ObjectPath"],function(n,a){"use strict";var e={};function r(n,e){var r=n.reduce(function(n,r){if(a.get(e,r)){return n.concat(a.get(e,r))}return n},[]);var t=[];return r.filter(function(n){var a=n.fileName;var e=t.indexOf(a)!==-1;if(e){return false}t.push(a);return true})}function t(a){return a.reduce(function(a,e){return n({},a,e.ui2personalization)},{})}function i(n){return n.reduce(function(n,a){return a.cacheKey?n+=a.cacheKey:n},"")||null}e.merge=function(n){return{appDescriptorChanges:r(n,"appDescriptorChanges"),changes:r(n,"changes"),ui2personalization:t(n),comp:{variants:r(n,"comp.variants"),changes:r(n,"comp.changes"),defaultVariants:r(n,"comp.defaultVariants"),standardVariants:r(n,"comp.standardVariants")},variants:r(n,"variants"),variantChanges:r(n,"variantChanges"),variantDependentControlChanges:r(n,"variantDependentControlChanges"),variantManagementChanges:r(n,"variantManagementChanges"),cacheKey:i(n)}};return e});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/StorageUtils",["sap/base/security/encodeURLParameters","sap/base/Log","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/base/util/isEmptyObject"],function(n,e,t,a,r){"use strict";var o={load:{LrepConnector:"sap/ui/fl/initial/_internal/connectors/LrepConnector",NeoLrepConnector:"sap/ui/fl/initial/_internal/connectors/NeoLrepConnector",PersonalizationConnector:"sap/ui/fl/initial/_internal/connectors/PersonalizationConnector",KeyUserConnector:"sap/ui/fl/initial/_internal/connectors/KeyUserConnector",StaticFileConnector:"sap/ui/fl/initial/_internal/connectors/StaticFileConnector",ObjectStorageConnector:"sap/ui/fl/apply/_internal/connectors/ObjectStorageConnector",JsObjectConnector:"sap/ui/fl/write/_internal/connectors/JsObjectConnector",ObjectPathConnector:"sap/ui/fl/write/_internal/connectors/ObjectPathConnector",LocalStorageConnector:"sap/ui/fl/write/_internal/connectors/LocalStorageConnector",SessionStorageConnector:"sap/ui/fl/write/_internal/connectors/SessionStorageConnector"},write:{LrepConnector:"sap/ui/fl/write/_internal/connectors/LrepConnector",NeoLrepConnector:"sap/ui/fl/write/_internal/connectors/NeoLrepConnector",PersonalizationConnector:"sap/ui/fl/write/_internal/connectors/PersonalizationConnector",KeyUserConnector:"sap/ui/fl/write/_internal/connectors/KeyUserConnector",StaticFileConnector:"sap/ui/fl/write/_internal/connectors/StaticFileConnector",JsObjectConnector:"sap/ui/fl/write/_internal/connectors/JsObjectConnector",ObjectPathConnector:"sap/ui/fl/write/_internal/connectors/ObjectPathConnector",LocalStorageConnector:"sap/ui/fl/write/_internal/connectors/LocalStorageConnector",SessionStorageConnector:"sap/ui/fl/write/_internal/connectors/SessionStorageConnector"}};var i="sap/ui/fl/initial/_internal/connectors/";var c={connector:"StaticFileConnector"};function s(n,e){return n.filter(function(n){return e.indexOf(n)!==-1||e[0]==="ALL"})}function l(n){function e(n,e){return new Date(n.creation)-new Date(e.creation)}["changes","variantChanges","variants","variantDependentControlChanges","variantManagementChanges"].forEach(function(t){n[t]=n[t].sort(e)});if(n.comp){["changes","defaultVariants","standardVariants"].forEach(function(t){n.comp[t]=n.comp[t].sort(e)})}return n}function u(n,e,t){return t.map(function(n){var t=n.connector;var a;if(!n.loadConnector&&!n.applyConnector&&!n.loadConnector){a=e?o.load[t]:o.write[t]}else if(e){a=n.loadConnector||n.applyConnector}else{a=n.writeConnector||"sap/ui/fl/write/connectors/BaseConnector"}return a})}function f(n,e,t){var a=u(n,e,t);return new Promise(function(n){sap.ui.require(a,function(){Array.from(arguments).forEach(function(n,a){if(!t[a].layers){t[a].layers=n.layers}else{t[a].layers=s(t[a].layers,n.layers)}if(e){t[a].loadConnectorModule=n}else{t[a].writeConnectorModule=n}});n(t)})})}return{getConnectors:function(n,e){var t=sap.ui.getCore().getConfiguration().getFlexibilityServices();var a=[];if(e){a=[c]}a=a.concat(t);return f(n,e,a)},getLoadConnectors:function(){return this.getConnectors(i,true)},getStaticFileConnector:function(){return f(i,true,[c])},logAndResolveDefault:function(n,t,a,r){e.error("Connector ("+t.connector+") failed call '"+a+"': "+r+"\nApplication startup continues without data from this storage.");return n},filterAndSortResponses:function(n){var e=[];Object.keys(n).forEach(function(t){e.push(n[t])});e=e.filter(function(n){return n.changes.length>0||n.variants.length>0||n.variantChanges.length>0||n.variantManagementChanges.length>0||n.variantDependentControlChanges.length>0||n.comp.variants.length>0||n.comp.changes.length>0||n.comp.defaultVariants.length>0||n.comp.standardVariants.length>0});e.sort(function(n,e){return n.index-e.index});return e},getGroupedFlexObjects:function(n){var e={};Object.keys(t).forEach(function(n){e[n]=this.getEmptyFlexDataResponse();e[n].index=a.getLayerIndex(n)}.bind(this));n.forEach(function(n){var t=n.layer;if(n.fileType==="ctrl_variant"&&n.variantManagementReference){e[t].variants.push(n)}else if(n.fileType==="ctrl_variant_change"){e[t].variantChanges.push(n)}else if(n.fileType==="ctrl_variant_management_change"){e[t].variantManagementChanges.push(n)}else if(n.fileType==="variant"){e[t].comp.variants.push(n)}else if(n.fileType==="change"){if(n.variantReference){e[t].variantDependentControlChanges.push(n)}else{switch(n.changeType){case"addFavorite":case"removeFavorite":case"updateVariant":e[t].comp.changes.push(n);break;case"defaultVariant":e[t].comp.defaultVariants.push(n);break;case"standardVariant":e[t].comp.standardVariants.push(n);break;default:e[t].changes.push(n)}}}});Object.keys(e).forEach(function(n){l(e[n])});return e},getEmptyFlexDataResponse:function(){return Object.assign({},{appDescriptorChanges:[],changes:[],comp:{variants:[],changes:[],defaultVariants:[],standardVariants:[]},variants:[],variantChanges:[],variantDependentControlChanges:[],variantManagementChanges:[],ui2personalization:{}})},isStorageResponseFilled:function(n){return Object.keys(n||{}).some(function(e){if(Array.isArray(n[e])){return n[e].length!==0}return!r(n[e])})},addLanguageInfo:function(n){if(!n){n={}}n["sap-language"]=sap.ui.getCore().getConfiguration().getLanguage()}}});
/*!
* OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.predefine("sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerRegistration",["sap/ui/core/Core","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/changeHandler/AddXML","sap/ui/fl/changeHandler/AddXMLAtExtensionPoint","sap/ui/fl/changeHandler/HideControl","sap/ui/fl/changeHandler/MoveControls","sap/ui/fl/changeHandler/MoveElements","sap/ui/fl/changeHandler/PropertyBindingChange","sap/ui/fl/changeHandler/PropertyChange","sap/ui/fl/changeHandler/StashControl","sap/ui/fl/changeHandler/UnhideControl","sap/ui/fl/changeHandler/UnstashControl"],function(e,n,a,r,t,i,o,s,l,d,g,h){"use strict";var f={hideControl:t,moveElements:o,moveControls:i,stashControl:d,unhideControl:g,unstashControl:h};var u={addXML:a,addXMLAtExtensionPoint:r,propertyBindingChange:s,propertyChange:l};var c={};function C(e,n){c[e]=n;n.catch(function(){}).then(function(){delete c[e]})}function p(e){return n.registerChangeHandlersForLibrary(e)}function H(e){if(e.getParameter("operation")==="add"){var n=e.getParameter("metadata");var a=n.sName;var r=n&&n.extensions&&n.extensions.flChangeHandlers;if(r){var t=p(r);C(a,t)}}}var v={getChangeHandlersOfLoadedLibsAndRegisterOnNewLoadedLibs:function(){var n=e.getLoadedLibraries();var a=[];Object.values(n).forEach(function(e){if(e.extensions&&e.extensions.flChangeHandlers){a.push(p(e.extensions.flChangeHandlers))}});e.attachLibraryChanged(H);return Promise.all(a)},waitForChangeHandlerRegistration:function(e){if(c[e]){return c[e].catch(function(){})}return Promise.resolve()},registerPredefinedChangeHandlers:function(){n.registerPredefinedChangeHandlers(f,u)}};return v});
/*!
* OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.predefine("sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage",["sap/base/util/each","sap/base/Log","sap/ui/fl/Layer","sap/ui/fl/initial/_internal/changeHandlers/ChangeRegistryItem","sap/ui/fl/registry/Settings","sap/ui/fl/requireAsync"],function(e,r,n,a,t,i){"use strict";var o={};var l={};var s={};var u={};function f(e,r){var n={};if(!r||!r.changeHandler){n.changeHandler=r}else{n=r}if(n.changeHandler==="default"){n.changeHandler=u.defaultChangeHandlers[e]}else if(Object.keys(u.developerChangeHandlers||{}).includes(e)){throw Error("You can't use a custom change handler for the following Developer Mode change type: "+e+". Please use 'default' instead.")}return n}function g(r){s={};e(r,function(e,r){var n=new a({controlType:"defaultActiveForAll",changeHandler:r,layers:t.getDeveloperModeLayerPermissions(),changeType:e});s[e]=n})}function c(r,n,i){i=f(n,i);var o=Object.assign({},t.getDefaultLayerPermissions());if(i.layers){e(i.layers,function(e,r){if(o[e]===undefined){throw Error("The Layer '"+e+"' is not supported. Please only use supported layers")}o[e]=r})}var l={controlType:r,changeHandler:i.changeHandler,layers:o,changeType:n};return new a(l)}function d(e,r,n){var a=c(e,r,n);l[e]=l[e]||{};l[e][r]=a}function h(n,a){var t=Promise.resolve(a);var o="ChangeHandlerStorage.registerChangeHandlersForControl.skip_next_then";if(typeof a==="string"){t=i(a+".flexibility").catch(function(e){r.error("Flexibility change handler registration failed.\nControlType: "+n+"\n"+e.message);return Promise.resolve(o)})}return t.then(function(r){if(r!==o){e(r,function(e,r){d(n,e,r)})}}).catch(function(e){r.error(e.message)})}function y(e,r,a){var t=l[e]&&l[e][r]||s[r];if(!t){throw Error("No Change handler registered for the Control and Change type")}a=a===n.PUBLIC?n.USER:a;if(!t.getLayers()[a]){throw Error("Change type "+r+" not enabled for layer "+a)}return t}function p(e,n,a,t){var o=t.getChangeHandlerModulePath(a);if(typeof o!=="string"){return Promise.resolve(undefined)}return i(o).then(function(r){var a=r[e];if(a){return c(n,e,a)}}).catch(function(e){r.error("Flexibility registration for control "+t.getId(a)+" failed to load module "+o+"\n"+e.message)})}o.getChangeHandler=function(e,r,n,a,t){return p(e,r,n,a).then(function(n){var a=n||y(r,e,t);return a.getChangeHandler()})};o.registerPredefinedChangeHandlers=function(e,r){u.defaultChangeHandlers=e;u.developerChangeHandlers=r;g(r)};o.registerChangeHandlersForLibrary=function(r){var n=[];e(r,function(e,r){n.push(h(e,r))});return Promise.all(n)};o.clearAll=function(){l={};s={};u={}};o.registerChangeHandlersForControl=function(e,r){return h(e,r)};return o});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/changeHandlers/ChangeRegistryItem",["sap/base/Log","sap/ui/fl/requireAsync","sap/ui/fl/Utils"],function(e,r,n){"use strict";var t=function(r){if(!r.changeHandler){e.error("sap.ui.fl.registry.ChangeRegistryItem: changeHandler required")}if(!r.changeType){e.error("sap.ui.fl.registry.ChangeRegistryItem: changeType required")}if(!r.layers){e.error("sap.ui.fl.registry.ChangeRegistryItem: layers required")}if(!r.controlType){e.error("sap.ui.fl.registry.ChangeRegistryItem: ControlType required")}this._controlType=r.controlType;this._changeType=r.changeType;this._changeHandler=r.changeHandler;this._layers=r.layers};t.prototype.getChangeTypeName=function(){return this._changeType};t.prototype.getControlType=function(){return this._controlType};t.prototype.getLayers=function(){return this._layers};t.prototype.getChangeHandler=function(){var e=new n.FakePromise;if(typeof this._changeHandler==="string"){e=r(this._changeHandler.replace(/\./g,"/")).then(function(e){this._changeHandler=e}.bind(this))}return e.then(function(){if(!this._changeHandler||typeof this._changeHandler.completeChangeContent!=="function"||typeof this._changeHandler.applyChange!=="function"||typeof this._changeHandler.revertChange!=="function"){return Promise.reject(new Error("The ChangeHandler is either not available or does not have all required functions"))}return this._changeHandler}.bind(this))};return t});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/connectors/StaticFileConnector",["sap/base/Log","sap/base/util/LoaderExtensions"],function(e,n){"use strict";function r(r,a){var o=r.replace(/\./g,"/")+"/changes/"+a+".json";var t=!!sap.ui.loader._.getModuleState(o);var i=sap.ui.getCore().getConfiguration();if(t||i.getDebug()||i.getComponentPreload()==="off"){try{return n.loadResource(o)}catch(n){if(n.name.includes("SyntaxError")){e.error(n)}e.warning("flexibility did not find a "+a+".json for the application: "+r)}}}return{loadFlexData:function(e){var n=e.componentName;if(!n){n=e.reference.replace(/.Component/g,"")}var a=r(n,"flexibility-bundle");if(a){a.changes=a.changes.concat(a.compVariants);delete a.compVariants;return Promise.resolve(a)}var o=r(n,"changes-bundle");if(o){return Promise.resolve({changes:o})}return Promise.resolve()}}});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/storageResultDisassemble",["sap/ui/fl/initial/_internal/StorageUtils","sap/base/util/merge","sap/base/util/isEmptyObject"],function(a,e,n){"use strict";function t(a,e){if(e.content.fileName!==e.content.variantManagementReference){a.push(e.content)}e.controlChanges.forEach(function(e){a.push(e)});for(var n in e.variantChanges){a=a.concat(e.variantChanges[n])}return a}function r(a){var e=true;if(a){Object.keys(a).some(function(n){if(a[n].length){e=false;return true}})}return e}return function(i){var s;if(!n(i.variantSection)){s=i.changes||[];for(var c in i.variantSection){var u=i.variantSection[c];for(var o in u.variantManagementChanges){s=s.concat(u.variantManagementChanges[o])}s=u.variants.reduce(t,s)}var f=a.getGroupedFlexObjects(s);var l=a.filterAndSortResponses(f);delete i.changes;delete i.variantSection;e(l[0]||{},i);return l}if(r(i.comp)){s=i.changes||[];i.comp={variants:[],changes:[],defaultVariants:[],standardVariants:[]};s.slice().reverse().forEach(function(a,e,n){var t=false;if(a.fileType==="variant"){i.comp.variants.unshift(a);t=true}else{switch(a.changeType){case"addFavorite":case"removeFavorite":case"updateVariant":i.comp.changes.unshift(a);t=true;break;case"defaultVariant":i.comp.defaultVariants.unshift(a);t=true;break;case"standardVariant":i.comp.standardVariants.unshift(a);t=true;break;default:break}}if(t){var r=n.length-1-e;i.changes.splice(r,1)}})}return[i]}});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/interfaces/BaseLoadConnector",[],function(){"use strict";var e={loadFlexData:function(){return Promise.reject("loadFlexData is not implemented")}};return e});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/interfaces/Delegate",[],function(){"use strict";return{getPropertyInfo:function(){return Promise.reject("not implemented")},getRepresentedProperties:function(){return Promise.reject("not implemented")},createLabel:function(){return Promise.reject("not implemented")},createControlForProperty:function(){return Promise.reject("not implemented")},createLayout:function(){return Promise.reject("not implemented")}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/library",["sap/ui/fl/RegistrationDelegator","sap/ui/fl/Utils","sap/ui/fl/Layer","sap/ui/core/library","sap/m/library"],function(e,i,r){"use strict";sap.ui.getCore().initLibrary({name:"sap.ui.fl",version:"1.97.0",controls:["sap.ui.fl.variants.VariantManagement","sap.ui.fl.util.IFrame"],dependencies:["sap.ui.core","sap.m"],designtime:"sap/ui/fl/designtime/library.designtime",extensions:{flChangeHandlers:{"sap.ui.fl.util.IFrame":"sap/ui/fl/util/IFrame"},"sap.ui.support":{diagnosticPlugins:["sap/ui/fl/support/Flexibility"],publicRules:true}}});sap.ui.fl.Scenario={AppVariant:"APP_VARIANT",VersionedAppVariant:"VERSIONED_APP_VARIANT",AdaptationProject:"ADAPTATION_PROJECT",FioriElementsFromScratch:"FE_FROM_SCRATCH",UiAdaptation:"UI_ADAPTATION"};sap.ui.fl.Versions={Original:-1,Draft:0,UrlParameter:"sap-ui-fl-version"};sap.ui.fl.condenser={Classification:{LastOneWins:"lastOneWins",Reverse:"reverse",Move:"move",Create:"create",Destroy:"destroy"}};e.registerAll();function a(){var e=i.getUshellContainer();if(e){return e.getLogonSystem().isTrial()}return false}if(a()){sap.ui.getCore().getConfiguration().setFlexibilityServices([{connector:"LrepConnector",url:"/sap/bc/lrep",layers:[]},{connector:"LocalStorageConnector",layers:[r.CUSTOMER,r.PUBLIC,r.USER]}])}return sap.ui.fl});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/registry/Settings",["sap/ui/fl/write/_internal/Storage","sap/ui/fl/Utils","sap/base/Log"],function(e,t,n){"use strict";function r(){var e=t.getUshellContainer();if(e){return t.getUShellService("UserInfo").then(function(e){var t=e.getUser();return t&&t.getId()}).catch(function(e){n.error("Error getting service from Unified Shell: "+e.message)})}return Promise.resolve()}var i=function(e){if(!e){throw new Error("no flex settings provided")}this._oSettings=e};i.attachEvent=function(e,t){i._oEventProvider.attachEvent(e,t)};i.detachEvent=function(e,t){i._oEventProvider.detachEvent(e,t)};i.getInstance=function(){if(i._instance){return Promise.resolve(i._instance)}if(i._oLoadSettingsPromise){return i._oLoadSettingsPromise}return i._loadSettings()};i._loadSettings=function(){var t;var o=e.loadFeatures().then(function(e){t=e;return r()}).then(function(e){if(!t){n.error("The request for flexibility settings failed; A default response is generated and returned to consuming APIs");t={isKeyUser:false,isKeyUserTranslationEnabled:false,isVariantSharingEnabled:false,isVariantPersonalizationEnabled:true,isAtoAvailable:false,isAtoEnabled:false,isAppVariantSaveAsEnabled:false,isCondensingEnabled:false,isProductiveSystem:true,isPublicLayerAvailable:false,isVariantAdaptationEnabled:false,versioning:{},_bFlexChangeMode:false,_bFlexibilityAdaptationButtonAllowed:false}}t.userId=e;return i._storeInstance(t)});i._oLoadSettingsPromise=o;return o};i._storeInstance=function(e){if(!i._instance){i._instance=new i(e)}return i._instance};i.getInstanceOrUndef=function(){return i._instance};i.getDefaultLayerPermissions=function(){return{VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:true,PUBLIC:false,USER:false}};i.getDeveloperModeLayerPermissions=function(){return{VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:false,PUBLIC:false,USER:false}};i.prototype._getBooleanProperty=function(e){return this._oSettings[e]||false};i.prototype.isKeyUser=function(){return this._getBooleanProperty("isKeyUser")};i.prototype.isKeyUserTranslationEnabled=function(){return this._getBooleanProperty("isKeyUserTranslationEnabled")};i.prototype.isPublicLayerAvailable=function(){return this._getBooleanProperty("isPublicLayerAvailable")};i.prototype.isVariantAdaptationEnabled=function(){return this._getBooleanProperty("isVariantAdaptationEnabled")};i.prototype.isAppVariantSaveAsEnabled=function(){return this._getBooleanProperty("isAppVariantSaveAsEnabled")};i.prototype.isVersioningEnabled=function(e){return!!(this._oSettings.versioning[e]||this._oSettings.versioning["ALL"])};i.prototype.isModelS=function(){return this._getBooleanProperty("isAtoAvailable")};i.prototype.isAtoEnabled=function(){return this._getBooleanProperty("isAtoEnabled")};i.prototype.isAtoAvailable=function(){return this._getBooleanProperty("isAtoAvailable")};i.prototype.isProductiveSystem=function(){return this._getBooleanProperty("isProductiveSystem")};i.prototype.isVariantSharingEnabled=function(){return this._getBooleanProperty("isVariantSharingEnabled")};i.prototype.isPublicFlVariantEnabled=function(){return this._getBooleanProperty("isPublicFlVariantEnabled")};i.prototype.isVariantPersonalizationEnabled=function(){return this._getBooleanProperty("isVariantPersonalizationEnabled")};i.prototype.isCondensingEnabled=function(){return this._getBooleanProperty("isCondensingEnabled")};i.prototype.getSystem=function(){return this._oSettings.system};i.prototype.getClient=function(){return this._oSettings.client};i.prototype.getUserId=function(){return this._oSettings.userId};return i},true);
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/requireAsync",[],function(){"use strict";return function(n){return new Promise(function(i,u){sap.ui.require([n],function(n){i(n)},function(n){u(n)})})}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/util/IFrame",["../library","sap/ui/core/Control","sap/ui/model/json/JSONModel","./getContainerUserInfo","sap/base/util/extend","sap/base/security/URLListValidator","sap/base/Log","sap/ui/core/library","./IFrameRenderer"],function(e,t,i,r,s,o,n){"use strict";function a(e){if(e.parts&&e.formatter){return e.formatter.apply(null,e.parts.map(function(e){if(e.model){return"{"+e.model+">"+e.path+"}"}return"{"+e.path+"}"}))}return e}var u=t.extend("sap.ui.fl.util.IFrame",{metadata:{library:"sap.ui.fl",properties:{url:{type:"sap.ui.core.URI",group:"Misc",defaultValue:""},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},title:{type:"string",group:"Misc",defaultValue:undefined},_settings:{type:"object",group:"Data",defaultValue:null}},designtime:"sap/ui/fl/designtime/util/IFrame.designtime"},init:function(){if(t.prototype.init){t.prototype.init.apply(this,arguments)}this._oInitializePromise=r().then(function(e){this._oUserModel=new i(e);this.setModel(this._oUserModel,"$user")}.bind(this))},waitForInit:function(){return this._oInitializePromise?this._oInitializePromise:Promise.reject()},setUrl:function(e){var t=decodeURI(e)===e?encodeURI(e):e;if(u.isValidUrl(t)){this.setProperty("url",t)}else{n.error("Provided URL is not valid as an IFrame src")}return this},applySettings:function(e){t.prototype.applySettings.apply(this,arguments);if(e){var i=this.getProperty("_settings")||{};if(e._settings){s(i,e._settings)}else{Object.keys(e).filter(function(t){return!!e[t]}).forEach(function(t){i[t]=a(e[t])})}this.setProperty("_settings",i)}},exit:function(){if(this._oUserModel){this._oUserModel.destroy();delete this._oUserModel}}});u.isValidUrl=function(e){return!o.entries().some(function(e){return/javascript/i.test(e.protocol)})&&o.validate(e)};return u});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/util/IFrameRenderer",[],function(){"use strict";function e(e,t,r){if(r!==""||r.toLowerCase()==="auto"){e.style(t,r)}}var t={apiVersion:2};t.render=function(t,r){t.openStart("iframe",r);e(t,"width",r.getWidth());e(t,"height",r.getHeight());t.style("display","block");t.style("border","none");t.attr("sandbox","allow-forms allow-popups allow-scripts allow-same-origin allow-modals");t.attr("src",r.getUrl());var i=r.getTitle();if(i){t.attr("title",i)}t.openEnd();t.close("iframe")};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/util/ManagedObjectModel",["sap/ui/core/Element","sap/ui/model/base/ManagedObjectModel"],function(e,t){"use strict";function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}var i=e.extend("sap.ui.fl.util.ManagedObjectModel",{metadata:{library:"sap.ui.fl",properties:{data:{type:"object"},name:{type:"string",defaultValue:"$sap.ui.fl.ManagedObjectModel"}},associations:{object:{type:"sap.ui.core.Element"}}},constructor:function(){e.apply(this,arguments);this._oManagedObjectModel=new t(sap.ui.getCore().byId(this.getObject()),this.getData());["data","name","object"].forEach(function(e){this["set"+a(e)]=function(){throw new Error("sap.ui.fl.util.ManagedObjectModel: Can't change the value of `"+e+"` after the object is initialized. Please recreate the object with correct values in the constructor.")}},this)}});i.prototype.setParent=function(t){var a=this.getParent();if(a){a.setModel(null,this.getName())}if(t){t.setModel(this._oManagedObjectModel,this.getName())}e.prototype.setParent.apply(this,arguments)};i.prototype.exit=function(){this._oManagedObjectModel.destroy()};return i});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/util/getContainerUserInfo",["sap/ui/fl/Utils","sap/base/Log"],function(e,r){"use strict";function t(e){if(!e){return""}return e}return function(){var n=e.getUshellContainer();if(n){return e.getUShellService("UserInfo").then(function(e){if(!e){return{}}var r=e.getUser();if(!r){return{}}var n=t(r.getEmail());var i;if(n){i=t(/@(.*)/.exec(n)[1])}else{i=""}return{fullName:t(r.getFullName()),firstName:t(r.getFirstName()),lastName:t(r.getLastName()),email:n,domain:i}}).catch(function(e){r.error("Unexpected exception when reading shell user info: "+e.toString());return{}})}return Promise.resolve({})}});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/variants/VariantModel",["sap/base/util/restricted/_omit","sap/base/util/restricted/_isEqual","sap/base/util/each","sap/base/util/includes","sap/base/util/isEmptyObject","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/BusyIndicator","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/fl/apply/_internal/flexState/controlVariants/Switcher","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/changeHandler/Base","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils","sap/ui/fl/registry/Settings","sap/ui/model/json/JSONModel"],function(e,t,n,a,r,i,o,s,c,l,f,h,u,p,g,v,d,m,V,C,R,y){"use strict";var D={};function x(e,t){return M(function(e,t){var n=t.model;var a=t.vmReference;var r=false;var i=e.key;var s=e.key;return Promise.resolve().then(function(){if(o.get([a,"currentVariant"],n.oData)&&n.oData[a].currentVariant!==n.oData[a].originalCurrentVariant){s=n.oData[a].originalCurrentVariant;r=true;return n.updateCurrentVariant({variantManagementReference:a,newVariantReference:i,appComponent:n.oAppComponent,internallyCalled:true})}}).then(function(){if(o.get([a,"modified"],n.oData)===true){var e=p.getControlChangesForVariant({reference:n.sFlexReference,vmReference:a,vReference:s,changeInstance:true});return b({changes:e,vmReference:a,vReference:s,revert:!r,model:n}).then(function(){n.oData[a].originalCurrentVariant=i;n.oData[a].modified=false;n.checkUpdate(true)})}}).then(function(){if(!r){n._callVariantSwitchListeners(a,n.oData[a].currentVariant)}})}.bind(null,e.getParameters(),t),t.model,t.vmReference)}function b(e){var t=e.model._getDirtyChangesFromVariantChanges(e.changes);t=t.reverse();return Promise.resolve().then(function(){if(e.revert){return f.revertMultipleChanges(t,{appComponent:e.model.oAppComponent,modifier:c,flexController:e.model.oFlexController})}}).then(function(){t.forEach(function(t){p.removeChangeFromVariant({reference:e.model.sFlexReference,change:t,vmReference:e.vmReference,vReference:e.vReference});e.model.oFlexController.deleteChange(t,e.model.oAppComponent)})})}function S(e,t,n){if(n||e.oData[t]){e.oData[t].variantBusy=n}e.checkUpdate()}function M(e,t,n){t._oVariantSwitchPromise=t._oVariantSwitchPromise.catch(function(){}).then(S.bind(null,t,n,true)).then(e).then(S.bind(null,t,n,false)).catch(function(e){S(t,n,false);throw e});t.oFlexController.setVariantSwitchPromise(t._oVariantSwitchPromise);return t._oVariantSwitchPromise}function F(e,t){D[e]=t}function I(e){return u.switchVariant(e).then(function(){delete this.oData[e.vmReference]}.bind(this)).catch(function(e){s.warning(e.message)})}function _(e,t){return u.switchVariant(e).then(function(){this.oData[e.vmReference].originalCurrentVariant=e.newVReference;this.oData[e.vmReference].currentVariant=e.newVReference;if(this.oData[e.vmReference].updateVariantInURL){h.updateVariantInURL({vmReference:e.vmReference,newVReference:e.newVReference,model:this})}this._callVariantSwitchListeners(e.vmReference,e.newVReference,undefined,t);this.checkUpdate()}.bind(this))}function E(e){R.getInstance().then(function(t){if(!t.isVariantPersonalizationEnabled()){e.remove=false;e.rename=false;e.change=false}})}function T(e,t,n){var a=n?V.getCurrentLayer():m.USER;if(e.layer===a&&e.key!==t){return true}return false}function P(e){return new Promise(function(t){if(e.getDomRef()){t()}else{e.addEventDelegate({onAfterRendering:function(){t()}})}})}var U=y.extend("sap.ui.fl.variants.VariantModel",{constructor:function(e,t){this.pSequentialImportCompleted=Promise.resolve();y.apply(this,[e]);this.sharing={PRIVATE:"private",PUBLIC:"public"};this.oFlexController=t.flexController;this.oChangePersistence=this.oFlexController._oChangePersistence;this.sFlexReference=this.oChangePersistence.getComponentName();this.oAppComponent=t.appComponent;this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");this._oVariantSwitchPromise=Promise.resolve();this._oVariantAppliedListeners={};if(r(e)){try{e=p.fillVariantModel({reference:this.sFlexReference})}catch(e){s.error("Variants Map was not found: "+e.message)}}if(e&&typeof e==="object"){Object.keys(e).forEach(function(t){e[t].variants.forEach(function(n){if(!e[t].currentVariant&&n.key===e[t].defaultVariant){e[t].currentVariant=n.key}n.originalTitle=n.title;n.originalFavorite=n.favorite;n.originalExecuteOnSelect=n.executeOnSelect;n.originalVisible=n.visible;n.originalContexts=n.contexts});e[t].originalCurrentVariant=e[t].currentVariant;e[t].originalDefaultVariant=e[t].defaultVariant});this.setData(e)}}});U.prototype.initialize=function(){return Promise.resolve().then(function(){var e=C.getUshellContainer();if(e){var t=[C.getUShellService("UserInfo"),C.getUShellService("URLParsing"),C.getUShellService("CrossApplicationNavigation"),C.getUShellService("ShellNavigation")];return Promise.all(t).then(function(e){F("UserInfo",e[0]);F("URLParsing",e[1]);F("CrossApplicationNavigation",e[2]);F("ShellNavigation",e[3])}).catch(function(e){throw new Error("Error getting service from Unified Shell: "+e)})}return undefined}).then(function(){h.initialize({model:this})}.bind(this))};U.prototype.updateCurrentVariant=function(e){var t={vmReference:e.variantManagementReference,currentVReference:this.oData[e.variantManagementReference].originalCurrentVariant,newVReference:e.newVariantReference,flexController:this.oFlexController,appComponent:e.appComponent||this.oAppComponent,modifier:c,reference:this.sFlexReference};if(e.internallyCalled){return _.call(this,t,e.scenario)}return M(_.bind(this,t,e.scenario),this,e.variantManagementReference)};U.prototype.getCurrentVariantReference=function(e){return this.oData[e].currentVariant};U.prototype.getVariantManagementReference=function(e){var t="";var n=-1;Object.keys(this.oData).some(function(a){return this.oData[a].variants.some(function(r,i){if(r.key===e){t=a;n=i;return true}})}.bind(this));return{variantManagementReference:t,variantIndex:n}};U.prototype.getVariant=function(e,t){return p.getVariant({reference:this.sFlexReference,vmReference:t||this.getVariantManagementReference(e).variantManagementReference,vReference:e})};U.prototype.getVariantProperty=function(e,t){return this.getVariant(e).content.content[t]};function w(e,t){var n=p.getVariantChangesForVariant({vmReference:e,reference:this.sFlexReference});var a=this.oData[e].currentVariant;var r=this.oData[e].defaultVariant;if(t.getExecuteOnSelectionForStandardDefault()&&a===r&&a===e&&!n.setExecuteOnSelect){var i=p.getVariant({reference:this.sFlexReference,vmReference:e,vReference:e});i.content.content.executeOnSelect=true;this.oData[e].variants[0].originalExecuteOnSelect=true;this.oData[e].variants[0].executeOnSelect=true;return true}return false}U.prototype.attachVariantApplied=function(e){var t=sap.ui.getCore().byId(e.vmControlId);var n=this.getVariantManagementReferenceForControl(t);return this.waitForVMControlInit(n).then(function(e,n){if(!this._oVariantAppliedListeners[e]){this._oVariantAppliedListeners[e]={}}var a=w.call(this,e,t);if(n.callAfterInitialVariant||a){var r={appComponent:this.oAppComponent,reference:this.sFlexReference,vmReference:e,flexController:this.oFlexController};p.waitForInitialVariantChanges(r).then(function(){var t=p.getCurrentVariantReference({vmReference:e,reference:this.sFlexReference});this._callVariantSwitchListeners(e,t,n.callback)}.bind(this))}return P(n.control).then(function(){if(g.getRelevantVariantManagementControlId(n.control,this.getVariantManagementControlIds())===n.vmControlId){this.oData[e].showExecuteOnSelection=true;this.checkUpdate(true);this._oVariantAppliedListeners[e][n.control.getId()]=n.callback}else{s.error("Error in attachVariantApplied: The passed VariantManagement ID does not match the responsible VariantManagement control")}}.bind(this))}.bind(this,n,e))};U.prototype._callVariantSwitchListeners=function(e,t,a,r){if(this._oVariantAppliedListeners[e]){var o;this.oData[e].variants.some(function(e){if(e.key===t){o=i({},e);return true}});if(r){o.createScenario=r}if(a){a(o)}else{n(this._oVariantAppliedListeners[e],function(e,t){t(o)})}}};U.prototype.detachVariantApplied=function(e,t){var n=this.getVariantManagementReferenceForControl(sap.ui.getCore().byId(e));if(this._oVariantAppliedListeners[n]){delete this._oVariantAppliedListeners[n][t]}};U.prototype.addChange=function(e){var t=e.getVariantReference();var n=this.getVariantManagementReference(t).variantManagementReference;if(e.getState()===d.states.NEW){this.oData[n].modified=true}this.checkUpdate(true);return p.addChangeToVariant({reference:this.sFlexReference,change:e,vmReference:n,vReference:t})};U.prototype.removeChange=function(e){var t=e.getVariantReference();var n=this.getVariantManagementReference(t).variantManagementReference;var a=p.removeChangeFromVariant({reference:this.sFlexReference,change:e,vmReference:n,vReference:t});this.checkDirtyStateForControlModels([n]);return a};U.prototype._getVariantTitleCount=function(e,t){var n=this.getData();return n[t].variants.reduce(function(t,n){if(e.toLowerCase()===n.title.toLowerCase()&&n.visible){t++}return t},0)};U.prototype._duplicateVariant=function(e){var t=e.newVariantReference;var n=e.sourceVariantReference;var a=e.variantManagementReference;var r=this.getVariant(n);var o=p.getControlChangesForVariant({vmReference:a,vReference:n,changeInstance:true,reference:this.sFlexReference}).map(function(e){return e.getDefinition()});var s={content:{},controlChanges:o,variantChanges:{}};var c=V.compareAgainstCurrentLayer(r.content.layer,e.layer);Object.keys(r.content).forEach(function(a){if(a==="fileName"){s.content[a]=t}else if(a==="variantReference"){if(c===1){var i=this.getVariant(r.content.variantReference);if(i.content.layer===e.layer){s.content[a]=i.content.variantReference}else{s.content[a]=r.content.variantReference}}else if(c===0){s.content[a]=r.content.variantReference}else if(c===-1){s.content[a]=n}}else if(a==="content"){s.content[a]=JSON.parse(JSON.stringify(r.content[a]));s.content.content.title=e.title}else{s.content[a]=r.content[a]}}.bind(this));s.content.layer=e.layer;s.content.contexts=e.contexts;o=s.controlChanges.slice();var l={};var f;s.controlChanges=o.reduce(function(t,n){if(V.compareAgainstCurrentLayer(n.layer,e.layer)>=0){l=i({},n);l.layer=e.layer;l.variantReference=s.content.fileName;if(!l.support){l.support={}}l.support.sourceChangeFileName=n.fileName;l.packageName="$TMP";f=d.createInitialFileContent(l);t.push(new d(f))}return t},[]);return s};U.prototype.copyVariant=function(e){var t=this._duplicateVariant(e);t.generator=e.generator;var n={key:t.content.fileName,layer:e.layer,title:t.content.content.title,originalTitle:t.content.content.title,originalExecuteOnSelect:t.content.content.executeOnSelect,executeOnSelect:false,favorite:true,originalFavorite:true,rename:true,change:true,remove:true,visible:true,originalVisible:true,sharing:e.layer===m.USER?this.sharing.PRIVATE:this.sharing.PUBLIC,contexts:t.content.contexts,originalContexts:t.originalContexts};var a=g.createVariant({model:this,variantSpecificData:t});var r=[];[a].concat(a.getControlChanges()).forEach(function(e){r.push(this.oChangePersistence.addDirtyChange(e))}.bind(this));var o=p.addVariantToVariantManagement({variantData:i({},a.getDefinitionWithChanges(),{content:{content:{visible:n.visible,favorite:n.favorite}}}),reference:this.sFlexReference,vmReference:e.variantManagementReference});this.oData[e.variantManagementReference].variants.splice(o,0,n);return this.updateCurrentVariant({variantManagementReference:e.variantManagementReference,newVariantReference:a.getId(),appComponent:e.appComponent,internallyCalled:true,scenario:"saveAs"}).then(function(){return r})};U.prototype.removeVariant=function(e){var t=this.oChangePersistence.getDirtyChanges().filter(function(t){return t.getVariantReference&&t.getVariantReference()===e.variant.getId()||t.getId()===e.variant.getId()});return this.updateCurrentVariant({variantManagementReference:e.variantManagementReference,newVariantReference:e.sourceVariantReference,appComponent:e.component}).then(function(){var n=p.removeVariantFromVariantManagement({reference:this.sFlexReference,variant:e.variant,vmReference:e.variantManagementReference});this.oData[e.variantManagementReference].variants.splice(n,1);this.checkUpdate();t.forEach(function(e){this.oChangePersistence.deleteChange(e)}.bind(this))}.bind(this))};U.prototype.collectModelChanges=function(e,n){var a=this.getData()[e];var r=a.variants;var i=[];var o={};r.forEach(function(e){if(e.originalTitle!==e.title){o={variantReference:e.key,changeType:"setTitle",title:e.title,originalTitle:e.originalTitle,layer:n};i.push(o)}if(e.originalFavorite!==e.favorite){o={variantReference:e.key,changeType:"setFavorite",favorite:e.favorite,originalFavorite:e.originalFavorite,layer:n};i.push(o)}if(e.originalExecuteOnSelect!==e.executeOnSelect){o={variantReference:e.key,changeType:"setExecuteOnSelect",executeOnSelect:e.executeOnSelect,originalExecuteOnSelect:e.originalExecuteOnSelect,layer:n};i.push(o)}if(!e.visible&&e.originalVisible){o={variantReference:e.key,changeType:"setVisible",visible:false,layer:n};i.push(o)}if(!t(e.originalContexts,e.contexts)){o={variantReference:e.key,changeType:"setContexts",layer:n,contexts:e.contexts,originalContexts:e.originalContexts};i.push(o)}});if(a.originalDefaultVariant!==a.defaultVariant){o={variantManagementReference:e,changeType:"setDefault",defaultVariant:a.defaultVariant,originalDefaultVariant:a.originalDefaultVariant,layer:n};i.push(o)}return i};U.prototype.manageVariants=function(e,t,n,a,r){return new Promise(function(i){e.attachEventOnce("manage",{resolve:i,variantManagementReference:t,layer:n},this.fnManageClickRta,this);e.openManagementDialog(true,a,r)}.bind(this))};U.prototype.addVariantChange=function(e,t){var n=this.setVariantProperties(e,t);var a={};var r={vmReference:e,add:true,reference:this.sFlexReference};a.changeType=t.changeType;a.layer=t.layer;a.generator=t.generator;if(t.changeType==="setDefault"){a.fileType="ctrl_variant_management_change";a.selector=c.getSelector(e,t.appComponent)}else{if(t.changeType==="setTitle"){v.setTextInChange(a,"title",t.title,"XFLD")}a.fileType="ctrl_variant_change";a.selector=c.getSelector(t.variantReference,t.appComponent)}var i=this.oFlexController.createBaseChange(a,t.appComponent);i.setContent(n);r.changeContent=i.getDefinition();p.updateChangesForVariantManagementInMap(r);this.oChangePersistence.addDirtyChange(i);return i};U.prototype.deleteVariantChange=function(e,t,n){var a={vmReference:e,add:false,reference:this.sFlexReference,changeContent:undefined};this.setVariantProperties(e,t,true);a.changeContent=n.getDefinition();p.updateChangesForVariantManagementInMap(a);this.oChangePersistence.deleteChange(n)};U.prototype.setVariantProperties=function(e,t,n){var a=-1;var r;var i=this.getData();if(t.variantReference){a=this.getVariantManagementReference(t.variantReference).variantIndex;r=i[e].variants[a]}var o={};switch(t.changeType){case"setTitle":o.title=t.title;r.title=t.title;r.originalTitle=r.title;break;case"setFavorite":o.favorite=t.favorite;r.favorite=t.favorite;r.originalFavorite=r.favorite;break;case"setExecuteOnSelect":o.executeOnSelect=t.executeOnSelect;if(r){r.executeOnSelect=t.executeOnSelect;r.originalExecuteOnSelect=r.executeOnSelect}break;case"setVisible":o.visible=t.visible;o.createdByReset=false;r.visible=t.visible;r.originalVisible=r.visible;break;case"setContexts":o.contexts=t.contexts;r.contexts=t.contexts;r.originalContexts=t.contexts;break;case"setDefault":o.defaultVariant=t.defaultVariant;i[e].defaultVariant=t.defaultVariant;i[e].originalDefaultVariant=i[e].defaultVariant;var s=h.getStoredHashParams({model:this});if(s){if(i[e].defaultVariant!==i[e].currentVariant&&s.indexOf(i[e].currentVariant)===-1){h.update({parameters:s.concat(i[e].currentVariant),updateURL:!this._bDesignTimeMode,updateHashEntry:true,model:this})}else if(i[e].defaultVariant===i[e].currentVariant&&s.indexOf(i[e].currentVariant)>-1){s.splice(s.indexOf(i[e].currentVariant),1);h.update({parameters:s,updateURL:!this._bDesignTimeMode,updateHashEntry:true,model:this})}}if(n&&i[e].currentVariant!==t.defaultVariant){this.updateCurrentVariant({variantManagementReference:e,newVariantReference:t.defaultVariant,appComponent:t.appComponent})}break;default:break}var c=p.getContent(this.sFlexReference);if(a>-1){var l=p.setVariantData({variantData:o,vmReference:e,previousIndex:a,reference:this.sFlexReference});i[e].variants.splice(a,1);i[e].variants.splice(l,0,r)}else if(c[e]){c[e].defaultVariant=t.defaultVariant}this.setData(i);this.checkUpdate(true);return o};U.prototype._ensureStandardVariantExists=function(t){var n=this.getData();var a=n[t]||{};var o=e(a,["initPromise"]);if(!n[t]||r(o)){n[t]=i(a,{currentVariant:t,originalCurrentVariant:t,defaultVariant:t,originalDefaultVariant:t,variants:[{key:t,title:this._oResourceBundle.getText("STANDARD_VARIANT_TITLE"),originalTitle:this._oResourceBundle.getText("STANDARD_VARIANT_ORIGINAL_TITLE"),favorite:true,originalFavorite:true,executeOnSelect:false,originalExecuteOnSelect:false,visible:true,originalVisible:true,contexts:{},originalContexts:{},author:g.DEFAULT_AUTHOR}]});this.setData(n);var c={};c[t]={defaultVariant:t,variantManagementChanges:{},variants:[{content:{fileName:t,fileType:"ctrl_variant",variantManagementReference:t,variantReference:"",support:{user:g.DEFAULT_AUTHOR},content:{title:this._oResourceBundle.getText("STANDARD_VARIANT_TITLE"),favorite:true,visible:true,executeOnSelect:false},contexts:{}},controlChanges:[],variantChanges:{}}]};try{p.addFakeStandardVariant(this.sFlexReference,this.oAppComponent.getId(),c)}catch(e){s.error("Variants Map was not found: "+e.message)}}};U.prototype.setModelPropertiesForControl=function(e,t,n){this.oData[e].modified=false;this.oData[e].showFavorites=true;var a=this._bDesignTimeMode;if(a!==t){this._bDesignTimeMode=t;if(t){h.clearAllVariantURLParameters({model:this})}else if(a){h.update({parameters:h.getStoredHashParams({model:this}),updateURL:true,updateHashEntry:false,model:this})}}if(!(typeof this.fnManageClick==="function"&&typeof this.fnManageClickRta==="function")){this._initializeManageVariantsEvents()}n.detachManage(this.fnManageClick,this);if(t&&this.oData[e]._isEditable){this.oData[e].variantsEditable=false;this.oData[e].variants.forEach(function(n){n.rename=true;n.change=true;n.sharing=this.sharing.PUBLIC;n.remove=T(n,e,t)}.bind(this))}else if(this.oData[e]._isEditable){n.attachManage({variantManagementReference:e},this.fnManageClick,this);this.oData[e].variantsEditable=true;this.oData[e].variants.forEach(function(n){n.remove=T(n,e,t);switch(n.layer){case m.USER:n.rename=true;n.change=true;n.sharing=this.sharing.PRIVATE;E(n);break;case m.PUBLIC:var a=this._oUserInfoService&&this._oUserInfoService.getUser();var r=!a||a.getId().toUpperCase()===n.author.toUpperCase()||R.getInstanceOrUndef().isKeyUser();n.remove=r;n.rename=r;n.change=r;n.sharing=this.sharing.PUBLIC;break;default:n.rename=false;n.change=false;n.sharing=this.sharing.PUBLIC}}.bind(this))}else{this.oData[e].variantsEditable=false;this.oData[e].variants.forEach(function(e){e.remove=false;e.rename=false;e.change=false})}};U.prototype._initializeManageVariantsEvents=function(){this.fnManageClickRta=function(e,t){var n=this.collectModelChanges(t.variantManagementReference,t.layer);t.resolve(n)};this.fnManageClick=function(e,t){if(!this.oFlexController||!p.getContent(this.sFlexReference)){return}var n=this.collectModelChanges(t.variantManagementReference,m.USER);var a=[];n.forEach(function(e){e.appComponent=this.oAppComponent;a.push(this.addVariantChange(t.variantManagementReference,e))}.bind(this));this.oChangePersistence.saveDirtyChanges(this.oAppComponent,false,a)}};function A(e,t,n,a){if(!this._bDesignTimeMode){return e.saveSequenceOfDirtyChanges(t,a).then(function(e){if(e){var t=e.response[0];this.oData[n].variants.forEach(function(e){if(e.key===t.fileName){e.author=t.support.user}})}}.bind(this))}return Promise.resolve()}U.prototype._handleSaveEvent=function(e){if(!this._bDesignTimeMode){var t=e.getSource();var n=e.getParameters();return this._handleSave(t,n)}return Promise.resolve()};U.prototype._handleSave=function(e,t){var n=C.getAppComponentForControl(e);var a=this.getLocalId(e.getId(),n);var r;return M(function(e,t,n){var a=n.def;var i=n.execute;var o=this.getCurrentVariantReference(e);var s=p.getControlChangesForVariant({reference:this.sFlexReference,vmReference:e,vReference:o,changeInstance:true});if(n.overwrite){return this.oFlexController.saveSequenceOfDirtyChanges(this._getDirtyChangesFromVariantChanges(s),t)}var c=n.layer||(n.public?m.PUBLIC:m.USER);var l=n.newVariantReference||C.createDefaultFileName();var f={variantManagementReference:e,appComponent:t,layer:c,title:n.name,contexts:n.contexts,sourceVariantReference:o,newVariantReference:l,generator:n.generator};return this.copyVariant(f).then(function(n){if(a){var f={changeType:"setDefault",defaultVariant:l,originalDefaultVariant:this.oData[e].defaultVariant,appComponent:t,layer:c,variantManagementReference:e};var h=this.addVariantChange(e,f);n.push(h)}if(i){var u={changeType:"setExecuteOnSelect",executeOnSelect:true,variantReference:l,appComponent:t,layer:c,variantManagementReference:e};var p=this.addVariantChange(e,u);n.push(p)}r=n;return b({changes:s,vmReference:e,vReference:o,model:this}).then(A.bind(this,this.oFlexController,n,e,t))}.bind(this))}.bind(this,a,n,t),this,a).then(function(){this.oData[a].modified=false;this.checkUpdate(true);return r}.bind(this))};U.prototype.getLocalId=function(e,t){return c.getSelector(e,t).id};U.prototype.getVariantManagementReferenceForControl=function(e){var t=e.getId();var n=C.getAppComponentForControl(e);return n&&n.getLocalId(t)||t};U.prototype.switchToDefaultForVariantManagement=function(e){if(this.oData[e].currentVariant!==this.oData[e].defaultVariant){l.show(200);this.updateCurrentVariant({variantManagementReference:e,newVariantReference:this.oData[e].defaultVariant}).then(function(){l.hide()})}};U.prototype.switchToDefaultForVariant=function(e){Object.keys(this.oData).forEach(function(t){if(!e||this.oData[t].currentVariant===e){this.switchToDefaultForVariantManagement(t)}}.bind(this))};U.prototype.registerToModel=function(e){var t=this.getVariantManagementReferenceForControl(e);this._ensureStandardVariantExists(t);this.oData[t]._isEditable=e.getEditable();this.oData[t].showExecuteOnSelection=false;e.attachEvent("select",{vmReference:t,model:this},x);e.attachSave(this._handleSaveEvent,this);this.setModelPropertiesForControl(t,false,e);var n=e.getUpdateVariantInURL();this.oData[t].updateVariantInURL=n;h.registerControl({vmReference:t,updateURL:!!n,model:this});h.handleModelContextChange({model:this,vmControl:e});if(this.oData[t].initPromise){this.oData[t].initPromise.resolveFunction();delete this.oData[t].initPromise}this.oData[t].init=true};U.prototype.waitForVMControlInit=function(e){if(!this.oData[e]){this.oData[e]={}}else if(this.oData[e].init){return Promise.resolve()}this.oData[e].initPromise={};this.oData[e].initPromise.promise=new Promise(function(t){this.oData[e].initPromise.resolveFunction=t}.bind(this));return this.oData[e].initPromise.promise};U.prototype._getDirtyChangesFromVariantChanges=function(e){var t=e.map(function(e){return e.getDefinition().fileName});return this.oChangePersistence.getDirtyChanges().filter(function(e){return a(t,e.getId())&&!e.assignedToVariant})};U.prototype.checkDirtyStateForControlModels=function(e){e.forEach(function(e){var t=this.oData[e];var n=this.getCurrentVariantReference(e);var a=p.getControlChangesForVariant({reference:this.sFlexReference,vmReference:e,vReference:n,changeInstance:true});var r=this._getDirtyChangesFromVariantChanges(a);t.modified=r.length>0}.bind(this));this.checkUpdate(true)};U.prototype.getCurrentControlVariantIds=function(){return Object.keys(this.oData||{}).reduce(function(e,t){return e.concat([this.oData[t].currentVariant])}.bind(this),[])};U.prototype.getVariantManagementControlIds=function(){var e;return Object.keys(this.oData||{}).reduce(function(t,n){if(this.oAppComponent.byId(n)){e=this.oAppComponent.createId(n)}else{e=n}t.push(e);return t}.bind(this),[])};U.prototype.resetMap=function(e){var t=Object.keys(this.oData);t.forEach(function(e){var t={vmReference:e,currentVReference:this.oData[e].currentVariant||this.oData[e].defaultVariant,newVReference:true,appComponent:this.oAppComponent,flexController:this.oFlexController,modifier:c,reference:this.sFlexReference};return M(I.bind(this,t),this,e)}.bind(this));return this._oVariantSwitchPromise.then(function(){p.clearFakedStandardVariants(this.sFlexReference,this.oAppComponent.getId());p.resetContent(this.sFlexReference,this.oAppComponent.getId());if(!e){h.initialize({model:this});h.update({parameters:[],updateHashEntry:true,model:this})}}.bind(this))};U.prototype.getUShellService=function(e){return C.getUshellContainer()&&D[e]};return U});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/Storage",["sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/write/_internal/StorageFeaturesMerger","sap/ui/fl/apply/_internal/flexObjects/States","sap/base/util/ObjectPath"],function(e,n,t,r){"use strict";var a="sap/ui/fl/write/_internal/connectors/";function i(){return e.getConnectors(a,false)}function o(e,n){var t=n.filter(function(n){return n.layers.indexOf("ALL")!==-1||n.layers.indexOf(e)!==-1});if(t.length===1){return t[0]}if(t.length===0){throw new Error("No Connector configuration could be found to write into layer: "+e)}if(t.length>1){throw new Error("sap.ui.core.Configuration 'flexibilityServices' has a misconfiguration: Multiple Connector configurations were found to write into layer: "+e)}}function u(n){var t=n.map(function(n){return n.writeConnectorModule.loadFeatures({url:n.url}).then(function(e){return{features:e,layers:n.layers}}).catch(e.logAndResolveDefault.bind(null,{features:{},layers:n.layers},n,"loadFeatures"))});return Promise.all(t)}function l(e){if(!e){return Promise.reject("No layer was provided")}return i().then(o.bind(this,e))}function s(e){if(e.draft){return new Promise(function(n,t){sap.ui.require(["sap/ui/fl/write/api/FeaturesAPI"],function(r){r.isVersioningEnabled(e.layer).then(function(r){if(r){n()}else{t("Draft is not supported for the given layer: "+e.layer)}})})})}return Promise.resolve()}function c(e){var n;if(e.allChanges&&e.allChanges.length&&e.condensedChanges){n={namespace:e.allChanges[0].getDefinition().namespace,layer:e.layer,delete:{change:[]},update:{change:[]},reorder:{change:[]},create:{change:[],ctrl_variant_change:[],ctrl_variant_management_change:[]}};var r=0;var a=false;e.allChanges.forEach(function(i,o){if(i.getFileType()==="ctrl_variant"){return}var u=n.create[i.getFileType()].length;if(i.condenserState){var l=false;if(i.condenserState==="delete"){if(i.getState()===t.PERSISTED){n.delete.change.push(i.getFileName())}r++}else if(e.condensedChanges.length){l=e.allChanges[o].getFileName()!==e.condensedChanges[o-r].getFileName()}if((i.condenserState==="select"||i.condenserState==="update")&&l&&!a){var s=e.condensedChanges.slice(o-r).map(function(e){return e.getFileName()});n.reorder.change=s;a=true}if(i.condenserState==="select"&&i.getState()===t.NEW){n.create.change[u]={};n.create.change[u][i.getFileName()]=i.getDefinition()}else if(i.condenserState==="update"){var c=n.update.change.length;n.update.change[c]={};n.update.change[c][i.getFileName()]={content:i.getContent()}}delete i.condenserState}else if(i.getState()===t.NEW){n.create[i.getFileType()][u]={};n.create[i.getFileType()][u][i.getId()]=i.getDefinition()}})}return n}function f(e,n){return s(n).then(l.bind(undefined,n.layer)).then(function(t){n.url=t.url;var a=r.get(e,t.writeConnectorModule);return a.call(t.writeConnectorModule,n)})}var d={};d.write=function(e){return f("write",e)};d.condense=function(e){e.flexObjects=c(e);if(!e.flexObjects){return Promise.reject("No changes were provided")}return f("condense",e)};d.remove=function(e){return f("remove",e)};d.update=function(e){return f("update",e)};d.reset=function(e){return f("reset",e)};d.getFlexInfo=function(e){return f("getFlexInfo",e)};d.getContexts=function(e){return f("getContexts",e)};d.loadContextDescriptions=function(e){return f("loadContextDescriptions",e)};d.isContextSharingEnabled=function(e){return f("isContextSharingEnabled",e)};d.loadFeatures=function(){return i().then(u).then(n.mergeResults)};d.publish=function(e){return f("publish",e)};d.versions={load:function(e){return i().then(f.bind(undefined,"versions.load",e))},activate:function(e){return i().then(f.bind(undefined,"versions.activate",e))},discardDraft:function(e){return i().then(f.bind(undefined,"versions.discardDraft",e))}};return d});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/StorageFeaturesMerger",["sap/base/util/merge"],function(e){"use strict";var i={isKeyUser:false,isKeyUserTranslationEnabled:false,isVariantSharingEnabled:false,isPublicFlVariantEnabled:false,isVariantPersonalizationEnabled:true,isAtoAvailable:false,isAtoEnabled:false,versioning:{},isProductiveSystem:true,isPublicLayerAvailable:false,isZeroDowntimeUpgradeRunning:false,system:"",client:""};function a(e){var i={};var a=!!e.features.isVersioningEnabled;e.layers.forEach(function(e){i[e]=a});return i}return{mergeResults:function(n){var r=i;n.forEach(function(i){Object.keys(i.features).forEach(function(e){if(e!=="isVersioningEnabled"){r[e]=i.features[e]}});r.versioning=e(r.versioning,a(i))});return r}}});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/Versions",["sap/ui/fl/registry/Settings","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/write/_internal/Storage","sap/ui/model/json/JSONModel","sap/ui/fl/Utils","sap/ui/model/BindingMode"],function(e,r,t,n,i,s){"use strict";var a={};var o=9;var f=o+1;function d(e,r,t){var a=c(t);var f=sap.ui.fl.Versions.Original;t.forEach(function(e){if(e.version===sap.ui.fl.Versions.Draft){e.type="draft"}else if(f===sap.ui.fl.Versions.Original){e.type="active";f=e.version}else{e.type="inactive"}});return i.getUShellService("URLParsing").then(function(e){var d=i.getParameter(sap.ui.fl.Versions.UrlParameter,e);var l;if(d){l=parseInt(d)}else if(t.length>0){l=t[0].version}else{l=sap.ui.fl.Versions.Original}var p=new n({versioningEnabled:r,versions:t,activeVersion:f,backendDraft:a,dirtyChanges:false,draftAvailable:a,activateEnabled:a,persistedVersion:l,displayedVersion:l});p.setDefaultBindingMode(s.OneWay);p.setSizeLimit(o);p.setDirtyChanges=function(e){p.setProperty("/dirtyChanges",e);p.updateDraftVersion();p.updateBindings(true)};p.updateDraftVersion=function(){var e=p.getProperty("/versions");var r=p.getProperty("/versioningEnabled");var t=p.getProperty("/dirtyChanges");var n=p.getProperty("/backendDraft");var i=r&&(t||n);p.setProperty("/draftAvailable",i);var s=t?sap.ui.fl.Versions.Draft:p.getProperty("/persistedVersion");p.setProperty("/displayedVersion",s);if(!c(e)&&i){e.splice(0,0,{version:sap.ui.fl.Versions.Draft,type:"draft"})}if(c(e)&&!i){e.shift();p.setProperty("/displayedVersion",p.getProperty("/persistedVersion"))}var a=p.getProperty("/displayedVersion")!==p.getProperty("/activeVersion");p.setProperty("/activateEnabled",a)};return p})}function l(e,r){var t=[];var n=r.changePersistences;n.forEach(function(e){t=e.getDirtyChanges().concat();t.forEach(function(r){e.deleteChange(r,true)})});return t.length>0}function p(e){var t={dirtyChangesExist:false,changePersistences:[]};if(e.reference){var n=r.getChangePersistenceForComponent(e.reference);if(n.getDirtyChanges().length>0){t.dirtyChangesExist=true;t.changePersistences.push(n)}}if(e.nonNormalizedReference){var i=r.getChangePersistenceForComponent(e.nonNormalizedReference);if(i.getDirtyChanges().length>0){t.dirtyChangesExist=true;t.changePersistences.push(i)}}return t}function c(e){return e.some(function(e){return e.version===sap.ui.fl.Versions.Draft})}var v={};v.initialize=function(r){var n=r.reference;var i=r.layer;r.limit=f;return e.getInstance().then(function(e){var s=e.isVersioningEnabled(i);var o=s?t.versions.load(r):Promise.resolve([]);return o.then(function(e){return d(r,s,e)}).then(function(e){a[n]=a[n]||{};a[n][i]=a[n][i]||{};a[n][i]=e;return a[n][i]})})};v.getVersionsModel=function(e){var r=e.reference;var t=e.layer;if(!a[r]||!a[r][t]){throw Error("Versions Model for reference '"+r+"' and layer '"+t+"' were not initialized.")}var n=p(e);if(n.dirtyChangesExist){a[r][t].updateDraftVersion(e)}return a[r][t]};v.clearInstances=function(){a={}};v.onAllChangesSaved=function(e){e.reference=i.normalizeReference(e.reference);var r=v.getVersionsModel(e);var t=r.getProperty("/versioningEnabled");var n=r.getProperty("/dirtyChanges");r.setProperty("/dirtyChanges",true);r.setProperty("/backendDraft",t&&n);r.updateDraftVersion()};v.activate=function(e){var r=v.getVersionsModel(e);var n=r.getProperty("/versions");var i=c(n);var s=r.getProperty("/displayedVersion");var a=r.getProperty("/activeVersion");var o=r.getProperty("/persistedVersion");if(s===a){return Promise.reject("Version is already active")}e.version=s;var f=[];if(r.getProperty("/dirtyChanges")){var d=p(e);var l=d.changePersistences;f=l.map(function(r){return r.saveDirtyChanges(e.appComponent,false,undefined,o)})}return Promise.all(f).then(t.versions.activate.bind(undefined,e)).then(function(e){n.forEach(function(e){e.type="inactive"});e.type="active";if(i){n.shift()}n.splice(0,0,e);r.setProperty("/backendDraft",false);r.setProperty("/dirtyChanges",false);r.setProperty("/draftAvailable",false);r.setProperty("/activateEnabled",false);r.setProperty("/activeVersion",e.version);r.setProperty("/displayedVersion",e.version);r.setProperty("/persistedVersion",e.version);r.updateBindings(true)})};v.discardDraft=function(e){var r=v.getVersionsModel(e);var n=r.getProperty("/versions");var i=p(e);var s=r.getProperty("/backendDraft");var a=s?t.versions.discardDraft(e):Promise.resolve();return a.then(function(){n.shift();r.setProperty("/backendDraft",false);r.setProperty("/dirtyChanges",false);r.setProperty("/draftAvailable",false);r.setProperty("/activateEnabled",false);r.setProperty("/displayedVersion",r.getProperty("/persistedVersion"));r.updateBindings(true);var t=l(e,i);return{backendChangesDiscarded:s,dirtyChangesDiscarded:t}})};return v});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/Condenser",["sap/base/util/each","sap/base/util/isPlainObject","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Core","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/write/_internal/condenser/classifications/LastOneWins","sap/ui/fl/write/_internal/condenser/classifications/Reverse","sap/ui/fl/write/_internal/condenser/UIReconstruction","sap/ui/fl/write/_internal/condenser/Utils","sap/ui/fl/Change","sap/ui/fl/Utils","sap/ui/performance/Measurement"],function(e,n,t,r,i,a,s,o,f,c,u,l,d){"use strict";var p={};var C="unclassified";var h={lastOneWins:s,reverse:o};var g=["affectedControl","sourceContainer","targetContainer"];function v(e,n){var t=e[sap.ui.fl.condenser.Classification.Move];return n.classification===sap.ui.fl.condenser.Classification.Create&&t&&t[t.length-1].targetContainer===n.targetContainer}function y(e,n){return n.classification===sap.ui.fl.condenser.Classification.Move&&e[sap.ui.fl.condenser.Classification.Destroy]}function E(e,n){return n.classification===sap.ui.fl.condenser.Classification.Create&&e[sap.ui.fl.condenser.Classification.Destroy]}function m(e,n,t,r){if(!y(e,t)&&!E(e,t)){var i=t.classification;if(!e[i]){t.change=r;r.condenserState="select";e[i]=[t]}else{r.condenserState="delete"}e[i][0].updateChange=r}if(v(e,t)||E(e,t)){if(e[sap.ui.fl.condenser.Classification.Move]){e[sap.ui.fl.condenser.Classification.Move].forEach(function(e){e.change.condenserState="delete"});delete e[sap.ui.fl.condenser.Classification.Move]}if(e[sap.ui.fl.condenser.Classification.Destroy]){e[sap.ui.fl.condenser.Classification.Destroy].forEach(function(e){e.change.condenserState="delete"});delete e[sap.ui.fl.condenser.Classification.Destroy]}}return f.addChange(n,t)}function _(e,n,t,r,i){if(!e[r.type]){e[r.type]={}}var a=e[r.type];if(r.type===c.NOT_INDEX_RELEVANT){if(!a[r.classification]){a[r.classification]={}}var s=a[r.classification];h[r.classification].addToChangesMap(s,r.uniqueKey,i);return Promise.resolve()}t.push(i);return m(a,n,r,i)}function S(e,n,t){if(!e[n]){e[n]=[]}e[n].push(t);t.condenserState="select"}function I(e,n){var t=r.getControlIdBySelector(n.getSelector(),e);var s=i.byId(t);if(s){var o={modifier:r,appComponent:e,view:l.getViewForControl(s)};var f=a.getControlIfTemplateAffected(n,s,o);return Promise.resolve(a.getChangeHandler(n,f,o)).then(function(e){if(e&&typeof e.getCondenserInfo==="function"){return e.getCondenserInfo(n,o)}return undefined}).then(function(e){if(e&&f.bTemplateAffected){N(e,n)}return e}).catch(function(){return undefined})}return Promise.resolve()}function N(e,n){var t=n.getOriginalSelector();var r=n.getSelector();g.forEach(function(n){if(e[n]&&e[n]===r){e[n]=t}})}function M(e,n,t,i){var a=n!==undefined?n.affectedControl:r.getControlIdBySelector(t.getSelector(),i);if(!e[a]){e[a]={}}return e[a]}function x(e,n,t,r,i){return i.reduce(function(i,a){return i.then(A.bind(this,e,n,t,r,a))}.bind(this),Promise.resolve())}function A(e,n,t,r,i){return I(e,i).then(function(a){T(a,e);var s=M(n,a,i,e);if(a!==undefined){O(a);return _(s,t,r,a,i)}S(s,C,i);n[C]=true;return undefined})}function O(e){if(h[e.classification]){e.type=c.NOT_INDEX_RELEVANT}else{e.type=c.INDEX_RELEVANT}}function T(e,n){g.forEach(function(t){if(e&&e[t]){e[t]=r.getControlIdBySelector(e[t],n)}})}function D(t,r){e(t,function(e,i){if(h[e]&&h[e].getChangesFromMap){h[e].getChangesFromMap(t,e).forEach(function(e){r.push(e)})}else if(n(i)){return D(i,r)}else if(Array.isArray(i)){i.forEach(function(e){if(e instanceof u){r.push(e)}else{r.push(e.change)}})}});return r}function R(e){return D(e,[])}function b(t,r){e(t,function(e,t){if(n(t)){b(t,r)}else if(Array.isArray(t)){t.forEach(function(e){if(!(e instanceof u)){r.push(e)}})}});return r}function w(e,n){n.sort(function(n,t){return e.indexOf(n)-e.indexOf(t)})}function F(e,n){n.sort(function(n,t){return e.indexOf(n.change)-e.indexOf(t.change)})}function P(e,n){var t=e.map(function(e){return e.getId()});n.forEach(function(n){if(t.indexOf(n.getId())===-1){e.push(n)}})}function L(e,n){e.forEach(function(e){var t=e.updateChange;if(t&&t.getState()!==u.states.NEW){var r=e.change;if(t.getFileName()!==r.getFileName()){var i=r.getContent();t.setContent(i);r.condenserState="delete";n=n.map(function(e){if(e.getFileName()===r.getFileName()){return t}return e})}else{t.setState(u.states.DIRTY)}t.condenserState="update"}});return n}p.condense=function(e,n){d.start("Condenser_overall","Condenser overall - CondenserClass",["sap.ui.fl","Condenser"]);var r={};var i={};var a=[];var s=[];var o=[];n.slice(0).reverse().forEach(function(e){if(e instanceof u&&e.isApplyProcessFinished()){o.push(e)}else{s.push(e)}});d.start("Condenser_defineMaps","defining of maps - CondenserClass",["sap.ui.fl","Condenser"]);return x(e,r,i,a,o).then(function(){d.end("Condenser_defineMaps");var e=r[C];if(!e){f.compareAndUpdate(r,i)}var o=R(r);if(e){a.forEach(function(e){e.condenserState="select"});P(o,a)}o=o.concat(s);w(n,o);if(!e){d.start("Condenser_handleIndexRelatedChanges","handle index related changes - CondenserClass",["sap.ui.fl","Condenser"]);var c=true;var u=b(r,[]);F(n,u);var l;try{d.start("Condenser_sort","sort index related changes - CondenserClass",["sap.ui.fl","Condenser"]);l=f.sortIndexRelatedChanges(i,u)}catch(e){t.error("Error during Condensing: "+e.message,"No Condensing performed for index-relevant changes.");c=false}d.end("Condenser_sort");if(c){f.swapChanges(l,o);o=L(u,o)}else{a.forEach(function(e){e.condenserState="select"});P(o,a);w(n,o)}d.end("Condenser_handleIndexRelatedChanges")}d.end("Condenser_overall");return o})};return p});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/UIReconstruction",["sap/base/util/restricted/_isEqual","sap/base/util/each","sap/ui/fl/write/_internal/condenser/classifications/Create","sap/ui/fl/write/_internal/condenser/classifications/Destroy","sap/ui/fl/write/_internal/condenser/classifications/Move","sap/ui/fl/write/_internal/condenser/Utils"],function(n,e,t,i,r,a){"use strict";var c={};var o={create:t,destroy:i,move:r};function f(n,t){e(n,function(n,i){e(i,function(e,r){t(i,n,r,e)})})}function s(n,e,t){n.splice(t,0,n.splice(e,1)[0])}function u(n,e){var t={};f(n,function(n,i,r,c){var o=r[a.TARGET_UI];o.forEach(function(n){e.forEach(function(e){if(n===e.affectedControl){if(!t[i]){t[i]={}}var r=t[i];if(!r[c]){r[c]=[]}var a=r[c];a.push(e)}})})});return t}function l(n){return!n.some(function(n){return n.classification!==sap.ui.fl.condenser.Classification.Create})}function h(n){return!n.some(function(n){return a.isUnknown(n)})}function v(n){return n.getTargetIndex(n.change)}function d(n){n.sort(function(n,e){var t=v(n);var i=v(e);return t-i})}function E(n){return!n.some(function(n){return!a.isUnknown(n)})}function g(e,t){var i;if(e.length<t.length){i=t.slice(e.length);if(!E(i)){return false}t=t.slice(0,e.length)}else if(e.length>t.length){i=e.slice(t.length,e.length);if(!E(i)){return false}e=e.slice(0,t.length)}return n(e,t)}function I(n,e,t,i,r){var c={};r.forEach(function(n){var i=n.targetContainer;if(!c[i]){c[i]={}}var r=c[i];if(!r[e]){r[e]=a.initializeArrayWithPlaceholders(0,t.length-1)}o[n.classification].simulate(r[e],n,t)});var f=c[n][e];if(g(i,f)){return true}return false}function T(n,t){f(t,function(t,i,r){r[a.TARGET_UI].forEach(function(t,i){if(!a.isUnknown(t)){var r=n[t];var c=r[a.INDEX_RELEVANT];e(c,function(n,e){if(n!==sap.ui.fl.condenser.Classification.Destroy){e.forEach(function(n){n.setTargetIndex(n.change,i);n.change.condenserState="select"})}})}})})}function p(n,t){f(t,function(t,i,r,c){var o=r[a.INITIAL_UI];var f=r[a.TARGET_UI];if(g(o,f)){f.forEach(function(t){var i=n[t];if(i!==undefined){e(i[a.INDEX_RELEVANT],function(n,e){e.forEach(function(n){n.change.condenserState="delete"})});delete i[a.INDEX_RELEVANT]}});delete t[c]}})}function _(n,e){f(e,function(e,t,i){var r=i[a.INITIAL_UI];var c=i[a.TARGET_UI];r.forEach(function(e,t){var i=n[e];if(!i||!i[a.INDEX_RELEVANT]){var r=a.PLACEHOLDER+t;var o=c.indexOf(e);if(o>=0){c[o]=r}}})})}c.swapChanges=function(n,e){var t=n.map(function(n){return e.indexOf(n)}).sort();n.forEach(function(n){e[t.shift()]=n})};c.sortIndexRelatedChanges=function(n,e){var t=[];var i=u(n,e);f(i,function(e,i,r,c){var o=n[i][c][a.TARGET_UI];var f=n[i][c][a.INITIAL_UI];var u=true;if(h(o)||l(r)){d(r)}else if(!I(i,c,f,o,r)){u=false;var v=r.length;while(v!==0&&!u){var E=0;var g=1;while(g<r.length&&!u){s(r,E,g);u=I(i,c,f,o,r);E++;g++}v--}}if(!u){throw Error("no correct sorting found for the container: "+i)}r.forEach(function(n){t=t.concat(n.change)})});return t};c.addChange=function(n,e){return o[e.classification].addToReconstructionMap(n,e)};c.compareAndUpdate=function(n,e){p(n,e);_(n,e);T(n,e)};return c});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/Utils",["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Core"],function(e,n){"use strict";var i={};i.TARGET_UI="targetUI";i.INITIAL_UI="initialUI";i.PLACEHOLDER="X";i.INDEX_RELEVANT="indexRelevant";i.NOT_INDEX_RELEVANT="notIndexRelevant";function t(e,n){return(Math.max(e,n)||0)+1}i.getInitialUIContainerElementIds=function(e,n,t,r){if(!e[n]){e[n]={}}var a=e[n];if(!a[t]){a[t]={}}var l=a[t];if(!l[i.TARGET_UI]){l[i.TARGET_UI]=r}if(!l[i.INITIAL_UI]){l[i.INITIAL_UI]=r.slice(0)}return l[i.INITIAL_UI]};i.getContainerElementIds=function(i,t){var r=n.byId(i);return Promise.resolve().then(e.getAggregation.bind(e,r,t)).then(function(e){return e.map(function(e){return e.getId()})})};i.initializeArrayWithPlaceholders=function(e,n){var r=t(n,e);return Array(r).fill(i.PLACEHOLDER).map(function(e,n){return e+n})};i.extendArrayWithPlaceholders=function(e,n,r){var a=t(n,r);if(e.length<a){var l;for(var f=e.length;f<=a;f++){l=i.PLACEHOLDER+e.length;e.splice(e.length,0,l)}}};i.extendElementsArray=function(e,n,t,r){i.extendArrayWithPlaceholders(e,n,t);var a=e.indexOf(r);var l=e.indexOf(i.PLACEHOLDER+n);if(a!==n&&n!==undefined){if(a>=0){i.shiftElement(e,a,n)}else if(l>-1){e[l]=r}else if(i.isUnknown(e[n])){e[n]=r}}};i.shiftElement=function(e,n,i){e.splice(i,0,e.splice(n,1)[0])};i.isUnknown=function(e){if(e!==undefined&&e.indexOf(i.PLACEHOLDER)===0){var n=e.slice(1,e.length);var t=parseInt(n);if(isNaN(t)){return false}return true}return false};return i});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Create",["sap/ui/core/Core","sap/ui/fl/write/_internal/condenser/Utils"],function(e,t){"use strict";return{addToReconstructionMap:function(n,r){var a=e.byId(r.affectedControl);var i=a&&a.sParentAggregationName||r.targetAggregation;return t.getContainerElementIds(r.targetContainer,i).then(function(e){var a=t.getInitialUIContainerElementIds(n,r.targetContainer,r.targetAggregation,e);var i=a.indexOf(r.affectedControl);if(i>-1){a.splice(i,1)}})},simulate:function(e,t){e.splice(t.getTargetIndex(t.change),0,t.affectedControl)}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Destroy",["sap/ui/fl/write/_internal/condenser/Utils"],function(e){"use strict";return{addToReconstructionMap:function(n,t){return e.getContainerElementIds(t.targetContainer,t.targetAggregation).then(function(i){var r=e.getInitialUIContainerElementIds(n,t.targetContainer,t.targetAggregation,i);if(r.length-1<t.sourceIndex){while(r.length-1<t.sourceIndex){var a=r.length;r.splice(r.length,0,e.PLACEHOLDER+a)}r[t.sourceIndex]=t.affectedControl}else{r.splice(t.sourceIndex,0,t.affectedControl)}})},simulate:function(n,t,i){var r=n.indexOf(t.affectedControl);if(r===-1){var a=e.PLACEHOLDER+i.indexOf(t.affectedControl);r=n.indexOf(a)}if(r>-1){n.splice(r,1)}}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/LastOneWins",[],function(){"use strict";return{addToChangesMap:function(e,n,s){if(!e[n]){e[n]=[s];s.condenserState="select"}else{s.condenserState="delete"}}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Move",["sap/ui/fl/write/_internal/condenser/Utils"],function(e){"use strict";return{addToReconstructionMap:function(t,n){return Promise.all([e.getContainerElementIds(n.sourceContainer,n.sourceAggregation),e.getContainerElementIds(n.targetContainer,n.targetAggregation)]).then(function(r){var i=r[0];var a=r[1];var o;var g;if(n.targetContainer===n.sourceContainer&&n.targetAggregation===n.sourceAggregation){o=e.getInitialUIContainerElementIds(t,n.targetContainer,n.targetAggregation,a);g=o.indexOf(n.affectedControl);e.shiftElement(o,g,n.sourceIndex)}else{o=e.getInitialUIContainerElementIds(t,n.targetContainer,n.targetAggregation,a);g=o.indexOf(n.affectedControl);o.splice(g,1);o=e.getInitialUIContainerElementIds(t,n.sourceContainer,n.sourceAggregation,i);o.splice(n.sourceIndex,0,n.affectedControl)}})},simulate:function(t,n,r){var i=n.affectedControl;var a=r.indexOf(i);e.extendElementsArray(t,a,undefined,i);var o=t.indexOf(i);var g=n.getTargetIndex(n.change);if(a===-1){t.splice(g,0,i)}else{t.splice(g,0,t.splice(o,1)[0])}}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Reverse",["sap/base/util/each"],function(e){"use strict";return{addToChangesMap:function(e,n,t){if(!e[n]){e[n]=[]}e[n].push(t)},getChangesFromMap:function(n,t){var a=[];e(n[t],function(e,n){n.reverse();var t;n.forEach(function(e,a){if(t&&t.getChangeType()!==e.getChangeType()){t=null;n[a].condenserState="delete";n[a-1].condenserState="delete"}else{t=e;if(a>0){n[a-1].condenserState="delete"}n[a].condenserState="select"}});if(t){a.push(t)}});return a}}});
sap.ui.require.preload({
	"sap/ui/fl/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.fl","type":"library","embeds":["support/apps/contentbrowser","support/apps/uiFlexibilityDiagnostics","variants/context"],"applicationVersion":{"version":"1.97.0"},"title":"SAPUI5 library with sap.ui.fl controls.","description":"SAPUI5 library with sap.ui.fl controls.","ach":"CA-UI5-FL","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_hcb"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.97","libs":{"sap.ui.core":{"minVersion":"1.97.0"},"sap.m":{"minVersion":"1.97.0"}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":["sap.ui.fl.variants.VariantManagement","sap.ui.fl.util.IFrame"],"elements":[],"types":[],"interfaces":[]}}}}'
},"sap/ui/fl/library-preload");
sap.ui.loader.config({bundlesUI5:{
"sap/ui/fl/library-preload-apply.js":['sap/ui/fl/apply/_internal/changes/descriptor/ui5/SetMinUI5Version.js','sap/ui/fl/apply/_internal/changes/descriptor/ui5/SetFlexExtensionPointEnabled.js','sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddNewModelEnhanceWith.js','sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddNewModel.js','sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddLibrary.js','sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddComponentUsages.js','sap/ui/fl/apply/_internal/changes/descriptor/ovp/DeleteCard.js','sap/ui/fl/apply/_internal/changes/descriptor/ovp/ChangeCard.js','sap/ui/fl/apply/_internal/changes/descriptor/ovp/AddNewCard.js','sap/ui/fl/apply/_internal/changes/descriptor/fiori/SetRegistrationIds.js','sap/ui/fl/apply/_internal/changes/descriptor/fiori/SetAbstract.js','sap/ui/fl/apply/_internal/changes/descriptor/app/SetTitle.js','sap/ui/fl/apply/_internal/changes/descriptor/app/ChangeInbound.js','sap/ui/fl/apply/_internal/changes/descriptor/app/ChangeDataSource.js','sap/ui/fl/apply/_internal/changes/descriptor/app/AddAnnotationsToOData.js','sap/ui/fl/apply/_internal/flexState/compVariants/Utils.js','sap/ui/fl/apply/_internal/flexState/changes/ExtensionPointState.js','sap/ui/fl/apply/_internal/flexState/UI2Personalization/UI2PersonalizationState.js','sap/ui/fl/apply/_internal/changes/descriptor/RegistrationBuild.js','sap/ui/fl/apply/_internal/changes/descriptor/Registration.js','sap/ui/fl/apply/_internal/changes/descriptor/ApplyUtil.js','sap/ui/fl/apply/_internal/flexObjects/RevertData.js','sap/ui/fl/apply/_internal/flexObjects/CompVariantRevertData.js','sap/ui/fl/apply/_internal/extensionPoint/Processor.js','sap/ui/fl/apply/_internal/connectors/ObjectStorageUtils.js','sap/ui/fl/apply/_internal/connectors/ObjectStorageConnector.js','sap/ui/fl/apply/api/UI2PersonalizationApplyAPI.js','sap/ui/fl/apply/api/SmartVariantManagementApplyAPI.js','sap/ui/fl/apply/api/FlexRuntimeInfoAPI.js','sap/ui/fl/apply/api/ControlVariantApplyAPI.js','sap/ui/fl/apply/_internal/ChangesController.js','sap/ui/fl/util/IFrame.flexibility.js','sap/ui/fl/transport/TransportSelection.js','sap/ui/fl/transport/TransportDialog.js','sap/ui/fl/util/changePropertyValueByPath.js','sap/ui/fl/util/DescriptorChangeCheck.js','sap/ui/fl/write/api/ChangesWriteAPI.js','sap/ui/fl/write/_internal/connectors/LrepConnector.js','sap/ui/fl/variants/VariantManagement.js','sap/ui/fl/write/_internal/transport/TransportSelection.js','sap/ui/fl/write/_internal/transport/TransportDialog.js','sap/ui/fl/descriptorRelated/api/DescriptorChangeFactory.js','sap/ui/fl/write/_internal/appVariant/AppVariantInlineChangeFactory.js','sap/ui/fl/write/connectors/BaseConnector.js','sap/ui/fl/initial/_internal/connectors/LrepConnector.js','sap/ui/fl/initial/_internal/connectors/Utils.js','sap/ui/fl/write/_internal/connectors/Utils.js','sap/ui/fl/write/_internal/transport/Transports.js','sap/ui/fl/descriptorRelated/internal/Utils.js','sap/ui/fl/write/_internal/appVariant/AppVariantInlineChange.js'],
"sap/ui/fl/library-preload-write.js":['sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/timeEditor/TimeEditor.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/rangeEditor/RangeEditor.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/booleanEditor/BooleanEditor.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/validators/IsRequired.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/getEditorConfig.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/dialog/CustomFieldCAPDialog.js','sap/ui/fl/write/_internal/flexState/compVariants/CompVariantState.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/CAPAccess.js','sap/ui/fl/write/api/connectors/ObjectStorageConnector.js','sap/ui/fl/write/api/connectors/FileListBaseConnector.js','sap/ui/fl/write/_internal/flexState/FlexObjectState.js','sap/ui/fl/write/_internal/fieldExtensibility/Utils.js','sap/ui/fl/write/_internal/fieldExtensibility/UriParser.js','sap/ui/fl/write/_internal/fieldExtensibility/SingleTenantABAPExtensibilityVariant.js','sap/ui/fl/write/_internal/fieldExtensibility/ServiceValidation.js','sap/ui/fl/write/_internal/fieldExtensibility/MultiTenantABAPExtensibilityVariant.js','sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariantFactory.js','sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariant.js','sap/ui/fl/write/_internal/fieldExtensibility/ABAPAccess.js','sap/ui/fl/write/_internal/extensionPoint/Registry.js','sap/ui/fl/write/_internal/extensionPoint/Processor.js','sap/ui/fl/write/_internal/delegates/ODataV4ReadDelegate.js','sap/ui/fl/write/_internal/connectors/SessionStorageConnector.js','sap/ui/fl/write/_internal/connectors/PersonalizationConnector.js','sap/ui/fl/write/_internal/connectors/ObjectStorageConnector.js','sap/ui/fl/write/_internal/connectors/ObjectPathConnector.js','sap/ui/fl/write/_internal/connectors/NeoLrepConnector.js','sap/ui/fl/write/_internal/connectors/LocalStorageConnector.js','sap/ui/fl/write/_internal/connectors/KeyUserConnector.js','sap/ui/fl/write/_internal/connectors/JsObjectConnector.js','sap/ui/fl/write/_internal/connectors/BackendConnector.js','sap/ui/fl/write/_internal/appVariant/AppVariantFactory.js','sap/ui/fl/write/_internal/appVariant/AppVariant.js','sap/ui/fl/write/api/VersionsAPI.js','sap/ui/fl/write/api/UI2PersonalizationWriteAPI.js','sap/ui/fl/write/api/SmartVariantManagementWriteAPI.js','sap/ui/fl/write/api/SmartBusinessWriteAPI.js','sap/ui/fl/write/api/ReloadInfoAPI.js','sap/ui/fl/write/api/PersistenceWriteAPI.js','sap/ui/fl/write/api/LocalResetAPI.js','sap/ui/fl/write/api/FieldExtensibility.js','sap/ui/fl/write/api/FeaturesAPI.js','sap/ui/fl/write/api/ExtensionPointRegistryAPI.js','sap/ui/fl/write/api/ControlPersonalizationWriteAPI.js','sap/ui/fl/write/api/ContextSharingAPI.js','sap/ui/fl/write/api/AppVariantWriteAPI.js','sap/ui/fl/write/_internal/SaveAs.js','sap/ui/fl/descriptorRelated/api/DescriptorVariantFactory.js','sap/ui/fl/descriptorRelated/api/DescriptorInlineChangeFactory.js','sap/ui/fl/util/resolveBinding.js','sap/ui/fl/FakeLrepLocalStorage.js','sap/ui/fl/FakeLrepConnectorSessionStorage.js','sap/ui/fl/FakeLrepConnectorLocalStorage.js','sap/ui/fl/FakeLrepConnector.js','sap/ui/fl/initial/_internal/connectors/PersonalizationConnector.js','sap/ui/fl/initial/_internal/connectors/NeoLrepConnector.js','sap/ui/fl/initial/_internal/connectors/KeyUserConnector.js','sap/ui/fl/initial/_internal/connectors/BackendConnector.js','sap/ui/fl/variants/context/Component.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/timeEditor/TimeEditor.fragment.xml','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/rangeEditor/RangeEditor.fragment.xml','sap/ui/fl/write/_internal/fieldExtensibility/cap/dialog/CustomFieldCAPDialog.fragment.xml','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/booleanEditor/BooleanEditor.fragment.xml','sap/ui/fl/variants/context/view/ContextVisibility.view.xml','sap/ui/fl/variants/context/controller/ContextVisibility.controller.js']
}});
