/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/support/supportRules/Storage","sap/ui/support/supportRules/Constants","sap/ui/support/supportRules/ui/models/SelectionUtils","sap/ui/support/supportRules/ui/models/SharedModel","sap/ui/core/util/File","sap/base/util/extend","sap/ui/support/library"],function(e,t,s,i,r,o,n){"use strict";var l={model:i,getSystemPresets:function(){var e=[],t;for(t in n.SystemPresets){e.push(n.SystemPresets[t])}return e},initializeSelectionPresets:function(t){if(this.model.getProperty("/persistingSettings")){var i=e.getSelectionPresets();if(i){this.model.setProperty("/selectionPresets",i)}}var r=this.model.getProperty("/selectionPresets"),n=0;this.getSystemPresets().forEach(function(e){var t=r.some(function(t){if(e.id===t.id){if(!t.isModified){var i=t.selected;t=o({},e);t.selected=i;if(i){s.setSelectedRules(t.selections)}}return true}});if(!t){var i={disableDelete:true,isSystemPreset:true};r.splice(n+1,0,o(i,e))}n++});var l=null;r.some(function(e){if(e.selected){l=e;return true}});if(l.isMySelection){l.selections=t}this.model.setProperty("/selectionPresetsCurrent",l)},syncCurrentSelectionPreset:function(e){var t=this.model.getProperty("/selectionPresetsCurrent");t.selections=e;if(!(t.isModified||t.isMySelection)){t.isModified=true;t.title=t.title+" *"}this.model.setProperty("/selectionPresetsCurrent",t);if(l.isPersistingAllowed()){l.persistSelectionPresets()}},exportSelectionsToFile:function(e,s,i,o){var n={id:e,title:s,description:i,dateExported:(new Date).toISOString(),version:"1.0",selections:o};var l=JSON.stringify(n);r.save(l,t.RULE_SELECTION_EXPORT_FILE_NAME,"json","text/plain")},isValidSelectionImport:function(e){var t=true;if(!e.hasOwnProperty("title")){t=false}if(!e.hasOwnProperty("selections")){t=false}else if(!Array.isArray(e.selections)){t=false}else{for(var s=0;s<e.selections.length;s++){var i=e.selections[s];if(!i.hasOwnProperty("ruleId")||!i.hasOwnProperty("libName")){t=false;break}}}return t},persistSelectionPresets:function(){e.setSelectionPresets(this.model.getProperty("/selectionPresets"))},persistCustomPresets:function(){e.setCustomPresets(this.model.getProperty("/customPresets"))},isPersistingAllowed:function(){return!!e.readPersistenceCookie(t.COOKIE_NAME)},loadCustomPresets:function(){var t=e.getCustomPresets();if(t){this.model.setProperty("/customPresets",t)}}};return l});