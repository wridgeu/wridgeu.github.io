/*!
 * copyright
 */
sap.ui.define(["sap/base/assert","sap/base/config","sap/base/Event","sap/base/Eventing","sap/base/Log","sap/base/i18n/Localization","sap/base/util/deepEqual"],function(e,t,n,a,i,r,o){"use strict";var s=t.getWritableInstance();var h;var f;var c={getTheme:function(){var e=s.get({name:"sapTheme",type:s.Type.String,defaultValue:s.get({name:"sapUiTheme",type:s.Type.String,defaultValue:"base",external:true}),external:true});var t=e.indexOf("@");if(t>=0){var n=m(e.slice(t+1));e=t>0?e.slice(0,t):e;if(n!==c.getThemeRoot(e)){c.setThemeRoot(e,n)}}return u(e,c.getThemeRoot(e))},setTheme:function(e){if(e){if(e.indexOf("@")!==-1){throw new TypeError("Providing a theme root as part of the theme parameter is not allowed.")}var t=!h;h=h||{};var n=c.getTheme();s.set("sapTheme",e);var a=c.getTheme();var i=n!==a;if(i){h.theme={new:a,old:n}}else{h=undefined}if(t){l(h)}if(!f&&i){p({theme:a})}}return this},isApplied:function(){return!f||f.themeLoaded},getThemeRoot:function(e,t){var n=s.get({name:"sapUiThemeRoots",type:s.Type.Object});var a;e=e||c.getTheme();if(n[e]&&typeof n[e]==="string"){a=n[e]}else if(n[e]&&typeof n[e]==="object"){a=n[e][t]||n[e][""]}return a},setThemeRoot:function(t,n,a,i){e(typeof t==="string","sThemeName must be a string");e(typeof n==="string","sThemeBaseUrl must be a string");var r=!h;h=h||{};var f={name:"sapUiThemeRoots",type:s.Type.Object,defaultValue:{}};var p=s.get(f);var g=s.get(f);if(typeof a==="boolean"){i=a;a=undefined}g[t]=g[t]||{};if(typeof g[t]==="string"){g[t]={"":g[t]};p[t]={"":p[t]}}if(a){for(var m=0;m<a.length;m++){var u=a[m];g[t][u]=n}}else{g[t][""]=n}if(!o(p,g)){s.set("sapUiThemeRoots",g);if(a){h.themeRoots={new:Object.assign({},g[t]),old:Object.assign({},p[t])}}else{h.themeRoots={new:n,old:p[t]&&p[t][""]}}h.themeRoots.forceUpdate=i&&t===c.getTheme()}else{h=undefined}if(r){l()}},attachAppliedOnce:function(e){var t="applied";if(f){c.attachEventOnce(t,e)}else{e.call(c,new n(t,c,{theme:c.getTheme()}))}},attachApplied:function(e){var t="applied";c.attachEvent(t,e);if(!f){e.call(c,new n(t,c,{theme:c.getTheme()}))}},detachApplied:function(e){c.detachEvent("applied",e)},attachChange:function(e){c.attachEvent("change",e)},detachChange:function(e){c.detachEvent("change",e)},notifyContentDensityChanged:function(){p({theme:c.getTheme()})},registerThemeManager:function(e){f=e;f.attachEvent("ThemeChanged",function(e){p(n.getParameters(e))});r.attachChange(function(e){var t=e.rtl;if(t!==undefined){f._updateThemeUrls(c.getTheme())}})}};function l(){if(h){c.fireEvent("change",h);h=undefined}}function p(e){c.fireEvent("applied",e)}function g(e,t){var n=s.get({name:"sapAllowedThemeOrigins",type:s.Type.String});return!!n&&n.split(",").some(function(n){try{n=t&&!n.startsWith("//")?"//"+n:n;return n==="*"||e===new URL(n.trim(),globalThis.location.href).origin}catch(e){i.error("sapAllowedThemeOrigin provides invalid theme origin: "+n);return false}})}function m(e){var t=e.startsWith("//"),n,a;try{n=new URL(e,globalThis.location.href);n.search="";if(n.origin&&g(n.origin,t)){a=n.toString()}else{n=new URL(n.pathname,globalThis.location.href);a=n.toString()}if(t){a=a.replace(n.protocol,"")}return a+(a.endsWith("/")?"":"/")+"UI5/"}catch(e){}}function u(e,t){if(e&&t==null&&e.match(/^sap_corbu$/i)){return"sap_fiori_3"}return e}a.apply(c);return c});
//# sourceMappingURL=Theming.js.map